{
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/index.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "./plugins/xpack_main",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "main"
              }
            ]
          },
          {
            "source": "./plugins/graph",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "graph"
              }
            ]
          },
          {
            "source": "./plugins/monitoring",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "monitoring"
              }
            ]
          },
          {
            "source": "./plugins/reporting",
            "imported": [
              "reporting"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "reporting",
                "local": "reporting"
              }
            ]
          },
          {
            "source": "./plugins/security",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "security"
              }
            ]
          },
          {
            "source": "./plugins/searchprofiler",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "searchprofiler"
              }
            ]
          },
          {
            "source": "./plugins/tilemap",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "tilemap"
              }
            ]
          }
        ],
        "exports": {
          "exported": [],
          "specifiers": []
        }
      },
      "usedHelpers": [
        "interop-require-default"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _pluginsXpack_main = require('./plugins/xpack_main');\n\nvar _pluginsXpack_main2 = _interopRequireDefault(_pluginsXpack_main);\n\nvar _pluginsGraph = require('./plugins/graph');\n\nvar _pluginsGraph2 = _interopRequireDefault(_pluginsGraph);\n\nvar _pluginsMonitoring = require('./plugins/monitoring');\n\nvar _pluginsMonitoring2 = _interopRequireDefault(_pluginsMonitoring);\n\nvar _pluginsReporting = require('./plugins/reporting');\n\nvar _pluginsSecurity = require('./plugins/security');\n\nvar _pluginsSecurity2 = _interopRequireDefault(_pluginsSecurity);\n\nvar _pluginsSearchprofiler = require('./plugins/searchprofiler');\n\nvar _pluginsSearchprofiler2 = _interopRequireDefault(_pluginsSearchprofiler);\n\nvar _pluginsTilemap = require('./plugins/tilemap');\n\nvar _pluginsTilemap2 = _interopRequireDefault(_pluginsTilemap);\n\nmodule.exports = function (kibana) {\n  return [(0, _pluginsXpack_main2['default'])(kibana), (0, _pluginsGraph2['default'])(kibana), (0, _pluginsMonitoring2['default'])(kibana), (0, _pluginsReporting.reporting)(kibana), (0, _pluginsSecurity2['default'])(kibana), (0, _pluginsSearchprofiler2['default'])(kibana), (0, _pluginsTilemap2['default'])(kibana)];\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL2luZGV4LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7aUNBQWlCLHNCQUFzQjs7Ozs0QkFDckIsaUJBQWlCOzs7O2lDQUNaLHNCQUFzQjs7OztnQ0FDbkIscUJBQXFCOzsrQkFDMUIsb0JBQW9COzs7O3FDQUNkLDBCQUEwQjs7Ozs4QkFDakMsbUJBQW1COzs7O0FBRXZDLE1BQU0sQ0FBQyxPQUFPLEdBQUcsVUFBVSxNQUFNLEVBQUU7QUFDakMsU0FBTyxDQUNMLG9DQUFLLE1BQU0sQ0FBQyxFQUNaLCtCQUFNLE1BQU0sQ0FBQyxFQUNiLG9DQUFXLE1BQU0sQ0FBQyxFQUNsQixpQ0FBVSxNQUFNLENBQUMsRUFDakIsa0NBQVMsTUFBTSxDQUFDLEVBQ2hCLHdDQUFlLE1BQU0sQ0FBQyxFQUN0QixpQ0FBUSxNQUFNLENBQUMsQ0FDaEIsQ0FBQztDQUNILENBQUMiLCJmaWxlIjoiL3Vzci9zaGFyZS9raWJhbmEvcGx1Z2lucy94LXBhY2svaW5kZXguanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgbWFpbiBmcm9tICcuL3BsdWdpbnMveHBhY2tfbWFpbic7XG5pbXBvcnQgZ3JhcGggZnJvbSAnLi9wbHVnaW5zL2dyYXBoJztcbmltcG9ydCBtb25pdG9yaW5nIGZyb20gJy4vcGx1Z2lucy9tb25pdG9yaW5nJztcbmltcG9ydCB7IHJlcG9ydGluZyB9IGZyb20gJy4vcGx1Z2lucy9yZXBvcnRpbmcnO1xuaW1wb3J0IHNlY3VyaXR5IGZyb20gJy4vcGx1Z2lucy9zZWN1cml0eSc7XG5pbXBvcnQgc2VhcmNocHJvZmlsZXIgZnJvbSAnLi9wbHVnaW5zL3NlYXJjaHByb2ZpbGVyJztcbmltcG9ydCB0aWxlbWFwIGZyb20gJy4vcGx1Z2lucy90aWxlbWFwJztcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoa2liYW5hKSB7XG4gIHJldHVybiBbXG4gICAgbWFpbihraWJhbmEpLFxuICAgIGdyYXBoKGtpYmFuYSksXG4gICAgbW9uaXRvcmluZyhraWJhbmEpLFxuICAgIHJlcG9ydGluZyhraWJhbmEpLFxuICAgIHNlY3VyaXR5KGtpYmFuYSksXG4gICAgc2VhcmNocHJvZmlsZXIoa2liYW5hKSxcbiAgICB0aWxlbWFwKGtpYmFuYSlcbiAgXTtcbn07XG4iXX0=",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/index.js"
      ],
      "names": [],
      "mappings": ";;;;iCAAiB,sBAAsB;;;;4BACrB,iBAAiB;;;;iCACZ,sBAAsB;;;;gCACnB,qBAAqB;;+BAC1B,oBAAoB;;;;qCACd,0BAA0B;;;;8BACjC,mBAAmB;;;;AAEvC,MAAM,CAAC,OAAO,GAAG,UAAU,MAAM,EAAE;AACjC,SAAO,CACL,oCAAK,MAAM,CAAC,EACZ,+BAAM,MAAM,CAAC,EACb,oCAAW,MAAM,CAAC,EAClB,iCAAU,MAAM,CAAC,EACjB,kCAAS,MAAM,CAAC,EAChB,wCAAe,MAAM,CAAC,EACtB,iCAAQ,MAAM,CAAC,CAChB,CAAC;CACH,CAAC",
      "file": "/usr/share/kibana/plugins/x-pack/index.js",
      "sourcesContent": [
        "import main from './plugins/xpack_main';\nimport graph from './plugins/graph';\nimport monitoring from './plugins/monitoring';\nimport { reporting } from './plugins/reporting';\nimport security from './plugins/security';\nimport searchprofiler from './plugins/searchprofiler';\nimport tilemap from './plugins/tilemap';\n\nmodule.exports = function (kibana) {\n  return [\n    main(kibana),\n    graph(kibana),\n    monitoring(kibana),\n    reporting(kibana),\n    security(kibana),\n    searchprofiler(kibana),\n    tilemap(kibana)\n  ];\n};\n"
      ]
    },
    "mtime": 1491771502683
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/xpack_main/index.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "path",
            "imported": [
              "join",
              "resolve"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "join",
                "local": "join"
              },
              {
                "kind": "named",
                "imported": "resolve",
                "local": "resolve"
              }
            ]
          },
          {
            "source": "../../server/lib/mirror_plugin_status",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "mirrorPluginStatus"
              }
            ]
          },
          {
            "source": "../../server/lib/require_all_and_apply",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "requireAllAndApply"
              }
            ]
          },
          {
            "source": "./server/lib/replace_injected_vars",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "replaceInjectedVars"
              }
            ]
          },
          {
            "source": "./server/lib/setup_xpack_main",
            "imported": [
              "setupXPackMain"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "setupXPackMain",
                "local": "setupXPackMain"
              }
            ]
          },
          {
            "source": "../../server/lib/xpack_info",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "xpackInfo"
              }
            ]
          }
        ],
        "exports": {
          "exported": [],
          "specifiers": []
        }
      },
      "usedHelpers": [
        "interop-require-default"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _path = require('path');\n\nvar _serverLibMirror_plugin_status = require('../../server/lib/mirror_plugin_status');\n\nvar _serverLibMirror_plugin_status2 = _interopRequireDefault(_serverLibMirror_plugin_status);\n\nvar _serverLibRequire_all_and_apply = require('../../server/lib/require_all_and_apply');\n\nvar _serverLibRequire_all_and_apply2 = _interopRequireDefault(_serverLibRequire_all_and_apply);\n\nvar _serverLibReplace_injected_vars = require('./server/lib/replace_injected_vars');\n\nvar _serverLibReplace_injected_vars2 = _interopRequireDefault(_serverLibReplace_injected_vars);\n\nvar _serverLibSetup_xpack_main = require('./server/lib/setup_xpack_main');\n\nvar _serverLibXpack_info = require('../../server/lib/xpack_info');\n\nvar _serverLibXpack_info2 = _interopRequireDefault(_serverLibXpack_info);\n\nexports['default'] = function (kibana) {\n  return new kibana.Plugin({\n    id: 'xpack_main',\n    publicDir: (0, _path.resolve)(__dirname, 'public'),\n    require: ['elasticsearch'],\n    uiExports: {\n      hacks: ['plugins/xpack_main/hacks/check_xpack_info_change'],\n      replaceInjectedVars: _serverLibReplace_injected_vars2['default']\n    },\n\n    init: function init(server) {\n      var _this = this;\n\n      var elasticsearchPlugin = server.plugins.elasticsearch;\n      (0, _serverLibMirror_plugin_status2['default'])(elasticsearchPlugin, this, 'yellow', 'red');\n      elasticsearchPlugin.status.on('green', function () {\n        return (0, _serverLibSetup_xpack_main.setupXPackMain)(server, _this, _serverLibXpack_info2['default']);\n      });\n\n      return (0, _serverLibRequire_all_and_apply2['default'])((0, _path.join)(__dirname, 'server', 'routes', '**', '*.js'), server);\n    }\n  });\n};\n\nmodule.exports = exports['default'];\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMveHBhY2tfbWFpbi9pbmRleC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7OztvQkFBOEIsTUFBTTs7NkNBQ0wsdUNBQXVDOzs7OzhDQUN2Qyx3Q0FBd0M7Ozs7OENBQ3ZDLG9DQUFvQzs7Ozt5Q0FDckMsK0JBQStCOzttQ0FDeEMsNkJBQTZCOzs7O3FCQUVwQyxVQUFVLE1BQU0sRUFBRTtBQUMvQixTQUFPLElBQUksTUFBTSxDQUFDLE1BQU0sQ0FBQztBQUN2QixNQUFFLEVBQUUsWUFBWTtBQUNoQixhQUFTLEVBQUUsbUJBQVEsU0FBUyxFQUFFLFFBQVEsQ0FBQztBQUN2QyxXQUFPLEVBQUUsQ0FBQyxlQUFlLENBQUM7QUFDMUIsYUFBUyxFQUFFO0FBQ1QsV0FBSyxFQUFFLENBQ0wsa0RBQWtELENBQ25EO0FBQ0QseUJBQW1CLDZDQUFBO0tBQ3BCOztBQUVELFFBQUksRUFBRSxjQUFVLE1BQU0sRUFBRTs7O0FBQ3RCLFVBQU0sbUJBQW1CLEdBQUcsTUFBTSxDQUFDLE9BQU8sQ0FBQyxhQUFhLENBQUM7QUFDekQsc0RBQW1CLG1CQUFtQixFQUFFLElBQUksRUFBRSxRQUFRLEVBQUUsS0FBSyxDQUFDLENBQUM7QUFDL0QseUJBQW1CLENBQUMsTUFBTSxDQUFDLEVBQUUsQ0FBQyxPQUFPLEVBQUU7ZUFBTSwrQ0FBZSxNQUFNLDBDQUFrQjtPQUFBLENBQUMsQ0FBQzs7QUFFdEYsYUFBTyxpREFBbUIsZ0JBQUssU0FBUyxFQUFFLFFBQVEsRUFBRSxRQUFRLEVBQUUsSUFBSSxFQUFFLE1BQU0sQ0FBQyxFQUFFLE1BQU0sQ0FBQyxDQUFDO0tBQ3RGO0dBQ0YsQ0FBQyxDQUFDO0NBQ0oiLCJmaWxlIjoiL3Vzci9zaGFyZS9raWJhbmEvcGx1Z2lucy94LXBhY2svcGx1Z2lucy94cGFja19tYWluL2luZGV4LmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgam9pbiwgcmVzb2x2ZSB9IGZyb20gJ3BhdGgnO1xuaW1wb3J0IG1pcnJvclBsdWdpblN0YXR1cyBmcm9tICcuLi8uLi9zZXJ2ZXIvbGliL21pcnJvcl9wbHVnaW5fc3RhdHVzJztcbmltcG9ydCByZXF1aXJlQWxsQW5kQXBwbHkgZnJvbSAnLi4vLi4vc2VydmVyL2xpYi9yZXF1aXJlX2FsbF9hbmRfYXBwbHknO1xuaW1wb3J0IHJlcGxhY2VJbmplY3RlZFZhcnMgZnJvbSAnLi9zZXJ2ZXIvbGliL3JlcGxhY2VfaW5qZWN0ZWRfdmFycyc7XG5pbXBvcnQgeyBzZXR1cFhQYWNrTWFpbiB9IGZyb20gJy4vc2VydmVyL2xpYi9zZXR1cF94cGFja19tYWluJztcbmltcG9ydCB4cGFja0luZm8gZnJvbSAnLi4vLi4vc2VydmVyL2xpYi94cGFja19pbmZvJztcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gKGtpYmFuYSkge1xuICByZXR1cm4gbmV3IGtpYmFuYS5QbHVnaW4oe1xuICAgIGlkOiAneHBhY2tfbWFpbicsXG4gICAgcHVibGljRGlyOiByZXNvbHZlKF9fZGlybmFtZSwgJ3B1YmxpYycpLFxuICAgIHJlcXVpcmU6IFsnZWxhc3RpY3NlYXJjaCddLFxuICAgIHVpRXhwb3J0czoge1xuICAgICAgaGFja3M6IFtcbiAgICAgICAgJ3BsdWdpbnMveHBhY2tfbWFpbi9oYWNrcy9jaGVja194cGFja19pbmZvX2NoYW5nZScsXG4gICAgICBdLFxuICAgICAgcmVwbGFjZUluamVjdGVkVmFyc1xuICAgIH0sXG5cbiAgICBpbml0OiBmdW5jdGlvbiAoc2VydmVyKSB7XG4gICAgICBjb25zdCBlbGFzdGljc2VhcmNoUGx1Z2luID0gc2VydmVyLnBsdWdpbnMuZWxhc3RpY3NlYXJjaDtcbiAgICAgIG1pcnJvclBsdWdpblN0YXR1cyhlbGFzdGljc2VhcmNoUGx1Z2luLCB0aGlzLCAneWVsbG93JywgJ3JlZCcpO1xuICAgICAgZWxhc3RpY3NlYXJjaFBsdWdpbi5zdGF0dXMub24oJ2dyZWVuJywgKCkgPT4gc2V0dXBYUGFja01haW4oc2VydmVyLCB0aGlzLCB4cGFja0luZm8pKTtcblxuICAgICAgcmV0dXJuIHJlcXVpcmVBbGxBbmRBcHBseShqb2luKF9fZGlybmFtZSwgJ3NlcnZlcicsICdyb3V0ZXMnLCAnKionLCAnKi5qcycpLCBzZXJ2ZXIpO1xuICAgIH1cbiAgfSk7XG59XG4iXX0=",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/xpack_main/index.js"
      ],
      "names": [],
      "mappings": ";;;;;;;;oBAA8B,MAAM;;6CACL,uCAAuC;;;;8CACvC,wCAAwC;;;;8CACvC,oCAAoC;;;;yCACrC,+BAA+B;;mCACxC,6BAA6B;;;;qBAEpC,UAAU,MAAM,EAAE;AAC/B,SAAO,IAAI,MAAM,CAAC,MAAM,CAAC;AACvB,MAAE,EAAE,YAAY;AAChB,aAAS,EAAE,mBAAQ,SAAS,EAAE,QAAQ,CAAC;AACvC,WAAO,EAAE,CAAC,eAAe,CAAC;AAC1B,aAAS,EAAE;AACT,WAAK,EAAE,CACL,kDAAkD,CACnD;AACD,yBAAmB,6CAAA;KACpB;;AAED,QAAI,EAAE,cAAU,MAAM,EAAE;;;AACtB,UAAM,mBAAmB,GAAG,MAAM,CAAC,OAAO,CAAC,aAAa,CAAC;AACzD,sDAAmB,mBAAmB,EAAE,IAAI,EAAE,QAAQ,EAAE,KAAK,CAAC,CAAC;AAC/D,yBAAmB,CAAC,MAAM,CAAC,EAAE,CAAC,OAAO,EAAE;eAAM,+CAAe,MAAM,0CAAkB;OAAA,CAAC,CAAC;;AAEtF,aAAO,iDAAmB,gBAAK,SAAS,EAAE,QAAQ,EAAE,QAAQ,EAAE,IAAI,EAAE,MAAM,CAAC,EAAE,MAAM,CAAC,CAAC;KACtF;GACF,CAAC,CAAC;CACJ",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/xpack_main/index.js",
      "sourcesContent": [
        "import { join, resolve } from 'path';\nimport mirrorPluginStatus from '../../server/lib/mirror_plugin_status';\nimport requireAllAndApply from '../../server/lib/require_all_and_apply';\nimport replaceInjectedVars from './server/lib/replace_injected_vars';\nimport { setupXPackMain } from './server/lib/setup_xpack_main';\nimport xpackInfo from '../../server/lib/xpack_info';\n\nexport default function (kibana) {\n  return new kibana.Plugin({\n    id: 'xpack_main',\n    publicDir: resolve(__dirname, 'public'),\n    require: ['elasticsearch'],\n    uiExports: {\n      hacks: [\n        'plugins/xpack_main/hacks/check_xpack_info_change',\n      ],\n      replaceInjectedVars\n    },\n\n    init: function (server) {\n      const elasticsearchPlugin = server.plugins.elasticsearch;\n      mirrorPluginStatus(elasticsearchPlugin, this, 'yellow', 'red');\n      elasticsearchPlugin.status.on('green', () => setupXPackMain(server, this, xpackInfo));\n\n      return requireAllAndApply(join(__dirname, 'server', 'routes', '**', '*.js'), server);\n    }\n  });\n}\n"
      ]
    },
    "mtime": 1491771506103
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/server/lib/mirror_plugin_status.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [],
        "exports": {
          "exported": [
            "mirrorPluginStatus",
            "upstreamPlugin",
            "downstreamPlugin",
            "statesToMirror"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "mirrorPluginStatus",
              "exported": "default"
            },
            {
              "kind": "local",
              "local": "upstreamPlugin",
              "exported": "default"
            },
            {
              "kind": "local",
              "local": "downstreamPlugin",
              "exported": "default"
            },
            {
              "kind": "local",
              "local": "statesToMirror",
              "exported": "default"
            }
          ]
        }
      },
      "usedHelpers": []
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nexports['default'] = mirrorPluginStatus;\n\nfunction mirrorPluginStatus(upstreamPlugin, downstreamPlugin) {\n\n  function mirror(previousState, previousMsg, newState, newMsg) {\n    if (newState) {\n      downstreamPlugin.status[newState](newMsg);\n    }\n  }\n\n  for (var _len = arguments.length, statesToMirror = Array(_len > 2 ? _len - 2 : 0), _key = 2; _key < _len; _key++) {\n    statesToMirror[_key - 2] = arguments[_key];\n  }\n\n  if (statesToMirror.length === 0) {\n    statesToMirror.push('change');\n  }\n\n  statesToMirror.map(function (state) {\n    return upstreamPlugin.status.on(state, mirror);\n  });\n  mirror(null, null, upstreamPlugin.status.state, upstreamPlugin.status.message); // initial mirroring\n}\n\nmodule.exports = exports['default'];\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3NlcnZlci9saWIvbWlycm9yX3BsdWdpbl9zdGF0dXMuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7cUJBQXdCLGtCQUFrQjs7QUFBM0IsU0FBUyxrQkFBa0IsQ0FBQyxjQUFjLEVBQUUsZ0JBQWdCLEVBQXFCOztBQUU5RixXQUFTLE1BQU0sQ0FBQyxhQUFhLEVBQUUsV0FBVyxFQUFFLFFBQVEsRUFBRSxNQUFNLEVBQUU7QUFDNUQsUUFBSSxRQUFRLEVBQUU7QUFDWixzQkFBZ0IsQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUM7S0FDM0M7R0FDRjs7b0NBTjZFLGNBQWM7QUFBZCxrQkFBYzs7O0FBUTVGLE1BQUksY0FBYyxDQUFDLE1BQU0sS0FBSyxDQUFDLEVBQUU7QUFDL0Isa0JBQWMsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUM7R0FDL0I7O0FBRUQsZ0JBQWMsQ0FBQyxHQUFHLENBQUMsVUFBQSxLQUFLO1dBQUksY0FBYyxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUMsS0FBSyxFQUFFLE1BQU0sQ0FBQztHQUFBLENBQUMsQ0FBQztBQUNyRSxRQUFNLENBQUMsSUFBSSxFQUFFLElBQUksRUFBRSxjQUFjLENBQUMsTUFBTSxDQUFDLEtBQUssRUFBRSxjQUFjLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDO0NBQ2hGIiwiZmlsZSI6Ii91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3NlcnZlci9saWIvbWlycm9yX3BsdWdpbl9zdGF0dXMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBtaXJyb3JQbHVnaW5TdGF0dXModXBzdHJlYW1QbHVnaW4sIGRvd25zdHJlYW1QbHVnaW4sIC4uLnN0YXRlc1RvTWlycm9yKSB7XG5cbiAgZnVuY3Rpb24gbWlycm9yKHByZXZpb3VzU3RhdGUsIHByZXZpb3VzTXNnLCBuZXdTdGF0ZSwgbmV3TXNnKSB7XG4gICAgaWYgKG5ld1N0YXRlKSB7XG4gICAgICBkb3duc3RyZWFtUGx1Z2luLnN0YXR1c1tuZXdTdGF0ZV0obmV3TXNnKTtcbiAgICB9XG4gIH1cblxuICBpZiAoc3RhdGVzVG9NaXJyb3IubGVuZ3RoID09PSAwKSB7XG4gICAgc3RhdGVzVG9NaXJyb3IucHVzaCgnY2hhbmdlJyk7XG4gIH1cblxuICBzdGF0ZXNUb01pcnJvci5tYXAoc3RhdGUgPT4gdXBzdHJlYW1QbHVnaW4uc3RhdHVzLm9uKHN0YXRlLCBtaXJyb3IpKTtcbiAgbWlycm9yKG51bGwsIG51bGwsIHVwc3RyZWFtUGx1Z2luLnN0YXR1cy5zdGF0ZSwgdXBzdHJlYW1QbHVnaW4uc3RhdHVzLm1lc3NhZ2UpOyAvLyBpbml0aWFsIG1pcnJvcmluZ1xufVxuIl19",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/server/lib/mirror_plugin_status.js"
      ],
      "names": [],
      "mappings": ";;;;;qBAAwB,kBAAkB;;AAA3B,SAAS,kBAAkB,CAAC,cAAc,EAAE,gBAAgB,EAAqB;;AAE9F,WAAS,MAAM,CAAC,aAAa,EAAE,WAAW,EAAE,QAAQ,EAAE,MAAM,EAAE;AAC5D,QAAI,QAAQ,EAAE;AACZ,sBAAgB,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,MAAM,CAAC,CAAC;KAC3C;GACF;;oCAN6E,cAAc;AAAd,kBAAc;;;AAQ5F,MAAI,cAAc,CAAC,MAAM,KAAK,CAAC,EAAE;AAC/B,kBAAc,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;GAC/B;;AAED,gBAAc,CAAC,GAAG,CAAC,UAAA,KAAK;WAAI,cAAc,CAAC,MAAM,CAAC,EAAE,CAAC,KAAK,EAAE,MAAM,CAAC;GAAA,CAAC,CAAC;AACrE,QAAM,CAAC,IAAI,EAAE,IAAI,EAAE,cAAc,CAAC,MAAM,CAAC,KAAK,EAAE,cAAc,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;CAChF",
      "file": "/usr/share/kibana/plugins/x-pack/server/lib/mirror_plugin_status.js",
      "sourcesContent": [
        "export default function mirrorPluginStatus(upstreamPlugin, downstreamPlugin, ...statesToMirror) {\n\n  function mirror(previousState, previousMsg, newState, newMsg) {\n    if (newState) {\n      downstreamPlugin.status[newState](newMsg);\n    }\n  }\n\n  if (statesToMirror.length === 0) {\n    statesToMirror.push('change');\n  }\n\n  statesToMirror.map(state => upstreamPlugin.status.on(state, mirror));\n  mirror(null, null, upstreamPlugin.status.state, upstreamPlugin.status.message); // initial mirroring\n}\n"
      ]
    },
    "mtime": 1491771505397
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/server/lib/require_all_and_apply.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "bluebird",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "Promise"
              }
            ]
          },
          {
            "source": "glob",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "glob"
              }
            ]
          }
        ],
        "exports": {
          "exported": [],
          "specifiers": []
        }
      },
      "usedHelpers": [
        "interop-require-default"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _bluebird = require('bluebird');\n\nvar _bluebird2 = _interopRequireDefault(_bluebird);\n\nvar _glob = require('glob');\n\nvar _glob2 = _interopRequireDefault(_glob);\n\nexports['default'] = function (path, server) {\n  return new _bluebird2['default'](function (resolve, reject) {\n    (0, _glob2['default'])(path, { ignore: '**/__test__/**' }, function (err, files) {\n      if (err) return reject(err);\n      var modules = files.map(require);\n      modules.forEach(function (fn) {\n        fn(server);\n      });\n      resolve(modules);\n    });\n  });\n};\n\n;\nmodule.exports = exports['default'];\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3NlcnZlci9saWIvcmVxdWlyZV9hbGxfYW5kX2FwcGx5LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7O3dCQUFvQixVQUFVOzs7O29CQUNiLE1BQU07Ozs7cUJBRVIsVUFBVSxJQUFJLEVBQUUsTUFBTSxFQUFFO0FBQ3JDLFNBQU8sMEJBQVksVUFBVSxPQUFPLEVBQUUsTUFBTSxFQUFFO0FBQzVDLDJCQUFLLElBQUksRUFBRSxFQUFFLE1BQU0sRUFBRSxnQkFBZ0IsRUFBRSxFQUFFLFVBQVUsR0FBRyxFQUFFLEtBQUssRUFBRTtBQUM3RCxVQUFJLEdBQUcsRUFBRSxPQUFPLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQztBQUM1QixVQUFNLE9BQU8sR0FBRyxLQUFLLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxDQUFDO0FBQ25DLGFBQU8sQ0FBQyxPQUFPLENBQUMsVUFBVSxFQUFFLEVBQUU7QUFDNUIsVUFBRSxDQUFDLE1BQU0sQ0FBQyxDQUFDO09BQ1osQ0FBQyxDQUFDO0FBQ0gsYUFBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDO0tBQ2xCLENBQUMsQ0FBQztHQUNKLENBQUMsQ0FBQztDQUNKOztBQUFBLENBQUMiLCJmaWxlIjoiL3Vzci9zaGFyZS9raWJhbmEvcGx1Z2lucy94LXBhY2svc2VydmVyL2xpYi9yZXF1aXJlX2FsbF9hbmRfYXBwbHkuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUHJvbWlzZSBmcm9tICdibHVlYmlyZCc7XG5pbXBvcnQgZ2xvYiBmcm9tICdnbG9iJztcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gKHBhdGgsIHNlcnZlcikge1xuICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgIGdsb2IocGF0aCwgeyBpZ25vcmU6ICcqKi9fX3Rlc3RfXy8qKicgfSwgZnVuY3Rpb24gKGVyciwgZmlsZXMpIHtcbiAgICAgIGlmIChlcnIpIHJldHVybiByZWplY3QoZXJyKTtcbiAgICAgIGNvbnN0IG1vZHVsZXMgPSBmaWxlcy5tYXAocmVxdWlyZSk7XG4gICAgICBtb2R1bGVzLmZvckVhY2goZnVuY3Rpb24gKGZuKSB7XG4gICAgICAgIGZuKHNlcnZlcik7XG4gICAgICB9KTtcbiAgICAgIHJlc29sdmUobW9kdWxlcyk7XG4gICAgfSk7XG4gIH0pO1xufTtcbiJdfQ==",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/server/lib/require_all_and_apply.js"
      ],
      "names": [],
      "mappings": ";;;;;;;;wBAAoB,UAAU;;;;oBACb,MAAM;;;;qBAER,UAAU,IAAI,EAAE,MAAM,EAAE;AACrC,SAAO,0BAAY,UAAU,OAAO,EAAE,MAAM,EAAE;AAC5C,2BAAK,IAAI,EAAE,EAAE,MAAM,EAAE,gBAAgB,EAAE,EAAE,UAAU,GAAG,EAAE,KAAK,EAAE;AAC7D,UAAI,GAAG,EAAE,OAAO,MAAM,CAAC,GAAG,CAAC,CAAC;AAC5B,UAAM,OAAO,GAAG,KAAK,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;AACnC,aAAO,CAAC,OAAO,CAAC,UAAU,EAAE,EAAE;AAC5B,UAAE,CAAC,MAAM,CAAC,CAAC;OACZ,CAAC,CAAC;AACH,aAAO,CAAC,OAAO,CAAC,CAAC;KAClB,CAAC,CAAC;GACJ,CAAC,CAAC;CACJ;;AAAA,CAAC",
      "file": "/usr/share/kibana/plugins/x-pack/server/lib/require_all_and_apply.js",
      "sourcesContent": [
        "import Promise from 'bluebird';\nimport glob from 'glob';\n\nexport default function (path, server) {\n  return new Promise(function (resolve, reject) {\n    glob(path, { ignore: '**/__test__/**' }, function (err, files) {\n      if (err) return reject(err);\n      const modules = files.map(require);\n      modules.forEach(function (fn) {\n        fn(server);\n      });\n      resolve(modules);\n    });\n  });\n};\n"
      ]
    },
    "mtime": 1491771505397
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/xpack_main/server/lib/replace_injected_vars.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [],
        "exports": {
          "exported": [],
          "specifiers": []
        }
      },
      "usedHelpers": [
        "extends"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nexports['default'] = function replaceInjectedVars(originalInjectedVars, request, server) {\n  var xpackInfo, withXpackInfo;\n  return regeneratorRuntime.async(function replaceInjectedVars$(context$1$0) {\n    while (1) switch (context$1$0.prev = context$1$0.next) {\n      case 0:\n        xpackInfo = server.plugins.xpack_main.info;\n\n        withXpackInfo = function withXpackInfo() {\n          return _extends({}, originalInjectedVars, {\n            xpackInitialInfo: xpackInfo.toJSON()\n          });\n        };\n\n        if (server.plugins.security) {\n          context$1$0.next = 4;\n          break;\n        }\n\n        return context$1$0.abrupt('return', withXpackInfo());\n\n      case 4:\n        if (!(!xpackInfo || !xpackInfo.feature('security').getLicenseCheckResults())) {\n          context$1$0.next = 6;\n          break;\n        }\n\n        return context$1$0.abrupt('return', originalInjectedVars);\n\n      case 6:\n        if (!xpackInfo.license.isOneOf('basic')) {\n          context$1$0.next = 8;\n          break;\n        }\n\n        return context$1$0.abrupt('return', withXpackInfo());\n\n      case 8:\n        context$1$0.next = 10;\n        return regeneratorRuntime.awrap(server.plugins.security.isAuthenticated(request));\n\n      case 10:\n        if (context$1$0.sent) {\n          context$1$0.next = 12;\n          break;\n        }\n\n        return context$1$0.abrupt('return', originalInjectedVars);\n\n      case 12:\n        return context$1$0.abrupt('return', withXpackInfo());\n\n      case 13:\n      case 'end':\n        return context$1$0.stop();\n    }\n  }, null, this);\n};\n\nmodule.exports = exports['default'];\n\n// kibana plugin is disabled\n\n// not enough license info to make decision one way or another\n\n// authentication is not a thing you can do\n\n// request is not authenticated\n\n// plugin enabled, license is appropriate, request is authenticated\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMveHBhY2tfbWFpbi9zZXJ2ZXIvbGliL3JlcGxhY2VfaW5qZWN0ZWRfdmFycy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7OztxQkFBZSxTQUFlLG1CQUFtQixDQUFDLG9CQUFvQixFQUFFLE9BQU8sRUFBRSxNQUFNO01BQy9FLFNBQVMsRUFDVCxhQUFhOzs7O0FBRGIsaUJBQVMsR0FBRyxNQUFNLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQyxJQUFJOztBQUMxQyxxQkFBYSxHQUFHLFNBQWhCLGFBQWE7OEJBQ2Qsb0JBQW9CO0FBQ3ZCLDRCQUFnQixFQUFFLFNBQVMsQ0FBQyxNQUFNLEVBQUU7O1NBQ3BDOztZQUdHLE1BQU0sQ0FBQyxPQUFPLENBQUMsUUFBUTs7Ozs7NENBQ25CLGFBQWEsRUFBRTs7O2NBSXBCLENBQUMsU0FBUyxJQUFJLENBQUMsU0FBUyxDQUFDLE9BQU8sQ0FBQyxVQUFVLENBQUMsQ0FBQyxzQkFBc0IsRUFBRSxDQUFBOzs7Ozs0Q0FDaEUsb0JBQW9COzs7YUFJekIsU0FBUyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDOzs7Ozs0Q0FDN0IsYUFBYSxFQUFFOzs7O3dDQUliLE1BQU0sQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLGVBQWUsQ0FBQyxPQUFPLENBQUM7Ozs7Ozs7OzRDQUNsRCxvQkFBb0I7Ozs0Q0FJdEIsYUFBYSxFQUFFOzs7Ozs7O0NBQ3ZCIiwiZmlsZSI6Ii91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMveHBhY2tfbWFpbi9zZXJ2ZXIvbGliL3JlcGxhY2VfaW5qZWN0ZWRfdmFycy5qcyIsInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIHJlcGxhY2VJbmplY3RlZFZhcnMob3JpZ2luYWxJbmplY3RlZFZhcnMsIHJlcXVlc3QsIHNlcnZlcikge1xuICBjb25zdCB4cGFja0luZm8gPSBzZXJ2ZXIucGx1Z2lucy54cGFja19tYWluLmluZm87XG4gIGNvbnN0IHdpdGhYcGFja0luZm8gPSAoKSA9PiAoe1xuICAgIC4uLm9yaWdpbmFsSW5qZWN0ZWRWYXJzLFxuICAgIHhwYWNrSW5pdGlhbEluZm86IHhwYWNrSW5mby50b0pTT04oKSxcbiAgfSk7XG5cbiAgLy8ga2liYW5hIHBsdWdpbiBpcyBkaXNhYmxlZFxuICBpZiAoIXNlcnZlci5wbHVnaW5zLnNlY3VyaXR5KSB7XG4gICAgcmV0dXJuIHdpdGhYcGFja0luZm8oKTtcbiAgfVxuXG4gIC8vIG5vdCBlbm91Z2ggbGljZW5zZSBpbmZvIHRvIG1ha2UgZGVjaXNpb24gb25lIHdheSBvciBhbm90aGVyXG4gIGlmICgheHBhY2tJbmZvIHx8ICF4cGFja0luZm8uZmVhdHVyZSgnc2VjdXJpdHknKS5nZXRMaWNlbnNlQ2hlY2tSZXN1bHRzKCkpIHtcbiAgICByZXR1cm4gb3JpZ2luYWxJbmplY3RlZFZhcnM7XG4gIH1cblxuICAvLyBhdXRoZW50aWNhdGlvbiBpcyBub3QgYSB0aGluZyB5b3UgY2FuIGRvXG4gIGlmICh4cGFja0luZm8ubGljZW5zZS5pc09uZU9mKCdiYXNpYycpKSB7XG4gICAgcmV0dXJuIHdpdGhYcGFja0luZm8oKTtcbiAgfVxuXG4gIC8vIHJlcXVlc3QgaXMgbm90IGF1dGhlbnRpY2F0ZWRcbiAgaWYgKCFhd2FpdCBzZXJ2ZXIucGx1Z2lucy5zZWN1cml0eS5pc0F1dGhlbnRpY2F0ZWQocmVxdWVzdCkpIHtcbiAgICByZXR1cm4gb3JpZ2luYWxJbmplY3RlZFZhcnM7XG4gIH1cblxuICAvLyBwbHVnaW4gZW5hYmxlZCwgbGljZW5zZSBpcyBhcHByb3ByaWF0ZSwgcmVxdWVzdCBpcyBhdXRoZW50aWNhdGVkXG4gIHJldHVybiB3aXRoWHBhY2tJbmZvKCk7XG59XG4iXX0=",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/xpack_main/server/lib/replace_injected_vars.js"
      ],
      "names": [],
      "mappings": ";;;;;;;;qBAAe,SAAe,mBAAmB,CAAC,oBAAoB,EAAE,OAAO,EAAE,MAAM;MAC/E,SAAS,EACT,aAAa;;;;AADb,iBAAS,GAAG,MAAM,CAAC,OAAO,CAAC,UAAU,CAAC,IAAI;;AAC1C,qBAAa,GAAG,SAAhB,aAAa;8BACd,oBAAoB;AACvB,4BAAgB,EAAE,SAAS,CAAC,MAAM,EAAE;;SACpC;;YAGG,MAAM,CAAC,OAAO,CAAC,QAAQ;;;;;4CACnB,aAAa,EAAE;;;cAIpB,CAAC,SAAS,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,UAAU,CAAC,CAAC,sBAAsB,EAAE,CAAA;;;;;4CAChE,oBAAoB;;;aAIzB,SAAS,CAAC,OAAO,CAAC,OAAO,CAAC,OAAO,CAAC;;;;;4CAC7B,aAAa,EAAE;;;;wCAIb,MAAM,CAAC,OAAO,CAAC,QAAQ,CAAC,eAAe,CAAC,OAAO,CAAC;;;;;;;;4CAClD,oBAAoB;;;4CAItB,aAAa,EAAE;;;;;;;CACvB",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/xpack_main/server/lib/replace_injected_vars.js",
      "sourcesContent": [
        "export default async function replaceInjectedVars(originalInjectedVars, request, server) {\n  const xpackInfo = server.plugins.xpack_main.info;\n  const withXpackInfo = () => ({\n    ...originalInjectedVars,\n    xpackInitialInfo: xpackInfo.toJSON(),\n  });\n\n  // kibana plugin is disabled\n  if (!server.plugins.security) {\n    return withXpackInfo();\n  }\n\n  // not enough license info to make decision one way or another\n  if (!xpackInfo || !xpackInfo.feature('security').getLicenseCheckResults()) {\n    return originalInjectedVars;\n  }\n\n  // authentication is not a thing you can do\n  if (xpackInfo.license.isOneOf('basic')) {\n    return withXpackInfo();\n  }\n\n  // request is not authenticated\n  if (!await server.plugins.security.isAuthenticated(request)) {\n    return originalInjectedVars;\n  }\n\n  // plugin enabled, license is appropriate, request is authenticated\n  return withXpackInfo();\n}\n"
      ]
    },
    "mtime": 1491771510565
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/xpack_main/server/lib/setup_xpack_main.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "lodash",
            "imported": [
              "once",
              "partial"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "once",
                "local": "once"
              },
              {
                "kind": "named",
                "imported": "partial",
                "local": "partial"
              }
            ]
          },
          {
            "source": "./inject_xpack_info_signature",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "injectXPackInfoSignature"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "setupXPackMain",
            "server",
            "xpackMainPlugin",
            "xpackInfo"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "setupXPackMain",
              "exported": "setupXPackMain"
            },
            {
              "kind": "local",
              "local": "server",
              "exported": "server"
            },
            {
              "kind": "local",
              "local": "xpackMainPlugin",
              "exported": "xpackMainPlugin"
            },
            {
              "kind": "local",
              "local": "xpackInfo",
              "exported": "xpackInfo"
            }
          ]
        }
      },
      "usedHelpers": [
        "interop-require-default"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nexports.setupXPackMain = setupXPackMain;\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _lodash = require('lodash');\n\nvar _inject_xpack_info_signature = require('./inject_xpack_info_signature');\n\nvar _inject_xpack_info_signature2 = _interopRequireDefault(_inject_xpack_info_signature);\n\nvar registerPreResponseHandlerSingleton = (0, _lodash.once)(function (server, info) {\n  server.ext('onPreResponse', (0, _lodash.partial)(_inject_xpack_info_signature2['default'], info));\n});\n\n/**\n * Setup the X-Pack Main plugin. This is fired every time that the Elasticsearch plugin becomes Green.\n *\n * This will ensure that X-Pack is installed on the Elasticsearch cluster, as well as trigger the initial\n * polling for _xpack/info.\n *\n * @param server {Object} The Kibana server object.\n * @param xpackMainPlugin {Object} The X-Pack Main plugin object.\n * @return {Promise} Never {@code null}.\n */\n\nfunction setupXPackMain(server, xpackMainPlugin, xpackInfo) {\n  return xpackInfo(server).then(function (info) {\n    server.expose('info', info);\n    registerPreResponseHandlerSingleton(server, info);\n  }).then(function () {\n    return xpackMainPlugin.status.green('Ready');\n  })['catch'](function (reason) {\n    var errorMessage = reason;\n\n    if (reason instanceof Error && reason.status === 400) {\n      errorMessage = 'X-Pack plugin is not installed on Elasticsearch cluster';\n    }\n\n    server.expose('info', reason.info);\n\n    xpackMainPlugin.status.red(errorMessage);\n  });\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMveHBhY2tfbWFpbi9zZXJ2ZXIvbGliL3NldHVwX3hwYWNrX21haW4uanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O3NCQUE4QixRQUFROzsyQ0FDRCwrQkFBK0I7Ozs7QUFFcEUsSUFBTSxtQ0FBbUMsR0FBRyxrQkFBSyxVQUFDLE1BQU0sRUFBRSxJQUFJLEVBQUs7QUFDakUsUUFBTSxDQUFDLEdBQUcsQ0FBQyxlQUFlLEVBQUUsK0RBQWtDLElBQUksQ0FBQyxDQUFDLENBQUM7Q0FDdEUsQ0FBQyxDQUFDOzs7Ozs7Ozs7Ozs7O0FBWUksU0FBUyxjQUFjLENBQUMsTUFBTSxFQUFFLGVBQWUsRUFBRSxTQUFTLEVBQUU7QUFDakUsU0FBTyxTQUFTLENBQUMsTUFBTSxDQUFDLENBQ3ZCLElBQUksQ0FBQyxVQUFBLElBQUksRUFBSTtBQUNaLFVBQU0sQ0FBQyxNQUFNLENBQUMsTUFBTSxFQUFFLElBQUksQ0FBQyxDQUFDO0FBQzVCLHVDQUFtQyxDQUFDLE1BQU0sRUFBRSxJQUFJLENBQUMsQ0FBQztHQUNuRCxDQUFDLENBQ0QsSUFBSSxDQUFDO1dBQU0sZUFBZSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDO0dBQUEsQ0FBQyxTQUM1QyxDQUFDLFVBQUEsTUFBTSxFQUFJO0FBQ2YsUUFBSSxZQUFZLEdBQUcsTUFBTSxDQUFDOztBQUUxQixRQUFJLEFBQUMsTUFBTSxZQUFZLEtBQUssSUFBSyxNQUFNLENBQUMsTUFBTSxLQUFLLEdBQUcsRUFBRTtBQUN0RCxrQkFBWSxHQUFHLHlEQUF5RCxDQUFDO0tBQzFFOztBQUVELFVBQU0sQ0FBQyxNQUFNLENBQUMsTUFBTSxFQUFFLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQzs7QUFFbkMsbUJBQWUsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLFlBQVksQ0FBQyxDQUFDO0dBQzFDLENBQUMsQ0FBQztDQUNKIiwiZmlsZSI6Ii91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMveHBhY2tfbWFpbi9zZXJ2ZXIvbGliL3NldHVwX3hwYWNrX21haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBvbmNlLCBwYXJ0aWFsIH0gZnJvbSAnbG9kYXNoJztcbmltcG9ydCBpbmplY3RYUGFja0luZm9TaWduYXR1cmUgZnJvbSAnLi9pbmplY3RfeHBhY2tfaW5mb19zaWduYXR1cmUnO1xuXG5jb25zdCByZWdpc3RlclByZVJlc3BvbnNlSGFuZGxlclNpbmdsZXRvbiA9IG9uY2UoKHNlcnZlciwgaW5mbykgPT4ge1xuICBzZXJ2ZXIuZXh0KCdvblByZVJlc3BvbnNlJywgcGFydGlhbChpbmplY3RYUGFja0luZm9TaWduYXR1cmUsIGluZm8pKTtcbn0pO1xuXG4vKipcbiAqIFNldHVwIHRoZSBYLVBhY2sgTWFpbiBwbHVnaW4uIFRoaXMgaXMgZmlyZWQgZXZlcnkgdGltZSB0aGF0IHRoZSBFbGFzdGljc2VhcmNoIHBsdWdpbiBiZWNvbWVzIEdyZWVuLlxuICpcbiAqIFRoaXMgd2lsbCBlbnN1cmUgdGhhdCBYLVBhY2sgaXMgaW5zdGFsbGVkIG9uIHRoZSBFbGFzdGljc2VhcmNoIGNsdXN0ZXIsIGFzIHdlbGwgYXMgdHJpZ2dlciB0aGUgaW5pdGlhbFxuICogcG9sbGluZyBmb3IgX3hwYWNrL2luZm8uXG4gKlxuICogQHBhcmFtIHNlcnZlciB7T2JqZWN0fSBUaGUgS2liYW5hIHNlcnZlciBvYmplY3QuXG4gKiBAcGFyYW0geHBhY2tNYWluUGx1Z2luIHtPYmplY3R9IFRoZSBYLVBhY2sgTWFpbiBwbHVnaW4gb2JqZWN0LlxuICogQHJldHVybiB7UHJvbWlzZX0gTmV2ZXIge0Bjb2RlIG51bGx9LlxuICovXG5leHBvcnQgZnVuY3Rpb24gc2V0dXBYUGFja01haW4oc2VydmVyLCB4cGFja01haW5QbHVnaW4sIHhwYWNrSW5mbykge1xuICByZXR1cm4geHBhY2tJbmZvKHNlcnZlcilcbiAgLnRoZW4oaW5mbyA9PiB7XG4gICAgc2VydmVyLmV4cG9zZSgnaW5mbycsIGluZm8pO1xuICAgIHJlZ2lzdGVyUHJlUmVzcG9uc2VIYW5kbGVyU2luZ2xldG9uKHNlcnZlciwgaW5mbyk7XG4gIH0pXG4gIC50aGVuKCgpID0+IHhwYWNrTWFpblBsdWdpbi5zdGF0dXMuZ3JlZW4oJ1JlYWR5JykpXG4gIC5jYXRjaChyZWFzb24gPT4ge1xuICAgIGxldCBlcnJvck1lc3NhZ2UgPSByZWFzb247XG5cbiAgICBpZiAoKHJlYXNvbiBpbnN0YW5jZW9mIEVycm9yKSAmJiByZWFzb24uc3RhdHVzID09PSA0MDApIHtcbiAgICAgIGVycm9yTWVzc2FnZSA9ICdYLVBhY2sgcGx1Z2luIGlzIG5vdCBpbnN0YWxsZWQgb24gRWxhc3RpY3NlYXJjaCBjbHVzdGVyJztcbiAgICB9XG5cbiAgICBzZXJ2ZXIuZXhwb3NlKCdpbmZvJywgcmVhc29uLmluZm8pO1xuXG4gICAgeHBhY2tNYWluUGx1Z2luLnN0YXR1cy5yZWQoZXJyb3JNZXNzYWdlKTtcbiAgfSk7XG59XG4iXX0=",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/xpack_main/server/lib/setup_xpack_main.js"
      ],
      "names": [],
      "mappings": ";;;;;;;;;sBAA8B,QAAQ;;2CACD,+BAA+B;;;;AAEpE,IAAM,mCAAmC,GAAG,kBAAK,UAAC,MAAM,EAAE,IAAI,EAAK;AACjE,QAAM,CAAC,GAAG,CAAC,eAAe,EAAE,+DAAkC,IAAI,CAAC,CAAC,CAAC;CACtE,CAAC,CAAC;;;;;;;;;;;;;AAYI,SAAS,cAAc,CAAC,MAAM,EAAE,eAAe,EAAE,SAAS,EAAE;AACjE,SAAO,SAAS,CAAC,MAAM,CAAC,CACvB,IAAI,CAAC,UAAA,IAAI,EAAI;AACZ,UAAM,CAAC,MAAM,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;AAC5B,uCAAmC,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;GACnD,CAAC,CACD,IAAI,CAAC;WAAM,eAAe,CAAC,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC;GAAA,CAAC,SAC5C,CAAC,UAAA,MAAM,EAAI;AACf,QAAI,YAAY,GAAG,MAAM,CAAC;;AAE1B,QAAI,AAAC,MAAM,YAAY,KAAK,IAAK,MAAM,CAAC,MAAM,KAAK,GAAG,EAAE;AACtD,kBAAY,GAAG,yDAAyD,CAAC;KAC1E;;AAED,UAAM,CAAC,MAAM,CAAC,MAAM,EAAE,MAAM,CAAC,IAAI,CAAC,CAAC;;AAEnC,mBAAe,CAAC,MAAM,CAAC,GAAG,CAAC,YAAY,CAAC,CAAC;GAC1C,CAAC,CAAC;CACJ",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/xpack_main/server/lib/setup_xpack_main.js",
      "sourcesContent": [
        "import { once, partial } from 'lodash';\nimport injectXPackInfoSignature from './inject_xpack_info_signature';\n\nconst registerPreResponseHandlerSingleton = once((server, info) => {\n  server.ext('onPreResponse', partial(injectXPackInfoSignature, info));\n});\n\n/**\n * Setup the X-Pack Main plugin. This is fired every time that the Elasticsearch plugin becomes Green.\n *\n * This will ensure that X-Pack is installed on the Elasticsearch cluster, as well as trigger the initial\n * polling for _xpack/info.\n *\n * @param server {Object} The Kibana server object.\n * @param xpackMainPlugin {Object} The X-Pack Main plugin object.\n * @return {Promise} Never {@code null}.\n */\nexport function setupXPackMain(server, xpackMainPlugin, xpackInfo) {\n  return xpackInfo(server)\n  .then(info => {\n    server.expose('info', info);\n    registerPreResponseHandlerSingleton(server, info);\n  })\n  .then(() => xpackMainPlugin.status.green('Ready'))\n  .catch(reason => {\n    let errorMessage = reason;\n\n    if ((reason instanceof Error) && reason.status === 400) {\n      errorMessage = 'X-Pack plugin is not installed on Elasticsearch cluster';\n    }\n\n    server.expose('info', reason.info);\n\n    xpackMainPlugin.status.red(errorMessage);\n  });\n}\n"
      ]
    },
    "mtime": 1491771510565
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/xpack_main/server/lib/inject_xpack_info_signature.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [],
        "exports": {
          "exported": [
            "injectXPackInfoSignature",
            "info",
            "request",
            "reply"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "injectXPackInfoSignature",
              "exported": "default"
            },
            {
              "kind": "local",
              "local": "info",
              "exported": "default"
            },
            {
              "kind": "local",
              "local": "request",
              "exported": "default"
            },
            {
              "kind": "local",
              "local": "reply",
              "exported": "default"
            }
          ]
        }
      },
      "usedHelpers": []
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nexports['default'] = injectXPackInfoSignature;\n\nfunction injectXPackInfoSignature(info, request, reply) {\n\n  function addSignatureHeader(response, signature) {\n    if (signature) {\n      response.headers['kbn-xpack-sig'] = signature;\n    }\n    return reply['continue']();\n  }\n\n  // If we're returning an error response, refresh xpack info\n  // from Elastisearch in case the error is due to a change in\n  // license information in Elasticsearch\n  if (request.response instanceof Error) {\n    return info.refreshNow().then(function (refreshedInfo) {\n      var signature = refreshedInfo.getSignature();\n      // Note: request.response.output is used instead of request.response\n      // because evidently HAPI does not allow headers to be set on the latter\n      // in case of error responses.\n      return addSignatureHeader(request.response.output, signature);\n    });\n  } else {\n    var signature = info.getSignature();\n    return addSignatureHeader(request.response, signature);\n  }\n}\n\n;\nmodule.exports = exports['default'];\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMveHBhY2tfbWFpbi9zZXJ2ZXIvbGliL2luamVjdF94cGFja19pbmZvX3NpZ25hdHVyZS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztxQkFBd0Isd0JBQXdCOztBQUFqQyxTQUFTLHdCQUF3QixDQUFDLElBQUksRUFBRSxPQUFPLEVBQUUsS0FBSyxFQUFFOztBQUVyRSxXQUFTLGtCQUFrQixDQUFDLFFBQVEsRUFBRSxTQUFTLEVBQUU7QUFDL0MsUUFBSSxTQUFTLEVBQUU7QUFDYixjQUFRLENBQUMsT0FBTyxDQUFDLGVBQWUsQ0FBQyxHQUFHLFNBQVMsQ0FBQztLQUMvQztBQUNELFdBQU8sS0FBSyxZQUFTLEVBQUUsQ0FBQztHQUN6Qjs7Ozs7QUFLRCxNQUFJLE9BQU8sQ0FBQyxRQUFRLFlBQVksS0FBSyxFQUFFO0FBQ3JDLFdBQU8sSUFBSSxDQUFDLFVBQVUsRUFBRSxDQUN2QixJQUFJLENBQUMsVUFBQyxhQUFhLEVBQUs7QUFDdkIsVUFBTSxTQUFTLEdBQUcsYUFBYSxDQUFDLFlBQVksRUFBRSxDQUFDOzs7O0FBSS9DLGFBQU8sa0JBQWtCLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxNQUFNLEVBQUUsU0FBUyxDQUFDLENBQUM7S0FDL0QsQ0FBQyxDQUFDO0dBQ0osTUFBTTtBQUNMLFFBQU0sU0FBUyxHQUFHLElBQUksQ0FBQyxZQUFZLEVBQUUsQ0FBQztBQUN0QyxXQUFPLGtCQUFrQixDQUFDLE9BQU8sQ0FBQyxRQUFRLEVBQUUsU0FBUyxDQUFDLENBQUM7R0FDeEQ7Q0FDRjs7QUFBQSxDQUFDIiwiZmlsZSI6Ii91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMveHBhY2tfbWFpbi9zZXJ2ZXIvbGliL2luamVjdF94cGFja19pbmZvX3NpZ25hdHVyZS5qcyIsInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGluamVjdFhQYWNrSW5mb1NpZ25hdHVyZShpbmZvLCByZXF1ZXN0LCByZXBseSkge1xuXG4gIGZ1bmN0aW9uIGFkZFNpZ25hdHVyZUhlYWRlcihyZXNwb25zZSwgc2lnbmF0dXJlKSB7XG4gICAgaWYgKHNpZ25hdHVyZSkge1xuICAgICAgcmVzcG9uc2UuaGVhZGVyc1sna2JuLXhwYWNrLXNpZyddID0gc2lnbmF0dXJlO1xuICAgIH1cbiAgICByZXR1cm4gcmVwbHkuY29udGludWUoKTtcbiAgfVxuXG4gIC8vIElmIHdlJ3JlIHJldHVybmluZyBhbiBlcnJvciByZXNwb25zZSwgcmVmcmVzaCB4cGFjayBpbmZvXG4gIC8vIGZyb20gRWxhc3Rpc2VhcmNoIGluIGNhc2UgdGhlIGVycm9yIGlzIGR1ZSB0byBhIGNoYW5nZSBpblxuICAvLyBsaWNlbnNlIGluZm9ybWF0aW9uIGluIEVsYXN0aWNzZWFyY2hcbiAgaWYgKHJlcXVlc3QucmVzcG9uc2UgaW5zdGFuY2VvZiBFcnJvcikge1xuICAgIHJldHVybiBpbmZvLnJlZnJlc2hOb3coKVxuICAgIC50aGVuKChyZWZyZXNoZWRJbmZvKSA9PiB7XG4gICAgICBjb25zdCBzaWduYXR1cmUgPSByZWZyZXNoZWRJbmZvLmdldFNpZ25hdHVyZSgpO1xuICAgICAgLy8gTm90ZTogcmVxdWVzdC5yZXNwb25zZS5vdXRwdXQgaXMgdXNlZCBpbnN0ZWFkIG9mIHJlcXVlc3QucmVzcG9uc2VcbiAgICAgIC8vIGJlY2F1c2UgZXZpZGVudGx5IEhBUEkgZG9lcyBub3QgYWxsb3cgaGVhZGVycyB0byBiZSBzZXQgb24gdGhlIGxhdHRlclxuICAgICAgLy8gaW4gY2FzZSBvZiBlcnJvciByZXNwb25zZXMuXG4gICAgICByZXR1cm4gYWRkU2lnbmF0dXJlSGVhZGVyKHJlcXVlc3QucmVzcG9uc2Uub3V0cHV0LCBzaWduYXR1cmUpO1xuICAgIH0pO1xuICB9IGVsc2Uge1xuICAgIGNvbnN0IHNpZ25hdHVyZSA9IGluZm8uZ2V0U2lnbmF0dXJlKCk7XG4gICAgcmV0dXJuIGFkZFNpZ25hdHVyZUhlYWRlcihyZXF1ZXN0LnJlc3BvbnNlLCBzaWduYXR1cmUpO1xuICB9XG59O1xuIl19",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/xpack_main/server/lib/inject_xpack_info_signature.js"
      ],
      "names": [],
      "mappings": ";;;;;qBAAwB,wBAAwB;;AAAjC,SAAS,wBAAwB,CAAC,IAAI,EAAE,OAAO,EAAE,KAAK,EAAE;;AAErE,WAAS,kBAAkB,CAAC,QAAQ,EAAE,SAAS,EAAE;AAC/C,QAAI,SAAS,EAAE;AACb,cAAQ,CAAC,OAAO,CAAC,eAAe,CAAC,GAAG,SAAS,CAAC;KAC/C;AACD,WAAO,KAAK,YAAS,EAAE,CAAC;GACzB;;;;;AAKD,MAAI,OAAO,CAAC,QAAQ,YAAY,KAAK,EAAE;AACrC,WAAO,IAAI,CAAC,UAAU,EAAE,CACvB,IAAI,CAAC,UAAC,aAAa,EAAK;AACvB,UAAM,SAAS,GAAG,aAAa,CAAC,YAAY,EAAE,CAAC;;;;AAI/C,aAAO,kBAAkB,CAAC,OAAO,CAAC,QAAQ,CAAC,MAAM,EAAE,SAAS,CAAC,CAAC;KAC/D,CAAC,CAAC;GACJ,MAAM;AACL,QAAM,SAAS,GAAG,IAAI,CAAC,YAAY,EAAE,CAAC;AACtC,WAAO,kBAAkB,CAAC,OAAO,CAAC,QAAQ,EAAE,SAAS,CAAC,CAAC;GACxD;CACF;;AAAA,CAAC",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/xpack_main/server/lib/inject_xpack_info_signature.js",
      "sourcesContent": [
        "export default function injectXPackInfoSignature(info, request, reply) {\n\n  function addSignatureHeader(response, signature) {\n    if (signature) {\n      response.headers['kbn-xpack-sig'] = signature;\n    }\n    return reply.continue();\n  }\n\n  // If we're returning an error response, refresh xpack info\n  // from Elastisearch in case the error is due to a change in\n  // license information in Elasticsearch\n  if (request.response instanceof Error) {\n    return info.refreshNow()\n    .then((refreshedInfo) => {\n      const signature = refreshedInfo.getSignature();\n      // Note: request.response.output is used instead of request.response\n      // because evidently HAPI does not allow headers to be set on the latter\n      // in case of error responses.\n      return addSignatureHeader(request.response.output, signature);\n    });\n  } else {\n    const signature = info.getSignature();\n    return addSignatureHeader(request.response, signature);\n  }\n};\n"
      ]
    },
    "mtime": 1491771510565
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/server/lib/xpack_info.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "lodash",
            "imported": [
              "once"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "once",
                "local": "once"
              }
            ]
          },
          {
            "source": "./_xpack_info",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "_xpackInfo"
              }
            ]
          }
        ],
        "exports": {
          "exported": [],
          "specifiers": []
        }
      },
      "usedHelpers": [
        "interop-require-default"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _lodash = require('lodash');\n\nvar _xpack_info = require('./_xpack_info');\n\nvar _xpack_info2 = _interopRequireDefault(_xpack_info);\n\nexports['default'] = (0, _lodash.once)(_xpack_info2['default']);\nmodule.exports = exports['default'];\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3NlcnZlci9saWIveHBhY2tfaW5mby5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7OztzQkFBcUIsUUFBUTs7MEJBQ04sZUFBZTs7OztxQkFFdkIsMENBQWdCIiwiZmlsZSI6Ii91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3NlcnZlci9saWIveHBhY2tfaW5mby5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IG9uY2UgfSBmcm9tICdsb2Rhc2gnO1xuaW1wb3J0IF94cGFja0luZm8gZnJvbSAnLi9feHBhY2tfaW5mbyc7XG5cbmV4cG9ydCBkZWZhdWx0IG9uY2UoX3hwYWNrSW5mbyk7XG4iXX0=",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/server/lib/xpack_info.js"
      ],
      "names": [],
      "mappings": ";;;;;;;;sBAAqB,QAAQ;;0BACN,eAAe;;;;qBAEvB,0CAAgB",
      "file": "/usr/share/kibana/plugins/x-pack/server/lib/xpack_info.js",
      "sourcesContent": [
        "import { once } from 'lodash';\nimport _xpackInfo from './_xpack_info';\n\nexport default once(_xpackInfo);\n"
      ]
    },
    "mtime": 1491771505397
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/server/lib/_xpack_info.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "crypto",
            "imported": [
              "createHash"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "createHash",
                "local": "createHash"
              }
            ]
          },
          {
            "source": "moment",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "moment"
              }
            ]
          },
          {
            "source": "lodash",
            "imported": [
              "get",
              "set",
              "includes",
              "forIn"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "get",
                "local": "get"
              },
              {
                "kind": "named",
                "imported": "set",
                "local": "set"
              },
              {
                "kind": "named",
                "imported": "includes",
                "local": "includes"
              },
              {
                "kind": "named",
                "imported": "forIn",
                "local": "forIn"
              }
            ]
          },
          {
            "source": "./poller",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "Poller"
              }
            ]
          },
          {
            "source": "./constants",
            "imported": [
              "LICENSE_EXPIRY_SOON_DURATION",
              "XPACK_INFO_API_DEFAULT_POLL_FREQUENCY"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "LICENSE_EXPIRY_SOON_DURATION",
                "local": "LICENSE_EXPIRY_SOON_DURATION"
              },
              {
                "kind": "named",
                "imported": "XPACK_INFO_API_DEFAULT_POLL_FREQUENCY",
                "local": "XPACK_INFO_API_DEFAULT_POLL_FREQUENCY"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "_xpackInfo",
            "server",
            "pollFrequencyInMillis"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "_xpackInfo",
              "exported": "default"
            },
            {
              "kind": "local",
              "local": "server",
              "exported": "default"
            },
            {
              "kind": "local",
              "local": "pollFrequencyInMillis",
              "exported": "default"
            }
          ]
        }
      },
      "usedHelpers": [
        "interop-require-default"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nexports['default'] = _xpackInfo;\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _crypto = require('crypto');\n\nvar _moment = require('moment');\n\nvar _moment2 = _interopRequireDefault(_moment);\n\nvar _lodash = require('lodash');\n\nvar _poller = require('./poller');\n\nvar _poller2 = _interopRequireDefault(_poller);\n\nvar _constants = require('./constants');\n\nfunction _xpackInfo(server, pollFrequencyInMillis) {\n  pollFrequencyInMillis = pollFrequencyInMillis || _constants.XPACK_INFO_API_DEFAULT_POLL_FREQUENCY.asMilliseconds();\n\n  var _cachedResponseFromElasticsearch = undefined;\n\n  var _licenseCheckResultsGenerators = {};\n  var _licenseCheckResults = {};\n  var _cachedXPackInfoJSON = undefined;\n  var _cachedXPackInfoJSONSignature = undefined;\n\n  var poller = new _poller2['default']({\n    functionToPoll: _callElasticsearchXPackAPI,\n    successFunction: _handleResponseFromElasticsearch,\n    errorFunction: _handleErrorFromElasticsearch,\n    pollFrequencyInMillis: pollFrequencyInMillis,\n    continuePollingOnError: true\n  });\n\n  var xpackInfoObject = {\n    license: {\n      getUid: function getUid() {\n        return (0, _lodash.get)(_cachedResponseFromElasticsearch, 'license.uid');\n      },\n      isActive: function isActive() {\n        return (0, _lodash.get)(_cachedResponseFromElasticsearch, 'license.status') === 'active';\n      },\n      expiresSoon: function expiresSoon() {\n        var expiryDateMillis = (0, _lodash.get)(_cachedResponseFromElasticsearch, 'license.expiry_date_in_millis');\n        var expirySoonDate = _moment2['default'].utc(expiryDateMillis).subtract(_constants.LICENSE_EXPIRY_SOON_DURATION);\n        return _moment2['default'].utc().isAfter(expirySoonDate);\n      },\n      getExpiryDateInMillis: function getExpiryDateInMillis() {\n        return (0, _lodash.get)(_cachedResponseFromElasticsearch, 'license.expiry_date_in_millis');\n      },\n      isOneOf: function isOneOf(candidateLicenses) {\n        if (!Array.isArray(candidateLicenses)) {\n          candidateLicenses = [candidateLicenses];\n        }\n        return (0, _lodash.includes)(candidateLicenses, (0, _lodash.get)(_cachedResponseFromElasticsearch, 'license.mode'));\n      },\n      getType: function getType() {\n        return (0, _lodash.get)(_cachedResponseFromElasticsearch, 'license.type');\n      }\n    },\n    feature: function feature(_feature) {\n      return {\n        isAvailable: function isAvailable() {\n          return (0, _lodash.get)(_cachedResponseFromElasticsearch, 'features.' + _feature + '.available');\n        },\n        isEnabled: function isEnabled() {\n          return (0, _lodash.get)(_cachedResponseFromElasticsearch, 'features.' + _feature + '.enabled');\n        },\n        registerLicenseCheckResultsGenerator: function registerLicenseCheckResultsGenerator(generator) {\n          _licenseCheckResultsGenerators[_feature] = generator;\n          _updateXPackInfoJSON();\n        },\n        getLicenseCheckResults: function getLicenseCheckResults() {\n          return _licenseCheckResults[_feature];\n        }\n      };\n    },\n    isAvailable: function isAvailable() {\n      return !!_cachedResponseFromElasticsearch && !!(0, _lodash.get)(_cachedResponseFromElasticsearch, 'license');\n    },\n    getSignature: function getSignature() {\n      return _cachedXPackInfoJSONSignature;\n    },\n    refreshNow: function refreshNow() {\n      var self = this;\n      return _callElasticsearchXPackAPI().then(_handleResponseFromElasticsearch)['catch'](_handleErrorFromElasticsearch).then(function () {\n        return self;\n      });\n    },\n    stopPolling: function stopPolling() {\n      // This method exists primarily for unit testing\n      poller.stop();\n    },\n    toJSON: function toJSON() {\n      return _cachedXPackInfoJSON;\n    }\n  };\n\n  var cluster = server.plugins.elasticsearch.getCluster('data');\n\n  function _callElasticsearchXPackAPI() {\n    server.log(['license', 'debug', 'xpack'], 'Calling Elasticsearch _xpack API');\n    return cluster.callWithInternalUser('transport.request', {\n      method: 'GET',\n      path: '/_xpack'\n    });\n  };\n\n  function _updateXPackInfoJSON() {\n    var json = {};\n\n    // Set response elements common to all features\n    (0, _lodash.set)(json, 'license.type', xpackInfoObject.license.getType());\n    (0, _lodash.set)(json, 'license.isActive', xpackInfoObject.license.isActive());\n    (0, _lodash.set)(json, 'license.expiryDateInMillis', xpackInfoObject.license.getExpiryDateInMillis());\n\n    // Set response elements specific to each feature. To do this,\n    // call the license check results generator for each feature, passing them\n    // the xpack info object\n    (0, _lodash.forIn)(_licenseCheckResultsGenerators, function (generator, feature) {\n      _licenseCheckResults[feature] = generator(xpackInfoObject); // return value expected to be a dictionary object\n    });\n    (0, _lodash.set)(json, 'features', _licenseCheckResults);\n\n    _cachedXPackInfoJSON = json;\n    _cachedXPackInfoJSONSignature = (0, _crypto.createHash)('md5').update(JSON.stringify(json)).digest('hex');\n  }\n\n  function _hasLicenseInfoFromElasticsearchChanged(response) {\n    var cachedResponse = _cachedResponseFromElasticsearch;\n    return (0, _lodash.get)(response, 'license.mode') !== (0, _lodash.get)(cachedResponse, 'license.mode') || (0, _lodash.get)(response, 'license.status') !== (0, _lodash.get)(cachedResponse, 'license.status') || (0, _lodash.get)(response, 'license.expiry_date_in_millis') !== (0, _lodash.get)(cachedResponse, 'license.expiry_date_in_millis');\n  }\n\n  function _getLicenseInfoForLog(response) {\n    var mode = (0, _lodash.get)(response, 'license.mode');\n    var status = (0, _lodash.get)(response, 'license.status');\n    var expiryDateInMillis = (0, _lodash.get)(response, 'license.expiry_date_in_millis');\n\n    return ['mode: ' + mode, 'status: ' + status, 'expiry date: ' + (0, _moment2['default'])(expiryDateInMillis, 'x').format()].join(' | ');\n  }\n\n  function _handleResponseFromElasticsearch(response) {\n\n    if (_hasLicenseInfoFromElasticsearchChanged(response)) {\n      var changed = '';\n      if (_cachedResponseFromElasticsearch) {\n        changed = 'changed ';\n      }\n\n      var licenseInfo = _getLicenseInfoForLog(response);\n      var logMessage = 'Imported ' + changed + 'license information from Elasticsearch: ' + licenseInfo;\n      server.log(['license', 'info', 'xpack'], logMessage);\n    }\n\n    _cachedResponseFromElasticsearch = response;\n    _updateXPackInfoJSON();\n  }\n\n  function _handleErrorFromElasticsearch(error) {\n    server.log(['license', 'warning', 'xpack'], 'License information could not be obtained from Elasticsearch. ' + error);\n    _cachedResponseFromElasticsearch = null;\n    _updateXPackInfoJSON();\n\n    // allow tests to shutdown\n    error.info = xpackInfoObject;\n\n    throw error;\n  }\n\n  // Start polling for changes\n  return poller.start().then(function () {\n    return xpackInfoObject;\n  });\n}\n\nmodule.exports = exports['default'];\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3NlcnZlci9saWIvX3hwYWNrX2luZm8uanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7cUJBTXdCLFVBQVU7Ozs7c0JBTlAsUUFBUTs7c0JBQ2hCLFFBQVE7Ozs7c0JBQ2UsUUFBUTs7c0JBQy9CLFVBQVU7Ozs7eUJBQ3VELGFBQWE7O0FBRWxGLFNBQVMsVUFBVSxDQUFDLE1BQU0sRUFBRSxxQkFBcUIsRUFBRTtBQUNoRSx1QkFBcUIsR0FBRyxxQkFBcUIsSUFBSSxpREFBc0MsY0FBYyxFQUFFLENBQUM7O0FBRXhHLE1BQUksZ0NBQWdDLFlBQUEsQ0FBQzs7QUFFckMsTUFBTSw4QkFBOEIsR0FBRyxFQUFFLENBQUM7QUFDMUMsTUFBTSxvQkFBb0IsR0FBRyxFQUFFLENBQUM7QUFDaEMsTUFBSSxvQkFBb0IsWUFBQSxDQUFDO0FBQ3pCLE1BQUksNkJBQTZCLFlBQUEsQ0FBQzs7QUFFbEMsTUFBTSxNQUFNLEdBQUcsd0JBQVc7QUFDeEIsa0JBQWMsRUFBRSwwQkFBMEI7QUFDMUMsbUJBQWUsRUFBRSxnQ0FBZ0M7QUFDakQsaUJBQWEsRUFBRSw2QkFBNkI7QUFDNUMseUJBQXFCLEVBQXJCLHFCQUFxQjtBQUNyQiwwQkFBc0IsRUFBRSxJQUFJO0dBQzdCLENBQUMsQ0FBQzs7QUFFSCxNQUFNLGVBQWUsR0FBRztBQUN0QixXQUFPLEVBQUU7QUFDUCxZQUFNLEVBQUUsa0JBQVk7QUFDbEIsZUFBTyxpQkFBSSxnQ0FBZ0MsRUFBRSxhQUFhLENBQUMsQ0FBQztPQUM3RDtBQUNELGNBQVEsRUFBRSxvQkFBWTtBQUNwQixlQUFPLGlCQUFJLGdDQUFnQyxFQUFFLGdCQUFnQixDQUFDLEtBQUssUUFBUSxDQUFDO09BQzdFO0FBQ0QsaUJBQVcsRUFBRSx1QkFBWTtBQUN2QixZQUFNLGdCQUFnQixHQUFHLGlCQUFJLGdDQUFnQyxFQUFFLCtCQUErQixDQUFDLENBQUM7QUFDaEcsWUFBTSxjQUFjLEdBQUcs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L3BsdWdpbnMveC1wYWNrL3NlcnZlci9saWIvX3hwYWNrX2luZm8uanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVIYXNoIH0gZnJvbSAnY3J5cHRvJztcbmltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50JztcbmltcG9ydCB7IGdldCwgc2V0LCBpbmNsdWRlcywgZm9ySW4gfSBmcm9tICdsb2Rhc2gnO1xuaW1wb3J0IFBvbGxlciBmcm9tICcuL3BvbGxlcic7XG5pbXBvcnQgeyBMSUNFTlNFX0VYUElSWV9TT09OX0RVUkFUSU9OLCBYUEFDS19JTkZPX0FQSV9ERUZBVUxUX1BPTExfRlJFUVVFTkNZIH0gZnJvbSAnLi9jb25zdGFudHMnO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBfeHBhY2tJbmZvKHNlcnZlciwgcG9sbEZyZXF1ZW5jeUluTWlsbGlzKSB7XG4gIHBvbGxGcmVxdWVuY3lJbk1pbGxpcyA9IHBvbGxGcmVxdWVuY3lJbk1pbGxpcyB8fCBYUEFDS19JTkZPX0FQSV9ERUZBVUxUX1BPTExfRlJFUVVFTkNZLmFzTWlsbGlzZWNvbmRzKCk7XG5cbiAgbGV0IF9jYWNoZWRSZXNwb25zZUZyb21FbGFzdGljc2VhcmNoO1xuXG4gIGNvbnN0IF9saWNlbnNlQ2hlY2tSZXN1bHRzR2VuZXJhdG9ycyA9IHt9O1xuICBjb25zdCBfbGljZW5zZUNoZWNrUmVzdWx0cyA9IHt9O1xuICBsZXQgX2NhY2hlZFhQYWNrSW5mb0pTT047XG4gIGxldCBfY2FjaGVkWFBhY2tJbmZvSlNPTlNpZ25hdHVyZTtcblxuICBjb25zdCBwb2xsZXIgPSBuZXcgUG9sbGVyKHtcbiAgICBmdW5jdGlvblRvUG9sbDogX2NhbGxFbGFzdGljc2VhcmNoWFBhY2tBUEksXG4gICAgc3VjY2Vzc0Z1bmN0aW9uOiBfaGFuZGxlUmVzcG9uc2VGcm9tRWxhc3RpY3NlYXJjaCxcbiAgICBlcnJvckZ1bmN0aW9uOiBfaGFuZGxlRXJyb3JGcm9tRWxhc3RpY3NlYXJjaCxcbiAgICBwb2xsRnJlcXVlbmN5SW5NaWxsaXMsXG4gICAgY29udGludWVQb2xsaW5nT25FcnJvcjogdHJ1ZVxuICB9KTtcblxuICBjb25zdCB4cGFja0luZm9PYmplY3QgPSB7XG4gICAgbGljZW5zZToge1xuICAgICAgZ2V0VWlkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBnZXQoX2NhY2hlZFJlc3BvbnNlRnJvbUVsYXN0aWNzZWFyY2gsICdsaWNlbnNlLnVpZCcpO1xuICAgICAgfSxcbiAgICAgIGlzQWN0aXZlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBnZXQoX2NhY2hlZFJlc3BvbnNlRnJvbUVsYXN0aWNzZWFyY2gsICdsaWNlbnNlLnN0YXR1cycpID09PSAnYWN0aXZlJztcbiAgICAgIH0sXG4gICAgICBleHBpcmVzU29vbjogZnVuY3Rpb24gKCkge1xuICAgICAgICBjb25zdCBleHBpcnlEYXRlTWlsbGlzID0gZ2V0KF9jYWNoZWRSZXNwb25zZUZyb21FbGFzdGljc2VhcmNoLCAnbGljZW5zZS5leHBpcnlfZGF0ZV9pbl9taWxsaXMnKTtcbiAgICAgICAgY29uc3QgZXhwaXJ5U29vbkRhdGUgPSBtb21lbnQudXRjKGV4cGlyeURhdGVNaWxsaXMpLnN1YnRyYWN0KExJQ0VOU0VfRVhQSVJZX1NPT05fRFVSQVRJT04pO1xuICAgICAgICByZXR1cm4gbW9tZW50LnV0YygpLmlzQWZ0ZXIoZXhwaXJ5U29vbkRhdGUpO1xuICAgICAgfSxcbiAgICAgIGdldEV4cGlyeURhdGVJbk1pbGxpczogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gZ2V0KF9jYWNoZWRSZXNwb25zZUZyb21FbGFzdGljc2VhcmNoLCAnbGljZW5zZS5leHBpcnlfZGF0ZV9pbl9taWxsaXMnKTtcbiAgICAgIH0sXG4gICAgICBpc09uZU9mOiBmdW5jdGlvbiAoY2FuZGlkYXRlTGljZW5zZXMpIHtcbiAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KGNhbmRpZGF0ZUxpY2Vuc2VzKSkge1xuICAgICAgICAgIGNhbmRpZGF0ZUxpY2Vuc2VzID0gWyBjYW5kaWRhdGVMaWNlbnNlcyBdO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBpbmNsdWRlcyhjYW5kaWRhdGVMaWNlbnNlcywgZ2V0KF9jYWNoZWRSZXNwb25zZUZyb21FbGFzdGljc2VhcmNoLCAnbGljZW5zZS5tb2RlJykpO1xuICAgICAgfSxcbiAgICAgIGdldFR5cGU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIGdldChfY2FjaGVkUmVzcG9uc2VGcm9tRWxhc3RpY3NlYXJjaCwgJ2xpY2Vuc2UudHlwZScpO1xuICAgICAgfVxuICAgIH0sXG4gICAgZmVhdHVyZTogZnVuY3Rpb24gKGZlYXR1cmUpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGlzQXZhaWxhYmxlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgcmV0dXJuIGdldChfY2FjaGVkUmVzcG9uc2VGcm9tRWxhc3RpY3NlYXJjaCwgJ2ZlYXR1cmVzLicgKyBmZWF0dXJlICsgJy5hdmFpbGFibGUnKTtcbiAgICAgICAgfSxcbiAgICAgICAgaXNFbmFibGVkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgcmV0dXJuIGdldChfY2FjaGVkUmVzcG9uc2VGcm9tRWxhc3RpY3NlYXJjaCwgJ2ZlYXR1cmVzLicgKyBmZWF0dXJlICsgJy5lbmFibGVkJyk7XG4gICAgICAgIH0sXG4gICAgICAgIHJlZ2lzdGVyTGljZW5zZUNoZWNrUmVzdWx0c0dlbmVyYXRvcjogZnVuY3Rpb24gKGdlbmVyYXRvcikge1xuICAgICAgICAgIF9saWNlbnNlQ2hlY2tSZXN1bHRzR2VuZXJhdG9yc1tmZWF0dXJlXSA9IGdlbmVyYXRvcjtcbiAgICAgICAgICBfdXBkYXRlWFBhY2tJbmZvSlNPTigpO1xuICAgICAgICB9LFxuICAgICAgICBnZXRMaWNlbnNlQ2hlY2tSZXN1bHRzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgcmV0dXJuIF9saWNlbnNlQ2hlY2tSZXN1bHRzW2ZlYXR1cmVdO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgIH0sXG4gICAgaXNBdmFpbGFibGU6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiAhIV9jYWNoZWRSZXNwb25zZUZyb21FbGFzdGljc2VhcmNoICYmICEhZ2V0KF9jYWNoZWRSZXNwb25zZUZyb21FbGFzdGljc2VhcmNoLCAnbGljZW5zZScpO1xuICAgIH0sXG4gICAgZ2V0U2lnbmF0dXJlOiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gX2NhY2hlZFhQYWNrSW5mb0pTT05TaWduYXR1cmU7XG4gICAgfSxcbiAgICByZWZyZXNoTm93OiBmdW5jdGlvbiAoKSB7XG4gICAgICBjb25zdCBzZWxmID0gdGhpcztcbiAgICAgIHJldHVybiBfY2FsbEVsYXN0aWNzZWFyY2hYUGFja0FQSSgpXG4gICAgICAudGhlbihfaGFuZGxlUmVzcG9uc2VGcm9tRWxhc3RpY3NlYXJjaClcbiAgICAgIC5jYXRjaChfaGFuZGxlRXJyb3JGcm9tRWxhc3RpY3NlYXJjaClcbiAgICAgIC50aGVuKCgpID0+IHNlbGYpO1xuICAgIH0sXG4gICAgc3RvcFBvbGxpbmc6IGZ1bmN0aW9uICgpIHtcbiAgICAgIC8vIFRoaXMgbWV0aG9kIGV4aXN0cyBwcmltYXJpbHkgZm9yIHVuaXQgdGVzdGluZ1xuICAgICAgcG9sbGVyLnN0b3AoKTtcbiAgICB9LFxuICAgIHRvSlNPTjogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIF9jYWNoZWRYUGFja0luZm9KU09OO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCBjbHVzdGVyID0gc2VydmVyLnBsdWdpbnMuZWxhc3RpY3NlYXJjaC5nZXRDbHVzdGVyKCdkYXRhJyk7XG5cbiAgZnVuY3Rpb24gX2NhbGxFbGFzdGljc2VhcmNoWFBhY2tBUEkoKSB7XG4gICAgc2VydmVyLmxvZyhbICdsaWNlbnNlJywgJ2RlYnVnJywgJ3hwYWNrJyBdLCAnQ2FsbGluZyBFbGFzdGljc2VhcmNoIF94cGFjayBBUEknKTtcbiAgICByZXR1cm4gY2x1c3Rlci5jYWxsV2l0aEludGVybmFsVXNlcigndHJhbnNwb3J0LnJlcXVlc3QnLCB7XG4gICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgcGF0aDogJy9feHBhY2snXG4gICAgfSk7XG4gIH07XG5cbiAgZnVuY3Rpb24gX3VwZGF0ZVhQYWNrSW5mb0pTT04oKSB7XG4gICAgY29uc3QganNvbiA9IHt9O1xuXG4gICAgLy8gU2V0IHJlc3BvbnNlIGVsZW1lbnRzIGNvbW1vbiB0byBhbGwgZmVhdHVyZXNcbiAgICBzZXQoanNvbiwgJ2xpY2Vuc2UudHlwZScsIHhwYWNrSW5mb09iamVjdC5saWNlbnNlLmdldFR5cGUoKSk7XG4gICAgc2V0KGpzb24sICdsaWNlbnNlLmlzQWN0aXZlJywgeHBhY2tJbmZvT2JqZWN0LmxpY2Vuc2UuaXNBY3RpdmUoKSk7XG4gICAgc2V0KGpzb24sICdsaWNlbnNlLmV4cGlyeURhdGVJbk1pbGxpcycsIHhwYWNrSW5mb09iamVjdC5saWNlbnNlLmdldEV4cGlyeURhdGVJbk1pbGxpcygpKTtcblxuICAgIC8vIFNldCByZXNwb25zZSBlbGVtZW50cyBzcGVjaWZpYyB0byBlYWNoIGZlYXR1cmUuIFRvIGRvIHRoaXMsXG4gICAgLy8gY2FsbCB0aGUgbGljZW5zZSBjaGVjayByZXN1bHRzIGdlbmVyYXRvciBmb3IgZWFjaCBmZWF0dXJlLCBwYXNzaW5nIHRoZW1cbiAgICAvLyB0aGUgeHBhY2sgaW5mbyBvYmplY3RcbiAgICBmb3JJbihfbGljZW5zZUNoZWNrUmVzdWx0c0dlbmVyYXRvcnMsIChnZW5lcmF0b3IsIGZlYXR1cmUpID0+IHtcbiAgICAgIF9saWNlbnNlQ2hlY2tSZXN1bHRzW2ZlYXR1cmVdID0gZ2VuZXJhdG9yKHhwYWNrSW5mb09iamVjdCk7IC8vIHJldHVybiB2YWx1ZSBleHBlY3RlZCB0byBiZSBhIGRpY3Rpb25hcnkgb2JqZWN0XG4gICAgfSk7XG4gICAgc2V0KGpzb24sICdmZWF0dXJlcycsIF9saWNlbnNlQ2hlY2tSZXN1bHRzKTtcblxuICAgIF9jYWNoZWRYUGFja0luZm9KU09OID0ganNvbjtcbiAgICBfY2FjaGVkWFBhY2tJbmZvSlNPTlNpZ25hdHVyZSA9IGNyZWF0ZUhhc2goJ21kNScpXG4gICAgLnVwZGF0ZShKU09OLnN0cmluZ2lmeShqc29uKSlcbiAgICAuZGlnZXN0KCdoZXgnKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIF9oYXNMaWNlbnNlSW5mb0Zyb21FbGFzdGljc2VhcmNoQ2hhbmdlZChyZXNwb25zZSkge1xuICAgIGNvbnN0IGNhY2hlZFJlc3BvbnNlID0gX2NhY2hlZFJlc3BvbnNlRnJvbUVsYXN0aWNzZWFyY2g7XG4gICAgcmV0dXJuIChnZXQocmVzcG9uc2UsICdsaWNlbnNlLm1vZGUnKSAhPT0gZ2V0KGNhY2hlZFJlc3BvbnNlLCAnbGljZW5zZS5tb2RlJylcbiAgICAgIHx8IGdldChyZXNwb25zZSwgJ2xpY2Vuc2Uuc3RhdHVzJykgIT09IGdldChjYWNoZWRSZXNwb25zZSwgJ2xpY2Vuc2Uuc3RhdHVzJylcbiAgICAgIHx8IGdldChyZXNwb25zZSwgJ2xpY2Vuc2UuZXhwaXJ5X2RhdGVfaW5fbWlsbGlzJykgIT09IGdldChjYWNoZWRSZXNwb25zZSwgJ2xpY2Vuc2UuZXhwaXJ5X2RhdGVfaW5fbWlsbGlzJykpO1xuICB9XG5cbiAgZnVuY3Rpb24gX2dldExpY2Vuc2VJbmZvRm9yTG9nKHJlc3BvbnNlKSB7XG4gICAgY29uc3QgbW9kZSA9IGdldChyZXNwb25zZSwgJ2xpY2Vuc2UubW9kZScpO1xuICAgIGNvbnN0IHN0YXR1cyA9IGdldChyZXNwb25zZSwgJ2xpY2Vuc2Uuc3RhdHVzJyk7XG4gICAgY29uc3QgZXhwaXJ5RGF0ZUluTWlsbGlzID0gZ2V0KHJlc3BvbnNlLCAnbGljZW5zZS5leHBpcnlfZGF0ZV9pbl9taWxsaXMnKTtcblxuICAgIHJldHVybiBbXG4gICAgICAnbW9kZTogJyArIG1vZGUsXG4gICAgICAnc3RhdHVzOiAnICsgc3RhdHVzLFxuICAgICAgJ2V4cGlyeSBkYXRlOiAnICsgbW9tZW50KGV4cGlyeURhdGVJbk1pbGxpcywgJ3gnKS5mb3JtYXQoKVxuICAgIF0uam9pbignIHwgJyk7XG4gIH1cblxuICBmdW5jdGlvbiBfaGFuZGxlUmVzcG9uc2VGcm9tRWxhc3RpY3NlYXJjaChyZXNwb25zZSkge1xuXG4gICAgaWYgKF9oYXNMaWNlbnNlSW5mb0Zyb21FbGFzdGljc2VhcmNoQ2hhbmdlZChyZXNwb25zZSkpIHtcbiAgICAgIGxldCBjaGFuZ2VkID0gJyc7XG4gICAgICBpZiAoX2NhY2hlZFJlc3BvbnNlRnJvbUVsYXN0aWNzZWFyY2gpIHtcbiAgICAgICAgY2hhbmdlZCA9ICdjaGFuZ2VkICc7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGxpY2Vuc2VJbmZvID0gX2dldExpY2Vuc2VJbmZvRm9yTG9nKHJlc3BvbnNlKTtcbiAgICAgIGNvbnN0IGxvZ01lc3NhZ2UgPSBgSW1wb3J0ZWQgJHtjaGFuZ2VkfWxpY2Vuc2UgaW5mb3JtYXRpb24gZnJvbSBFbGFzdGljc2VhcmNoOiAke2xpY2Vuc2VJbmZvfWA7XG4gICAgICBzZXJ2ZXIubG9nKFsgJ2xpY2Vuc2UnLCAnaW5mbycsICd4cGFjaycgIF0sIGxvZ01lc3NhZ2UpO1xuICAgIH1cblxuICAgIF9jYWNoZWRSZXNwb25zZUZyb21FbGFzdGljc2VhcmNoID0gcmVzcG9uc2U7XG4gICAgX3VwZGF0ZVhQYWNrSW5mb0pTT04oKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIF9oYW5kbGVFcnJvckZyb21FbGFzdGljc2VhcmNoKGVycm9yKSB7XG4gICAgc2VydmVyLmxvZyhbICdsaWNlbnNlJywgJ3dhcm5pbmcnLCAneHBhY2snIF0sICdMaWNlbnNlIGluZm9ybWF0aW9uIGNvdWxkIG5vdCBiZSBvYnRhaW5lZCBmcm9tIEVsYXN0aWNzZWFyY2guICcgKyBlcnJvcik7XG4gICAgX2NhY2hlZFJlc3BvbnNlRnJvbUVsYXN0aWNzZWFyY2ggPSBudWxsO1xuICAgIF91cGRhdGVYUGFja0luZm9KU09OKCk7XG5cbiAgICAvLyBhbGxvdyB0ZXN0cyB0byBzaHV0ZG93blxuICAgIGVycm9yLmluZm8gPSB4cGFja0luZm9PYmplY3Q7XG5cbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxuXG4gIC8vIFN0YXJ0IHBvbGxpbmcgZm9yIGNoYW5nZXNcbiAgcmV0dXJuIHBvbGxlci5zdGFydCgpXG4gIC50aGVuKCgpID0+IHhwYWNrSW5mb09iamVjdCk7XG59XG4iXX0=",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/server/lib/_xpack_info.js"
      ],
      "names": [],
      "mappings": "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",
      "file": "/usr/share/kibana/plugins/x-pack/server/lib/_xpack_info.js",
      "sourcesContent": [
        "import { createHash } from 'crypto';\nimport moment from 'moment';\nimport { get, set, includes, forIn } from 'lodash';\nimport Poller from './poller';\nimport { LICENSE_EXPIRY_SOON_DURATION, XPACK_INFO_API_DEFAULT_POLL_FREQUENCY } from './constants';\n\nexport default function _xpackInfo(server, pollFrequencyInMillis) {\n  pollFrequencyInMillis = pollFrequencyInMillis || XPACK_INFO_API_DEFAULT_POLL_FREQUENCY.asMilliseconds();\n\n  let _cachedResponseFromElasticsearch;\n\n  const _licenseCheckResultsGenerators = {};\n  const _licenseCheckResults = {};\n  let _cachedXPackInfoJSON;\n  let _cachedXPackInfoJSONSignature;\n\n  const poller = new Poller({\n    functionToPoll: _callElasticsearchXPackAPI,\n    successFunction: _handleResponseFromElasticsearch,\n    errorFunction: _handleErrorFromElasticsearch,\n    pollFrequencyInMillis,\n    continuePollingOnError: true\n  });\n\n  const xpackInfoObject = {\n    license: {\n      getUid: function () {\n        return get(_cachedResponseFromElasticsearch, 'license.uid');\n      },\n      isActive: function () {\n        return get(_cachedResponseFromElasticsearch, 'license.status') === 'active';\n      },\n      expiresSoon: function () {\n        const expiryDateMillis = get(_cachedResponseFromElasticsearch, 'license.expiry_date_in_millis');\n        const expirySoonDate = moment.utc(expiryDateMillis).subtract(LICENSE_EXPIRY_SOON_DURATION);\n        return moment.utc().isAfter(expirySoonDate);\n      },\n      getExpiryDateInMillis: function () {\n        return get(_cachedResponseFromElasticsearch, 'license.expiry_date_in_millis');\n      },\n      isOneOf: function (candidateLicenses) {\n        if (!Array.isArray(candidateLicenses)) {\n          candidateLicenses = [ candidateLicenses ];\n        }\n        return includes(candidateLicenses, get(_cachedResponseFromElasticsearch, 'license.mode'));\n      },\n      getType: function () {\n        return get(_cachedResponseFromElasticsearch, 'license.type');\n      }\n    },\n    feature: function (feature) {\n      return {\n        isAvailable: function () {\n          return get(_cachedResponseFromElasticsearch, 'features.' + feature + '.available');\n        },\n        isEnabled: function () {\n          return get(_cachedResponseFromElasticsearch, 'features.' + feature + '.enabled');\n        },\n        registerLicenseCheckResultsGenerator: function (generator) {\n          _licenseCheckResultsGenerators[feature] = generator;\n          _updateXPackInfoJSON();\n        },\n        getLicenseCheckResults: function () {\n          return _licenseCheckResults[feature];\n        }\n      };\n    },\n    isAvailable: function () {\n      return !!_cachedResponseFromElasticsearch && !!get(_cachedResponseFromElasticsearch, 'license');\n    },\n    getSignature: function () {\n      return _cachedXPackInfoJSONSignature;\n    },\n    refreshNow: function () {\n      const self = this;\n      return _callElasticsearchXPackAPI()\n      .then(_handleResponseFromElasticsearch)\n      .catch(_handleErrorFromElasticsearch)\n      .then(() => self);\n    },\n    stopPolling: function () {\n      // This method exists primarily for unit testing\n      poller.stop();\n    },\n    toJSON: function () {\n      return _cachedXPackInfoJSON;\n    }\n  };\n\n  const cluster = server.plugins.elasticsearch.getCluster('data');\n\n  function _callElasticsearchXPackAPI() {\n    server.log([ 'license', 'debug', 'xpack' ], 'Calling Elasticsearch _xpack API');\n    return cluster.callWithInternalUser('transport.request', {\n      method: 'GET',\n      path: '/_xpack'\n    });\n  };\n\n  function _updateXPackInfoJSON() {\n    const json = {};\n\n    // Set response elements common to all features\n    set(json, 'license.type', xpackInfoObject.license.getType());\n    set(json, 'license.isActive', xpackInfoObject.license.isActive());\n    set(json, 'license.expiryDateInMillis', xpackInfoObject.license.getExpiryDateInMillis());\n\n    // Set response elements specific to each feature. To do this,\n    // call the license check results generator for each feature, passing them\n    // the xpack info object\n    forIn(_licenseCheckResultsGenerators, (generator, feature) => {\n      _licenseCheckResults[feature] = generator(xpackInfoObject); // return value expected to be a dictionary object\n    });\n    set(json, 'features', _licenseCheckResults);\n\n    _cachedXPackInfoJSON = json;\n    _cachedXPackInfoJSONSignature = createHash('md5')\n    .update(JSON.stringify(json))\n    .digest('hex');\n  }\n\n  function _hasLicenseInfoFromElasticsearchChanged(response) {\n    const cachedResponse = _cachedResponseFromElasticsearch;\n    return (get(response, 'license.mode') !== get(cachedResponse, 'license.mode')\n      || get(response, 'license.status') !== get(cachedResponse, 'license.status')\n      || get(response, 'license.expiry_date_in_millis') !== get(cachedResponse, 'license.expiry_date_in_millis'));\n  }\n\n  function _getLicenseInfoForLog(response) {\n    const mode = get(response, 'license.mode');\n    const status = get(response, 'license.status');\n    const expiryDateInMillis = get(response, 'license.expiry_date_in_millis');\n\n    return [\n      'mode: ' + mode,\n      'status: ' + status,\n      'expiry date: ' + moment(expiryDateInMillis, 'x').format()\n    ].join(' | ');\n  }\n\n  function _handleResponseFromElasticsearch(response) {\n\n    if (_hasLicenseInfoFromElasticsearchChanged(response)) {\n      let changed = '';\n      if (_cachedResponseFromElasticsearch) {\n        changed = 'changed ';\n      }\n\n      const licenseInfo = _getLicenseInfoForLog(response);\n      const logMessage = `Imported ${changed}license information from Elasticsearch: ${licenseInfo}`;\n      server.log([ 'license', 'info', 'xpack'  ], logMessage);\n    }\n\n    _cachedResponseFromElasticsearch = response;\n    _updateXPackInfoJSON();\n  }\n\n  function _handleErrorFromElasticsearch(error) {\n    server.log([ 'license', 'warning', 'xpack' ], 'License information could not be obtained from Elasticsearch. ' + error);\n    _cachedResponseFromElasticsearch = null;\n    _updateXPackInfoJSON();\n\n    // allow tests to shutdown\n    error.info = xpackInfoObject;\n\n    throw error;\n  }\n\n  // Start polling for changes\n  return poller.start()\n  .then(() => xpackInfoObject);\n}\n"
      ]
    },
    "mtime": 1491771505397
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/server/lib/poller.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "lodash",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "_"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "Poller"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "Poller",
              "exported": "default"
            }
          ]
        }
      },
      "usedHelpers": [
        "create-class",
        "class-call-check",
        "interop-require-default"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\nvar _lodash = require('lodash');\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar Poller = (function () {\n  function Poller(options) {\n    _classCallCheck(this, Poller);\n\n    this.functionToPoll = options.functionToPoll; // Must return a Promise\n    this.successFunction = options.successFunction || _lodash2['default'].noop;\n    this.errorFunction = options.errorFunction || _lodash2['default'].noop;\n    this.pollFrequencyInMillis = options.pollFrequencyInMillis;\n    this.continuePollingOnError = options.continuePollingOnError || false;\n    this._timeoutId = null;\n  }\n\n  _createClass(Poller, [{\n    key: '_poll',\n    value: function _poll() {\n      var _this = this;\n\n      return this.functionToPoll().then(this.successFunction).then(function () {\n        _this._timeoutId = setTimeout(_this._poll.bind(_this), _this.pollFrequencyInMillis);\n      })['catch'](function (e) {\n        if (_this.continuePollingOnError) {\n          _this._timeoutId = setTimeout(_this._poll.bind(_this), _this.pollFrequencyInMillis);\n        } else {\n          _this.stop();\n        }\n        _this.errorFunction(e);\n      });\n    }\n  }, {\n    key: 'start',\n    value: function start() {\n      if (!this.isRunning()) {\n        return this._poll();\n      }\n    }\n  }, {\n    key: 'stop',\n    value: function stop() {\n      if (this.isRunning()) {\n        clearTimeout(this._timeoutId);\n        this._timeoutId = null;\n      }\n    }\n  }, {\n    key: 'isRunning',\n    value: function isRunning() {\n      return this._timeoutId !== null;\n    }\n  }]);\n\n  return Poller;\n})();\n\nexports['default'] = Poller;\nmodule.exports = exports['default'];\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3NlcnZlci9saWIvcG9sbGVyLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztzQkFBYyxRQUFROzs7O0lBRUQsTUFBTTtBQUVkLFdBRlEsTUFBTSxDQUViLE9BQU8sRUFBRTswQkFGRixNQUFNOztBQUd2QixRQUFJLENBQUMsY0FBYyxHQUFHLE9BQU8sQ0FBQyxjQUFjLENBQUM7QUFDN0MsUUFBSSxDQUFDLGVBQWUsR0FBRyxPQUFPLENBQUMsZUFBZSxJQUFJLG9CQUFFLElBQUksQ0FBQztBQUN6RCxRQUFJLENBQUMsYUFBYSxHQUFHLE9BQU8sQ0FBQyxhQUFhLElBQUksb0JBQUUsSUFBSSxDQUFDO0FBQ3JELFFBQUksQ0FBQyxxQkFBcUIsR0FBRyxPQUFPLENBQUMscUJBQXFCLENBQUM7QUFDM0QsUUFBSSxDQUFDLHNCQUFzQixHQUFHLE9BQU8sQ0FBQyxzQkFBc0IsSUFBSSxLQUFLLENBQUM7QUFDdEUsUUFBSSxDQUFDLFVBQVUsR0FBRyxJQUFJLENBQUM7R0FDeEI7O2VBVGtCLE1BQU07O1dBV3BCLGlCQUFHOzs7QUFDTixhQUFPLElBQUksQ0FBQyxjQUFjLEVBQUUsQ0FDM0IsSUFBSSxDQUFDLElBQUksQ0FBQyxlQUFlLENBQUMsQ0FDMUIsSUFBSSxDQUFDLFlBQU07QUFDVixjQUFLLFVBQVUsR0FBRyxVQUFVLENBQUMsTUFBSyxLQUFLLENBQUMsSUFBSSxPQUFNLEVBQUUsTUFBSyxxQkFBcUIsQ0FBQyxDQUFDO09BQ2pGLENBQUMsU0FDSSxDQUFDLFVBQUEsQ0FBQyxFQUFJO0FBQ1YsWUFBSSxNQUFLLHNCQUFzQixFQUFFO0FBQy9CLGdCQUFLLFVBQVUsR0FBRyxVQUFVLENBQUMsTUFBSyxLQUFLLENBQUMsSUFBSSxPQUFNLEVBQUUsTUFBSyxxQkFBcUIsQ0FBQyxDQUFDO1NBQ2pGLE1BQU07QUFDTCxnQkFBSyxJQUFJLEVBQUUsQ0FBQztTQUNiO0FBQ0QsY0FBSyxhQUFhLENBQUMsQ0FBQyxDQUFDLENBQUM7T0FDdkIsQ0FBQyxDQUFDO0tBQ0o7OztXQUVJLGlCQUFHO0FBQ04sVUFBSSxDQUFDLElBQUksQ0FBQyxTQUFTLEVBQUUsRUFBRTtBQUNyQixlQUFPLElBQUksQ0FBQyxLQUFLLEVBQUUsQ0FBQztPQUNyQjtLQUNGOzs7V0FFRyxnQkFBRztBQUNMLFVBQUksSUFBSSxDQUFDLFNBQVMsRUFBRSxFQUFFO0FBQ3BCLG9CQUFZLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDO0FBQzlCLFlBQUksQ0FBQyxVQUFVLEdBQUcsSUFBSSxDQUFDO09BQ3hCO0tBQ0Y7OztXQUVRLHFCQUFHO0FBQ1YsYUFBTyxJQUFJLENBQUMsVUFBVSxLQUFLLElBQUksQ0FBQztLQUNqQzs7O1NBMUNrQixNQUFNOzs7cUJBQU4sTUFBTSIsImZpbGUiOiIvdXNyL3NoYXJlL2tpYmFuYS9wbHVnaW5zL3gtcGFjay9zZXJ2ZXIvbGliL3BvbGxlci5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBfIGZyb20gJ2xvZGFzaCc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvbGxlciB7XG5cbiAgY29uc3RydWN0b3Iob3B0aW9ucykge1xuICAgIHRoaXMuZnVuY3Rpb25Ub1BvbGwgPSBvcHRpb25zLmZ1bmN0aW9uVG9Qb2xsOyAvLyBNdXN0IHJldHVybiBhIFByb21pc2VcbiAgICB0aGlzLnN1Y2Nlc3NGdW5jdGlvbiA9IG9wdGlvbnMuc3VjY2Vzc0Z1bmN0aW9uIHx8IF8ubm9vcDtcbiAgICB0aGlzLmVycm9yRnVuY3Rpb24gPSBvcHRpb25zLmVycm9yRnVuY3Rpb24gfHwgXy5ub29wO1xuICAgIHRoaXMucG9sbEZyZXF1ZW5jeUluTWlsbGlzID0gb3B0aW9ucy5wb2xsRnJlcXVlbmN5SW5NaWxsaXM7XG4gICAgdGhpcy5jb250aW51ZVBvbGxpbmdPbkVycm9yID0gb3B0aW9ucy5jb250aW51ZVBvbGxpbmdPbkVycm9yIHx8IGZhbHNlO1xuICAgIHRoaXMuX3RpbWVvdXRJZCA9IG51bGw7XG4gIH1cblxuICBfcG9sbCgpIHtcbiAgICByZXR1cm4gdGhpcy5mdW5jdGlvblRvUG9sbCgpXG4gICAgLnRoZW4odGhpcy5zdWNjZXNzRnVuY3Rpb24pXG4gICAgLnRoZW4oKCkgPT4ge1xuICAgICAgdGhpcy5fdGltZW91dElkID0gc2V0VGltZW91dCh0aGlzLl9wb2xsLmJpbmQodGhpcyksIHRoaXMucG9sbEZyZXF1ZW5jeUluTWlsbGlzKTtcbiAgICB9KVxuICAgIC5jYXRjaChlID0+IHtcbiAgICAgIGlmICh0aGlzLmNvbnRpbnVlUG9sbGluZ09uRXJyb3IpIHtcbiAgICAgICAgdGhpcy5fdGltZW91dElkID0gc2V0VGltZW91dCh0aGlzLl9wb2xsLmJpbmQodGhpcyksIHRoaXMucG9sbEZyZXF1ZW5jeUluTWlsbGlzKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuc3RvcCgpO1xuICAgICAgfVxuICAgICAgdGhpcy5lcnJvckZ1bmN0aW9uKGUpO1xuICAgIH0pO1xuICB9XG5cbiAgc3RhcnQoKSB7XG4gICAgaWYgKCF0aGlzLmlzUnVubmluZygpKSB7XG4gICAgICByZXR1cm4gdGhpcy5fcG9sbCgpO1xuICAgIH1cbiAgfVxuXG4gIHN0b3AoKSB7XG4gICAgaWYgKHRoaXMuaXNSdW5uaW5nKCkpIHtcbiAgICAgIGNsZWFyVGltZW91dCh0aGlzLl90aW1lb3V0SWQpO1xuICAgICAgdGhpcy5fdGltZW91dElkID0gbnVsbDtcbiAgICB9XG4gIH1cblxuICBpc1J1bm5pbmcoKSB7XG4gICAgcmV0dXJuIHRoaXMuX3RpbWVvdXRJZCAhPT0gbnVsbDtcbiAgfVxuXG59XG4iXX0=",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/server/lib/poller.js"
      ],
      "names": [],
      "mappings": ";;;;;;;;;;;;sBAAc,QAAQ;;;;IAED,MAAM;AAEd,WAFQ,MAAM,CAEb,OAAO,EAAE;0BAFF,MAAM;;AAGvB,QAAI,CAAC,cAAc,GAAG,OAAO,CAAC,cAAc,CAAC;AAC7C,QAAI,CAAC,eAAe,GAAG,OAAO,CAAC,eAAe,IAAI,oBAAE,IAAI,CAAC;AACzD,QAAI,CAAC,aAAa,GAAG,OAAO,CAAC,aAAa,IAAI,oBAAE,IAAI,CAAC;AACrD,QAAI,CAAC,qBAAqB,GAAG,OAAO,CAAC,qBAAqB,CAAC;AAC3D,QAAI,CAAC,sBAAsB,GAAG,OAAO,CAAC,sBAAsB,IAAI,KAAK,CAAC;AACtE,QAAI,CAAC,UAAU,GAAG,IAAI,CAAC;GACxB;;eATkB,MAAM;;WAWpB,iBAAG;;;AACN,aAAO,IAAI,CAAC,cAAc,EAAE,CAC3B,IAAI,CAAC,IAAI,CAAC,eAAe,CAAC,CAC1B,IAAI,CAAC,YAAM;AACV,cAAK,UAAU,GAAG,UAAU,CAAC,MAAK,KAAK,CAAC,IAAI,OAAM,EAAE,MAAK,qBAAqB,CAAC,CAAC;OACjF,CAAC,SACI,CAAC,UAAA,CAAC,EAAI;AACV,YAAI,MAAK,sBAAsB,EAAE;AAC/B,gBAAK,UAAU,GAAG,UAAU,CAAC,MAAK,KAAK,CAAC,IAAI,OAAM,EAAE,MAAK,qBAAqB,CAAC,CAAC;SACjF,MAAM;AACL,gBAAK,IAAI,EAAE,CAAC;SACb;AACD,cAAK,aAAa,CAAC,CAAC,CAAC,CAAC;OACvB,CAAC,CAAC;KACJ;;;WAEI,iBAAG;AACN,UAAI,CAAC,IAAI,CAAC,SAAS,EAAE,EAAE;AACrB,eAAO,IAAI,CAAC,KAAK,EAAE,CAAC;OACrB;KACF;;;WAEG,gBAAG;AACL,UAAI,IAAI,CAAC,SAAS,EAAE,EAAE;AACpB,oBAAY,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;AAC9B,YAAI,CAAC,UAAU,GAAG,IAAI,CAAC;OACxB;KACF;;;WAEQ,qBAAG;AACV,aAAO,IAAI,CAAC,UAAU,KAAK,IAAI,CAAC;KACjC;;;SA1CkB,MAAM;;;qBAAN,MAAM",
      "file": "/usr/share/kibana/plugins/x-pack/server/lib/poller.js",
      "sourcesContent": [
        "import _ from 'lodash';\n\nexport default class Poller {\n\n  constructor(options) {\n    this.functionToPoll = options.functionToPoll; // Must return a Promise\n    this.successFunction = options.successFunction || _.noop;\n    this.errorFunction = options.errorFunction || _.noop;\n    this.pollFrequencyInMillis = options.pollFrequencyInMillis;\n    this.continuePollingOnError = options.continuePollingOnError || false;\n    this._timeoutId = null;\n  }\n\n  _poll() {\n    return this.functionToPoll()\n    .then(this.successFunction)\n    .then(() => {\n      this._timeoutId = setTimeout(this._poll.bind(this), this.pollFrequencyInMillis);\n    })\n    .catch(e => {\n      if (this.continuePollingOnError) {\n        this._timeoutId = setTimeout(this._poll.bind(this), this.pollFrequencyInMillis);\n      } else {\n        this.stop();\n      }\n      this.errorFunction(e);\n    });\n  }\n\n  start() {\n    if (!this.isRunning()) {\n      return this._poll();\n    }\n  }\n\n  stop() {\n    if (this.isRunning()) {\n      clearTimeout(this._timeoutId);\n      this._timeoutId = null;\n    }\n  }\n\n  isRunning() {\n    return this._timeoutId !== null;\n  }\n\n}\n"
      ]
    },
    "mtime": 1491771505397
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/server/lib/constants.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "moment",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "moment"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "LICENSE_EXPIRY_SOON_DURATION",
            "XPACK_INFO_API_DEFAULT_POLL_FREQUENCY"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "LICENSE_EXPIRY_SOON_DURATION",
              "exported": "LICENSE_EXPIRY_SOON_DURATION"
            },
            {
              "kind": "local",
              "local": "XPACK_INFO_API_DEFAULT_POLL_FREQUENCY",
              "exported": "XPACK_INFO_API_DEFAULT_POLL_FREQUENCY"
            }
          ]
        }
      },
      "usedHelpers": [
        "interop-require-default"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _moment = require('moment');\n\nvar _moment2 = _interopRequireDefault(_moment);\n\nvar LICENSE_EXPIRY_SOON_DURATION = _moment2['default'].duration(30, 'days');\nexports.LICENSE_EXPIRY_SOON_DURATION = LICENSE_EXPIRY_SOON_DURATION;\nvar XPACK_INFO_API_DEFAULT_POLL_FREQUENCY = _moment2['default'].duration(30, 'seconds');\nexports.XPACK_INFO_API_DEFAULT_POLL_FREQUENCY = XPACK_INFO_API_DEFAULT_POLL_FREQUENCY;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3NlcnZlci9saWIvY29uc3RhbnRzLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7O3NCQUFtQixRQUFROzs7O0FBRXBCLElBQU0sNEJBQTRCLEdBQUcsb0JBQU8sUUFBUSxDQUFDLEVBQUUsRUFBRSxNQUFNLENBQUMsQ0FBQzs7QUFDakUsSUFBTSxxQ0FBcUMsR0FBRyxvQkFBTyxRQUFRLENBQUMsRUFBRSxFQUFFLFNBQVMsQ0FBQyxDQUFDIiwiZmlsZSI6Ii91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3NlcnZlci9saWIvY29uc3RhbnRzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnO1xuXG5leHBvcnQgY29uc3QgTElDRU5TRV9FWFBJUllfU09PTl9EVVJBVElPTiA9IG1vbWVudC5kdXJhdGlvbigzMCwgJ2RheXMnKTtcbmV4cG9ydCBjb25zdCBYUEFDS19JTkZPX0FQSV9ERUZBVUxUX1BPTExfRlJFUVVFTkNZID0gbW9tZW50LmR1cmF0aW9uKDMwLCAnc2Vjb25kcycpO1xuIl19",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/server/lib/constants.js"
      ],
      "names": [],
      "mappings": ";;;;;;;;sBAAmB,QAAQ;;;;AAEpB,IAAM,4BAA4B,GAAG,oBAAO,QAAQ,CAAC,EAAE,EAAE,MAAM,CAAC,CAAC;;AACjE,IAAM,qCAAqC,GAAG,oBAAO,QAAQ,CAAC,EAAE,EAAE,SAAS,CAAC,CAAC",
      "file": "/usr/share/kibana/plugins/x-pack/server/lib/constants.js",
      "sourcesContent": [
        "import moment from 'moment';\n\nexport const LICENSE_EXPIRY_SOON_DURATION = moment.duration(30, 'days');\nexport const XPACK_INFO_API_DEFAULT_POLL_FREQUENCY = moment.duration(30, 'seconds');\n"
      ]
    },
    "mtime": 1491771505397
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/graph/index.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "path",
            "imported": [
              "resolve"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "resolve",
                "local": "resolve"
              }
            ]
          },
          {
            "source": "boom",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "Boom"
              }
            ]
          },
          {
            "source": "./server/lib/check_license",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "checkLicense"
              }
            ]
          },
          {
            "source": "../../server/lib/mirror_plugin_status",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "mirrorPluginStatus"
              }
            ]
          }
        ],
        "exports": {
          "exported": [],
          "specifiers": []
        }
      },
      "usedHelpers": [
        "interop-require-default"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _path = require('path');\n\nvar _boom = require('boom');\n\nvar _boom2 = _interopRequireDefault(_boom);\n\nvar _serverLibCheck_license = require('./server/lib/check_license');\n\nvar _serverLibCheck_license2 = _interopRequireDefault(_serverLibCheck_license);\n\nvar _serverLibMirror_plugin_status = require('../../server/lib/mirror_plugin_status');\n\nvar _serverLibMirror_plugin_status2 = _interopRequireDefault(_serverLibMirror_plugin_status);\n\nvar graphExploreRoute = require('./server/routes/graphExplore');\nvar searchProxyRoute = require('./server/routes/searchProxy');\n\nvar APP_TITLE = 'Graph';\n\nmodule.exports = function (kibana) {\n\n  //2.x bootstrap code copied from https://github.com/elastic/timelion/pull/57/files\n  var mainFile = 'plugins/graph/app';\n  var ownDescriptor = Object.getOwnPropertyDescriptor(kibana, 'autoload');\n  var protoDescriptor = Object.getOwnPropertyDescriptor(kibana.constructor.prototype, 'autoload');\n  var descriptor = ownDescriptor || protoDescriptor || {};\n  if (descriptor.get) {\n    // the autoload list has been replaced with a getter that complains about\n    // improper access, bypass that getter by seeing if it is defined\n    mainFile = 'plugins/graph/app_with_autoload';\n  }\n\n  return new kibana.Plugin({\n    id: 'graph',\n    configPrefix: 'xpack.graph',\n    publicDir: (0, _path.resolve)(__dirname, 'public'),\n    require: ['kibana', 'elasticsearch', 'xpack_main'],\n    uiExports: {\n      app: {\n        title: APP_TITLE,\n        order: 9000,\n        icon: 'plugins/graph/icon.png',\n        description: 'Graph exploration',\n        //2.x        main: 'plugins/graph/app',\n        main: mainFile, //2.x\n        injectVars: function injectVars(server, options) {\n          var config = server.config();\n          return {\n            kbnIndex: config.get('kibana.index'),\n            esApiVersion: config.get('elasticsearch.apiVersion'),\n            esShardTimeout: config.get('elasticsearch.shardTimeout'),\n            graphSavePolicy: config.get('xpack.graph.savePolicy'),\n            canEditDrillDownUrls: config.get('xpack.graph.canEditDrillDownUrls')\n          };\n        }\n      },\n      hacks: ['plugins/graph/hacks/toggle_app_link_in_nav']\n    },\n\n    config: function config(Joi) {\n      return Joi.object({\n        enabled: Joi.boolean()['default'](true),\n        canEditDrillDownUrls: Joi.boolean()['default'](true),\n        savePolicy: Joi.string().valid(['config', 'configAndDataWithConsent', 'configAndData', 'none'])['default']('configAndData')\n      })['default']();\n    },\n\n    init: function init(server, options) {\n      var thisPlugin = this;\n      var xpackMainPlugin = server.plugins.xpack_main;\n\n      (0, _serverLibMirror_plugin_status2['default'])(xpackMainPlugin, thisPlugin);\n      xpackMainPlugin.status.once('green', function () {\n        // Register a function that is called whenever the xpack info changes,\n        // to re-compute the license check results for this plugin\n        xpackMainPlugin.info.feature(thisPlugin.id).registerLicenseCheckResultsGenerator(_serverLibCheck_license2['default']);\n      });\n\n      // Add server routes and initalize the plugin here\n      var commonRouteConfig = {\n        pre: [function forbidApiAccess(request, reply) {\n          var licenseCheckResults = xpackMainPlugin.info.feature(thisPlugin.id).getLicenseCheckResults();\n          if (licenseCheckResults.showAppLink && licenseCheckResults.enableAppLink) {\n            reply();\n          } else {\n            reply(_boom2['default'].forbidden(licenseCheckResults.message));\n          }\n        }]\n      };\n      graphExploreRoute(server, commonRouteConfig);\n      searchProxyRoute(server, commonRouteConfig);\n    }\n  });\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvZ3JhcGgvaW5kZXguanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztvQkFBd0IsTUFBTTs7b0JBQ2IsTUFBTTs7OztzQ0FHRSw0QkFBNEI7Ozs7NkNBQ3RCLHVDQUF1Qzs7OztBQUh0RSxJQUFNLGlCQUFpQixHQUFHLE9BQU8sQ0FBQyw4QkFBOEIsQ0FBQyxDQUFDO0FBQ2xFLElBQU0sZ0JBQWdCLEdBQUcsT0FBTyxDQUFDLDZCQUE2QixDQUFDLENBQUM7O0FBSWhFLElBQU0sU0FBUyxHQUFHLE9BQU8sQ0FBQzs7QUFFMUIsTUFBTSxDQUFDLE9BQU8sR0FBRyxVQUFVLE1BQU0sRUFBRTs7O0FBR2pDLE1BQUksUUFBUSxHQUFHLG1CQUFtQixDQUFDO0FBQ25DLE1BQU0sYUFBYSxHQUFHLE1BQU0sQ0FBQyx3QkFBd0IsQ0FBQyxNQUFNLEVBQUUsVUFBVSxDQUFDLENBQUM7QUFDMUUsTUFBTSxlQUFlLEdBQUcsTUFBTSxDQUFDLHdCQUF3QixDQUFDLE1BQU0sQ0FBQyxXQUFXLENBQUMsU0FBUyxFQUFFLFVBQVUsQ0FBQyxDQUFDO0FBQ2xHLE1BQU0sVUFBVSxHQUFHLGFBQWEsSUFBSSxlQUFlLElBQUksRUFBRSxDQUFDO0FBQzFELE1BQUksVUFBVSxDQUFDLEdBQUcsRUFBRTs7O0FBR2xCLFlBQVEsR0FBRyxpQ0FBaUMsQ0FBQztHQUM5Qzs7QUFJRCxTQUFPLElBQUksTUFBTSxDQUFDLE1BQU0sQ0FBQztBQUN2QixNQUFFLEVBQUUsT0FBTztBQUNYLGdCQUFZLEVBQUUsYUFBYTtBQUMzQixhQUFTLEVBQUUsbUJBQVEsU0FBUyxFQUFFLFFBQVEsQ0FBQztBQUN2QyxXQUFPLEVBQUUsQ0FBQyxRQUFRLEVBQUUsZUFBZSxFQUFFLFlBQVksQ0FBQztBQUNsRCxhQUFTLEVBQUU7QUFDVCxTQUFHLEVBQUU7QUFDSCxhQUFLLEVBQUUsU0FBUztBQUNoQixhQUFLLEVBQUUsSUFBSTtBQUNYLFlBQUksRUFBRSx3QkFBd0I7QUFDOUIsbUJBQVcsRUFBRSxtQkFBbUI7O0FBRWhDLFlBQUksRUFBRSxRQUFRO0FBQ2Qsa0JBQVUsRUFBRSxvQkFBVSxNQUFNLEVBQUUsT0FBTyxFQUFFO0FBQ3JDLGNBQU0sTUFBTSxHQUFHLE1BQU0sQ0FBQyxNQUFNLEVBQUUsQ0FBQztBQUMvQixpQkFBTztBQUNMLG9CQUFRLEVBQUUsTUFBTSxDQUFDLEdBQUcsQ0FBQyxjQUFjLENBQUM7QUFDcEMsd0JBQVksRUFBRSxNQUFNLENBQUMsR0FBRyxDQUFDLDBCQUEwQixDQUFDO0FBQ3BELDBCQUFjLEVBQUUsTUFBTSxDQUFDLEdBQUcsQ0FBQyw0QkFBNEIsQ0FBQztBQUN4RCwyQkFBZSxFQUFFLE1BQU0sQ0FBQyxHQUFHLENBQUMsd0JBQXdCLENBQUM7QUFDckQsZ0NBQW9CLEVBQUUsTUFBTSxDQUFDLEdBQUcsQ0FBQyxrQ0FBa0MsQ0FBQztXQUNyRSxDQUFDO1NBQ0g7T0FDRjtBQUNELFdBQUssRUFBRSxDQUFDLDRDQUE0QyxDQUFDO0tBQ3REOztBQUVELFVBQU0sRUFBRSxnQkFBVSxHQUFHLEVBQUU7QUFDckIsYUFBTyxHQUFHLENBQUMsTUFBTSxDQUFDO0FBQ2hCLGVBQU8sRUFBRSxHQUFHLENBQUMsT0FBTyxFQUFFLFdBQVEsQ0FBQyxJQUFJLENBQUM7QUFDcEMsNEJBQW9CLEVBQUUsR0FBRyxDQUFDLE9BQU8sRUFBRSxXQUFRLENBQUMsSUFBSSxDQUFDO0FBQ2pELGtCQUFVLEVBQUcsR0FBRyxDQUFDLE1BQU0sRUFBRSxDQUFDLEtBQUssQ0FBQyxDQUFDLFFBQVEsRUFBQywwQkFBMEIsRUFBQyxlQUFlLEVBQUMsTUFBTSxDQUFDLENBQUMsV0FBUSxDQUFDLGVBQWUsQ0FBQztPQUN2SCxDQUFDLFdBQVEsRUFBRSxDQUFDO0tBQ2Q7O0FBRUQsUUFBSSxFQUFFLGNBQVUsTUFBTSxFQUFFLE9BQU8sRUFBRTtBQUMvQixVQUFNLFVBQVUsR0FBRyxJQUFJLENBQUM7QUFDeEIsVUFBTSxlQUFlLEdBQUcsTUFBTSxDQUFDLE9BQU8sQ0FBQyxVQUFVLENBQUM7O0FBRWxELHNEQUFtQixlQUFlLEVBQUUsVUFBVSxDQUFDLENBQUM7QUFDaEQscUJBQWUsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxZQUFNOzs7QUFHekMsdUJBQWUsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxvQ0FBb0MscUNBQWMsQ0FBQztPQUNoRyxDQUFDLENBQUM7OztBQUdILFVBQU0saUJBQWlCLEdBQUc7QUFDeEIsV0FBRyxFQUFFLENBQ0gsU0FBUyxlQUFlLENBQUMsT0FBTyxFQUFFLEtBQUssRUFBRTtBQUN2QyxjQUFNLG1CQUFtQixHQUFHLGVBQWUsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxzQkFBc0IsRUFBRSxDQUFDO0FBQ2pHLGNBQUksbUJBQW1CLENBQUMsV0FBVyxJQUFJLG1CQUFtQixDQUFDLGFBQWEsRUFBRTtBQUN4RSxpQkFBSyxFQUFFLENBQUM7V0FDVCxNQUFNO0FBQ0wsaUJBQUssQ0FBQyxrQkFBSyxTQUFTLENBQUMsbUJBQW1CLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQztXQUNwRDtTQUNGLENBQ0Y7T0FDRixDQUFDO0FBQ0YsdUJBQWlCLENBQUMsTUFBTSxFQUFFLGlCQUFpQixDQUFDLENBQUM7QUFDN0Msc0JBQWdCLENBQUMsTUFBTSxFQUFFLGlCQUFpQixDQUFDLENBQUM7S0FDN0M7R0FDRixDQUFDLENBQUM7Q0FDSixDQUFDIiwiZmlsZSI6Ii91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvZ3JhcGgvaW5kZXguanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyByZXNvbHZlIH0gZnJvbSAncGF0aCc7XG5pbXBvcnQgQm9vbSBmcm9tICdib29tJztcbmNvbnN0IGdyYXBoRXhwbG9yZVJvdXRlID0gcmVxdWlyZSgnLi9zZXJ2ZXIvcm91dGVzL2dyYXBoRXhwbG9yZScpO1xuY29uc3Qgc2VhcmNoUHJveHlSb3V0ZSA9IHJlcXVpcmUoJy4vc2VydmVyL3JvdXRlcy9zZWFyY2hQcm94eScpO1xuaW1wb3J0IGNoZWNrTGljZW5zZSBmcm9tICcuL3NlcnZlci9saWIvY2hlY2tfbGljZW5zZSc7XG5pbXBvcnQgbWlycm9yUGx1Z2luU3RhdHVzIGZyb20gJy4uLy4uL3NlcnZlci9saWIvbWlycm9yX3BsdWdpbl9zdGF0dXMnO1xuXG5jb25zdCBBUFBfVElUTEUgPSAnR3JhcGgnO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChraWJhbmEpIHtcblxuICAgIC8vMi54IGJvb3RzdHJhcCBjb2RlIGNvcGllZCBmcm9tIGh0dHBzOi8vZ2l0aHViLmNvbS9lbGFzdGljL3RpbWVsaW9uL3B1bGwvNTcvZmlsZXNcbiAgbGV0IG1haW5GaWxlID0gJ3BsdWdpbnMvZ3JhcGgvYXBwJztcbiAgY29uc3Qgb3duRGVzY3JpcHRvciA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioa2liYW5hLCAnYXV0b2xvYWQnKTtcbiAgY29uc3QgcHJvdG9EZXNjcmlwdG9yID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihraWJhbmEuY29uc3RydWN0b3IucHJvdG90eXBlLCAnYXV0b2xvYWQnKTtcbiAgY29uc3QgZGVzY3JpcHRvciA9IG93bkRlc2NyaXB0b3IgfHwgcHJvdG9EZXNjcmlwdG9yIHx8IHt9O1xuICBpZiAoZGVzY3JpcHRvci5nZXQpIHtcbiAgICAvLyB0aGUgYXV0b2xvYWQgbGlzdCBoYXMgYmVlbiByZXBsYWNlZCB3aXRoIGEgZ2V0dGVyIHRoYXQgY29tcGxhaW5zIGFib3V0XG4gICAgLy8gaW1wcm9wZXIgYWNjZXNzLCBieXBhc3MgdGhhdCBnZXR0ZXIgYnkgc2VlaW5nIGlmIGl0IGlzIGRlZmluZWRcbiAgICBtYWluRmlsZSA9ICdwbHVnaW5zL2dyYXBoL2FwcF93aXRoX2F1dG9sb2FkJztcbiAgfVxuXG5cblxuICByZXR1cm4gbmV3IGtpYmFuYS5QbHVnaW4oe1xuICAgIGlkOiAnZ3JhcGgnLFxuICAgIGNvbmZpZ1ByZWZpeDogJ3hwYWNrLmdyYXBoJyxcbiAgICBwdWJsaWNEaXI6IHJlc29sdmUoX19kaXJuYW1lLCAncHVibGljJyksXG4gICAgcmVxdWlyZTogWydraWJhbmEnLCAnZWxhc3RpY3NlYXJjaCcsICd4cGFja19tYWluJ10sXG4gICAgdWlFeHBvcnRzOiB7XG4gICAgICBhcHA6IHtcbiAgICAgICAgdGl0bGU6IEFQUF9USVRMRSxcbiAgICAgICAgb3JkZXI6IDkwMDAsXG4gICAgICAgIGljb246ICdwbHVnaW5zL2dyYXBoL2ljb24ucG5nJyxcbiAgICAgICAgZGVzY3JpcHRpb246ICdHcmFwaCBleHBsb3JhdGlvbicsXG4gICAgICAgIC8vMi54ICAgICAgICBtYWluOiAncGx1Z2lucy9ncmFwaC9hcHAnLFxuICAgICAgICBtYWluOiBtYWluRmlsZSwgLy8yLnhcbiAgICAgICAgaW5qZWN0VmFyczogZnVuY3Rpb24gKHNlcnZlciwgb3B0aW9ucykge1xuICAgICAgICAgIGNvbnN0IGNvbmZpZyA9IHNlcnZlci5jb25maWcoKTtcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAga2JuSW5kZXg6IGNvbmZpZy5nZXQoJ2tpYmFuYS5pbmRleCcpLFxuICAgICAgICAgICAgZXNBcGlWZXJzaW9uOiBjb25maWcuZ2V0KCdlbGFzdGljc2VhcmNoLmFwaVZlcnNpb24nKSxcbiAgICAgICAgICAgIGVzU2hhcmRUaW1lb3V0OiBjb25maWcuZ2V0KCdlbGFzdGljc2VhcmNoLnNoYXJkVGltZW91dCcpLFxuICAgICAgICAgICAgZ3JhcGhTYXZlUG9saWN5OiBjb25maWcuZ2V0KCd4cGFjay5ncmFwaC5zYXZlUG9saWN5JyksXG4gICAgICAgICAgICBjYW5FZGl0RHJpbGxEb3duVXJsczogY29uZmlnLmdldCgneHBhY2suZ3JhcGguY2FuRWRpdERyaWxsRG93blVybHMnKVxuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBoYWNrczogWydwbHVnaW5zL2dyYXBoL2hhY2tzL3RvZ2dsZV9hcHBfbGlua19pbl9uYXYnXSxcbiAgICB9LFxuXG4gICAgY29uZmlnOiBmdW5jdGlvbiAoSm9pKSB7XG4gICAgICByZXR1cm4gSm9pLm9iamVjdCh7XG4gICAgICAgIGVuYWJsZWQ6IEpvaS5ib29sZWFuKCkuZGVmYXVsdCh0cnVlKSxcbiAgICAgICAgY2FuRWRpdERyaWxsRG93blVybHM6IEpvaS5ib29sZWFuKCkuZGVmYXVsdCh0cnVlKSxcbiAgICAgICAgc2F2ZVBvbGljeSA6IEpvaS5zdHJpbmcoKS52YWxpZChbJ2NvbmZpZycsJ2NvbmZpZ0FuZERhdGFXaXRoQ29uc2VudCcsJ2NvbmZpZ0FuZERhdGEnLCdub25lJ10pLmRlZmF1bHQoJ2NvbmZpZ0FuZERhdGEnKSxcbiAgICAgIH0pLmRlZmF1bHQoKTtcbiAgICB9LFxuXG4gICAgaW5pdDogZnVuY3Rpb24gKHNlcnZlciwgb3B0aW9ucykge1xuICAgICAgY29uc3QgdGhpc1BsdWdpbiA9IHRoaXM7XG4gICAgICBjb25zdCB4cGFja01haW5QbHVnaW4gPSBzZXJ2ZXIucGx1Z2lucy54cGFja19tYWluO1xuXG4gICAgICBtaXJyb3JQbHVnaW5TdGF0dXMoeHBhY2tNYWluUGx1Z2luLCB0aGlzUGx1Z2luKTtcbiAgICAgIHhwYWNrTWFpblBsdWdpbi5zdGF0dXMub25jZSgnZ3JlZW4nLCAoKSA9PiB7XG4gICAgICAgIC8vIFJlZ2lzdGVyIGEgZnVuY3Rpb24gdGhhdCBpcyBjYWxsZWQgd2hlbmV2ZXIgdGhlIHhwYWNrIGluZm8gY2hhbmdlcyxcbiAgICAgICAgLy8gdG8gcmUtY29tcHV0ZSB0aGUgbGljZW5zZSBjaGVjayByZXN1bHRzIGZvciB0aGlzIHBsdWdpblxuICAgICAgICB4cGFja01haW5QbHVnaW4uaW5mby5mZWF0dXJlKHRoaXNQbHVnaW4uaWQpLnJlZ2lzdGVyTGljZW5zZUNoZWNrUmVzdWx0c0dlbmVyYXRvcihjaGVja0xpY2Vuc2UpO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIEFkZCBzZXJ2ZXIgcm91dGVzIGFuZCBpbml0YWxpemUgdGhlIHBsdWdpbiBoZXJlXG4gICAgICBjb25zdCBjb21tb25Sb3V0ZUNvbmZpZyA9IHtcbiAgICAgICAgcHJlOiBbXG4gICAgICAgICAgZnVuY3Rpb24gZm9yYmlkQXBpQWNjZXNzKHJlcXVlc3QsIHJlcGx5KSB7XG4gICAgICAgICAgICBjb25zdCBsaWNlbnNlQ2hlY2tSZXN1bHRzID0geHBhY2tNYWluUGx1Z2luLmluZm8uZmVhdHVyZSh0aGlzUGx1Z2luLmlkKS5nZXRMaWNlbnNlQ2hlY2tSZXN1bHRzKCk7XG4gICAgICAgICAgICBpZiAobGljZW5zZUNoZWNrUmVzdWx0cy5zaG93QXBwTGluayAmJiBsaWNlbnNlQ2hlY2tSZXN1bHRzLmVuYWJsZUFwcExpbmspIHtcbiAgICAgICAgICAgICAgcmVwbHkoKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHJlcGx5KEJvb20uZm9yYmlkZGVuKGxpY2Vuc2VDaGVja1Jlc3VsdHMubWVzc2FnZSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgICAgfTtcbiAgICAgIGdyYXBoRXhwbG9yZVJvdXRlKHNlcnZlciwgY29tbW9uUm91dGVDb25maWcpO1xuICAgICAgc2VhcmNoUHJveHlSb3V0ZShzZXJ2ZXIsIGNvbW1vblJvdXRlQ29uZmlnKTtcbiAgICB9XG4gIH0pO1xufTtcbiJdfQ==",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/graph/index.js"
      ],
      "names": [],
      "mappings": "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",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/graph/index.js",
      "sourcesContent": [
        "import { resolve } from 'path';\nimport Boom from 'boom';\nconst graphExploreRoute = require('./server/routes/graphExplore');\nconst searchProxyRoute = require('./server/routes/searchProxy');\nimport checkLicense from './server/lib/check_license';\nimport mirrorPluginStatus from '../../server/lib/mirror_plugin_status';\n\nconst APP_TITLE = 'Graph';\n\nmodule.exports = function (kibana) {\n\n    //2.x bootstrap code copied from https://github.com/elastic/timelion/pull/57/files\n  let mainFile = 'plugins/graph/app';\n  const ownDescriptor = Object.getOwnPropertyDescriptor(kibana, 'autoload');\n  const protoDescriptor = Object.getOwnPropertyDescriptor(kibana.constructor.prototype, 'autoload');\n  const descriptor = ownDescriptor || protoDescriptor || {};\n  if (descriptor.get) {\n    // the autoload list has been replaced with a getter that complains about\n    // improper access, bypass that getter by seeing if it is defined\n    mainFile = 'plugins/graph/app_with_autoload';\n  }\n\n\n\n  return new kibana.Plugin({\n    id: 'graph',\n    configPrefix: 'xpack.graph',\n    publicDir: resolve(__dirname, 'public'),\n    require: ['kibana', 'elasticsearch', 'xpack_main'],\n    uiExports: {\n      app: {\n        title: APP_TITLE,\n        order: 9000,\n        icon: 'plugins/graph/icon.png',\n        description: 'Graph exploration',\n        //2.x        main: 'plugins/graph/app',\n        main: mainFile, //2.x\n        injectVars: function (server, options) {\n          const config = server.config();\n          return {\n            kbnIndex: config.get('kibana.index'),\n            esApiVersion: config.get('elasticsearch.apiVersion'),\n            esShardTimeout: config.get('elasticsearch.shardTimeout'),\n            graphSavePolicy: config.get('xpack.graph.savePolicy'),\n            canEditDrillDownUrls: config.get('xpack.graph.canEditDrillDownUrls')\n          };\n        }\n      },\n      hacks: ['plugins/graph/hacks/toggle_app_link_in_nav'],\n    },\n\n    config: function (Joi) {\n      return Joi.object({\n        enabled: Joi.boolean().default(true),\n        canEditDrillDownUrls: Joi.boolean().default(true),\n        savePolicy : Joi.string().valid(['config','configAndDataWithConsent','configAndData','none']).default('configAndData'),\n      }).default();\n    },\n\n    init: function (server, options) {\n      const thisPlugin = this;\n      const xpackMainPlugin = server.plugins.xpack_main;\n\n      mirrorPluginStatus(xpackMainPlugin, thisPlugin);\n      xpackMainPlugin.status.once('green', () => {\n        // Register a function that is called whenever the xpack info changes,\n        // to re-compute the license check results for this plugin\n        xpackMainPlugin.info.feature(thisPlugin.id).registerLicenseCheckResultsGenerator(checkLicense);\n      });\n\n      // Add server routes and initalize the plugin here\n      const commonRouteConfig = {\n        pre: [\n          function forbidApiAccess(request, reply) {\n            const licenseCheckResults = xpackMainPlugin.info.feature(thisPlugin.id).getLicenseCheckResults();\n            if (licenseCheckResults.showAppLink && licenseCheckResults.enableAppLink) {\n              reply();\n            } else {\n              reply(Boom.forbidden(licenseCheckResults.message));\n            }\n          }\n        ]\n      };\n      graphExploreRoute(server, commonRouteConfig);\n      searchProxyRoute(server, commonRouteConfig);\n    }\n  });\n};\n"
      ]
    },
    "mtime": 1491771506099
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/graph/server/lib/check_license.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [],
        "exports": {
          "exported": [
            "checkLicense",
            "xpackLicenseInfo"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "checkLicense",
              "exported": "default"
            },
            {
              "kind": "local",
              "local": "xpackLicenseInfo",
              "exported": "default"
            }
          ]
        }
      },
      "usedHelpers": []
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nexports['default'] = checkLicense;\n\nfunction checkLicense(xpackLicenseInfo) {\n\n  if (!xpackLicenseInfo || !xpackLicenseInfo.isAvailable()) {\n    return {\n      showAppLink: true,\n      enableAppLink: false,\n      message: 'Graph is unavailable - license information is not available at this time.'\n    };\n  }\n\n  var graphFeature = xpackLicenseInfo.feature('graph');\n  if (!graphFeature.isEnabled()) {\n    return {\n      showAppLink: false,\n      enableAppLink: false,\n      message: 'Graph is unavailable'\n    };\n  }\n\n  var isLicenseActive = xpackLicenseInfo.license.isActive();\n  var message = undefined;\n  if (!isLicenseActive) {\n    message = 'Graph is unavailable - license has expired.';\n  }\n\n  if (xpackLicenseInfo.license.isOneOf(['trial', 'platinum'])) {\n    return {\n      showAppLink: true,\n      enableAppLink: isLicenseActive,\n      message: message\n    };\n  }\n\n  message = 'Graph is unavailable for the current ' + xpackLicenseInfo.license.getType() + ' license. Please upgrade your license.';\n  return {\n    showAppLink: false,\n    enableAppLink: false,\n    message: message\n  };\n}\n\nmodule.exports = exports['default'];\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvZ3JhcGgvc2VydmVyL2xpYi9jaGVja19saWNlbnNlLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O3FCQUF3QixZQUFZOztBQUFyQixTQUFTLFlBQVksQ0FBQyxnQkFBZ0IsRUFBRTs7QUFFckQsTUFBSSxDQUFDLGdCQUFnQixJQUFJLENBQUMsZ0JBQWdCLENBQUMsV0FBVyxFQUFFLEVBQUU7QUFDeEQsV0FBTztBQUNMLGlCQUFXLEVBQUUsSUFBSTtBQUNqQixtQkFBYSxFQUFFLEtBQUs7QUFDcEIsYUFBTyxFQUFFLDJFQUEyRTtLQUNyRixDQUFDO0dBQ0g7O0FBRUQsTUFBTSxZQUFZLEdBQUcsZ0JBQWdCLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDO0FBQ3ZELE1BQUksQ0FBQyxZQUFZLENBQUMsU0FBUyxFQUFFLEVBQUU7QUFDN0IsV0FBTztBQUNMLGlCQUFXLEVBQUUsS0FBSztBQUNsQixtQkFBYSxFQUFFLEtBQUs7QUFDcEIsYUFBTyxFQUFFLHNCQUFzQjtLQUNoQyxDQUFDO0dBQ0g7O0FBRUQsTUFBTSxlQUFlLEdBQUcsZ0JBQWdCLENBQUMsT0FBTyxDQUFDLFFBQVEsRUFBRSxDQUFDO0FBQzVELE1BQUksT0FBTyxZQUFBLENBQUM7QUFDWixNQUFJLENBQUMsZUFBZSxFQUFFO0FBQ3BCLFdBQU8sZ0RBQWdELENBQUM7R0FDekQ7O0FBRUQsTUFBSSxnQkFBZ0IsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUUsT0FBTyxFQUFFLFVBQVUsQ0FBRSxDQUFDLEVBQUU7QUFDN0QsV0FBTztBQUNMLGlCQUFXLEVBQUUsSUFBSTtBQUNqQixtQkFBYSxFQUFFLGVBQWU7QUFDOUIsYUFBTyxFQUFQLE9BQU87S0FDUixDQUFDO0dBQ0g7O0FBRUQsU0FBTyw2Q0FBMkMsZ0JBQWdCLENBQUMsT0FBTyxDQUFDLE9BQU8sRUFBRSwyQ0FBd0MsQ0FBQztBQUM3SCxTQUFPO0FBQ0wsZUFBVyxFQUFFLEtBQUs7QUFDbEIsaUJBQWEsRUFBRSxLQUFLO0FBQ3BCLFdBQU8sRUFBUCxPQUFPO0dBQ1IsQ0FBQztDQUNIIiwiZmlsZSI6Ii91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvZ3JhcGgvc2VydmVyL2xpYi9jaGVja19saWNlbnNlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gY2hlY2tMaWNlbnNlKHhwYWNrTGljZW5zZUluZm8pIHtcblxuICBpZiAoIXhwYWNrTGljZW5zZUluZm8gfHwgIXhwYWNrTGljZW5zZUluZm8uaXNBdmFpbGFibGUoKSkge1xuICAgIHJldHVybiB7XG4gICAgICBzaG93QXBwTGluazogdHJ1ZSxcbiAgICAgIGVuYWJsZUFwcExpbms6IGZhbHNlLFxuICAgICAgbWVzc2FnZTogJ0dyYXBoIGlzIHVuYXZhaWxhYmxlIC0gbGljZW5zZSBpbmZvcm1hdGlvbiBpcyBub3QgYXZhaWxhYmxlIGF0IHRoaXMgdGltZS4nXG4gICAgfTtcbiAgfVxuXG4gIGNvbnN0IGdyYXBoRmVhdHVyZSA9IHhwYWNrTGljZW5zZUluZm8uZmVhdHVyZSgnZ3JhcGgnKTtcbiAgaWYgKCFncmFwaEZlYXR1cmUuaXNFbmFibGVkKCkpIHtcbiAgICByZXR1cm4ge1xuICAgICAgc2hvd0FwcExpbms6IGZhbHNlLFxuICAgICAgZW5hYmxlQXBwTGluazogZmFsc2UsXG4gICAgICBtZXNzYWdlOiAnR3JhcGggaXMgdW5hdmFpbGFibGUnXG4gICAgfTtcbiAgfVxuXG4gIGNvbnN0IGlzTGljZW5zZUFjdGl2ZSA9IHhwYWNrTGljZW5zZUluZm8ubGljZW5zZS5pc0FjdGl2ZSgpO1xuICBsZXQgbWVzc2FnZTtcbiAgaWYgKCFpc0xpY2Vuc2VBY3RpdmUpIHtcbiAgICBtZXNzYWdlID0gYEdyYXBoIGlzIHVuYXZhaWxhYmxlIC0gbGljZW5zZSBoYXMgZXhwaXJlZC5gO1xuICB9XG5cbiAgaWYgKHhwYWNrTGljZW5zZUluZm8ubGljZW5zZS5pc09uZU9mKFsgJ3RyaWFsJywgJ3BsYXRpbnVtJyBdKSkge1xuICAgIHJldHVybiB7XG4gICAgICBzaG93QXBwTGluazogdHJ1ZSxcbiAgICAgIGVuYWJsZUFwcExpbms6IGlzTGljZW5zZUFjdGl2ZSxcbiAgICAgIG1lc3NhZ2VcbiAgICB9O1xuICB9XG5cbiAgbWVzc2FnZSA9IGBHcmFwaCBpcyB1bmF2YWlsYWJsZSBmb3IgdGhlIGN1cnJlbnQgJHt4cGFja0xpY2Vuc2VJbmZvLmxpY2Vuc2UuZ2V0VHlwZSgpfSBsaWNlbnNlLiBQbGVhc2UgdXBncmFkZSB5b3VyIGxpY2Vuc2UuYDtcbiAgcmV0dXJuIHtcbiAgICBzaG93QXBwTGluazogZmFsc2UsXG4gICAgZW5hYmxlQXBwTGluazogZmFsc2UsXG4gICAgbWVzc2FnZVxuICB9O1xufVxuIl19",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/graph/server/lib/check_license.js"
      ],
      "names": [],
      "mappings": ";;;;;qBAAwB,YAAY;;AAArB,SAAS,YAAY,CAAC,gBAAgB,EAAE;;AAErD,MAAI,CAAC,gBAAgB,IAAI,CAAC,gBAAgB,CAAC,WAAW,EAAE,EAAE;AACxD,WAAO;AACL,iBAAW,EAAE,IAAI;AACjB,mBAAa,EAAE,KAAK;AACpB,aAAO,EAAE,2EAA2E;KACrF,CAAC;GACH;;AAED,MAAM,YAAY,GAAG,gBAAgB,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;AACvD,MAAI,CAAC,YAAY,CAAC,SAAS,EAAE,EAAE;AAC7B,WAAO;AACL,iBAAW,EAAE,KAAK;AAClB,mBAAa,EAAE,KAAK;AACpB,aAAO,EAAE,sBAAsB;KAChC,CAAC;GACH;;AAED,MAAM,eAAe,GAAG,gBAAgB,CAAC,OAAO,CAAC,QAAQ,EAAE,CAAC;AAC5D,MAAI,OAAO,YAAA,CAAC;AACZ,MAAI,CAAC,eAAe,EAAE;AACpB,WAAO,gDAAgD,CAAC;GACzD;;AAED,MAAI,gBAAgB,CAAC,OAAO,CAAC,OAAO,CAAC,CAAE,OAAO,EAAE,UAAU,CAAE,CAAC,EAAE;AAC7D,WAAO;AACL,iBAAW,EAAE,IAAI;AACjB,mBAAa,EAAE,eAAe;AAC9B,aAAO,EAAP,OAAO;KACR,CAAC;GACH;;AAED,SAAO,6CAA2C,gBAAgB,CAAC,OAAO,CAAC,OAAO,EAAE,2CAAwC,CAAC;AAC7H,SAAO;AACL,eAAW,EAAE,KAAK;AAClB,iBAAa,EAAE,KAAK;AACpB,WAAO,EAAP,OAAO;GACR,CAAC;CACH",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/graph/server/lib/check_license.js",
      "sourcesContent": [
        "export default function checkLicense(xpackLicenseInfo) {\n\n  if (!xpackLicenseInfo || !xpackLicenseInfo.isAvailable()) {\n    return {\n      showAppLink: true,\n      enableAppLink: false,\n      message: 'Graph is unavailable - license information is not available at this time.'\n    };\n  }\n\n  const graphFeature = xpackLicenseInfo.feature('graph');\n  if (!graphFeature.isEnabled()) {\n    return {\n      showAppLink: false,\n      enableAppLink: false,\n      message: 'Graph is unavailable'\n    };\n  }\n\n  const isLicenseActive = xpackLicenseInfo.license.isActive();\n  let message;\n  if (!isLicenseActive) {\n    message = `Graph is unavailable - license has expired.`;\n  }\n\n  if (xpackLicenseInfo.license.isOneOf([ 'trial', 'platinum' ])) {\n    return {\n      showAppLink: true,\n      enableAppLink: isLicenseActive,\n      message\n    };\n  }\n\n  message = `Graph is unavailable for the current ${xpackLicenseInfo.license.getType()} license. Please upgrade your license.`;\n  return {\n    showAppLink: false,\n    enableAppLink: false,\n    message\n  };\n}\n"
      ]
    },
    "mtime": 1491771510543
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/graph/server/routes/graphExplore.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "boom",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "Boom"
              }
            ]
          },
          {
            "source": "lodash",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "_"
              }
            ]
          }
        ],
        "exports": {
          "exported": [],
          "specifiers": []
        }
      },
      "usedHelpers": [
        "extends",
        "interop-require-default"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _boom = require('boom');\n\nvar _boom2 = _interopRequireDefault(_boom);\n\nvar _lodash = require('lodash');\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nmodule.exports = function (server, commonRouteConfig) {\n  var _server$plugins$elasticsearch$getCluster = server.plugins.elasticsearch.getCluster('data');\n\n  var callWithRequest = _server$plugins$elasticsearch$getCluster.callWithRequest;\n\n  function graphExplore(req) {\n    var payload = req.payload;\n    return callWithRequest(req, 'transport.request', {\n      'path': '/' + encodeURIComponent(payload.index) + '/_xpack/_graph/_explore',\n      body: payload.query,\n      method: 'POST',\n      query: {}\n    });\n  }\n  server.route({\n    path: '/api/graph/graphExplore',\n    method: 'POST',\n    handler: function handler(req, reply) {\n      graphExplore(req).then(function (resp) {\n        reply({\n          ok: true,\n          resp: resp\n        });\n      })['catch'](function (err) {\n        //Extract known reasons for bad choice of field\n        var reasons = _lodash2['default'].get(err, 'body.error.root_cause', []);\n\n        var fieldDataReason = reasons.find(function (cause) {\n          return cause.reason.includes('Fielddata is disabled on text fields');\n        });\n        if (fieldDataReason) {\n          reply(_boom2['default'].badRequest(fieldDataReason.reason));\n          return;\n        }\n\n        var floatDataReason = reasons.find(function (cause) {\n          return cause.reason.includes('No support for examining floating point');\n        });\n        if (floatDataReason) {\n          reply(_boom2['default'].badRequest(floatDataReason.reason));\n          return;\n        }\n\n        var badDiversityFieldReason = reasons.find(function (cause) {\n          return cause.reason.includes('Sample diversifying key must be a single valued-field');\n        });\n        if (badDiversityFieldReason) {\n          reply(_boom2['default'].badRequest(badDiversityFieldReason.reason));\n          return;\n        }\n\n        var badQueryReason = reasons.find(function (cause) {\n          return cause.reason.includes('Failed to parse query') || cause.type == 'parsing_exception';\n        });\n        if (badQueryReason) {\n          reply(_boom2['default'].badRequest(badQueryReason.reason));\n          return;\n        }\n\n        // Throw generic error\n        throw err;\n      })['catch'](reply);\n    },\n    config: _extends({}, commonRouteConfig)\n  });\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvZ3JhcGgvc2VydmVyL3JvdXRlcy9ncmFwaEV4cGxvcmUuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7O29CQUNpQixNQUFNOzs7O3NCQUNULFFBQVE7Ozs7QUFFdEIsTUFBTSxDQUFDLE9BQU8sR0FBRyxVQUFVLE1BQU0sRUFBRSxpQkFBaUIsRUFBRTtpREFDeEIsTUFBTSxDQUFDLE9BQU8sQ0FBQyxhQUFhLENBQUMsVUFBVSxDQUFDLE1BQU0sQ0FBQzs7TUFBbkUsZUFBZSw0Q0FBZixlQUFlOztBQUV2QixXQUFTLFlBQVksQ0FBQyxHQUFHLEVBQUU7QUFDekIsUUFBTSxPQUFPLEdBQUcsR0FBRyxDQUFDLE9BQU8sQ0FBQztBQUM1QixXQUFPLGVBQWUsQ0FBQyxHQUFHLEVBQUUsbUJBQW1CLEVBQUU7QUFDL0MsWUFBTSxFQUFFLEdBQUcsR0FBRyxrQkFBa0IsQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLEdBQUcseUJBQXlCO0FBQzNFLFVBQUksRUFBRSxPQUFPLENBQUMsS0FBSztBQUNuQixZQUFNLEVBQUUsTUFBTTtBQUNkLFdBQUssRUFBRSxFQUFFO0tBQ1YsQ0FBQyxDQUFDO0dBQ0o7QUFDRCxRQUFNLENBQUMsS0FBSyxDQUFDO0FBQ1gsUUFBSSxFQUFFLHlCQUF5QjtBQUMvQixVQUFNLEVBQUUsTUFBTTtBQUNkLFdBQU8sRUFBRSxpQkFBVSxHQUFHLEVBQUUsS0FBSyxFQUFFO0FBQzdCLGtCQUFZLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLFVBQVUsSUFBSSxFQUFFO0FBQ3JDLGFBQUssQ0FBQztBQUNKLFlBQUUsRUFBRSxJQUFJO0FBQ1IsY0FBSSxFQUFFLElBQUk7U0FDWCxDQUFDLENBQUM7T0FDSixDQUFDLFNBQU0sQ0FBQyxVQUFVLEdBQUcsRUFBRTs7QUFFdEIsWUFBTSxPQUFPLEdBQUcsb0JBQUUsR0FBRyxDQUFDLEdBQUcsRUFBQyx1QkFBdUIsRUFBRSxFQUFFLENBQUMsQ0FBQzs7QUFFdkQsWUFBTSxlQUFlLEdBQUcsT0FBTyxDQUFDLElBQUksQ0FBQyxVQUFBLEtBQUs7aUJBQUksS0FBSyxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsc0NBQXNDLENBQUM7U0FBQSxDQUFDLENBQUM7QUFDN0csWUFBSSxlQUFlLEVBQUU7QUFDbkIsZUFBSyxDQUFDLGtCQUFLLFVBQVUsQ0FBQyxlQUFlLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQztBQUMvQyxpQkFBTztTQUNSOztBQUVELFlBQU0sZUFBZSxHQUFHLE9BQU8sQ0FBQyxJQUFJLENBQUMsVUFBQSxLQUFLO2lCQUFJLEtBQUssQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLHlDQUF5QyxDQUFDO1NBQUEsQ0FBQyxDQUFDO0FBQ2hILFlBQUksZUFBZSxFQUFFO0FBQ25CLGVBQUssQ0FBQyxrQkFBSyxVQUFVLENBQUMsZUFBZSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUM7QUFDL0MsaUJBQU87U0FDUjs7QUFFRCxZQUFNLHVCQUF1QixHQUFHLE9BQU8sQ0FBQyxJQUFJLENBQUMsVUFBQSxLQUFLO2lCQUNoRCxLQUFLLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyx1REFBdUQsQ0FBQztTQUFBLENBQUMsQ0FBQztBQUNsRixZQUFJLHVCQUF1QixFQUFFO0FBQzNCLGVBQUssQ0FBQyxrQkFBSyxVQUFVLENBQUMsdUJBQXVCLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQztBQUN2RCxpQkFBTztTQUNSOztBQUVELFlBQU0sY0FBYyxHQUFHLE9BQU8sQ0FBQyxJQUFJLENBQUMsVUFBQSxLQUFLO2lCQUFJLEtBQUssQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLHVCQUF1QixDQUFDLElBQ3RGLEtBQUssQ0FBQyxJQUFJLElBQUksbUJBQW1CO1NBQUEsQ0FBQyxDQUFDO0FBQ3hDLFlBQUksY0FBYyxFQUFFO0FBQ2xCLGVBQUssQ0FBQyxrQkFBSyxVQUFVLENBQUMsY0FBYyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUM7QUFDOUMsaUJBQU87U0FDUjs7O0FBR0QsY0FBTSxHQUFHLENBQUM7T0FDWCxDQUFDLFNBQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQztLQUNqQjtBQUNELFVBQU0sZUFDRCxpQkFBaUIsQ0FDckI7R0FDRixDQUFDLENBQUM7Q0FFSixDQUFDIiwiZmlsZSI6Ii91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvZ3JhcGgvc2VydmVyL3JvdXRlcy9ncmFwaEV4cGxvcmUuanMiLCJzb3VyY2VzQ29udGVudCI6WyJcbmltcG9ydCBCb29tIGZyb20gJ2Jvb20nO1xuaW1wb3J0IF8gZnJvbSAnbG9kYXNoJztcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoc2VydmVyLCBjb21tb25Sb3V0ZUNvbmZpZykge1xuICBjb25zdCB7IGNhbGxXaXRoUmVxdWVzdCB9ID0gc2VydmVyLnBsdWdpbnMuZWxhc3RpY3NlYXJjaC5nZXRDbHVzdGVyKCdkYXRhJyk7XG5cbiAgZnVuY3Rpb24gZ3JhcGhFeHBsb3JlKHJlcSkge1xuICAgIGNvbnN0IHBheWxvYWQgPSByZXEucGF5bG9hZDtcbiAgICByZXR1cm4gY2FsbFdpdGhSZXF1ZXN0KHJlcSwgJ3RyYW5zcG9ydC5yZXF1ZXN0Jywge1xuICAgICAgJ3BhdGgnOiAnLycgKyBlbmNvZGVVUklDb21wb25lbnQocGF5bG9hZC5pbmRleCkgKyAnL194cGFjay9fZ3JhcGgvX2V4cGxvcmUnLFxuICAgICAgYm9keTogcGF5bG9hZC5xdWVyeSxcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgcXVlcnk6IHt9XG4gICAgfSk7XG4gIH1cbiAgc2VydmVyLnJvdXRlKHtcbiAgICBwYXRoOiAnL2FwaS9ncmFwaC9ncmFwaEV4cGxvcmUnLFxuICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgIGhhbmRsZXI6IGZ1bmN0aW9uIChyZXEsIHJlcGx5KSB7XG4gICAgICBncmFwaEV4cGxvcmUocmVxKS50aGVuKGZ1bmN0aW9uIChyZXNwKSB7XG4gICAgICAgIHJlcGx5KHtcbiAgICAgICAgICBvazogdHJ1ZSxcbiAgICAgICAgICByZXNwOiByZXNwXG4gICAgICAgIH0pO1xuICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikge1xuICAgICAgICAvL0V4dHJhY3Qga25vd24gcmVhc29ucyBmb3IgYmFkIGNob2ljZSBvZiBmaWVsZFxuICAgICAgICBjb25zdCByZWFzb25zID0gXy5nZXQoZXJyLCdib2R5LmVycm9yLnJvb3RfY2F1c2UnLCBbXSk7XG5cbiAgICAgICAgY29uc3QgZmllbGREYXRhUmVhc29uID0gcmVhc29ucy5maW5kKGNhdXNlID0+IGNhdXNlLnJlYXNvbi5pbmNsdWRlcygnRmllbGRkYXRhIGlzIGRpc2FibGVkIG9uIHRleHQgZmllbGRzJykpO1xuICAgICAgICBpZiAoZmllbGREYXRhUmVhc29uKSB7XG4gICAgICAgICAgcmVwbHkoQm9vbS5iYWRSZXF1ZXN0KGZpZWxkRGF0YVJlYXNvbi5yZWFzb24pKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBmbG9hdERhdGFSZWFzb24gPSByZWFzb25zLmZpbmQoY2F1c2UgPT4gY2F1c2UucmVhc29uLmluY2x1ZGVzKCdObyBzdXBwb3J0IGZvciBleGFtaW5pbmcgZmxvYXRpbmcgcG9pbnQnKSk7XG4gICAgICAgIGlmIChmbG9hdERhdGFSZWFzb24pIHtcbiAgICAgICAgICByZXBseShCb29tLmJhZFJlcXVlc3QoZmxvYXREYXRhUmVhc29uLnJlYXNvbikpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGJhZERpdmVyc2l0eUZpZWxkUmVhc29uID0gcmVhc29ucy5maW5kKGNhdXNlID0+XG4gICAgICAgICAgY2F1c2UucmVhc29uLmluY2x1ZGVzKCdTYW1wbGUgZGl2ZXJzaWZ5aW5nIGtleSBtdXN0IGJlIGEgc2luZ2xlIHZhbHVlZC1maWVsZCcpKTtcbiAgICAgICAgaWYgKGJhZERpdmVyc2l0eUZpZWxkUmVhc29uKSB7XG4gICAgICAgICAgcmVwbHkoQm9vbS5iYWRSZXF1ZXN0KGJhZERpdmVyc2l0eUZpZWxkUmVhc29uLnJlYXNvbikpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGJhZFF1ZXJ5UmVhc29uID0gcmVhc29ucy5maW5kKGNhdXNlID0+IGNhdXNlLnJlYXNvbi5pbmNsdWRlcygnRmFpbGVkIHRvIHBhcnNlIHF1ZXJ5JylcbiAgICAgICAgICB8fCBjYXVzZS50eXBlID09ICdwYXJzaW5nX2V4Y2VwdGlvbicpO1xuICAgICAgICBpZiAoYmFkUXVlcnlSZWFzb24pIHtcbiAgICAgICAgICByZXBseShCb29tLmJhZFJlcXVlc3QoYmFkUXVlcnlSZWFzb24ucmVhc29uKSk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgICAvLyBUaHJvdyBnZW5lcmljIGVycm9yXG4gICAgICAgIHRocm93IGVycjtcbiAgICAgIH0pLmNhdGNoKHJlcGx5KTtcbiAgICB9LFxuICAgIGNvbmZpZzoge1xuICAgICAgLi4uY29tbW9uUm91dGVDb25maWdcbiAgICB9XG4gIH0pO1xuXG59O1xuIl19",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/graph/server/routes/graphExplore.js"
      ],
      "names": [],
      "mappings": ";;;;;;oBACiB,MAAM;;;;sBACT,QAAQ;;;;AAEtB,MAAM,CAAC,OAAO,GAAG,UAAU,MAAM,EAAE,iBAAiB,EAAE;iDACxB,MAAM,CAAC,OAAO,CAAC,aAAa,CAAC,UAAU,CAAC,MAAM,CAAC;;MAAnE,eAAe,4CAAf,eAAe;;AAEvB,WAAS,YAAY,CAAC,GAAG,EAAE;AACzB,QAAM,OAAO,GAAG,GAAG,CAAC,OAAO,CAAC;AAC5B,WAAO,eAAe,CAAC,GAAG,EAAE,mBAAmB,EAAE;AAC/C,YAAM,EAAE,GAAG,GAAG,kBAAkB,CAAC,OAAO,CAAC,KAAK,CAAC,GAAG,yBAAyB;AAC3E,UAAI,EAAE,OAAO,CAAC,KAAK;AACnB,YAAM,EAAE,MAAM;AACd,WAAK,EAAE,EAAE;KACV,CAAC,CAAC;GACJ;AACD,QAAM,CAAC,KAAK,CAAC;AACX,QAAI,EAAE,yBAAyB;AAC/B,UAAM,EAAE,MAAM;AACd,WAAO,EAAE,iBAAU,GAAG,EAAE,KAAK,EAAE;AAC7B,kBAAY,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,UAAU,IAAI,EAAE;AACrC,aAAK,CAAC;AACJ,YAAE,EAAE,IAAI;AACR,cAAI,EAAE,IAAI;SACX,CAAC,CAAC;OACJ,CAAC,SAAM,CAAC,UAAU,GAAG,EAAE;;AAEtB,YAAM,OAAO,GAAG,oBAAE,GAAG,CAAC,GAAG,EAAC,uBAAuB,EAAE,EAAE,CAAC,CAAC;;AAEvD,YAAM,eAAe,GAAG,OAAO,CAAC,IAAI,CAAC,UAAA,KAAK;iBAAI,KAAK,CAAC,MAAM,CAAC,QAAQ,CAAC,sCAAsC,CAAC;SAAA,CAAC,CAAC;AAC7G,YAAI,eAAe,EAAE;AACnB,eAAK,CAAC,kBAAK,UAAU,CAAC,eAAe,CAAC,MAAM,CAAC,CAAC,CAAC;AAC/C,iBAAO;SACR;;AAED,YAAM,eAAe,GAAG,OAAO,CAAC,IAAI,CAAC,UAAA,KAAK;iBAAI,KAAK,CAAC,MAAM,CAAC,QAAQ,CAAC,yCAAyC,CAAC;SAAA,CAAC,CAAC;AAChH,YAAI,eAAe,EAAE;AACnB,eAAK,CAAC,kBAAK,UAAU,CAAC,eAAe,CAAC,MAAM,CAAC,CAAC,CAAC;AAC/C,iBAAO;SACR;;AAED,YAAM,uBAAuB,GAAG,OAAO,CAAC,IAAI,CAAC,UAAA,KAAK;iBAChD,KAAK,CAAC,MAAM,CAAC,QAAQ,CAAC,uDAAuD,CAAC;SAAA,CAAC,CAAC;AAClF,YAAI,uBAAuB,EAAE;AAC3B,eAAK,CAAC,kBAAK,UAAU,CAAC,uBAAuB,CAAC,MAAM,CAAC,CAAC,CAAC;AACvD,iBAAO;SACR;;AAED,YAAM,cAAc,GAAG,OAAO,CAAC,IAAI,CAAC,UAAA,KAAK;iBAAI,KAAK,CAAC,MAAM,CAAC,QAAQ,CAAC,uBAAuB,CAAC,IACtF,KAAK,CAAC,IAAI,IAAI,mBAAmB;SAAA,CAAC,CAAC;AACxC,YAAI,cAAc,EAAE;AAClB,eAAK,CAAC,kBAAK,UAAU,CAAC,cAAc,CAAC,MAAM,CAAC,CAAC,CAAC;AAC9C,iBAAO;SACR;;;AAGD,cAAM,GAAG,CAAC;OACX,CAAC,SAAM,CAAC,KAAK,CAAC,CAAC;KACjB;AACD,UAAM,eACD,iBAAiB,CACrB;GACF,CAAC,CAAC;CAEJ,CAAC",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/graph/server/routes/graphExplore.js",
      "sourcesContent": [
        "\nimport Boom from 'boom';\nimport _ from 'lodash';\n\nmodule.exports = function (server, commonRouteConfig) {\n  const { callWithRequest } = server.plugins.elasticsearch.getCluster('data');\n\n  function graphExplore(req) {\n    const payload = req.payload;\n    return callWithRequest(req, 'transport.request', {\n      'path': '/' + encodeURIComponent(payload.index) + '/_xpack/_graph/_explore',\n      body: payload.query,\n      method: 'POST',\n      query: {}\n    });\n  }\n  server.route({\n    path: '/api/graph/graphExplore',\n    method: 'POST',\n    handler: function (req, reply) {\n      graphExplore(req).then(function (resp) {\n        reply({\n          ok: true,\n          resp: resp\n        });\n      }).catch(function (err) {\n        //Extract known reasons for bad choice of field\n        const reasons = _.get(err,'body.error.root_cause', []);\n\n        const fieldDataReason = reasons.find(cause => cause.reason.includes('Fielddata is disabled on text fields'));\n        if (fieldDataReason) {\n          reply(Boom.badRequest(fieldDataReason.reason));\n          return;\n        }\n\n        const floatDataReason = reasons.find(cause => cause.reason.includes('No support for examining floating point'));\n        if (floatDataReason) {\n          reply(Boom.badRequest(floatDataReason.reason));\n          return;\n        }\n\n        const badDiversityFieldReason = reasons.find(cause =>\n          cause.reason.includes('Sample diversifying key must be a single valued-field'));\n        if (badDiversityFieldReason) {\n          reply(Boom.badRequest(badDiversityFieldReason.reason));\n          return;\n        }\n\n        const badQueryReason = reasons.find(cause => cause.reason.includes('Failed to parse query')\n          || cause.type == 'parsing_exception');\n        if (badQueryReason) {\n          reply(Boom.badRequest(badQueryReason.reason));\n          return;\n        }\n\n          // Throw generic error\n        throw err;\n      }).catch(reply);\n    },\n    config: {\n      ...commonRouteConfig\n    }\n  });\n\n};\n"
      ]
    },
    "mtime": 1491771510543
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/graph/server/routes/searchProxy.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [],
        "exports": {
          "exported": [],
          "specifiers": []
        }
      },
      "usedHelpers": [
        "extends"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nmodule.exports = function (server, commonRouteConfig) {\n\n  server.route({\n    path: '/api/graph/searchProxy',\n    method: 'POST',\n    handler: function handler(req, reply) {\n      var _server$plugins$elasticsearch$getCluster = server.plugins.elasticsearch.getCluster('data');\n\n      var callWithRequest = _server$plugins$elasticsearch$getCluster.callWithRequest;\n\n      callWithRequest(req, 'search', req.payload).then(function (resp) {\n        reply({\n          ok: true,\n          resp: resp\n        });\n      })['catch'](reply);\n    },\n    config: _extends({}, commonRouteConfig)\n  });\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvZ3JhcGgvc2VydmVyL3JvdXRlcy9zZWFyY2hQcm94eS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsTUFBTSxDQUFDLE9BQU8sR0FBRyxVQUFVLE1BQU0sRUFBRSxpQkFBaUIsRUFBRTs7QUFFcEQsUUFBTSxDQUFDLEtBQUssQ0FBQztBQUNYLFFBQUksRUFBRSx3QkFBd0I7QUFDOUIsVUFBTSxFQUFFLE1BQU07QUFDZCxXQUFPLEVBQUUsaUJBQVUsR0FBRyxFQUFFLEtBQUssRUFBRTtxREFDRCxNQUFNLENBQUMsT0FBTyxDQUFDLGFBQWEsQ0FBQyxVQUFVLENBQUMsTUFBTSxDQUFDOztVQUFuRSxlQUFlLDRDQUFmLGVBQWU7O0FBRXZCLHFCQUFlLENBQUMsR0FBRyxFQUFFLFFBQVEsRUFBRSxHQUFHLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLFVBQVUsSUFBSSxFQUFFO0FBQy9ELGFBQUssQ0FBQztBQUNKLFlBQUUsRUFBRSxJQUFJO0FBQ1IsY0FBSSxFQUFDLElBQUk7U0FDVixDQUFDLENBQUM7T0FDSixDQUFDLFNBQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQztLQUdqQjtBQUNELFVBQU0sZUFDRCxpQkFBaUIsQ0FDckI7R0FDRixDQUFDLENBQUM7Q0FHSixDQUFDIiwiZmlsZSI6Ii91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvZ3JhcGgvc2VydmVyL3JvdXRlcy9zZWFyY2hQcm94eS5qcyIsInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKHNlcnZlciwgY29tbW9uUm91dGVDb25maWcpIHtcblxuICBzZXJ2ZXIucm91dGUoe1xuICAgIHBhdGg6ICcvYXBpL2dyYXBoL3NlYXJjaFByb3h5JyxcbiAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICBoYW5kbGVyOiBmdW5jdGlvbiAocmVxLCByZXBseSkge1xuICAgICAgY29uc3QgeyBjYWxsV2l0aFJlcXVlc3QgfSA9IHNlcnZlci5wbHVnaW5zLmVsYXN0aWNzZWFyY2guZ2V0Q2x1c3RlcignZGF0YScpO1xuXG4gICAgICBjYWxsV2l0aFJlcXVlc3QocmVxLCAnc2VhcmNoJywgcmVxLnBheWxvYWQpLnRoZW4oZnVuY3Rpb24gKHJlc3ApIHtcbiAgICAgICAgcmVwbHkoe1xuICAgICAgICAgIG9rOiB0cnVlLFxuICAgICAgICAgIHJlc3A6cmVzcFxuICAgICAgICB9KTtcbiAgICAgIH0pLmNhdGNoKHJlcGx5KTtcblxuXG4gICAgfSxcbiAgICBjb25maWc6IHtcbiAgICAgIC4uLmNvbW1vblJvdXRlQ29uZmlnXG4gICAgfVxuICB9KTtcblxuXG59O1xuIl19",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/graph/server/routes/searchProxy.js"
      ],
      "names": [],
      "mappings": ";;;;AAAA,MAAM,CAAC,OAAO,GAAG,UAAU,MAAM,EAAE,iBAAiB,EAAE;;AAEpD,QAAM,CAAC,KAAK,CAAC;AACX,QAAI,EAAE,wBAAwB;AAC9B,UAAM,EAAE,MAAM;AACd,WAAO,EAAE,iBAAU,GAAG,EAAE,KAAK,EAAE;qDACD,MAAM,CAAC,OAAO,CAAC,aAAa,CAAC,UAAU,CAAC,MAAM,CAAC;;UAAnE,eAAe,4CAAf,eAAe;;AAEvB,qBAAe,CAAC,GAAG,EAAE,QAAQ,EAAE,GAAG,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,UAAU,IAAI,EAAE;AAC/D,aAAK,CAAC;AACJ,YAAE,EAAE,IAAI;AACR,cAAI,EAAC,IAAI;SACV,CAAC,CAAC;OACJ,CAAC,SAAM,CAAC,KAAK,CAAC,CAAC;KAGjB;AACD,UAAM,eACD,iBAAiB,CACrB;GACF,CAAC,CAAC;CAGJ,CAAC",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/graph/server/routes/searchProxy.js",
      "sourcesContent": [
        "module.exports = function (server, commonRouteConfig) {\n\n  server.route({\n    path: '/api/graph/searchProxy',\n    method: 'POST',\n    handler: function (req, reply) {\n      const { callWithRequest } = server.plugins.elasticsearch.getCluster('data');\n\n      callWithRequest(req, 'search', req.payload).then(function (resp) {\n        reply({\n          ok: true,\n          resp:resp\n        });\n      }).catch(reply);\n\n\n    },\n    config: {\n      ...commonRouteConfig\n    }\n  });\n\n\n};\n"
      ]
    },
    "mtime": 1491771510543
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/monitoring/index.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "lodash",
            "imported": [
              "get",
              "has",
              "set"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "get",
                "local": "get"
              },
              {
                "kind": "named",
                "imported": "has",
                "local": "has"
              },
              {
                "kind": "named",
                "imported": "set",
                "local": "set"
              }
            ]
          },
          {
            "source": "path",
            "imported": [
              "join",
              "resolve"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "join",
                "local": "join"
              },
              {
                "kind": "named",
                "imported": "resolve",
                "local": "resolve"
              }
            ]
          },
          {
            "source": "bluebird",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "Promise"
              }
            ]
          },
          {
            "source": "elasticsearch",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "elasticsearch"
              }
            ]
          },
          {
            "source": "../../server/lib/require_all_and_apply",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "requireAllAndApply"
              }
            ]
          },
          {
            "source": "./server/lib/es_client/health_check",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "esHealthCheck"
              }
            ]
          },
          {
            "source": "./server/lib/es_client/instantiate_client",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "instantiateClient"
              }
            ]
          },
          {
            "source": "./server/kibana_monitoring",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "initKibanaMonitoring"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "monitoringIndex",
            "kibana"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "monitoringIndex",
              "exported": "default"
            },
            {
              "kind": "local",
              "local": "kibana",
              "exported": "default"
            }
          ]
        }
      },
      "usedHelpers": [
        "interop-require-default"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nexports['default'] = monitoringIndex;\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _lodash = require('lodash');\n\nvar _path = require('path');\n\nvar _bluebird = require('bluebird');\n\nvar _bluebird2 = _interopRequireDefault(_bluebird);\n\nvar _elasticsearch = require('elasticsearch');\n\nvar _elasticsearch2 = _interopRequireDefault(_elasticsearch);\n\nvar _serverLibRequire_all_and_apply = require('../../server/lib/require_all_and_apply');\n\nvar _serverLibRequire_all_and_apply2 = _interopRequireDefault(_serverLibRequire_all_and_apply);\n\nvar _serverLibEs_clientHealth_check = require('./server/lib/es_client/health_check');\n\nvar _serverLibEs_clientHealth_check2 = _interopRequireDefault(_serverLibEs_clientHealth_check);\n\nvar _serverLibEs_clientInstantiate_client = require('./server/lib/es_client/instantiate_client');\n\nvar _serverLibEs_clientInstantiate_client2 = _interopRequireDefault(_serverLibEs_clientInstantiate_client);\n\nvar _serverKibana_monitoring = require('./server/kibana_monitoring');\n\nvar _serverKibana_monitoring2 = _interopRequireDefault(_serverKibana_monitoring);\n\nfunction monitoringIndex(kibana) {\n  return new kibana.Plugin({\n    require: ['kibana', 'elasticsearch', 'xpack_main'],\n    id: 'monitoring',\n    configPrefix: 'xpack.monitoring',\n    publicDir: (0, _path.resolve)(__dirname, 'public'),\n    uiExports: {\n      app: {\n        title: 'Monitoring',\n        order: 9002,\n        description: 'Monitoring for Elasticsearch',\n        icon: 'plugins/monitoring/monitoring.svg',\n        main: 'plugins/monitoring/monitoring',\n        injectVars: function injectVars(server) {\n          var config = server.config();\n          return {\n            maxBucketSize: config.get('xpack.monitoring.max_bucket_size'),\n            minIntervalSeconds: config.get('xpack.monitoring.min_interval_seconds'),\n            kbnIndex: config.get('kibana.index'),\n            esApiVersion: config.get('elasticsearch.apiVersion'),\n            esShardTimeout: config.get('elasticsearch.shardTimeout'),\n            showLicenseExpiration: config.get('xpack.monitoring.show_license_expiration'),\n            showCgroupMetricsElasticsearch: config.get('xpack.monitoring.ui.container.elasticsearch.enabled'),\n            showCgroupMetricsLogstash: config.get('xpack.monitoring.ui.container.logstash.enabled')\n          };\n        }\n      },\n      injectDefaultVars: function injectDefaultVars(server) {\n        var config = server.config();\n        return {\n          statsReportUrl: config.get('xpack.monitoring.stats_report_url'),\n          reportStats: config.get('xpack.monitoring.report_stats'),\n          monitoringUiEnabled: config.get('xpack.monitoring.ui.enabled')\n        };\n      },\n      hacks: ['plugins/monitoring/hacks/phone_home_notifications', 'plugins/monitoring/hacks/phone_home_trigger', 'plugins/monitoring/hacks/toggle_app_link_in_nav']\n    },\n\n    config: function config(Joi) {\n      var DEFAULT_REQUEST_HEADERS = ['authorization'];\n      var array = Joi.array;\n      var boolean = Joi.boolean;\n      var number = Joi.number;\n      var object = Joi.object;\n      var string = Joi.string;\n\n      return object({\n        enabled: boolean()['default'](true),\n        ui: object({\n          enabled: boolean()['default'](true),\n          container: object({\n            elasticsearch: object({\n              enabled: boolean()['default'](false)\n            })['default'](),\n            logstash: object({\n              enabled: boolean()['default'](false)\n            })['default']()\n          })['default']()\n        })['default'](),\n        chart: object({\n          elasticsearch: object({\n            index: object({\n              index_memory: array().items(string().valid('index_mem_doc_values', 'index_mem_fixed_bit_set', 'index_mem_norms', 'index_mem_points', 'index_mem_stored_fields', 'index_mem_term_vectors', 'index_mem_terms', 'index_mem_versions', 'index_mem_writer', 'index_mem_fielddata', 'index_mem_query_cache', 'index_mem_request_cache')).max(3).unique().single()['default'](['index_mem_terms', 'index_mem_points'])\n            })['default'](),\n            node: object({\n              index_memory: array().items(string().valid('node_index_mem_doc_values', 'node_index_mem_fixed_bit_set', 'node_index_mem_norms', 'node_index_mem_points', 'node_index_mem_stored_fields', 'node_index_mem_term_vectors', 'node_index_mem_terms', 'node_index_mem_versions', 'node_index_mem_writer', 'node_index_mem_fielddata', 'node_index_mem_query_cache', 'node_index_mem_request_cache')).max(3).unique().single()['default'](['node_index_mem_terms', 'node_index_mem_points'])\n            })['default']()\n          })['default']()\n        })['default'](),\n        loggingTag: string()['default']('monitoring-ui'),\n        index: string()['default']('.monitoring-data-2'),\n        kibana: object({\n          index_pattern: string()['default']('.monitoring-kibana-2-*'),\n          collection: object({\n            enabled: boolean()['default'](true),\n            interval: number()['default'](10000)\n          })['default']()\n        })['default'](),\n        logstash: object({\n          index_pattern: string()['default']('.monitoring-logstash-2-*')\n        })['default'](),\n        missing_intervals: number()['default'](12),\n        max_bucket_size: number()['default'](10000),\n        min_interval_seconds: number()['default'](10),\n        show_license_expiration: boolean()['default'](true),\n        report_stats: boolean()['default'](true),\n        node_resolver: string().regex(/^(?:transport_address|name|uuid)$/)['default']('uuid'),\n        stats_report_url: Joi.when('$dev', {\n          is: true,\n          then: string()['default']('../api/monitoring/v1/phone-home'),\n          otherwise: string()['default']('https://marvel-stats.elasticsearch.com/appdata/marvelOpts')\n        }),\n        agent: object({\n          interval: string().regex(/[\\d\\.]+[yMwdhms]/)['default']('10s')\n        })['default'](),\n        elasticsearch: object({\n          customHeaders: object()['default']({}),\n          index_pattern: string()['default']('.monitoring-es-2-*'),\n          logQueries: boolean()['default'](false),\n          requestHeadersWhitelist: array().items().single()['default'](DEFAULT_REQUEST_HEADERS),\n          url: string().uri({ scheme: ['http', 'https'] }), // if empty, use Kibana's connection config\n          username: string(),\n          password: string(),\n          requestTimeout: number()['default'](30000),\n          pingTimeout: number()['default'](30000),\n          ssl: object({\n            verificationMode: string().valid('none', 'certificate', 'full')['default']('full'),\n            certificateAuthorities: array().single().items(string()),\n            certificate: string(),\n            key: string(),\n            keyPassphrase: string()\n          })['default'](),\n          apiVersion: string()['default']('master'),\n          engineVersion: string().valid('^5.0.0')['default']('^5.0.0')\n        })['default']()\n      })['default']();\n    },\n\n    deprecations: function deprecations(_ref) {\n      var rename = _ref.rename;\n\n      return [rename('elasticsearch.ssl.ca', 'elasticsearch.ssl.certificateAuthorities'), rename('elasticsearch.ssl.cert', 'elasticsearch.ssl.certificate'), function (settings, log) {\n        if (!(0, _lodash.has)(settings, 'elasticsearch.ssl.verify')) {\n          return;\n        }\n\n        var verificationMode = (0, _lodash.get)(settings, 'elasticsearch.ssl.verify') ? 'full' : 'none';\n        (0, _lodash.set)(settings, 'elasticsearch.ssl.verificationMode', verificationMode);\n        delete settings.elasticsearch.ssl.verify;\n\n        log('Config key \"elasticsearch.ssl.verify\" is deprecated. It has been replaced with \"elasticsearch.ssl.verificationMode\"');\n      }];\n    },\n\n    init: function init(server, _options) {\n      var _this = this;\n\n      var xpackMainPlugin = server.plugins.xpack_main;\n      return xpackMainPlugin.status.once('green', function () {\n        return _bluebird2['default'].all([(0, _serverLibEs_clientInstantiate_client2['default'])(server, _elasticsearch2['default']), // Instantiate the dedicated ES client. Dependency injection for ES for test mocking\n        (0, _serverLibRequire_all_and_apply2['default'])((0, _path.join)(__dirname, 'server', 'routes', '**', '*.js'), server), // Require all the routes\n        (0, _serverKibana_monitoring2['default'])(_this.kbnServer, server), // send kibana server ops to the monitoring bulk api\n        (0, _serverLibEs_clientHealth_check2['default'])(_this, server).start() // Make sure the Monitoring index is created and ready\n        ]);\n      });\n    }\n  });\n}\n\n;\nmodule.exports = exports['default'];\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvbW9uaXRvcmluZy9pbmRleC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztxQkFTd0IsZUFBZTs7OztzQkFUVCxRQUFROztvQkFDUixNQUFNOzt3QkFDaEIsVUFBVTs7Ozs2QkFDSixlQUFlOzs7OzhDQUNWLHdDQUF3Qzs7Ozs4Q0FDN0MscUNBQXFDOzs7O29EQUNqQywyQ0FBMkM7Ozs7dUNBQ3hDLDRCQUE0Qjs7OztBQUU5QyxTQUFTLGVBQWUsQ0FBQyxNQUFNLEVBQUU7QUFDOUMsU0FBTyxJQUFJLE1BQU0sQ0FBQyxNQUFNLENBQUM7QUFDdkIsV0FBTyxFQUFFLENBQUMsUUFBUSxFQUFFLGVBQWUsRUFBRSxZQUFZLENBQUM7QUFDbEQsTUFBRSxFQUFFLFlBQVk7QUFDaEIsZ0JBQVksRUFBRSxrQkFBa0I7QUFDaEMsYUFBUyxFQUFFLG1CQUFRLFNBQVMsRUFBRSxRQUFRLENBQUM7QUFDdkMsYUFBUyxFQUFFO0FBQ1QsU0FBRyxFQUFFO0FBQ0gsYUFBSyxFQUFFLFlBQVk7QUFDbkIsYUFBSyxFQUFFLElBQUk7QUFDWCxtQkFBVyxFQUFFLDhCQUE4QjtBQUMzQyxZQUFJLEVBQUUsbUNBQW1DO0FBQ3pDLFlBQUksRUFBRSwrQkFBK0I7QUFDckMsa0JBQVUsRUFBQSxvQkFBQyxNQUFNLEVBQUU7QUFDakIsY0FBTSxNQUFNLEdBQUcsTUFBTSxDQUFDLE1BQU0sRUFBRSxDQUFDO0FBQy9CLGlCQUFPO0FBQ0wseUJBQWEsRUFBRSxNQUFNLENBQUMsR0FBRyxDQUFDLGtDQUFrQyxDQUFDO0FBQzdELDhCQUFrQixFQUFFLE1BQU0sQ0FBQyxHQUFHLENBQUMsdUNBQXVDLENBQUM7QUFDdkUsb0JBQVEsRUFBRSxNQUFNLENBQUMsR0FBRyxDQUFDLGNBQWMsQ0FBQztBQUNwQyx3QkFBWSxFQUFFLE1BQU0sQ0FBQyxHQUFHLENBQUMsMEJBQTBCLENBQUM7QUFDcEQsMEJBQWMsRUFBRSxN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ZSxHQUFHLE1BQU0sQ0FBQyxPQUFPLENBQUMsVUFBVSxDQUFDO0FBQ2xELGFBQU8sZUFBZSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLFlBQU07QUFDaEQsZUFBTyxzQkFBUSxHQUFHLENBQUMsQ0FDakIsdURBQWtCLE1BQU0sNkJBQWdCO0FBQ3hDLHlEQUFtQixnQkFBSyxTQUFTLEVBQUUsUUFBUSxFQUFFLFFBQVEsRUFBRSxJQUFJLEVBQUUsTUFBTSxDQUFDLEVBQUUsTUFBTSxDQUFDO0FBQzdFLGtEQUFxQixNQUFLLFNBQVMsRUFBRSxNQUFNLENBQUM7QUFDNUMsZ0VBQW9CLE1BQU0sQ0FBQyxDQUFDLEtBQUssRUFBRTtTQUNwQyxDQUFDLENBQUM7T0FDSixDQUFDLENBQUM7S0FDSjtHQUNGLENBQUMsQ0FBQztDQUNKOztBQUFBLENBQUMiLCJmaWxlIjoiL3Vzci9zaGFyZS9raWJhbmEvcGx1Z2lucy94LXBhY2svcGx1Z2lucy9tb25pdG9yaW5nL2luZGV4LmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZ2V0LCBoYXMsIHNldCB9IGZyb20gJ2xvZGFzaCc7XG5pbXBvcnQgeyBqb2luLCByZXNvbHZlIH0gZnJvbSAncGF0aCc7XG5pbXBvcnQgUHJvbWlzZSBmcm9tICdibHVlYmlyZCc7XG5pbXBvcnQgZWxhc3RpY3NlYXJjaCBmcm9tICdlbGFzdGljc2VhcmNoJztcbmltcG9ydCByZXF1aXJlQWxsQW5kQXBwbHkgZnJvbSAnLi4vLi4vc2VydmVyL2xpYi9yZXF1aXJlX2FsbF9hbmRfYXBwbHknO1xuaW1wb3J0IGVzSGVhbHRoQ2hlY2sgZnJvbSAnLi9zZXJ2ZXIvbGliL2VzX2NsaWVudC9oZWFsdGhfY2hlY2snO1xuaW1wb3J0IGluc3RhbnRpYXRlQ2xpZW50IGZyb20gJy4vc2VydmVyL2xpYi9lc19jbGllbnQvaW5zdGFudGlhdGVfY2xpZW50JztcbmltcG9ydCBpbml0S2liYW5hTW9uaXRvcmluZyBmcm9tICcuL3NlcnZlci9raWJhbmFfbW9uaXRvcmluZyc7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIG1vbml0b3JpbmdJbmRleChraWJhbmEpIHtcbiAgcmV0dXJuIG5ldyBraWJhbmEuUGx1Z2luKHtcbiAgICByZXF1aXJlOiBbJ2tpYmFuYScsICdlbGFzdGljc2VhcmNoJywgJ3hwYWNrX21haW4nXSxcbiAgICBpZDogJ21vbml0b3JpbmcnLFxuICAgIGNvbmZpZ1ByZWZpeDogJ3hwYWNrLm1vbml0b3JpbmcnLFxuICAgIHB1YmxpY0RpcjogcmVzb2x2ZShfX2Rpcm5hbWUsICdwdWJsaWMnKSxcbiAgICB1aUV4cG9ydHM6IHtcbiAgICAgIGFwcDoge1xuICAgICAgICB0aXRsZTogJ01vbml0b3JpbmcnLFxuICAgICAgICBvcmRlcjogOTAwMixcbiAgICAgICAgZGVzY3JpcHRpb246ICdNb25pdG9yaW5nIGZvciBFbGFzdGljc2VhcmNoJyxcbiAgICAgICAgaWNvbjogJ3BsdWdpbnMvbW9uaXRvcmluZy9tb25pdG9yaW5nLnN2ZycsXG4gICAgICAgIG1haW46ICdwbHVnaW5zL21vbml0b3JpbmcvbW9uaXRvcmluZycsXG4gICAgICAgIGluamVjdFZhcnMoc2VydmVyKSB7XG4gICAgICAgICAgY29uc3QgY29uZmlnID0gc2VydmVyLmNvbmZpZygpO1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBtYXhCdWNrZXRTaXplOiBjb25maWcuZ2V0KCd4cGFjay5tb25pdG9yaW5nLm1heF9idWNrZXRfc2l6ZScpLFxuICAgICAgICAgICAgbWluSW50ZXJ2YWxTZWNvbmRzOiBjb25maWcuZ2V0KCd4cGFjay5tb25pdG9yaW5nLm1pbl9pbnRlcnZhbF9zZWNvbmRzJyksXG4gICAgICAgICAgICBrYm5JbmRleDogY29uZmlnLmdldCgna2liYW5hLmluZGV4JyksXG4gICAgICAgICAgICBlc0FwaVZlcnNpb246IGNvbmZpZy5nZXQoJ2VsYXN0aWNzZWFyY2guYXBpVmVyc2lvbicpLFxuICAgICAgICAgICAgZXNTaGFyZFRpbWVvdXQ6IGNvbmZpZy5nZXQoJ2VsYXN0aWNzZWFyY2guc2hhcmRUaW1lb3V0JyksXG4gICAgICAgICAgICBzaG93TGljZW5zZUV4cGlyYXRpb246IGNvbmZpZy5nZXQoJ3hwYWNrLm1vbml0b3Jpbmcuc2hvd19saWNlbnNlX2V4cGlyYXRpb24nKSxcbiAgICAgICAgICAgIHNob3dDZ3JvdXBNZXRyaWNzRWxhc3RpY3NlYXJjaDogY29uZmlnLmdldCgneHBhY2subW9uaXRvcmluZy51aS5jb250YWluZXIuZWxhc3RpY3NlYXJjaC5lbmFibGVkJyksXG4gICAgICAgICAgICBzaG93Q2dyb3VwTWV0cmljc0xvZ3N0YXNoOiBjb25maWcuZ2V0KCd4cGFjay5tb25pdG9yaW5nLnVpLmNvbnRhaW5lci5sb2dzdGFzaC5lbmFibGVkJylcbiAgICAgICAgICB9O1xuICAgICAgICB9LFxuICAgICAgfSxcbiAgICAgIGluamVjdERlZmF1bHRWYXJzKHNlcnZlcikge1xuICAgICAgICBjb25zdCBjb25maWcgPSBzZXJ2ZXIuY29uZmlnKCk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgc3RhdHNSZXBvcnRVcmw6IGNvbmZpZy5nZXQoJ3hwYWNrLm1vbml0b3Jpbmcuc3RhdHNfcmVwb3J0X3VybCcpLFxuICAgICAgICAgIHJlcG9ydFN0YXRzOiBjb25maWcuZ2V0KCd4cGFjay5tb25pdG9yaW5nLnJlcG9ydF9zdGF0cycpLFxuICAgICAgICAgIG1vbml0b3JpbmdVaUVuYWJsZWQ6IGNvbmZpZy5nZXQoJ3hwYWNrLm1vbml0b3JpbmcudWkuZW5hYmxlZCcpXG4gICAgICAgIH07XG4gICAgICB9LFxuICAgICAgaGFja3M6IFtcbiAgICAgICAgJ3BsdWdpbnMvbW9uaXRvcmluZy9oYWNrcy9waG9uZV9ob21lX25vdGlmaWNhdGlvbnMnLFxuICAgICAgICAncGx1Z2lucy9tb25pdG9yaW5nL2hhY2tzL3Bob25lX2hvbWVfdHJpZ2dlcicsXG4gICAgICAgICdwbHVnaW5zL21vbml0b3JpbmcvaGFja3MvdG9nZ2xlX2FwcF9saW5rX2luX25hdidcbiAgICAgIF1cbiAgICB9LFxuXG4gICAgY29uZmlnOiBmdW5jdGlvbiAoSm9pKSB7XG4gICAgICBjb25zdCBERUZBVUxUX1JFUVVFU1RfSEVBREVSUyA9IFsgJ2F1dGhvcml6YXRpb24nIF07XG4gICAgICBjb25zdCB7IGFycmF5LCBib29sZWFuLCBudW1iZXIsIG9iamVjdCwgc3RyaW5nIH0gPSBKb2k7XG5cbiAgICAgIHJldHVybiBvYmplY3Qoe1xuICAgICAgICBlbmFibGVkOiBib29sZWFuKCkuZGVmYXVsdCh0cnVlKSxcbiAgICAgICAgdWk6IG9iamVjdCh7XG4gICAgICAgICAgZW5hYmxlZDogYm9vbGVhbigpLmRlZmF1bHQodHJ1ZSksXG4gICAgICAgICAgY29udGFpbmVyOiBvYmplY3Qoe1xuICAgICAgICAgICAgZWxhc3RpY3NlYXJjaDogb2JqZWN0KHtcbiAgICAgICAgICAgICAgZW5hYmxlZDogYm9vbGVhbigpLmRlZmF1bHQoZmFsc2UpXG4gICAgICAgICAgICB9KS5kZWZhdWx0KCksXG4gICAgICAgICAgICBsb2dzdGFzaDogb2JqZWN0KHtcbiAgICAgICAgICAgICAgZW5hYmxlZDogYm9vbGVhbigpLmRlZmF1bHQoZmFsc2UpXG4gICAgICAgICAgICB9KS5kZWZhdWx0KClcbiAgICAgICAgICB9KS5kZWZhdWx0KClcbiAgICAgICAgfSkuZGVmYXVsdCgpLFxuICAgICAgICBjaGFydDogb2JqZWN0KHtcbiAgICAgICAgICBlbGFzdGljc2VhcmNoOiBvYmplY3Qoe1xuICAgICAgICAgICAgaW5kZXg6IG9iamVjdCh7XG4gICAgICAgICAgICAgIGluZGV4X21lbW9yeTogYXJyYXkoKS5pdGVtcyhzdHJpbmcoKS52YWxpZChcbiAgICAgICAgICAgICAgICAnaW5kZXhfbWVtX2RvY192YWx1ZXMnLFxuICAgICAgICAgICAgICAgICdpbmRleF9tZW1fZml4ZWRfYml0X3NldCcsXG4gICAgICAgICAgICAgICAgJ2luZGV4X21lbV9ub3JtcycsXG4gICAgICAgICAgICAgICAgJ2luZGV4X21lbV9wb2ludHMnLFxuICAgICAgICAgICAgICAgICdpbmRleF9tZW1fc3RvcmVkX2ZpZWxkcycsXG4gICAgICAgICAgICAgICAgJ2luZGV4X21lbV90ZXJtX3ZlY3RvcnMnLFxuICAgICAgICAgICAgICAgICdpbmRleF9tZW1fdGVybXMnLFxuICAgICAgICAgICAgICAgICdpbmRleF9tZW1fdmVyc2lvbnMnLFxuICAgICAgICAgICAgICAgICdpbmRleF9tZW1fd3JpdGVyJyxcbiAgICAgICAgICAgICAgICAnaW5kZXhfbWVtX2ZpZWxkZGF0YScsXG4gICAgICAgICAgICAgICAgJ2luZGV4X21lbV9xdWVyeV9jYWNoZScsXG4gICAgICAgICAgICAgICAgJ2luZGV4X21lbV9yZXF1ZXN0X2NhY2hlJ1xuICAgICAgICAgICAgICApKS5tYXgoMykudW5pcXVlKCkuc2luZ2xlKCkuZGVmYXVsdChbXG4gICAgICAgICAgICAgICAgJ2luZGV4X21lbV90ZXJtcycsXG4gICAgICAgICAgICAgICAgJ2luZGV4X21lbV9wb2ludHMnXG4gICAgICAgICAgICAgIF0pXG4gICAgICAgICAgICB9KS5kZWZhdWx0KCksXG4gICAgICAgICAgICBub2RlOiBvYmplY3Qoe1xuICAgICAgICAgICAgICBpbmRleF9tZW1vcnk6IGFycmF5KCkuaXRlbXMoc3RyaW5nKCkudmFsaWQoXG4gICAgICAgICAgICAgICAgJ25vZGVfaW5kZXhfbWVtX2RvY192YWx1ZXMnLFxuICAgICAgICAgICAgICAgICdub2RlX2luZGV4X21lbV9maXhlZF9iaXRfc2V0JyxcbiAgICAgICAgICAgICAgICAnbm9kZV9pbmRleF9tZW1fbm9ybXMnLFxuICAgICAgICAgICAgICAgICdub2RlX2luZGV4X21lbV9wb2ludHMnLFxuICAgICAgICAgICAgICAgICdub2RlX2luZGV4X21lbV9zdG9yZWRfZmllbGRzJyxcbiAgICAgICAgICAgICAgICAnbm9kZV9pbmRleF9tZW1fdGVybV92ZWN0b3JzJyxcbiAgICAgICAgICAgICAgICAnbm9kZV9pbmRleF9tZW1fdGVybXMnLFxuICAgICAgICAgICAgICAgICdub2RlX2luZGV4X21lbV92ZXJzaW9ucycsXG4gICAgICAgICAgICAgICAgJ25vZGVfaW5kZXhfbWVtX3dyaXRlcicsXG4gICAgICAgICAgICAgICAgJ25vZGVfaW5kZXhfbWVtX2ZpZWxkZGF0YScsXG4gICAgICAgICAgICAgICAgJ25vZGVfaW5kZXhfbWVtX3F1ZXJ5X2NhY2hlJyxcbiAgICAgICAgICAgICAgICAnbm9kZV9pbmRleF9tZW1fcmVxdWVzdF9jYWNoZSdcbiAgICAgICAgICAgICAgKSkubWF4KDMpLnVuaXF1ZSgpLnNpbmdsZSgpLmRlZmF1bHQoW1xuICAgICAgICAgICAgICAgICdub2RlX2luZGV4X21lbV90ZXJtcycsXG4gICAgICAgICAgICAgICAgJ25vZGVfaW5kZXhfbWVtX3BvaW50cydcbiAgICAgICAgICAgICAgXSlcbiAgICAgICAgICAgIH0pLmRlZmF1bHQoKVxuICAgICAgICAgIH0pLmRlZmF1bHQoKVxuICAgICAgICB9KS5kZWZhdWx0KCksXG4gICAgICAgIGxvZ2dpbmdUYWc6IHN0cmluZygpLmRlZmF1bHQoJ21vbml0b3JpbmctdWknKSxcbiAgICAgICAgaW5kZXg6IHN0cmluZygpLmRlZmF1bHQoJy5tb25pdG9yaW5nLWRhdGEtMicpLFxuICAgICAgICBraWJhbmE6IG9iamVjdCh7XG4gICAgICAgICAgaW5kZXhfcGF0dGVybjogc3RyaW5nKCkuZGVmYXVsdCgnLm1vbml0b3Jpbmcta2liYW5hLTItKicpLFxuICAgICAgICAgIGNvbGxlY3Rpb246IG9iamVjdCh7XG4gICAgICAgICAgICBlbmFibGVkOiBib29sZWFuKCkuZGVmYXVsdCh0cnVlKSxcbiAgICAgICAgICAgIGludGVydmFsOiBudW1iZXIoKS5kZWZhdWx0KDEwMDAwKVxuICAgICAgICAgIH0pLmRlZmF1bHQoKVxuICAgICAgICB9KS5kZWZhdWx0KCksXG4gICAgICAgIGxvZ3N0YXNoOiBvYmplY3Qoe1xuICAgICAgICAgIGluZGV4X3BhdHRlcm46IHN0cmluZygpLmRlZmF1bHQoJy5tb25pdG9yaW5nLWxvZ3N0YXNoLTItKicpXG4gICAgICAgIH0pLmRlZmF1bHQoKSxcbiAgICAgICAgbWlzc2luZ19pbnRlcnZhbHM6IG51bWJlcigpLmRlZmF1bHQoMTIpLFxuICAgICAgICBtYXhfYnVja2V0X3NpemU6IG51bWJlcigpLmRlZmF1bHQoMTAwMDApLFxuICAgICAgICBtaW5faW50ZXJ2YWxfc2Vjb25kczogbnVtYmVyKCkuZGVmYXVsdCgxMCksXG4gICAgICAgIHNob3dfbGljZW5zZV9leHBpcmF0aW9uOiBib29sZWFuKCkuZGVmYXVsdCh0cnVlKSxcbiAgICAgICAgcmVwb3J0X3N0YXRzOiBib29sZWFuKCkuZGVmYXVsdCh0cnVlKSxcbiAgICAgICAgbm9kZV9yZXNvbHZlcjogc3RyaW5nKCkucmVnZXgoL14oPzp0cmFuc3BvcnRfYWRkcmVzc3xuYW1lfHV1aWQpJC8pLmRlZmF1bHQoJ3V1aWQnKSxcbiAgICAgICAgc3RhdHNfcmVwb3J0X3VybDogSm9pLndoZW4oJyRkZXYnLCB7XG4gICAgICAgICAgaXM6IHRydWUsXG4gICAgICAgICAgdGhlbjogc3RyaW5nKCkuZGVmYXVsdCgnLi4vYXBpL21vbml0b3JpbmcvdjEvcGhvbmUtaG9tZScpLFxuICAgICAgICAgIG90aGVyd2lzZTogc3RyaW5nKCkuZGVmYXVsdCgnaHR0cHM6Ly9tYXJ2ZWwtc3RhdHMuZWxhc3RpY3NlYXJjaC5jb20vYXBwZGF0YS9tYXJ2ZWxPcHRzJylcbiAgICAgICAgfSksXG4gICAgICAgIGFnZW50OiBvYmplY3Qoe1xuICAgICAgICAgIGludGVydmFsOiBzdHJpbmcoKS5yZWdleCgvW1xcZFxcLl0rW3lNd2RobXNdLykuZGVmYXVsdCgnMTBzJylcbiAgICAgICAgfSkuZGVmYXVsdCgpLFxuICAgICAgICBlbGFzdGljc2VhcmNoOiBvYmplY3Qoe1xuICAgICAgICAgIGN1c3RvbUhlYWRlcnM6IG9iamVjdCgpLmRlZmF1bHQoe30pLFxuICAgICAgICAgIGluZGV4X3BhdHRlcm46IHN0cmluZygpLmRlZmF1bHQoJy5tb25pdG9yaW5nLWVzLTItKicpLFxuICAgICAgICAgIGxvZ1F1ZXJpZXM6IGJvb2xlYW4oKS5kZWZhdWx0KGZhbHNlKSxcbiAgICAgICAgICByZXF1ZXN0SGVhZGVyc1doaXRlbGlzdDogYXJyYXkoKS5pdGVtcygpLnNpbmdsZSgpLmRlZmF1bHQoREVGQVVMVF9SRVFVRVNUX0hFQURFUlMpLFxuICAgICAgICAgIHVybDogc3RyaW5nKCkudXJpKHsgc2NoZW1lOiBbJ2h0dHAnLCAnaHR0cHMnXSB9KSwgLy8gaWYgZW1wdHksIHVzZSBLaWJhbmEncyBjb25uZWN0aW9uIGNvbmZpZ1xuICAgICAgICAgIHVzZXJuYW1lOiBzdHJpbmcoKSxcbiAgICAgICAgICBwYXNzd29yZDogc3RyaW5nKCksXG4gICAgICAgICAgcmVxdWVzdFRpbWVvdXQ6IG51bWJlcigpLmRlZmF1bHQoMzAwMDApLFxuICAgICAgICAgIHBpbmdUaW1lb3V0OiBudW1iZXIoKS5kZWZhdWx0KDMwMDAwKSxcbiAgICAgICAgICBzc2w6IG9iamVjdCh7XG4gICAgICAgICAgICB2ZXJpZmljYXRpb25Nb2RlOiBzdHJpbmcoKS52YWxpZCgnbm9uZScsICdjZXJ0aWZpY2F0ZScsICdmdWxsJykuZGVmYXVsdCgnZnVsbCcpLFxuICAgICAgICAgICAgY2VydGlmaWNhdGVBdXRob3JpdGllczogYXJyYXkoKS5zaW5nbGUoKS5pdGVtcyhzdHJpbmcoKSksXG4gICAgICAgICAgICBjZXJ0aWZpY2F0ZTogc3RyaW5nKCksXG4gICAgICAgICAgICBrZXk6IHN0cmluZygpLFxuICAgICAgICAgICAga2V5UGFzc3BocmFzZTogc3RyaW5nKClcbiAgICAgICAgICB9KS5kZWZhdWx0KCksXG4gICAgICAgICAgYXBpVmVyc2lvbjogc3RyaW5nKCkuZGVmYXVsdCgnbWFzdGVyJyksXG4gICAgICAgICAgZW5naW5lVmVyc2lvbjogc3RyaW5nKCkudmFsaWQoJ141LjAuMCcpLmRlZmF1bHQoJ141LjAuMCcpXG4gICAgICAgIH0pLmRlZmF1bHQoKVxuICAgICAgfSkuZGVmYXVsdCgpO1xuICAgIH0sXG5cbiAgICBkZXByZWNhdGlvbnM6IGZ1bmN0aW9uICh7IHJlbmFtZSB9KSB7XG4gICAgICByZXR1cm4gW1xuICAgICAgICByZW5hbWUoJ2VsYXN0aWNzZWFyY2guc3NsLmNhJywgJ2VsYXN0aWNzZWFyY2guc3NsLmNlcnRpZmljYXRlQXV0aG9yaXRpZXMnKSxcbiAgICAgICAgcmVuYW1lKCdlbGFzdGljc2VhcmNoLnNzbC5jZXJ0JywgJ2VsYXN0aWNzZWFyY2guc3NsLmNlcnRpZmljYXRlJyksXG4gICAgICAgIChzZXR0aW5ncywgbG9nKSA9PiB7XG4gICAgICAgICAgaWYgKCFoYXMoc2V0dGluZ3MsICdlbGFzdGljc2VhcmNoLnNzbC52ZXJpZnknKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGNvbnN0IHZlcmlmaWNhdGlvbk1vZGUgPSBnZXQoc2V0dGluZ3MsICdlbGFzdGljc2VhcmNoLnNzbC52ZXJpZnknKSA/ICdmdWxsJyA6ICdub25lJztcbiAgICAgICAgICBzZXQoc2V0dGluZ3MsICdlbGFzdGljc2VhcmNoLnNzbC52ZXJpZmljYXRpb25Nb2RlJywgdmVyaWZpY2F0aW9uTW9kZSk7XG4gICAgICAgICAgZGVsZXRlIHNldHRpbmdzLmVsYXN0aWNzZWFyY2guc3NsLnZlcmlmeTtcblxuICAgICAgICAgIGxvZyhgQ29uZmlnIGtleSBcImVsYXN0aWNzZWFyY2guc3NsLnZlcmlmeVwiIGlzIGRlcHJlY2F0ZWQuIEl0IGhhcyBiZWVuIHJlcGxhY2VkIHdpdGggXCJlbGFzdGljc2VhcmNoLnNzbC52ZXJpZmljYXRpb25Nb2RlXCJgKTtcbiAgICAgICAgfVxuICAgICAgXTtcbiAgICB9LFxuXG4gICAgaW5pdDogZnVuY3Rpb24gKHNlcnZlciwgX29wdGlvbnMpIHtcbiAgICAgIGNvbnN0IHhwYWNrTWFpblBsdWdpbiA9IHNlcnZlci5wbHVnaW5zLnhwYWNrX21haW47XG4gICAgICByZXR1cm4geHBhY2tNYWluUGx1Z2luLnN0YXR1cy5vbmNlKCdncmVlbicsICgpID0+IHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UuYWxsKFtcbiAgICAgICAgICBpbnN0YW50aWF0ZUNsaWVudChzZXJ2ZXIsIGVsYXN0aWNzZWFyY2gpLCAvLyBJbnN0YW50aWF0ZSB0aGUgZGVkaWNhdGVkIEVTIGNsaWVudC4gRGVwZW5kZW5jeSBpbmplY3Rpb24gZm9yIEVTIGZvciB0ZXN0IG1vY2tpbmdcbiAgICAgICAgICByZXF1aXJlQWxsQW5kQXBwbHkoam9pbihfX2Rpcm5hbWUsICdzZXJ2ZXInLCAncm91dGVzJywgJyoqJywgJyouanMnKSwgc2VydmVyKSwgLy8gUmVxdWlyZSBhbGwgdGhlIHJvdXRlc1xuICAgICAgICAgIGluaXRLaWJhbmFNb25pdG9yaW5nKHRoaXMua2JuU2VydmVyLCBzZXJ2ZXIpLCAvLyBzZW5kIGtpYmFuYSBzZXJ2ZXIgb3BzIHRvIHRoZSBtb25pdG9yaW5nIGJ1bGsgYXBpXG4gICAgICAgICAgZXNIZWFsdGhDaGVjayh0aGlzLCBzZXJ2ZXIpLnN0YXJ0KCkgLy8gTWFrZSBzdXJlIHRoZSBNb25pdG9yaW5nIGluZGV4IGlzIGNyZWF0ZWQgYW5kIHJlYWR5XG4gICAgICAgIF0pO1xuICAgICAgfSk7XG4gICAgfVxuICB9KTtcbn07XG4iXX0=",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/monitoring/index.js"
      ],
      "names": [],
      "mappings": "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",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/monitoring/index.js",
      "sourcesContent": [
        "import { get, has, set } from 'lodash';\nimport { join, resolve } from 'path';\nimport Promise from 'bluebird';\nimport elasticsearch from 'elasticsearch';\nimport requireAllAndApply from '../../server/lib/require_all_and_apply';\nimport esHealthCheck from './server/lib/es_client/health_check';\nimport instantiateClient from './server/lib/es_client/instantiate_client';\nimport initKibanaMonitoring from './server/kibana_monitoring';\n\nexport default function monitoringIndex(kibana) {\n  return new kibana.Plugin({\n    require: ['kibana', 'elasticsearch', 'xpack_main'],\n    id: 'monitoring',\n    configPrefix: 'xpack.monitoring',\n    publicDir: resolve(__dirname, 'public'),\n    uiExports: {\n      app: {\n        title: 'Monitoring',\n        order: 9002,\n        description: 'Monitoring for Elasticsearch',\n        icon: 'plugins/monitoring/monitoring.svg',\n        main: 'plugins/monitoring/monitoring',\n        injectVars(server) {\n          const config = server.config();\n          return {\n            maxBucketSize: config.get('xpack.monitoring.max_bucket_size'),\n            minIntervalSeconds: config.get('xpack.monitoring.min_interval_seconds'),\n            kbnIndex: config.get('kibana.index'),\n            esApiVersion: config.get('elasticsearch.apiVersion'),\n            esShardTimeout: config.get('elasticsearch.shardTimeout'),\n            showLicenseExpiration: config.get('xpack.monitoring.show_license_expiration'),\n            showCgroupMetricsElasticsearch: config.get('xpack.monitoring.ui.container.elasticsearch.enabled'),\n            showCgroupMetricsLogstash: config.get('xpack.monitoring.ui.container.logstash.enabled')\n          };\n        },\n      },\n      injectDefaultVars(server) {\n        const config = server.config();\n        return {\n          statsReportUrl: config.get('xpack.monitoring.stats_report_url'),\n          reportStats: config.get('xpack.monitoring.report_stats'),\n          monitoringUiEnabled: config.get('xpack.monitoring.ui.enabled')\n        };\n      },\n      hacks: [\n        'plugins/monitoring/hacks/phone_home_notifications',\n        'plugins/monitoring/hacks/phone_home_trigger',\n        'plugins/monitoring/hacks/toggle_app_link_in_nav'\n      ]\n    },\n\n    config: function (Joi) {\n      const DEFAULT_REQUEST_HEADERS = [ 'authorization' ];\n      const { array, boolean, number, object, string } = Joi;\n\n      return object({\n        enabled: boolean().default(true),\n        ui: object({\n          enabled: boolean().default(true),\n          container: object({\n            elasticsearch: object({\n              enabled: boolean().default(false)\n            }).default(),\n            logstash: object({\n              enabled: boolean().default(false)\n            }).default()\n          }).default()\n        }).default(),\n        chart: object({\n          elasticsearch: object({\n            index: object({\n              index_memory: array().items(string().valid(\n                'index_mem_doc_values',\n                'index_mem_fixed_bit_set',\n                'index_mem_norms',\n                'index_mem_points',\n                'index_mem_stored_fields',\n                'index_mem_term_vectors',\n                'index_mem_terms',\n                'index_mem_versions',\n                'index_mem_writer',\n                'index_mem_fielddata',\n                'index_mem_query_cache',\n                'index_mem_request_cache'\n              )).max(3).unique().single().default([\n                'index_mem_terms',\n                'index_mem_points'\n              ])\n            }).default(),\n            node: object({\n              index_memory: array().items(string().valid(\n                'node_index_mem_doc_values',\n                'node_index_mem_fixed_bit_set',\n                'node_index_mem_norms',\n                'node_index_mem_points',\n                'node_index_mem_stored_fields',\n                'node_index_mem_term_vectors',\n                'node_index_mem_terms',\n                'node_index_mem_versions',\n                'node_index_mem_writer',\n                'node_index_mem_fielddata',\n                'node_index_mem_query_cache',\n                'node_index_mem_request_cache'\n              )).max(3).unique().single().default([\n                'node_index_mem_terms',\n                'node_index_mem_points'\n              ])\n            }).default()\n          }).default()\n        }).default(),\n        loggingTag: string().default('monitoring-ui'),\n        index: string().default('.monitoring-data-2'),\n        kibana: object({\n          index_pattern: string().default('.monitoring-kibana-2-*'),\n          collection: object({\n            enabled: boolean().default(true),\n            interval: number().default(10000)\n          }).default()\n        }).default(),\n        logstash: object({\n          index_pattern: string().default('.monitoring-logstash-2-*')\n        }).default(),\n        missing_intervals: number().default(12),\n        max_bucket_size: number().default(10000),\n        min_interval_seconds: number().default(10),\n        show_license_expiration: boolean().default(true),\n        report_stats: boolean().default(true),\n        node_resolver: string().regex(/^(?:transport_address|name|uuid)$/).default('uuid'),\n        stats_report_url: Joi.when('$dev', {\n          is: true,\n          then: string().default('../api/monitoring/v1/phone-home'),\n          otherwise: string().default('https://marvel-stats.elasticsearch.com/appdata/marvelOpts')\n        }),\n        agent: object({\n          interval: string().regex(/[\\d\\.]+[yMwdhms]/).default('10s')\n        }).default(),\n        elasticsearch: object({\n          customHeaders: object().default({}),\n          index_pattern: string().default('.monitoring-es-2-*'),\n          logQueries: boolean().default(false),\n          requestHeadersWhitelist: array().items().single().default(DEFAULT_REQUEST_HEADERS),\n          url: string().uri({ scheme: ['http', 'https'] }), // if empty, use Kibana's connection config\n          username: string(),\n          password: string(),\n          requestTimeout: number().default(30000),\n          pingTimeout: number().default(30000),\n          ssl: object({\n            verificationMode: string().valid('none', 'certificate', 'full').default('full'),\n            certificateAuthorities: array().single().items(string()),\n            certificate: string(),\n            key: string(),\n            keyPassphrase: string()\n          }).default(),\n          apiVersion: string().default('master'),\n          engineVersion: string().valid('^5.0.0').default('^5.0.0')\n        }).default()\n      }).default();\n    },\n\n    deprecations: function ({ rename }) {\n      return [\n        rename('elasticsearch.ssl.ca', 'elasticsearch.ssl.certificateAuthorities'),\n        rename('elasticsearch.ssl.cert', 'elasticsearch.ssl.certificate'),\n        (settings, log) => {\n          if (!has(settings, 'elasticsearch.ssl.verify')) {\n            return;\n          }\n\n          const verificationMode = get(settings, 'elasticsearch.ssl.verify') ? 'full' : 'none';\n          set(settings, 'elasticsearch.ssl.verificationMode', verificationMode);\n          delete settings.elasticsearch.ssl.verify;\n\n          log(`Config key \"elasticsearch.ssl.verify\" is deprecated. It has been replaced with \"elasticsearch.ssl.verificationMode\"`);\n        }\n      ];\n    },\n\n    init: function (server, _options) {\n      const xpackMainPlugin = server.plugins.xpack_main;\n      return xpackMainPlugin.status.once('green', () => {\n        return Promise.all([\n          instantiateClient(server, elasticsearch), // Instantiate the dedicated ES client. Dependency injection for ES for test mocking\n          requireAllAndApply(join(__dirname, 'server', 'routes', '**', '*.js'), server), // Require all the routes\n          initKibanaMonitoring(this.kbnServer, server), // send kibana server ops to the monitoring bulk api\n          esHealthCheck(this, server).start() // Make sure the Monitoring index is created and ready\n        ]);\n      });\n    }\n  });\n};\n"
      ]
    },
    "mtime": 1491771506061
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/monitoring/server/lib/es_client/health_check.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "bluebird",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "Promise"
              }
            ]
          },
          {
            "source": "elasticsearch",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "elasticsearch"
              }
            ]
          },
          {
            "source": "./kibana_version",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "kibanaVersion"
              }
            ]
          },
          {
            "source": "./ensure_not_tribe",
            "imported": [
              "ensureNotTribe"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "ensureNotTribe",
                "local": "ensureNotTribe"
              }
            ]
          },
          {
            "source": "./ensure_es_version",
            "imported": [
              "ensureEsVersion"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "ensureEsVersion",
                "local": "ensureEsVersion"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "esHealthCheck",
            "plugin",
            "server"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "esHealthCheck",
              "exported": "default"
            },
            {
              "kind": "local",
              "local": "plugin",
              "exported": "default"
            },
            {
              "kind": "local",
              "local": "server",
              "exported": "default"
            }
          ]
        }
      },
      "usedHelpers": [
        "interop-require-default"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nexports['default'] = esHealthCheck;\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _bluebird = require('bluebird');\n\nvar _bluebird2 = _interopRequireDefault(_bluebird);\n\nvar _elasticsearch = require('elasticsearch');\n\nvar _elasticsearch2 = _interopRequireDefault(_elasticsearch);\n\nvar _kibana_version = require('./kibana_version');\n\nvar _kibana_version2 = _interopRequireDefault(_kibana_version);\n\nvar _ensure_not_tribe = require('./ensure_not_tribe');\n\nvar _ensure_es_version = require('./ensure_es_version');\n\nvar NoConnections = _elasticsearch2['default'].errors.NoConnections;\nvar REQUEST_DELAY = 2500;\nvar NO_INDEX = 'no_index';\nvar INITIALIZING = 'initializing';\nvar READY = 'ready';\n\nfunction esHealthCheck(plugin, server) {\n  var _server$plugins$elasticsearch$getCluster = server.plugins.elasticsearch.getCluster('monitoring');\n\n  var callWithInternalUser = _server$plugins$elasticsearch$getCluster.callWithInternalUser;\n\n  var config = server.config();\n  function getHealth() {\n    return callWithInternalUser('cluster.health', {\n      timeout: '5s',\n      index: config.get('xpack.monitoring.index'),\n      ignore: [408]\n    }).then(function (resp) {\n      // if \"timed_out\" === true then elasticsearch could not\n      // find any idices matching our filter within 5 seconds\n      if (!resp || resp.timed_out) {\n        return NO_INDEX;\n      }\n\n      // \"red\" status means shards are not ready for queries\n      if (resp.status === 'red') {\n        return INITIALIZING;\n      }\n\n      return READY;\n    });\n  }\n\n  function waitForPong() {\n    return callWithInternalUser('ping')['catch'](function (err) {\n      if (!(err instanceof NoConnections)) throw err;\n\n      var elasticsearchUrl = config.get('xpack.monitoring.elasticsearch.url') || config.get('elasticsearch.url');\n      plugin.status.red('Unable to connect to Elasticsearch at ' + elasticsearchUrl + '.');\n      return _bluebird2['default'].delay(REQUEST_DELAY).then(waitForPong);\n    });\n  }\n\n  function waitForShards() {\n    return getHealth().then(function (health) {\n      if (health === NO_INDEX) {\n        // UI will show a \"waiting for data\" screen\n      }\n      if (health === INITIALIZING) {\n        plugin.status.red('Elasticsearch is still initializing the Monitoring indices');\n        return _bluebird2['default'].delay(REQUEST_DELAY).then(waitForShards);\n      }\n      // otherwise we are g2g\n      plugin.status.green('Ready');\n    });\n  }\n\n  var timeoutId = null;\n\n  function check() {\n    return waitForPong().then(function () {\n      // execute version and tribe checks in parallel\n      // but always report the version check result first\n      var versionPromise = (0, _ensure_es_version.ensureEsVersion)(server, _kibana_version2['default'].get());\n      var tribePromise = (0, _ensure_not_tribe.ensureNotTribe)(callWithInternalUser);\n      return versionPromise.then(function () {\n        return tribePromise;\n      });\n    }).then(waitForShards)['catch'](function (err) {\n      return plugin.status.red(err);\n    });\n  }\n\n  function scheduleCheck(ms) {\n    if (timeoutId) return;\n    var myId = setTimeout(function () {\n      check()['finally'](function () {\n        if (timeoutId === myId) startOrRestartChecking();\n      });\n    }, ms);\n    timeoutId = myId;\n  }\n\n  function stopChecking() {\n    if (!timeoutId) return false;\n    clearTimeout(timeoutId);\n    timeoutId = null;\n    return true;\n  }\n\n  function startOrRestartChecking() {\n    scheduleCheck(stopChecking() ? REQUEST_DELAY : 1);\n  }\n\n  return {\n    start: function start() {\n      plugin.status.yellow('Waiting for Monitoring Health Check');\n      startOrRestartChecking();\n    }\n  };\n}\n\n;\nmodule.exports = exports['default'];\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvbW9uaXRvcmluZy9zZXJ2ZXIvbGliL2VzX2NsaWVudC9oZWFsdGhfY2hlY2suanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7cUJBWXdCLGFBQWE7Ozs7d0JBWmpCLFVBQVU7Ozs7NkJBQ0osZUFBZTs7Ozs4QkFDZixrQkFBa0I7Ozs7Z0NBQ2Isb0JBQW9COztpQ0FDbkIscUJBQXFCOztBQUVyRCxJQUFNLGFBQWEsR0FBRywyQkFBYyxNQUFNLENBQUMsYUFBYSxDQUFDO0FBQ3pELElBQU0sYUFBYSxHQUFHLElBQUksQ0FBQztBQUMzQixJQUFNLFFBQVEsR0FBRyxVQUFVLENBQUM7QUFDNUIsSUFBTSxZQUFZLEdBQUcsY0FBYyxDQUFDO0FBQ3BDLElBQU0sS0FBSyxHQUFHLE9BQU8sQ0FBQzs7QUFFUCxTQUFTLGFBQWEsQ0FBQyxNQUFNLEVBQUUsTUFBTSxFQUFFO2lEQUNuQixNQUFNLENBQUMsT0FBTyxDQUFDLGFBQWEsQ0FBQyxVQUFVLENBQUMsWUFBWSxDQUFDOztNQUE5RSxvQkFBb0IsNENBQXBCLG9CQUFvQjs7QUFDNUIsTUFBTSxNQUFNLEdBQUcsTUFBTSxDQUFDLE1BQU0sRUFBRSxDQUFDO0FBQy9CLFdBQVMsU0FBUyxHQUFHO0FBQ25CLFdBQU8sb0JBQW9CLENBQUMsZ0JBQWdCLEVBQUU7QUFDNUMsYUFBTyxFQUFFLElBQUk7QUFDYixXQUFLLEVBQUUsTUFBTSxDQUFDLEdBQUcsQ0FBQyx3QkFBd0IsQ0FBQztBQUMzQyxZQUFNLEVBQUUsQ0FBQyxHQUFHLENBQUM7S0FDZCxDQUFDLENBQ0QsSUFBSSxDQUFDLFVBQUEsSUFBSSxFQUFJOzs7QUFHWixVQUFJLENBQUMsSUFBSSxJQUFJLElBQUksQ0FBQyxTQUFTLEVBQUU7QUFDM0IsZUFBTyxRQUFRLENBQUM7T0FDakI7OztBQUdELFVBQUksSUFBSSxDQUFDLE1BQU0sS0FBSyxLQUFLLEVBQUU7QUFDekIsZUFBTyxZ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bHVnaW5zL3gtcGFjay9wbHVnaW5zL21vbml0b3Jpbmcvc2VydmVyL2xpYi9lc19jbGllbnQvaGVhbHRoX2NoZWNrLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFByb21pc2UgZnJvbSAnYmx1ZWJpcmQnO1xuaW1wb3J0IGVsYXN0aWNzZWFyY2ggZnJvbSAnZWxhc3RpY3NlYXJjaCc7XG5pbXBvcnQga2liYW5hVmVyc2lvbiBmcm9tICcuL2tpYmFuYV92ZXJzaW9uJztcbmltcG9ydCB7IGVuc3VyZU5vdFRyaWJlIH0gZnJvbSAnLi9lbnN1cmVfbm90X3RyaWJlJztcbmltcG9ydCB7IGVuc3VyZUVzVmVyc2lvbiB9IGZyb20gJy4vZW5zdXJlX2VzX3ZlcnNpb24nO1xuXG5jb25zdCBOb0Nvbm5lY3Rpb25zID0gZWxhc3RpY3NlYXJjaC5lcnJvcnMuTm9Db25uZWN0aW9ucztcbmNvbnN0IFJFUVVFU1RfREVMQVkgPSAyNTAwO1xuY29uc3QgTk9fSU5ERVggPSAnbm9faW5kZXgnO1xuY29uc3QgSU5JVElBTElaSU5HID0gJ2luaXRpYWxpemluZyc7XG5jb25zdCBSRUFEWSA9ICdyZWFkeSc7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGVzSGVhbHRoQ2hlY2socGx1Z2luLCBzZXJ2ZXIpIHtcbiAgY29uc3QgeyBjYWxsV2l0aEludGVybmFsVXNlciB9ID0gc2VydmVyLnBsdWdpbnMuZWxhc3RpY3NlYXJjaC5nZXRDbHVzdGVyKCdtb25pdG9yaW5nJyk7XG4gIGNvbnN0IGNvbmZpZyA9IHNlcnZlci5jb25maWcoKTtcbiAgZnVuY3Rpb24gZ2V0SGVhbHRoKCkge1xuICAgIHJldHVybiBjYWxsV2l0aEludGVybmFsVXNlcignY2x1c3Rlci5oZWFsdGgnLCB7XG4gICAgICB0aW1lb3V0OiAnNXMnLFxuICAgICAgaW5kZXg6IGNvbmZpZy5nZXQoJ3hwYWNrLm1vbml0b3JpbmcuaW5kZXgnKSxcbiAgICAgIGlnbm9yZTogWzQwOF1cbiAgICB9KVxuICAgIC50aGVuKHJlc3AgPT4ge1xuICAgICAgLy8gaWYgXCJ0aW1lZF9vdXRcIiA9PT0gdHJ1ZSB0aGVuIGVsYXN0aWNzZWFyY2ggY291bGQgbm90XG4gICAgICAvLyBmaW5kIGFueSBpZGljZXMgbWF0Y2hpbmcgb3VyIGZpbHRlciB3aXRoaW4gNSBzZWNvbmRzXG4gICAgICBpZiAoIXJlc3AgfHwgcmVzcC50aW1lZF9vdXQpIHtcbiAgICAgICAgcmV0dXJuIE5PX0lOREVYO1xuICAgICAgfVxuXG4gICAgICAvLyBcInJlZFwiIHN0YXR1cyBtZWFucyBzaGFyZHMgYXJlIG5vdCByZWFkeSBmb3IgcXVlcmllc1xuICAgICAgaWYgKHJlc3Auc3RhdHVzID09PSAncmVkJykge1xuICAgICAgICByZXR1cm4gSU5JVElBTElaSU5HO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gUkVBRFk7XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiB3YWl0Rm9yUG9uZygpIHtcbiAgICByZXR1cm4gY2FsbFdpdGhJbnRlcm5hbFVzZXIoJ3BpbmcnKVxuICAgIC5jYXRjaChlcnIgPT4ge1xuICAgICAgaWYgKCEoZXJyIGluc3RhbmNlb2YgTm9Db25uZWN0aW9ucykpIHRocm93IGVycjtcblxuICAgICAgY29uc3QgZWxhc3RpY3NlYXJjaFVybCA9IGNvbmZpZy5nZXQoJ3hwYWNrLm1vbml0b3JpbmcuZWxhc3RpY3NlYXJjaC51cmwnKSB8fCBjb25maWcuZ2V0KCdlbGFzdGljc2VhcmNoLnVybCcpO1xuICAgICAgcGx1Z2luLnN0YXR1cy5yZWQoYFVuYWJsZSB0byBjb25uZWN0IHRvIEVsYXN0aWNzZWFyY2ggYXQgJHtlbGFzdGljc2VhcmNoVXJsfS5gKTtcbiAgICAgIHJldHVybiBQcm9taXNlLmRlbGF5KFJFUVVFU1RfREVMQVkpLnRoZW4od2FpdEZvclBvbmcpO1xuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gd2FpdEZvclNoYXJkcygpIHtcbiAgICByZXR1cm4gZ2V0SGVhbHRoKClcbiAgICAudGhlbihoZWFsdGggPT4ge1xuICAgICAgaWYgKGhlYWx0aCA9PT0gTk9fSU5ERVgpIHtcbiAgICAgICAgLy8gVUkgd2lsbCBzaG93IGEgXCJ3YWl0aW5nIGZvciBkYXRhXCIgc2NyZWVuXG4gICAgICB9XG4gICAgICBpZiAoaGVhbHRoID09PSBJTklUSUFMSVpJTkcpIHtcbiAgICAgICAgcGx1Z2luLnN0YXR1cy5yZWQoJ0VsYXN0aWNzZWFyY2ggaXMgc3RpbGwgaW5pdGlhbGl6aW5nIHRoZSBNb25pdG9yaW5nIGluZGljZXMnKTtcbiAgICAgICAgcmV0dXJuIFByb21pc2UuZGVsYXkoUkVRVUVTVF9ERUxBWSlcbiAgICAgICAgLnRoZW4od2FpdEZvclNoYXJkcyk7XG4gICAgICB9XG4gICAgICAvLyBvdGhlcndpc2Ugd2UgYXJlIGcyZ1xuICAgICAgcGx1Z2luLnN0YXR1cy5ncmVlbignUmVhZHknKTtcbiAgICB9KTtcbiAgfVxuXG4gIGxldCB0aW1lb3V0SWQgPSBudWxsO1xuXG4gIGZ1bmN0aW9uIGNoZWNrKCkge1xuICAgIHJldHVybiB3YWl0Rm9yUG9uZygpXG4gICAgLnRoZW4oKCkgPT4ge1xuICAgICAgLy8gZXhlY3V0ZSB2ZXJzaW9uIGFuZCB0cmliZSBjaGVja3MgaW4gcGFyYWxsZWxcbiAgICAgIC8vIGJ1dCBhbHdheXMgcmVwb3J0IHRoZSB2ZXJzaW9uIGNoZWNrIHJlc3VsdCBmaXJzdFxuICAgICAgY29uc3QgdmVyc2lvblByb21pc2UgPSBlbnN1cmVFc1ZlcnNpb24oc2VydmVyLCBraWJhbmFWZXJzaW9uLmdldCgpKTtcbiAgICAgIGNvbnN0IHRyaWJlUHJvbWlzZSA9IGVuc3VyZU5vdFRyaWJlKGNhbGxXaXRoSW50ZXJuYWxVc2VyKTtcbiAgICAgIHJldHVybiB2ZXJzaW9uUHJvbWlzZS50aGVuKCgpID0+IHRyaWJlUHJvbWlzZSk7XG4gICAgfSlcbiAgICAudGhlbih3YWl0Rm9yU2hhcmRzKVxuICAgIC5jYXRjaChlcnIgPT4gcGx1Z2luLnN0YXR1cy5yZWQoZXJyKSk7XG4gIH1cblxuICBmdW5jdGlvbiBzY2hlZHVsZUNoZWNrKG1zKSB7XG4gICAgaWYgKHRpbWVvdXRJZCkgcmV0dXJuO1xuICAgIGNvbnN0IG15SWQgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIGNoZWNrKCkuZmluYWxseSgoKSA9PiB7XG4gICAgICAgIGlmICh0aW1lb3V0SWQgPT09IG15SWQpIHN0YXJ0T3JSZXN0YXJ0Q2hlY2tpbmcoKTtcbiAgICAgIH0pO1xuICAgIH0sIG1zKTtcbiAgICB0aW1lb3V0SWQgPSBteUlkO1xuICB9XG5cbiAgZnVuY3Rpb24gc3RvcENoZWNraW5nKCkge1xuICAgIGlmICghdGltZW91dElkKSByZXR1cm4gZmFsc2U7XG4gICAgY2xlYXJUaW1lb3V0KHRpbWVvdXRJZCk7XG4gICAgdGltZW91dElkID0gbnVsbDtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHN0YXJ0T3JSZXN0YXJ0Q2hlY2tpbmcoKSB7XG4gICAgc2NoZWR1bGVDaGVjayhzdG9wQ2hlY2tpbmcoKSA/IFJFUVVFU1RfREVMQVkgOiAxKTtcbiAgfVxuXG5cbiAgcmV0dXJuIHtcbiAgICBzdGFydCgpIHtcbiAgICAgIHBsdWdpbi5zdGF0dXMueWVsbG93KCdXYWl0aW5nIGZvciBNb25pdG9yaW5nIEhlYWx0aCBDaGVjaycpO1xuICAgICAgc3RhcnRPclJlc3RhcnRDaGVja2luZygpO1xuICAgIH1cbiAgfTtcbn07XG4iXX0=",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/monitoring/server/lib/es_client/health_check.js"
      ],
      "names": [],
      "mappings": "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",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/monitoring/server/lib/es_client/health_check.js",
      "sourcesContent": [
        "import Promise from 'bluebird';\nimport elasticsearch from 'elasticsearch';\nimport kibanaVersion from './kibana_version';\nimport { ensureNotTribe } from './ensure_not_tribe';\nimport { ensureEsVersion } from './ensure_es_version';\n\nconst NoConnections = elasticsearch.errors.NoConnections;\nconst REQUEST_DELAY = 2500;\nconst NO_INDEX = 'no_index';\nconst INITIALIZING = 'initializing';\nconst READY = 'ready';\n\nexport default function esHealthCheck(plugin, server) {\n  const { callWithInternalUser } = server.plugins.elasticsearch.getCluster('monitoring');\n  const config = server.config();\n  function getHealth() {\n    return callWithInternalUser('cluster.health', {\n      timeout: '5s',\n      index: config.get('xpack.monitoring.index'),\n      ignore: [408]\n    })\n    .then(resp => {\n      // if \"timed_out\" === true then elasticsearch could not\n      // find any idices matching our filter within 5 seconds\n      if (!resp || resp.timed_out) {\n        return NO_INDEX;\n      }\n\n      // \"red\" status means shards are not ready for queries\n      if (resp.status === 'red') {\n        return INITIALIZING;\n      }\n\n      return READY;\n    });\n  }\n\n  function waitForPong() {\n    return callWithInternalUser('ping')\n    .catch(err => {\n      if (!(err instanceof NoConnections)) throw err;\n\n      const elasticsearchUrl = config.get('xpack.monitoring.elasticsearch.url') || config.get('elasticsearch.url');\n      plugin.status.red(`Unable to connect to Elasticsearch at ${elasticsearchUrl}.`);\n      return Promise.delay(REQUEST_DELAY).then(waitForPong);\n    });\n  }\n\n  function waitForShards() {\n    return getHealth()\n    .then(health => {\n      if (health === NO_INDEX) {\n        // UI will show a \"waiting for data\" screen\n      }\n      if (health === INITIALIZING) {\n        plugin.status.red('Elasticsearch is still initializing the Monitoring indices');\n        return Promise.delay(REQUEST_DELAY)\n        .then(waitForShards);\n      }\n      // otherwise we are g2g\n      plugin.status.green('Ready');\n    });\n  }\n\n  let timeoutId = null;\n\n  function check() {\n    return waitForPong()\n    .then(() => {\n      // execute version and tribe checks in parallel\n      // but always report the version check result first\n      const versionPromise = ensureEsVersion(server, kibanaVersion.get());\n      const tribePromise = ensureNotTribe(callWithInternalUser);\n      return versionPromise.then(() => tribePromise);\n    })\n    .then(waitForShards)\n    .catch(err => plugin.status.red(err));\n  }\n\n  function scheduleCheck(ms) {\n    if (timeoutId) return;\n    const myId = setTimeout(() => {\n      check().finally(() => {\n        if (timeoutId === myId) startOrRestartChecking();\n      });\n    }, ms);\n    timeoutId = myId;\n  }\n\n  function stopChecking() {\n    if (!timeoutId) return false;\n    clearTimeout(timeoutId);\n    timeoutId = null;\n    return true;\n  }\n\n  function startOrRestartChecking() {\n    scheduleCheck(stopChecking() ? REQUEST_DELAY : 1);\n  }\n\n\n  return {\n    start() {\n      plugin.status.yellow('Waiting for Monitoring Health Check');\n      startOrRestartChecking();\n    }\n  };\n};\n"
      ]
    },
    "mtime": 1491771513552
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/monitoring/server/lib/es_client/kibana_version.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "../../../../../package.json",
            "imported": [
              "version"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "version",
                "local": "kibanaVersion"
              }
            ]
          }
        ],
        "exports": {
          "exported": [],
          "specifiers": []
        }
      },
      "usedHelpers": []
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nvar _packageJson = require('../../../../../package.json');\n\nexports['default'] = {\n  // Make the version stubbable to improve testability.\n  get: function get() {\n    return _packageJson.version;\n  }\n};\nmodule.exports = exports['default'];\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvbW9uaXRvcmluZy9zZXJ2ZXIvbGliL2VzX2NsaWVudC9raWJhbmFfdmVyc2lvbi5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7MkJBRU8sNkJBQTZCOztxQkFFckI7O0FBRWIsS0FBRyxFQUFBLGVBQUc7QUFDSixnQ0FBcUI7R0FDdEI7Q0FDRiIsImZpbGUiOiIvdXNyL3NoYXJlL2tpYmFuYS9wbHVnaW5zL3gtcGFjay9wbHVnaW5zL21vbml0b3Jpbmcvc2VydmVyL2xpYi9lc19jbGllbnQva2liYW5hX3ZlcnNpb24uanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICB2ZXJzaW9uIGFzIGtpYmFuYVZlcnNpb24sXG59IGZyb20gJy4uLy4uLy4uLy4uLy4uL3BhY2thZ2UuanNvbic7XG5cbmV4cG9ydCBkZWZhdWx0IHtcbiAgLy8gTWFrZSB0aGUgdmVyc2lvbiBzdHViYmFibGUgdG8gaW1wcm92ZSB0ZXN0YWJpbGl0eS5cbiAgZ2V0KCkge1xuICAgIHJldHVybiBraWJhbmFWZXJzaW9uO1xuICB9LFxufTtcbiJdfQ==",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/monitoring/server/lib/es_client/kibana_version.js"
      ],
      "names": [],
      "mappings": ";;;;;;2BAEO,6BAA6B;;qBAErB;;AAEb,KAAG,EAAA,eAAG;AACJ,gCAAqB;GACtB;CACF",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/monitoring/server/lib/es_client/kibana_version.js",
      "sourcesContent": [
        "import {\n  version as kibanaVersion,\n} from '../../../../../package.json';\n\nexport default {\n  // Make the version stubbable to improve testability.\n  get() {\n    return kibanaVersion;\n  },\n};\n"
      ]
    },
    "mtime": 1491771513552
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/monitoring/server/lib/es_client/ensure_not_tribe.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "lodash",
            "imported": [
              "get"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "get",
                "local": "get"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "ensureNotTribe",
            "callWithInternalUser"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "ensureNotTribe",
              "exported": "ensureNotTribe"
            },
            {
              "kind": "local",
              "local": "callWithInternalUser",
              "exported": "callWithInternalUser"
            }
          ]
        }
      },
      "usedHelpers": []
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nexports.ensureNotTribe = ensureNotTribe;\n\nvar _lodash = require('lodash');\n\nfunction ensureNotTribe(callWithInternalUser) {\n  return callWithInternalUser('nodes.info', {\n    nodeId: '_local',\n    filterPath: 'nodes.*.settings.tribe'\n  }).then(function (info) {\n    var nodeId = Object.keys(info.nodes || {})[0];\n    var tribeSettings = (0, _lodash.get)(info, ['nodes', nodeId, 'settings', 'tribe']);\n\n    if (tribeSettings) {\n      throw new Error('Monitoring does not support using tribe nodes as the primary elasticsearch connection.');\n    }\n\n    return true;\n  });\n}\n\n;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvbW9uaXRvcmluZy9zZXJ2ZXIvbGliL2VzX2NsaWVudC9lbnN1cmVfbm90X3RyaWJlLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7c0JBQW9CLFFBQVE7O0FBRXJCLFNBQVMsY0FBYyxDQUFDLG9CQUFvQixFQUFFO0FBQ25ELFNBQU8sb0JBQW9CLENBQUMsWUFBWSxFQUFFO0FBQ3hDLFVBQU0sRUFBRSxRQUFRO0FBQ2hCLGNBQVUsRUFBRSx3QkFBd0I7R0FDckMsQ0FBQyxDQUNELElBQUksQ0FBQyxVQUFVLElBQUksRUFBRTtBQUNwQixRQUFNLE1BQU0sR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDaEQsUUFBTSxhQUFhLEdBQUcsaUJBQUksSUFBSSxFQUFFLENBQUMsT0FBTyxFQUFFLE1BQU0sRUFBRSxVQUFVLEVBQUUsT0FBTyxDQUFDLENBQUMsQ0FBQzs7QUFFeEUsUUFBSSxhQUFhLEVBQUU7QUFDakIsWUFBTSxJQUFJLEtBQUssQ0FBQyx3RkFBd0YsQ0FBQyxDQUFDO0tBQzNHOztBQUVELFdBQU8sSUFBSSxDQUFDO0dBQ2IsQ0FBQyxDQUFDO0NBQ0o7O0FBQUEsQ0FBQyIsImZpbGUiOiIvdXNyL3NoYXJlL2tpYmFuYS9wbHVnaW5zL3gtcGFjay9wbHVnaW5zL21vbml0b3Jpbmcvc2VydmVyL2xpYi9lc19jbGllbnQvZW5zdXJlX25vdF90cmliZS5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGdldCB9IGZyb20gJ2xvZGFzaCc7XG5cbmV4cG9ydCBmdW5jdGlvbiBlbnN1cmVOb3RUcmliZShjYWxsV2l0aEludGVybmFsVXNlcikge1xuICByZXR1cm4gY2FsbFdpdGhJbnRlcm5hbFVzZXIoJ25vZGVzLmluZm8nLCB7XG4gICAgbm9kZUlkOiAnX2xvY2FsJyxcbiAgICBmaWx0ZXJQYXRoOiAnbm9kZXMuKi5zZXR0aW5ncy50cmliZSdcbiAgfSlcbiAgLnRoZW4oZnVuY3Rpb24gKGluZm8pIHtcbiAgICBjb25zdCBub2RlSWQgPSBPYmplY3Qua2V5cyhpbmZvLm5vZGVzIHx8IHt9KVswXTtcbiAgICBjb25zdCB0cmliZVNldHRpbmdzID0gZ2V0KGluZm8sIFsnbm9kZXMnLCBub2RlSWQsICdzZXR0aW5ncycsICd0cmliZSddKTtcblxuICAgIGlmICh0cmliZVNldHRpbmdzKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01vbml0b3JpbmcgZG9lcyBub3Qgc3VwcG9ydCB1c2luZyB0cmliZSBub2RlcyBhcyB0aGUgcHJpbWFyeSBlbGFzdGljc2VhcmNoIGNvbm5lY3Rpb24uJyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRydWU7XG4gIH0pO1xufTtcbiJdfQ==",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/monitoring/server/lib/es_client/ensure_not_tribe.js"
      ],
      "names": [],
      "mappings": ";;;;;;;sBAAoB,QAAQ;;AAErB,SAAS,cAAc,CAAC,oBAAoB,EAAE;AACnD,SAAO,oBAAoB,CAAC,YAAY,EAAE;AACxC,UAAM,EAAE,QAAQ;AAChB,cAAU,EAAE,wBAAwB;GACrC,CAAC,CACD,IAAI,CAAC,UAAU,IAAI,EAAE;AACpB,QAAM,MAAM,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,IAAI,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;AAChD,QAAM,aAAa,GAAG,iBAAI,IAAI,EAAE,CAAC,OAAO,EAAE,MAAM,EAAE,UAAU,EAAE,OAAO,CAAC,CAAC,CAAC;;AAExE,QAAI,aAAa,EAAE;AACjB,YAAM,IAAI,KAAK,CAAC,wFAAwF,CAAC,CAAC;KAC3G;;AAED,WAAO,IAAI,CAAC;GACb,CAAC,CAAC;CACJ;;AAAA,CAAC",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/monitoring/server/lib/es_client/ensure_not_tribe.js",
      "sourcesContent": [
        "import { get } from 'lodash';\n\nexport function ensureNotTribe(callWithInternalUser) {\n  return callWithInternalUser('nodes.info', {\n    nodeId: '_local',\n    filterPath: 'nodes.*.settings.tribe'\n  })\n  .then(function (info) {\n    const nodeId = Object.keys(info.nodes || {})[0];\n    const tribeSettings = get(info, ['nodes', nodeId, 'settings', 'tribe']);\n\n    if (tribeSettings) {\n      throw new Error('Monitoring does not support using tribe nodes as the primary elasticsearch connection.');\n    }\n\n    return true;\n  });\n};\n"
      ]
    },
    "mtime": 1491771513552
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/monitoring/server/lib/es_client/ensure_es_version.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "lodash",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "_"
              }
            ]
          },
          {
            "source": "./is_es_compatible_with_kibana",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "isEsCompatibleWithKibana"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "ensureEsVersion",
            "server",
            "kibanaVersion"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "ensureEsVersion",
              "exported": "ensureEsVersion"
            },
            {
              "kind": "local",
              "local": "server",
              "exported": "server"
            },
            {
              "kind": "local",
              "local": "kibanaVersion",
              "exported": "kibanaVersion"
            }
          ]
        }
      },
      "usedHelpers": [
        "interop-require-default"
      ]
    },
    "ignored": false,
    "code": "/**\n * ES and Kibana versions are locked, so Kibana should require that ES has the same version as\n * that defined in Kibana's package.json.\n */\n\n'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nexports.ensureEsVersion = ensureEsVersion;\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _lodash = require('lodash');\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _is_es_compatible_with_kibana = require('./is_es_compatible_with_kibana');\n\nvar _is_es_compatible_with_kibana2 = _interopRequireDefault(_is_es_compatible_with_kibana);\n\n/**\n *  tracks the node descriptions that get logged in warnings so\n *  that we don't spam the log with the same message over and over.\n *\n *  There are situations, like in testing or multi-tenancy, where\n *  the server argument changes, so we must track the previous\n *  node warnings per server\n */\nvar lastWarnedNodesForServer = new WeakMap();\n\nfunction ensureEsVersion(server, kibanaVersion) {\n  server.log(['plugin', 'debug'], 'Checking Elasticsearch version');\n\n  var _server$plugins$elasticsearch$getCluster = server.plugins.elasticsearch.getCluster('monitoring');\n\n  var callWithInternalUser = _server$plugins$elasticsearch$getCluster.callWithInternalUser;\n\n  return callWithInternalUser('nodes.info', {\n    filterPath: ['nodes.*.version', 'nodes.*.http.publish_address', 'nodes.*.ip']\n  }).then(function (info) {\n    // Aggregate incompatible ES nodes.\n    var incompatibleNodes = [];\n\n    // Aggregate ES nodes which should prompt a Kibana upgrade.\n    var warningNodes = [];\n\n    _lodash2['default'].forEach(info.nodes, function (esNode) {\n      if (!(0, _is_es_compatible_with_kibana2['default'])(esNode.version, kibanaVersion)) {\n        // Exit early to avoid collecting ES nodes with newer major versions in the `warningNodes`.\n        return incompatibleNodes.push(esNode);\n      }\n\n      // It's acceptable if ES and Kibana versions are not the same so long as\n      // they are not incompatible, but we should warn about it\n      if (esNode.version !== kibanaVersion) {\n        warningNodes.push(esNode);\n      }\n    });\n\n    function getPublishAddress(node) {\n      return _lodash2['default'].get(node, 'http.publish_address');\n    }\n\n    function getHumanizedNodeNames(nodes) {\n      return nodes.map(function (node) {\n        var publishAddressRaw = getPublishAddress(node);\n        var publishAddress = publishAddressRaw ? publishAddressRaw + ' ' : '';\n        return 'v' + node.version + ' @ ' + publishAddress + '(' + node.ip + ')';\n      });\n    }\n\n    if (warningNodes.length) {\n      var simplifiedNodes = warningNodes.map(function (node) {\n        return {\n          version: node.version,\n          http: {\n            publish_address: getPublishAddress(node)\n          },\n          ip: node.ip\n        };\n      });\n\n      // Don't show the same warning over and over again.\n      var warningNodeNames = getHumanizedNodeNames(simplifiedNodes).join(', ');\n      if (lastWarnedNodesForServer.get(server) !== warningNodeNames) {\n        lastWarnedNodesForServer.set(server, warningNodeNames);\n        server.log(['warning'], {\n          tmpl: 'You\\'re running Kibana ' + kibanaVersion + ' with some different versions of ' + 'Elasticsearch on a monitoring cluster. Update Kibana and Elasticsearch to the same version to prevent compatibility issues: ' + warningNodeNames,\n          kibanaVersion: kibanaVersion,\n          nodes: simplifiedNodes\n        });\n      }\n    }\n\n    if (incompatibleNodes.length) {\n      var incompatibleNodeNames = getHumanizedNodeNames(incompatibleNodes);\n      throw new Error('This version of Kibana requires Elasticsearch v' + (kibanaVersion + ' on all nodes of the monitoring cluster. I found ') + ('the following incompatible nodes in your cluster: ' + incompatibleNodeNames.join(', ')));\n    }\n\n    return true;\n  });\n}\n\n;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvbW9uaXRvcmluZy9zZXJ2ZXIvbGliL2VzX2NsaWVudC9lbnN1cmVfZXNfdmVyc2lvbi5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztzQkFLYyxRQUFROzs7OzRDQUNlLGdDQUFnQzs7Ozs7Ozs7Ozs7O0FBVXJFLElBQU0sd0JBQXdCLEdBQUcsSUFBSSxPQUFPLEVBQUUsQ0FBQzs7QUFFeEMsU0FBUyxlQUFlLENBQUMsTUFBTSxFQUFFLGFBQWEsRUFBRTtBQUNyRCxRQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsUUFBUSxFQUFFLE9BQU8sQ0FBQyxFQUFFLGdDQUFnQyxDQUFDLENBQUM7O2lEQUVqQyxNQUFNLENBQUMsT0FBTyxDQUFDLGFBQWEsQ0FBQyxVQUFVLENBQUMsWUFBWSxDQUFDOztNQUE5RSxvQkFBb0IsNENBQXBCLG9CQUFvQjs7QUFFNUIsU0FBTyxvQkFBb0IsQ0FBQyxZQUFZLEVBQUU7QUFDeEMsY0FBVSxFQUFFLENBQ1YsaUJBQWlCLEVBQ2pCLDhCQUE4QixFQUM5QixZQUFZLENBQ2I7R0FDRixDQUFDLENBQ0QsSUFBSSxDQUFDLFVBQVUsSUFBSSxFQUFFOztBQUVwQixRQUFNLGlCQUFpQixHQUFHLEVBQUUsQ0FBQzs7O0FBRzdCLFFBQU0sWUFBWSxHQUFHLEVBQUUsQ0FBQzs7QUFFeEIsd0JBQUUsT0FBTyxDQUFDLElBQUksQ0FBQyxLQUFLLEVBQUUsVUFBQSxNQUFNLEVBQUk7QUFDOUIsVUFBSSxDQUFDLCtDQUF5QixNQUFNLENBQUMsT0FBTyxFQUFFLGFBQWEsQ0FBQyxFQUFFOztBQUU1RCxlQUFPLGlCQUFpQixDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQztPQUN2Qzs7OztBQUlELFVBQUksTUFBTSxDQUFDLE9BQU8sS0FBSyxhQUFhLEVBQUU7QUFDcEMsb0JBQVksQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7T0FDM0I7S0FDRixDQUFDLENBQUM7O0FBRUgsYUFBUyxpQkFBaUIsQ0FBQyxJQUFJLEVBQUU7QUFDL0IsYUFBTyxvQkFBRSxHQUFHLENBQUMsSUFBSSxFQUFFLHNCQUFzQixDQUFDLENBQUM7S0FDNUM7O0FBRUQsYUFBUyxxQkFBcUIsQ0FBQyxLQUFLLEVBQUU7QUFDcEMsYUFBTyxLQUFLLENBQUMsR0FBRyxDQUFDLFVBQUEsSUFBSSxFQUFJO0FBQ3ZCLFlBQU0saUJBQWlCLEdBQUcsaUJBQWlCLENBQUMsSUFBSSxDQUFDLENBQUM7QUFDbEQsWUFBTSxjQUFjLEdBQUksaUJBQWlCLEdBQUcsaUJBQWlCLEdBQUcsR0FBRyxHQUFHLEVBQUUsQ0FBQztBQUN6RSxxQkFBVyxJQUFJLENBQUMsT0FBTyxXQUFNLGNBQWMsU0FBSSxJQUFJLENBQUMsRUFBRSxPQUFJO09BQzNELENBQUMsQ0FBQztLQUNKOztBQUVELFFBQUksWUFBWSxDQUFDLE1BQU0sRUFBRTtBQUN2QixVQUFNLGVBQWUsR0FBRyxZQUFZLENBQUMsR0FBRyxDQUFDLFVBQUEsSUFBSTtlQUFLO0FBQ2hELGlCQUFPLEVBQUUsSUFBSSxDQUFDLE9BQU87QUFDckIsY0FBSSxFQUFFO0FBQ0osMkJBQWUsRUFBRSxpQkFBaUIsQ0FBQyxJQUFJLENBQUM7V0FDekM7QUFDRCxZQUFFLEVBQUUsSUFBSSxDQUFDLEVBQUU7U0FDWjtPQUFDLENBQUMsQ0FBQzs7O0FBR0osVUFBTSxnQkFBZ0IsR0FBRyxxQkFBcUIsQ0FBQyxlQUFlLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7QUFDM0UsVUFBSSx3QkFBd0IsQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLEtBQUssZ0JBQWdCLEVBQUU7QUFDN0QsZ0NBQXdCLENBQUMsR0FBRyxDQUFDLE1BQU0sRUFBRSxnQkFBZ0IsQ0FBQyxDQUFDO0FBQ3ZELGNBQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxTQUFTLENBQUMsRUFBRTtBQUN0QixjQUFJLEVBQ0YsNEJBQXlCLGFBQWEseUNBQ3RDLDhIQUE4SCxHQUM5SCxnQkFBZ0IsQUFDakI7QUFDRCx1QkFBYSxFQUFiLGFBQWE7QUFDYixlQUFLLEVBQUUsZUFBZTtTQUN2QixDQUFDLENBQUM7T0FDSjtLQUNGOztBQUVELFFBQUksaUJBQWlCLENBQUMsTUFBTSxFQUFFO0FBQzVCLFVBQU0scUJBQXFCLEdBQUcscUJBQXFCLENBQUMsaUJBQWlCLENBQUMsQ0FBQztBQUN2RSxZQUFNLElBQUksS0FBSyxDQUNiLHFEQUNHLGFBQWEsdURBQW1ELDJEQUNkLHFCQUFxQixDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBRSxDQUN4RixDQUFDO0tBQ0g7O0FBRUQsV0FBTyxJQUFJLENBQUM7R0FDYixDQUFDLENBQUM7Q0FDSjs7QUFBQSxDQUFDIiwiZmlsZSI6Ii91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvbW9uaXRvcmluZy9zZXJ2ZXIvbGliL2VzX2NsaWVudC9lbnN1cmVfZXNfdmVyc2lvbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogRVMgYW5kIEtpYmFuYSB2ZXJzaW9ucyBhcmUgbG9ja2VkLCBzbyBLaWJhbmEgc2hvdWxkIHJlcXVpcmUgdGhhdCBFUyBoYXMgdGhlIHNhbWUgdmVyc2lvbiBhc1xuICogdGhhdCBkZWZpbmVkIGluIEtpYmFuYSdzIHBhY2thZ2UuanNvbi5cbiAqL1xuXG5pbXBvcnQgXyBmcm9tICdsb2Rhc2gnO1xuaW1wb3J0IGlzRXNDb21wYXRpYmxlV2l0aEtpYmFuYSBmcm9tICcuL2lzX2VzX2NvbXBhdGlibGVfd2l0aF9raWJhbmEnO1xuXG4vKipcbiAqICB0cmFja3MgdGhlIG5vZGUgZGVzY3JpcHRpb25zIHRoYXQgZ2V0IGxvZ2dlZCBpbiB3YXJuaW5ncyBzb1xuICogIHRoYXQgd2UgZG9uJ3Qgc3BhbSB0aGUgbG9nIHdpdGggdGhlIHNhbWUgbWVzc2FnZSBvdmVyIGFuZCBvdmVyLlxuICpcbiAqICBUaGVyZSBhcmUgc2l0dWF0aW9ucywgbGlrZSBpbiB0ZXN0aW5nIG9yIG11bHRpLXRlbmFuY3ksIHdoZXJlXG4gKiAgdGhlIHNlcnZlciBhcmd1bWVudCBjaGFuZ2VzLCBzbyB3ZSBtdXN0IHRyYWNrIHRoZSBwcmV2aW91c1xuICogIG5vZGUgd2FybmluZ3MgcGVyIHNlcnZlclxuICovXG5jb25zdCBsYXN0V2FybmVkTm9kZXNGb3JTZXJ2ZXIgPSBuZXcgV2Vha01hcCgpO1xuXG5leHBvcnQgZnVuY3Rpb24gZW5zdXJlRXNWZXJzaW9uKHNlcnZlciwga2liYW5hVmVyc2lvbikge1xuICBzZXJ2ZXIubG9nKFsncGx1Z2luJywgJ2RlYnVnJ10sICdDaGVja2luZyBFbGFzdGljc2VhcmNoIHZlcnNpb24nKTtcblxuICBjb25zdCB7IGNhbGxXaXRoSW50ZXJuYWxVc2VyIH0gPSBzZXJ2ZXIucGx1Z2lucy5lbGFzdGljc2VhcmNoLmdldENsdXN0ZXIoJ21vbml0b3JpbmcnKTtcblxuICByZXR1cm4gY2FsbFdpdGhJbnRlcm5hbFVzZXIoJ25vZGVzLmluZm8nLCB7XG4gICAgZmlsdGVyUGF0aDogW1xuICAgICAgJ25vZGVzLioudmVyc2lvbicsXG4gICAgICAnbm9kZXMuKi5odHRwLnB1Ymxpc2hfYWRkcmVzcycsXG4gICAgICAnbm9kZXMuKi5pcCcsXG4gICAgXVxuICB9KVxuICAudGhlbihmdW5jdGlvbiAoaW5mbykge1xuICAgIC8vIEFnZ3JlZ2F0ZSBpbmNvbXBhdGlibGUgRVMgbm9kZXMuXG4gICAgY29uc3QgaW5jb21wYXRpYmxlTm9kZXMgPSBbXTtcblxuICAgIC8vIEFnZ3JlZ2F0ZSBFUyBub2RlcyB3aGljaCBzaG91bGQgcHJvbXB0IGEgS2liYW5hIHVwZ3JhZGUuXG4gICAgY29uc3Qgd2FybmluZ05vZGVzID0gW107XG5cbiAgICBfLmZvckVhY2goaW5mby5ub2RlcywgZXNOb2RlID0+IHtcbiAgICAgIGlmICghaXNFc0NvbXBhdGlibGVXaXRoS2liYW5hKGVzTm9kZS52ZXJzaW9uLCBraWJhbmFWZXJzaW9uKSkge1xuICAgICAgICAvLyBFeGl0IGVhcmx5IHRvIGF2b2lkIGNvbGxlY3RpbmcgRVMgbm9kZXMgd2l0aCBuZXdlciBtYWpvciB2ZXJzaW9ucyBpbiB0aGUgYHdhcm5pbmdOb2Rlc2AuXG4gICAgICAgIHJldHVybiBpbmNvbXBhdGlibGVOb2Rlcy5wdXNoKGVzTm9kZSk7XG4gICAgICB9XG5cbiAgICAgIC8vIEl0J3MgYWNjZXB0YWJsZSBpZiBFUyBhbmQgS2liYW5hIHZlcnNpb25zIGFyZSBub3QgdGhlIHNhbWUgc28gbG9uZyBhc1xuICAgICAgLy8gdGhleSBhcmUgbm90IGluY29tcGF0aWJsZSwgYnV0IHdlIHNob3VsZCB3YXJuIGFib3V0IGl0XG4gICAgICBpZiAoZXNOb2RlLnZlcnNpb24gIT09IGtpYmFuYVZlcnNpb24pIHtcbiAgICAgICAgd2FybmluZ05vZGVzLnB1c2goZXNOb2RlKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGZ1bmN0aW9uIGdldFB1Ymxpc2hBZGRyZXNzKG5vZGUpIHtcbiAgICAgIHJldHVybiBfLmdldChub2RlLCAnaHR0cC5wdWJsaXNoX2FkZHJlc3MnKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRIdW1hbml6ZWROb2RlTmFtZXMobm9kZXMpIHtcbiAgICAgIHJldHVybiBub2Rlcy5tYXAobm9kZSA9PiB7XG4gICAgICAgIGNvbnN0IHB1Ymxpc2hBZGRyZXNzUmF3ID0gZ2V0UHVibGlzaEFkZHJlc3Mobm9kZSk7XG4gICAgICAgIGNvbnN0IHB1Ymxpc2hBZGRyZXNzID0gIHB1Ymxpc2hBZGRyZXNzUmF3ID8gcHVibGlzaEFkZHJlc3NSYXcgKyAnICcgOiAnJztcbiAgICAgICAgcmV0dXJuIGB2JHtub2RlLnZlcnNpb259IEAgJHtwdWJsaXNoQWRkcmVzc30oJHtub2RlLmlwfSlgO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgaWYgKHdhcm5pbmdOb2Rlcy5sZW5ndGgpIHtcbiAgICAgIGNvbnN0IHNpbXBsaWZpZWROb2RlcyA9IHdhcm5pbmdOb2Rlcy5tYXAobm9kZSA9PiAoe1xuICAgICAgICB2ZXJzaW9uOiBub2RlLnZlcnNpb24sXG4gICAgICAgIGh0dHA6IHtcbiAgICAgICAgICBwdWJsaXNoX2FkZHJlc3M6IGdldFB1Ymxpc2hBZGRyZXNzKG5vZGUpLFxuICAgICAgICB9LFxuICAgICAgICBpcDogbm9kZS5pcCxcbiAgICAgIH0pKTtcblxuICAgICAgLy8gRG9uJ3Qgc2hvdyB0aGUgc2FtZSB3YXJuaW5nIG92ZXIgYW5kIG92ZXIgYWdhaW4uXG4gICAgICBjb25zdCB3YXJuaW5nTm9kZU5hbWVzID0gZ2V0SHVtYW5pemVkTm9kZU5hbWVzKHNpbXBsaWZpZWROb2Rlcykuam9pbignLCAnKTtcbiAgICAgIGlmIChsYXN0V2FybmVkTm9kZXNGb3JTZXJ2ZXIuZ2V0KHNlcnZlcikgIT09IHdhcm5pbmdOb2RlTmFtZXMpIHtcbiAgICAgICAgbGFzdFdhcm5lZE5vZGVzRm9yU2VydmVyLnNldChzZXJ2ZXIsIHdhcm5pbmdOb2RlTmFtZXMpO1xuICAgICAgICBzZXJ2ZXIubG9nKFsnd2FybmluZyddLCB7XG4gICAgICAgICAgdG1wbDogKFxuICAgICAgICAgICAgYFlvdSdyZSBydW5uaW5nIEtpYmFuYSAke2tpYmFuYVZlcnNpb259IHdpdGggc29tZSBkaWZmZXJlbnQgdmVyc2lvbnMgb2YgYCArXG4gICAgICAgICAgICAnRWxhc3RpY3NlYXJjaCBvbiBhIG1vbml0b3JpbmcgY2x1c3Rlci4gVXBkYXRlIEtpYmFuYSBhbmQgRWxhc3RpY3NlYXJjaCB0byB0aGUgc2FtZSB2ZXJzaW9uIHRvIHByZXZlbnQgY29tcGF0aWJpbGl0eSBpc3N1ZXM6ICcgK1xuICAgICAgICAgICAgd2FybmluZ05vZGVOYW1lc1xuICAgICAgICAgICksXG4gICAgICAgICAga2liYW5hVmVyc2lvbixcbiAgICAgICAgICBub2Rlczogc2ltcGxpZmllZE5vZGVzLFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoaW5jb21wYXRpYmxlTm9kZXMubGVuZ3RoKSB7XG4gICAgICBjb25zdCBpbmNvbXBhdGlibGVOb2RlTmFtZXMgPSBnZXRIdW1hbml6ZWROb2RlTmFtZXMoaW5jb21wYXRpYmxlTm9kZXMpO1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICBgVGhpcyB2ZXJzaW9uIG9mIEtpYmFuYSByZXF1aXJlcyBFbGFzdGljc2VhcmNoIHZgICtcbiAgICAgICAgYCR7a2liYW5hVmVyc2lvbn0gb24gYWxsIG5vZGVzIG9mIHRoZSBtb25pdG9yaW5nIGNsdXN0ZXIuIEkgZm91bmQgYCArXG4gICAgICAgIGB0aGUgZm9sbG93aW5nIGluY29tcGF0aWJsZSBub2RlcyBpbiB5b3VyIGNsdXN0ZXI6ICR7aW5jb21wYXRpYmxlTm9kZU5hbWVzLmpvaW4oJywgJyl9YFxuICAgICAgKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdHJ1ZTtcbiAgfSk7XG59O1xuIl19",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/monitoring/server/lib/es_client/ensure_es_version.js"
      ],
      "names": [],
      "mappings": ";;;;;;;;;;;;;;sBAKc,QAAQ;;;;4CACe,gCAAgC;;;;;;;;;;;;AAUrE,IAAM,wBAAwB,GAAG,IAAI,OAAO,EAAE,CAAC;;AAExC,SAAS,eAAe,CAAC,MAAM,EAAE,aAAa,EAAE;AACrD,QAAM,CAAC,GAAG,CAAC,CAAC,QAAQ,EAAE,OAAO,CAAC,EAAE,gCAAgC,CAAC,CAAC;;iDAEjC,MAAM,CAAC,OAAO,CAAC,aAAa,CAAC,UAAU,CAAC,YAAY,CAAC;;MAA9E,oBAAoB,4CAApB,oBAAoB;;AAE5B,SAAO,oBAAoB,CAAC,YAAY,EAAE;AACxC,cAAU,EAAE,CACV,iBAAiB,EACjB,8BAA8B,EAC9B,YAAY,CACb;GACF,CAAC,CACD,IAAI,CAAC,UAAU,IAAI,EAAE;;AAEpB,QAAM,iBAAiB,GAAG,EAAE,CAAC;;;AAG7B,QAAM,YAAY,GAAG,EAAE,CAAC;;AAExB,wBAAE,OAAO,CAAC,IAAI,CAAC,KAAK,EAAE,UAAA,MAAM,EAAI;AAC9B,UAAI,CAAC,+CAAyB,MAAM,CAAC,OAAO,EAAE,aAAa,CAAC,EAAE;;AAE5D,eAAO,iBAAiB,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;OACvC;;;;AAID,UAAI,MAAM,CAAC,OAAO,KAAK,aAAa,EAAE;AACpC,oBAAY,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;OAC3B;KACF,CAAC,CAAC;;AAEH,aAAS,iBAAiB,CAAC,IAAI,EAAE;AAC/B,aAAO,oBAAE,GAAG,CAAC,IAAI,EAAE,sBAAsB,CAAC,CAAC;KAC5C;;AAED,aAAS,qBAAqB,CAAC,KAAK,EAAE;AACpC,aAAO,KAAK,CAAC,GAAG,CAAC,UAAA,IAAI,EAAI;AACvB,YAAM,iBAAiB,GAAG,iBAAiB,CAAC,IAAI,CAAC,CAAC;AAClD,YAAM,cAAc,GAAI,iBAAiB,GAAG,iBAAiB,GAAG,GAAG,GAAG,EAAE,CAAC;AACzE,qBAAW,IAAI,CAAC,OAAO,WAAM,cAAc,SAAI,IAAI,CAAC,EAAE,OAAI;OAC3D,CAAC,CAAC;KACJ;;AAED,QAAI,YAAY,CAAC,MAAM,EAAE;AACvB,UAAM,eAAe,GAAG,YAAY,CAAC,GAAG,CAAC,UAAA,IAAI;eAAK;AAChD,iBAAO,EAAE,IAAI,CAAC,OAAO;AACrB,cAAI,EAAE;AACJ,2BAAe,EAAE,iBAAiB,CAAC,IAAI,CAAC;WACzC;AACD,YAAE,EAAE,IAAI,CAAC,EAAE;SACZ;OAAC,CAAC,CAAC;;;AAGJ,UAAM,gBAAgB,GAAG,qBAAqB,CAAC,eAAe,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;AAC3E,UAAI,wBAAwB,CAAC,GAAG,CAAC,MAAM,CAAC,KAAK,gBAAgB,EAAE;AAC7D,gCAAwB,CAAC,GAAG,CAAC,MAAM,EAAE,gBAAgB,CAAC,CAAC;AACvD,cAAM,CAAC,GAAG,CAAC,CAAC,SAAS,CAAC,EAAE;AACtB,cAAI,EACF,4BAAyB,aAAa,yCACtC,8HAA8H,GAC9H,gBAAgB,AACjB;AACD,uBAAa,EAAb,aAAa;AACb,eAAK,EAAE,eAAe;SACvB,CAAC,CAAC;OACJ;KACF;;AAED,QAAI,iBAAiB,CAAC,MAAM,EAAE;AAC5B,UAAM,qBAAqB,GAAG,qBAAqB,CAAC,iBAAiB,CAAC,CAAC;AACvE,YAAM,IAAI,KAAK,CACb,qDACG,aAAa,uDAAmD,2DACd,qBAAqB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAE,CACxF,CAAC;KACH;;AAED,WAAO,IAAI,CAAC;GACb,CAAC,CAAC;CACJ;;AAAA,CAAC",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/monitoring/server/lib/es_client/ensure_es_version.js",
      "sourcesContent": [
        "/**\n * ES and Kibana versions are locked, so Kibana should require that ES has the same version as\n * that defined in Kibana's package.json.\n */\n\nimport _ from 'lodash';\nimport isEsCompatibleWithKibana from './is_es_compatible_with_kibana';\n\n/**\n *  tracks the node descriptions that get logged in warnings so\n *  that we don't spam the log with the same message over and over.\n *\n *  There are situations, like in testing or multi-tenancy, where\n *  the server argument changes, so we must track the previous\n *  node warnings per server\n */\nconst lastWarnedNodesForServer = new WeakMap();\n\nexport function ensureEsVersion(server, kibanaVersion) {\n  server.log(['plugin', 'debug'], 'Checking Elasticsearch version');\n\n  const { callWithInternalUser } = server.plugins.elasticsearch.getCluster('monitoring');\n\n  return callWithInternalUser('nodes.info', {\n    filterPath: [\n      'nodes.*.version',\n      'nodes.*.http.publish_address',\n      'nodes.*.ip',\n    ]\n  })\n  .then(function (info) {\n    // Aggregate incompatible ES nodes.\n    const incompatibleNodes = [];\n\n    // Aggregate ES nodes which should prompt a Kibana upgrade.\n    const warningNodes = [];\n\n    _.forEach(info.nodes, esNode => {\n      if (!isEsCompatibleWithKibana(esNode.version, kibanaVersion)) {\n        // Exit early to avoid collecting ES nodes with newer major versions in the `warningNodes`.\n        return incompatibleNodes.push(esNode);\n      }\n\n      // It's acceptable if ES and Kibana versions are not the same so long as\n      // they are not incompatible, but we should warn about it\n      if (esNode.version !== kibanaVersion) {\n        warningNodes.push(esNode);\n      }\n    });\n\n    function getPublishAddress(node) {\n      return _.get(node, 'http.publish_address');\n    }\n\n    function getHumanizedNodeNames(nodes) {\n      return nodes.map(node => {\n        const publishAddressRaw = getPublishAddress(node);\n        const publishAddress =  publishAddressRaw ? publishAddressRaw + ' ' : '';\n        return `v${node.version} @ ${publishAddress}(${node.ip})`;\n      });\n    }\n\n    if (warningNodes.length) {\n      const simplifiedNodes = warningNodes.map(node => ({\n        version: node.version,\n        http: {\n          publish_address: getPublishAddress(node),\n        },\n        ip: node.ip,\n      }));\n\n      // Don't show the same warning over and over again.\n      const warningNodeNames = getHumanizedNodeNames(simplifiedNodes).join(', ');\n      if (lastWarnedNodesForServer.get(server) !== warningNodeNames) {\n        lastWarnedNodesForServer.set(server, warningNodeNames);\n        server.log(['warning'], {\n          tmpl: (\n            `You're running Kibana ${kibanaVersion} with some different versions of ` +\n            'Elasticsearch on a monitoring cluster. Update Kibana and Elasticsearch to the same version to prevent compatibility issues: ' +\n            warningNodeNames\n          ),\n          kibanaVersion,\n          nodes: simplifiedNodes,\n        });\n      }\n    }\n\n    if (incompatibleNodes.length) {\n      const incompatibleNodeNames = getHumanizedNodeNames(incompatibleNodes);\n      throw new Error(\n        `This version of Kibana requires Elasticsearch v` +\n        `${kibanaVersion} on all nodes of the monitoring cluster. I found ` +\n        `the following incompatible nodes in your cluster: ${incompatibleNodeNames.join(', ')}`\n      );\n    }\n\n    return true;\n  });\n};\n"
      ]
    },
    "mtime": 1491771513552
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/monitoring/server/lib/es_client/is_es_compatible_with_kibana.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "semver",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "semver"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "isEsCompatibleWithKibana",
            "esVersion",
            "kibanaVersion"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "isEsCompatibleWithKibana",
              "exported": "default"
            },
            {
              "kind": "local",
              "local": "esVersion",
              "exported": "default"
            },
            {
              "kind": "local",
              "local": "kibanaVersion",
              "exported": "default"
            }
          ]
        }
      },
      "usedHelpers": [
        "interop-require-default"
      ]
    },
    "ignored": false,
    "code": "/**\n * Let's weed out the ES versions that won't work with a given Kibana version.\n * 1. Major version differences will never work together.\n * 2. Older versions of ES won't work with newer versions of Kibana.\n */\n\n'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nexports['default'] = isEsCompatibleWithKibana;\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _semver = require('semver');\n\nvar _semver2 = _interopRequireDefault(_semver);\n\nfunction isEsCompatibleWithKibana(esVersion, kibanaVersion) {\n  var esVersionNumbers = {\n    major: _semver2['default'].major(esVersion),\n    minor: _semver2['default'].minor(esVersion),\n    patch: _semver2['default'].patch(esVersion)\n  };\n\n  var kibanaVersionNumbers = {\n    major: _semver2['default'].major(kibanaVersion),\n    minor: _semver2['default'].minor(kibanaVersion),\n    patch: _semver2['default'].patch(kibanaVersion)\n  };\n\n  // Reject mismatching major version numbers.\n  if (esVersionNumbers.major !== kibanaVersionNumbers.major) {\n    return false;\n  }\n\n  // Reject older minor versions of ES.\n  if (esVersionNumbers.minor < kibanaVersionNumbers.minor) {\n    return false;\n  }\n\n  return true;\n}\n\nmodule.exports = exports['default'];\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvbW9uaXRvcmluZy9zZXJ2ZXIvbGliL2VzX2NsaWVudC9pc19lc19jb21wYXRpYmxlX3dpdGhfa2liYW5hLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O3FCQVF3Qix3QkFBd0I7Ozs7c0JBRjdCLFFBQVE7Ozs7QUFFWixTQUFTLHdCQUF3QixDQUFDLFNBQVMsRUFBRSxhQUFhLEVBQUU7QUFDekUsTUFBTSxnQkFBZ0IsR0FBRztBQUN2QixTQUFLLEVBQUUsb0JBQU8sS0FBSyxDQUFDLFNBQVMsQ0FBQztBQUM5QixTQUFLLEVBQUUsb0JBQU8sS0FBSyxDQUFDLFNBQVMsQ0FBQztBQUM5QixTQUFLLEVBQUUsb0JBQU8sS0FBSyxDQUFDLFNBQVMsQ0FBQztHQUMvQixDQUFDOztBQUVGLE1BQU0sb0JBQW9CLEdBQUc7QUFDM0IsU0FBSyxFQUFFLG9CQUFPLEtBQUssQ0FBQyxhQUFhLENBQUM7QUFDbEMsU0FBSyxFQUFFLG9CQUFPLEtBQUssQ0FBQyxhQUFhLENBQUM7QUFDbEMsU0FBSyxFQUFFLG9CQUFPLEtBQUssQ0FBQyxhQUFhLENBQUM7R0FDbkMsQ0FBQzs7O0FBR0YsTUFBSSxnQkFBZ0IsQ0FBQyxLQUFLLEtBQUssb0JBQW9CLENBQUMsS0FBSyxFQUFFO0FBQ3pELFdBQU8sS0FBSyxDQUFDO0dBQ2Q7OztBQUdELE1BQUksZ0JBQWdCLENBQUMsS0FBSyxHQUFHLG9CQUFvQixDQUFDLEtBQUssRUFBRTtBQUN2RCxXQUFPLEtBQUssQ0FBQztHQUNkOztBQUVELFNBQU8sSUFBSSxDQUFDO0NBQ2IiLCJmaWxlIjoiL3Vzci9zaGFyZS9raWJhbmEvcGx1Z2lucy94LXBhY2svcGx1Z2lucy9tb25pdG9yaW5nL3NlcnZlci9saWIvZXNfY2xpZW50L2lzX2VzX2NvbXBhdGlibGVfd2l0aF9raWJhbmEuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIExldCdzIHdlZWQgb3V0IHRoZSBFUyB2ZXJzaW9ucyB0aGF0IHdvbid0IHdvcmsgd2l0aCBhIGdpdmVuIEtpYmFuYSB2ZXJzaW9uLlxuICogMS4gTWFqb3IgdmVyc2lvbiBkaWZmZXJlbmNlcyB3aWxsIG5ldmVyIHdvcmsgdG9nZXRoZXIuXG4gKiAyLiBPbGRlciB2ZXJzaW9ucyBvZiBFUyB3b24ndCB3b3JrIHdpdGggbmV3ZXIgdmVyc2lvbnMgb2YgS2liYW5hLlxuICovXG5cbmltcG9ydCBzZW12ZXIgZnJvbSAnc2VtdmVyJztcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gaXNFc0NvbXBhdGlibGVXaXRoS2liYW5hKGVzVmVyc2lvbiwga2liYW5hVmVyc2lvbikge1xuICBjb25zdCBlc1ZlcnNpb25OdW1iZXJzID0ge1xuICAgIG1ham9yOiBzZW12ZXIubWFqb3IoZXNWZXJzaW9uKSxcbiAgICBtaW5vcjogc2VtdmVyLm1pbm9yKGVzVmVyc2lvbiksXG4gICAgcGF0Y2g6IHNlbXZlci5wYXRjaChlc1ZlcnNpb24pLFxuICB9O1xuXG4gIGNvbnN0IGtpYmFuYVZlcnNpb25OdW1iZXJzID0ge1xuICAgIG1ham9yOiBzZW12ZXIubWFqb3Ioa2liYW5hVmVyc2lvbiksXG4gICAgbWlub3I6IHNlbXZlci5taW5vcihraWJhbmFWZXJzaW9uKSxcbiAgICBwYXRjaDogc2VtdmVyLnBhdGNoKGtpYmFuYVZlcnNpb24pLFxuICB9O1xuXG4gIC8vIFJlamVjdCBtaXNtYXRjaGluZyBtYWpvciB2ZXJzaW9uIG51bWJlcnMuXG4gIGlmIChlc1ZlcnNpb25OdW1iZXJzLm1ham9yICE9PSBraWJhbmFWZXJzaW9uTnVtYmVycy5tYWpvcikge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIC8vIFJlamVjdCBvbGRlciBtaW5vciB2ZXJzaW9ucyBvZiBFUy5cbiAgaWYgKGVzVmVyc2lvbk51bWJlcnMubWlub3IgPCBraWJhbmFWZXJzaW9uTnVtYmVycy5taW5vcikge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIHJldHVybiB0cnVlO1xufVxuIl19",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/monitoring/server/lib/es_client/is_es_compatible_with_kibana.js"
      ],
      "names": [],
      "mappings": ";;;;;;;;;;;qBAQwB,wBAAwB;;;;sBAF7B,QAAQ;;;;AAEZ,SAAS,wBAAwB,CAAC,SAAS,EAAE,aAAa,EAAE;AACzE,MAAM,gBAAgB,GAAG;AACvB,SAAK,EAAE,oBAAO,KAAK,CAAC,SAAS,CAAC;AAC9B,SAAK,EAAE,oBAAO,KAAK,CAAC,SAAS,CAAC;AAC9B,SAAK,EAAE,oBAAO,KAAK,CAAC,SAAS,CAAC;GAC/B,CAAC;;AAEF,MAAM,oBAAoB,GAAG;AAC3B,SAAK,EAAE,oBAAO,KAAK,CAAC,aAAa,CAAC;AAClC,SAAK,EAAE,oBAAO,KAAK,CAAC,aAAa,CAAC;AAClC,SAAK,EAAE,oBAAO,KAAK,CAAC,aAAa,CAAC;GACnC,CAAC;;;AAGF,MAAI,gBAAgB,CAAC,KAAK,KAAK,oBAAoB,CAAC,KAAK,EAAE;AACzD,WAAO,KAAK,CAAC;GACd;;;AAGD,MAAI,gBAAgB,CAAC,KAAK,GAAG,oBAAoB,CAAC,KAAK,EAAE;AACvD,WAAO,KAAK,CAAC;GACd;;AAED,SAAO,IAAI,CAAC;CACb",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/monitoring/server/lib/es_client/is_es_compatible_with_kibana.js",
      "sourcesContent": [
        "/**\n * Let's weed out the ES versions that won't work with a given Kibana version.\n * 1. Major version differences will never work together.\n * 2. Older versions of ES won't work with newer versions of Kibana.\n */\n\nimport semver from 'semver';\n\nexport default function isEsCompatibleWithKibana(esVersion, kibanaVersion) {\n  const esVersionNumbers = {\n    major: semver.major(esVersion),\n    minor: semver.minor(esVersion),\n    patch: semver.patch(esVersion),\n  };\n\n  const kibanaVersionNumbers = {\n    major: semver.major(kibanaVersion),\n    minor: semver.minor(kibanaVersion),\n    patch: semver.patch(kibanaVersion),\n  };\n\n  // Reject mismatching major version numbers.\n  if (esVersionNumbers.major !== kibanaVersionNumbers.major) {\n    return false;\n  }\n\n  // Reject older minor versions of ES.\n  if (esVersionNumbers.minor < kibanaVersionNumbers.minor) {\n    return false;\n  }\n\n  return true;\n}\n"
      ]
    },
    "mtime": 1491771513552
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/monitoring/server/lib/es_client/instantiate_client.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "lodash",
            "imported": [
              "bindKey",
              "once"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "bindKey",
                "local": "bindKey"
              },
              {
                "kind": "named",
                "imported": "once",
                "local": "once"
              }
            ]
          },
          {
            "source": "../../kibana_monitoring/lib/monitoring_bulk",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "monitoringBulk"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "exposeClient",
            "server"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "exposeClient",
              "exported": "exposeClient"
            },
            {
              "kind": "local",
              "local": "server",
              "exported": "server"
            }
          ]
        }
      },
      "usedHelpers": [
        "get",
        "inherits",
        "class-call-check",
        "interop-require-default"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nvar _get = function get(_x, _x2, _x3) { var _again = true; _function: while (_again) { var object = _x, property = _x2, receiver = _x3; _again = false; if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { _x = parent; _x2 = property; _x3 = receiver; _again = true; desc = parent = undefined; continue _function; } } else if ('value' in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } } };\n\nexports.exposeClient = exposeClient;\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar _lodash = require('lodash');\n\nvar _kibana_monitoringLibMonitoring_bulk = require('../../kibana_monitoring/lib/monitoring_bulk');\n\nvar _kibana_monitoringLibMonitoring_bulk2 = _interopRequireDefault(_kibana_monitoringLibMonitoring_bulk);\n\n/* Provide a dedicated Elasticsearch client for Monitoring\n * The connection options can be customized for the Monitoring application\n * This allows the app to connect to a decidated monitoring cluster even if\n * Kibana itself is connected to a production cluster.\n */\n\nfunction exposeClient(server) {\n  var loggingTag = server.config().get('xpack.monitoring.loggingTag');\n  var Logger = server.plugins.elasticsearch.ElasticsearchClientLogging;\n  var logQueries = Boolean(server.config().get('xpack.monitoring.elasticsearch.logQueries'));\n\n  var MonitoringClientLogging = (function (_Logger) {\n    _inherits(MonitoringClientLogging, _Logger);\n\n    function MonitoringClientLogging() {\n      _classCallCheck(this, MonitoringClientLogging);\n\n      _get(Object.getPrototypeOf(MonitoringClientLogging.prototype), 'constructor', this).call(this);\n\n      this.tags = [loggingTag];\n      this.logQueries = logQueries;\n    }\n\n    return MonitoringClientLogging;\n  })(Logger);\n\n  var config = Object.assign({}, server.config().get('xpack.monitoring.elasticsearch'));\n  var configSource = 'monitoring';\n\n  if (!Boolean(config.url)) {\n    config = server.config().get('elasticsearch');\n    configSource = 'production';\n  }\n\n  config.log = MonitoringClientLogging;\n  config.plugins = [_kibana_monitoringLibMonitoring_bulk2['default']];\n\n  var esPlugin = server.plugins.elasticsearch;\n  var cluster = esPlugin.createCluster('monitoring', config);\n  server.on('close', (0, _lodash.bindKey)(cluster, 'close'));\n\n  server.log([loggingTag, 'es-client'], 'config sourced from: ' + configSource + ' cluster (' + config.url + ')');\n}\n\nvar instantiateClient = (0, _lodash.once)(exposeClient);\n\nexports['default'] = instantiateClient;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvbW9uaXRvcmluZy9zZXJ2ZXIvbGliL2VzX2NsaWVudC9pbnN0YW50aWF0ZV9jbGllbnQuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7OztzQkFBOEIsUUFBUTs7bURBQ1gsNkNBQTZDOzs7Ozs7Ozs7O0FBUWpFLFNBQVMsWUFBWSxDQUFDLE1BQU0sRUFBRTtBQUNuQyxNQUFNLFVBQVUsR0FBRyxNQUFNLENBQUMsTUFBTSxFQUFFLENBQUMsR0FBRyxDQUFDLDZCQUE2QixDQUFDLENBQUM7QUFDdEUsTUFBTSxNQUFNLEdBQUcsTUFBTSxDQUFDLE9BQU8sQ0FBQyxhQUFhLENBQUMsMEJBQTBCLENBQUM7QUFDdkUsTUFBTSxVQUFVLEdBQUcsT0FBTyxDQUFDLE1BQU0sQ0FBQyxNQUFNLEVBQUUsQ0FBQyxHQUFHLENBQUMsMkNBQTJDLENBQUMsQ0FBQyxDQUFDOztNQUV2Rix1QkFBdUI7Y0FBdkIsdUJBQXVCOztBQUNoQixhQURQLHVCQUF1QixHQUNiOzRCQURWLHVCQUF1Qjs7QUFFekIsaUNBRkUsdUJBQXVCLDZDQUVqQjs7QUFFUixVQUFJLENBQUMsSUFBSSxHQUFHLENBQUMsVUFBVSxDQUFDLENBQUM7QUFDekIsVUFBSSxDQUFDLFVBQVUsR0FBRyxVQUFVLENBQUM7S0FDOUI7O1dBTkcsdUJBQXVCO0tBQVMsTUFBTTs7QUFTNUMsTUFBSSxNQUFNLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQyxFQUFFLEVBQUUsTUFBTSxDQUFDLE1BQU0sRUFBRSxDQUFDLEdBQUcsQ0FBQyxnQ0FBZ0MsQ0FBQyxDQUFDLENBQUM7QUFDdEYsTUFBSSxZQUFZLEdBQUcsWUFBWSxDQUFDOztBQUVoQyxNQUFJLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsRUFBRTtBQUN4QixVQUFNLEdBQUcsTUFBTSxDQUFDLE1BQU0sRUFBRSxDQUFDLEdBQUcsQ0FBQyxlQUFlLENBQUMsQ0FBQztBQUM5QyxnQkFBWSxHQUFHLFlBQVksQ0FBQztHQUM3Qjs7QUFFRCxRQUFNLENBQUMsR0FBRyxHQUFHLHVCQUF1QixDQUFDO0FBQ3JDLFFBQU0sQ0FBQyxPQUFPLEdBQUcsa0RBQWdCLENBQUM7O0FBRWxDLE1BQU0sUUFBUSxHQUFHLE1BQU0sQ0FBQyxPQUFPLENBQUMsYUFBYSxDQUFDO0FBQzlDLE1BQU0sT0FBTyxHQUFHLFFBQVEsQ0FBQyxhQUFhLENBQUMsWUFBWSxFQUFFLE1BQU0sQ0FBQyxDQUFDO0FBQzdELFFBQU0sQ0FBQyxFQUFFLENBQUMsT0FBTyxFQUFFLHFCQUFRLE9BQU8sRUFBRSxPQUFPLENBQUMsQ0FBQyxDQUFDOztBQUU5QyxRQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsVUFBVSxFQUFFLFdBQVcsQ0FBQyw0QkFBMEIsWUFBWSxrQkFBYSxNQUFNLENBQUMsR0FBRyxPQUFJLENBQUM7Q0FDdkc7O0FBR0QsSUFBTSxpQkFBaUIsR0FBRyxrQkFBSyxZQUFZLENBQUMsQ0FBQzs7cUJBRTlCLGlCQUFpQiIsImZpbGUiOiIvdXNyL3NoYXJlL2tpYmFuYS9wbHVnaW5zL3gtcGFjay9wbHVnaW5zL21vbml0b3Jpbmcvc2VydmVyL2xpYi9lc19jbGllbnQvaW5zdGFudGlhdGVfY2xpZW50LmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgYmluZEtleSwgb25jZSB9IGZyb20gJ2xvZGFzaCc7XG5pbXBvcnQgbW9uaXRvcmluZ0J1bGsgZnJvbSAnLi4vLi4va2liYW5hX21vbml0b3JpbmcvbGliL21vbml0b3JpbmdfYnVsayc7XG5cbi8qIFByb3ZpZGUgYSBkZWRpY2F0ZWQgRWxhc3RpY3NlYXJjaCBjbGllbnQgZm9yIE1vbml0b3JpbmdcbiAqIFRoZSBjb25uZWN0aW9uIG9wdGlvbnMgY2FuIGJlIGN1c3RvbWl6ZWQgZm9yIHRoZSBNb25pdG9yaW5nIGFwcGxpY2F0aW9uXG4gKiBUaGlzIGFsbG93cyB0aGUgYXBwIHRvIGNvbm5lY3QgdG8gYSBkZWNpZGF0ZWQgbW9uaXRvcmluZyBjbHVzdGVyIGV2ZW4gaWZcbiAqIEtpYmFuYSBpdHNlbGYgaXMgY29ubmVjdGVkIHRvIGEgcHJvZHVjdGlvbiBjbHVzdGVyLlxuICovXG5cbmV4cG9ydCBmdW5jdGlvbiBleHBvc2VDbGllbnQoc2VydmVyKSB7XG4gIGNvbnN0IGxvZ2dpbmdUYWcgPSBzZXJ2ZXIuY29uZmlnKCkuZ2V0KCd4cGFjay5tb25pdG9yaW5nLmxvZ2dpbmdUYWcnKTtcbiAgY29uc3QgTG9nZ2VyID0gc2VydmVyLnBsdWdpbnMuZWxhc3RpY3NlYXJjaC5FbGFzdGljc2VhcmNoQ2xpZW50TG9nZ2luZztcbiAgY29uc3QgbG9nUXVlcmllcyA9IEJvb2xlYW4oc2VydmVyLmNvbmZpZygpLmdldCgneHBhY2subW9uaXRvcmluZy5lbGFzdGljc2VhcmNoLmxvZ1F1ZXJpZXMnKSk7XG5cbiAgY2xhc3MgTW9uaXRvcmluZ0NsaWVudExvZ2dpbmcgZXh0ZW5kcyBMb2dnZXIge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgc3VwZXIoKTtcblxuICAgICAgdGhpcy50YWdzID0gW2xvZ2dpbmdUYWddO1xuICAgICAgdGhpcy5sb2dRdWVyaWVzID0gbG9nUXVlcmllcztcbiAgICB9XG4gIH1cblxuICBsZXQgY29uZmlnID0gT2JqZWN0LmFzc2lnbih7fSwgc2VydmVyLmNvbmZpZygpLmdldCgneHBhY2subW9uaXRvcmluZy5lbGFzdGljc2VhcmNoJykpO1xuICBsZXQgY29uZmlnU291cmNlID0gJ21vbml0b3JpbmcnO1xuXG4gIGlmICghQm9vbGVhbihjb25maWcudXJsKSkge1xuICAgIGNvbmZpZyA9IHNlcnZlci5jb25maWcoKS5nZXQoJ2VsYXN0aWNzZWFyY2gnKTtcbiAgICBjb25maWdTb3VyY2UgPSAncHJvZHVjdGlvbic7XG4gIH1cblxuICBjb25maWcubG9nID0gTW9uaXRvcmluZ0NsaWVudExvZ2dpbmc7XG4gIGNvbmZpZy5wbHVnaW5zID0gW21vbml0b3JpbmdCdWxrXTtcblxuICBjb25zdCBlc1BsdWdpbiA9IHNlcnZlci5wbHVnaW5zLmVsYXN0aWNzZWFyY2g7XG4gIGNvbnN0IGNsdXN0ZXIgPSBlc1BsdWdpbi5jcmVhdGVDbHVzdGVyKCdtb25pdG9yaW5nJywgY29uZmlnKTtcbiAgc2VydmVyLm9uKCdjbG9zZScsIGJpbmRLZXkoY2x1c3RlciwgJ2Nsb3NlJykpO1xuXG4gIHNlcnZlci5sb2coW2xvZ2dpbmdUYWcsICdlcy1jbGllbnQnXSwgYGNvbmZpZyBzb3VyY2VkIGZyb206ICR7Y29uZmlnU291cmNlfSBjbHVzdGVyICgke2NvbmZpZy51cmx9KWApO1xufVxuXG5cbmNvbnN0IGluc3RhbnRpYXRlQ2xpZW50ID0gb25jZShleHBvc2VDbGllbnQpO1xuXG5leHBvcnQgZGVmYXVsdCBpbnN0YW50aWF0ZUNsaWVudDtcbiJdfQ==",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/monitoring/server/lib/es_client/instantiate_client.js"
      ],
      "names": [],
      "mappings": ";;;;;;;;;;;;;;;;sBAA8B,QAAQ;;mDACX,6CAA6C;;;;;;;;;;AAQjE,SAAS,YAAY,CAAC,MAAM,EAAE;AACnC,MAAM,UAAU,GAAG,MAAM,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,6BAA6B,CAAC,CAAC;AACtE,MAAM,MAAM,GAAG,MAAM,CAAC,OAAO,CAAC,aAAa,CAAC,0BAA0B,CAAC;AACvE,MAAM,UAAU,GAAG,OAAO,CAAC,MAAM,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,2CAA2C,CAAC,CAAC,CAAC;;MAEvF,uBAAuB;cAAvB,uBAAuB;;AAChB,aADP,uBAAuB,GACb;4BADV,uBAAuB;;AAEzB,iCAFE,uBAAuB,6CAEjB;;AAER,UAAI,CAAC,IAAI,GAAG,CAAC,UAAU,CAAC,CAAC;AACzB,UAAI,CAAC,UAAU,GAAG,UAAU,CAAC;KAC9B;;WANG,uBAAuB;KAAS,MAAM;;AAS5C,MAAI,MAAM,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,MAAM,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,gCAAgC,CAAC,CAAC,CAAC;AACtF,MAAI,YAAY,GAAG,YAAY,CAAC;;AAEhC,MAAI,CAAC,OAAO,CAAC,MAAM,CAAC,GAAG,CAAC,EAAE;AACxB,UAAM,GAAG,MAAM,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,eAAe,CAAC,CAAC;AAC9C,gBAAY,GAAG,YAAY,CAAC;GAC7B;;AAED,QAAM,CAAC,GAAG,GAAG,uBAAuB,CAAC;AACrC,QAAM,CAAC,OAAO,GAAG,kDAAgB,CAAC;;AAElC,MAAM,QAAQ,GAAG,MAAM,CAAC,OAAO,CAAC,aAAa,CAAC;AAC9C,MAAM,OAAO,GAAG,QAAQ,CAAC,aAAa,CAAC,YAAY,EAAE,MAAM,CAAC,CAAC;AAC7D,QAAM,CAAC,EAAE,CAAC,OAAO,EAAE,qBAAQ,OAAO,EAAE,OAAO,CAAC,CAAC,CAAC;;AAE9C,QAAM,CAAC,GAAG,CAAC,CAAC,UAAU,EAAE,WAAW,CAAC,4BAA0B,YAAY,kBAAa,MAAM,CAAC,GAAG,OAAI,CAAC;CACvG;;AAGD,IAAM,iBAAiB,GAAG,kBAAK,YAAY,CAAC,CAAC;;qBAE9B,iBAAiB",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/monitoring/server/lib/es_client/instantiate_client.js",
      "sourcesContent": [
        "import { bindKey, once } from 'lodash';\nimport monitoringBulk from '../../kibana_monitoring/lib/monitoring_bulk';\n\n/* Provide a dedicated Elasticsearch client for Monitoring\n * The connection options can be customized for the Monitoring application\n * This allows the app to connect to a decidated monitoring cluster even if\n * Kibana itself is connected to a production cluster.\n */\n\nexport function exposeClient(server) {\n  const loggingTag = server.config().get('xpack.monitoring.loggingTag');\n  const Logger = server.plugins.elasticsearch.ElasticsearchClientLogging;\n  const logQueries = Boolean(server.config().get('xpack.monitoring.elasticsearch.logQueries'));\n\n  class MonitoringClientLogging extends Logger {\n    constructor() {\n      super();\n\n      this.tags = [loggingTag];\n      this.logQueries = logQueries;\n    }\n  }\n\n  let config = Object.assign({}, server.config().get('xpack.monitoring.elasticsearch'));\n  let configSource = 'monitoring';\n\n  if (!Boolean(config.url)) {\n    config = server.config().get('elasticsearch');\n    configSource = 'production';\n  }\n\n  config.log = MonitoringClientLogging;\n  config.plugins = [monitoringBulk];\n\n  const esPlugin = server.plugins.elasticsearch;\n  const cluster = esPlugin.createCluster('monitoring', config);\n  server.on('close', bindKey(cluster, 'close'));\n\n  server.log([loggingTag, 'es-client'], `config sourced from: ${configSource} cluster (${config.url})`);\n}\n\n\nconst instantiateClient = once(exposeClient);\n\nexport default instantiateClient;\n"
      ]
    },
    "mtime": 1491771513552
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/monitoring/server/kibana_monitoring/lib/monitoring_bulk.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [],
        "exports": {
          "exported": [
            "addMonitoringApi",
            "Client",
            "_config",
            "components"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "addMonitoringApi",
              "exported": "default"
            },
            {
              "kind": "local",
              "local": "Client",
              "exported": "default"
            },
            {
              "kind": "local",
              "local": "_config",
              "exported": "default"
            },
            {
              "kind": "local",
              "local": "components",
              "exported": "default"
            }
          ]
        }
      },
      "usedHelpers": []
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nexports['default'] = addMonitoringApi;\n\nfunction addMonitoringApi(Client, _config, components) {\n  var ca = components.clientAction.factory;\n  Client.prototype.monitoring = components.clientAction.namespaceFactory();\n  var monitoring = Client.prototype.monitoring.prototype;\n\n  /**\n   * Perform a [monitoring.bulk](http://www.elastic.co/guide/en/elasticsearch/reference/master/docs-bulk.html) request\n   *\n   * @param {Object} params - An object with parameters used to carry out this action\n   * @param {String} params.system_id - Reporting application id\n   * @param {String} params.system_api_version - Reporting application API version\n   * @param {Number} params.interval - Collection interval in string format (e.g., '10s' or '10000ms')\n   * @param {String} params.consistency - Explicit write consistency setting for the operation\n   * @param {Boolean} params.refresh - Refresh the index after performing the operation\n   * @param {String} params.routing - Specific routing value\n   * @param {Date, Number} params.timeout - Explicit operation timeout\n   * @param {String} params.type - Default document type for items which don't provide one\n   * @param {String, String[], Boolean} params.fields - Default comma-separated list of fields to return in the response for updates\n   */\n  monitoring.bulk = ca({\n    params: {\n      system_id: {\n        type: 'string'\n      },\n      system_api_version: {\n        type: 'string'\n      },\n      type: {\n        type: 'string'\n      },\n      interval: {\n        type: 'string'\n      }\n    },\n    urls: [{\n      fmt: '/_xpack/monitoring/<%=type%>/_bulk',\n      req: {\n        type: {\n          type: 'string'\n        }\n      }\n    }, {\n      fmt: '/_xpack/monitoring/_bulk'\n    }],\n    needBody: true,\n    bulkBody: true,\n    method: 'POST'\n  });\n}\n\n;\nmodule.exports = exports['default'];\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvbW9uaXRvcmluZy9zZXJ2ZXIva2liYW5hX21vbml0b3JpbmcvbGliL21vbml0b3JpbmdfYnVsay5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztxQkFBd0IsZ0JBQWdCOztBQUF6QixTQUFTLGdCQUFnQixDQUFDLE1BQU0sRUFBRSxPQUFPLEVBQUUsVUFBVSxFQUFFO0FBQ3BFLE1BQU0sRUFBRSxHQUFHLFVBQVUsQ0FBQyxZQUFZLENBQUMsT0FBTyxDQUFDO0FBQzNDLFFBQU0sQ0FBQyxTQUFTLENBQUMsVUFBVSxHQUFHLFVBQVUsQ0FBQyxZQUFZLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQztBQUN6RSxNQUFNLFVBQVUsR0FBRyxNQUFNLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBQyxTQUFTLENBQUM7Ozs7Ozs7Ozs7Ozs7Ozs7QUFnQnpELFlBQVUsQ0FBQyxJQUFJLEdBQUcsRUFBRSxDQUFDO0FBQ25CLFVBQU0sRUFBRTtBQUNOLGVBQVMsRUFBRTtBQUNULFlBQUksRUFBRSxRQUFRO09BQ2Y7QUFDRCx3QkFBa0IsRUFBRTtBQUNsQixZQUFJLEVBQUUsUUFBUTtPQUNmO0FBQ0QsVUFBSSxFQUFFO0FBQ0osWUFBSSxFQUFFLFFBQVE7T0FDZjtBQUNELGNBQVEsRUFBRTtBQUNSLFlBQUksRUFBRSxRQUFRO09BQ2Y7S0FDRjtBQUNELFFBQUksRUFBRSxDQUFDO0FBQ0wsU0FBRyxFQUFFLG9DQUFvQztBQUN6QyxTQUFHLEVBQUU7QUFDSCxZQUFJLEVBQUU7QUFDSixjQUFJLEVBQUUsUUFBUTtTQUNmO09BQ0Y7S0FDRixFQUFFO0FBQ0QsU0FBRyxFQUFFLDBCQUEwQjtLQUNoQyxDQUFDO0FBQ0YsWUFBUSxFQUFFLElBQUk7QUFDZCxZQUFRLEVBQUUsSUFBSTtBQUNkLFVBQU0sRUFBRSxNQUFNO0dBQ2YsQ0FBQyxDQUFDO0NBRUo7O0FBQUEsQ0FBQyIsImZpbGUiOiIvdXNyL3NoYXJlL2tpYmFuYS9wbHVnaW5zL3gtcGFjay9wbHVnaW5zL21vbml0b3Jpbmcvc2VydmVyL2tpYmFuYV9tb25pdG9yaW5nL2xpYi9tb25pdG9yaW5nX2J1bGsuanMiLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBhZGRNb25pdG9yaW5nQXBpKENsaWVudCwgX2NvbmZpZywgY29tcG9uZW50cykge1xuICBjb25zdCBjYSA9IGNvbXBvbmVudHMuY2xpZW50QWN0aW9uLmZhY3Rvcnk7XG4gIENsaWVudC5wcm90b3R5cGUubW9uaXRvcmluZyA9IGNvbXBvbmVudHMuY2xpZW50QWN0aW9uLm5hbWVzcGFjZUZhY3RvcnkoKTtcbiAgY29uc3QgbW9uaXRvcmluZyA9IENsaWVudC5wcm90b3R5cGUubW9uaXRvcmluZy5wcm90b3R5cGU7XG5cbiAvKipcbiAgKiBQZXJmb3JtIGEgW21vbml0b3JpbmcuYnVsa10oaHR0cDovL3d3dy5lbGFzdGljLmNvL2d1aWRlL2VuL2VsYXN0aWNzZWFyY2gvcmVmZXJlbmNlL21hc3Rlci9kb2NzLWJ1bGsuaHRtbCkgcmVxdWVzdFxuICAqXG4gICogQHBhcmFtIHtPYmplY3R9IHBhcmFtcyAtIEFuIG9iamVjdCB3aXRoIHBhcmFtZXRlcnMgdXNlZCB0byBjYXJyeSBvdXQgdGhpcyBhY3Rpb25cbiAgKiBAcGFyYW0ge1N0cmluZ30gcGFyYW1zLnN5c3RlbV9pZCAtIFJlcG9ydGluZyBhcHBsaWNhdGlvbiBpZFxuICAqIEBwYXJhbSB7U3RyaW5nfSBwYXJhbXMuc3lzdGVtX2FwaV92ZXJzaW9uIC0gUmVwb3J0aW5nIGFwcGxpY2F0aW9uIEFQSSB2ZXJzaW9uXG4gICogQHBhcmFtIHtOdW1iZXJ9IHBhcmFtcy5pbnRlcnZhbCAtIENvbGxlY3Rpb24gaW50ZXJ2YWwgaW4gc3RyaW5nIGZvcm1hdCAoZS5nLiwgJzEwcycgb3IgJzEwMDAwbXMnKVxuICAqIEBwYXJhbSB7U3RyaW5nfSBwYXJhbXMuY29uc2lzdGVuY3kgLSBFeHBsaWNpdCB3cml0ZSBjb25zaXN0ZW5jeSBzZXR0aW5nIGZvciB0aGUgb3BlcmF0aW9uXG4gICogQHBhcmFtIHtCb29sZWFufSBwYXJhbXMucmVmcmVzaCAtIFJlZnJlc2ggdGhlIGluZGV4IGFmdGVyIHBlcmZvcm1pbmcgdGhlIG9wZXJhdGlvblxuICAqIEBwYXJhbSB7U3RyaW5nfSBwYXJhbXMucm91dGluZyAtIFNwZWNpZmljIHJvdXRpbmcgdmFsdWVcbiAgKiBAcGFyYW0ge0RhdGUsIE51bWJlcn0gcGFyYW1zLnRpbWVvdXQgLSBFeHBsaWNpdCBvcGVyYXRpb24gdGltZW91dFxuICAqIEBwYXJhbSB7U3RyaW5nfSBwYXJhbXMudHlwZSAtIERlZmF1bHQgZG9jdW1lbnQgdHlwZSBmb3IgaXRlbXMgd2hpY2ggZG9uJ3QgcHJvdmlkZSBvbmVcbiAgKiBAcGFyYW0ge1N0cmluZywgU3RyaW5nW10sIEJvb2xlYW59IHBhcmFtcy5maWVsZHMgLSBEZWZhdWx0IGNvbW1hLXNlcGFyYXRlZCBsaXN0IG9mIGZpZWxkcyB0byByZXR1cm4gaW4gdGhlIHJlc3BvbnNlIGZvciB1cGRhdGVzXG4gICovXG4gIG1vbml0b3JpbmcuYnVsayA9IGNhKHtcbiAgICBwYXJhbXM6IHtcbiAgICAgIHN5c3RlbV9pZDoge1xuICAgICAgICB0eXBlOiAnc3RyaW5nJ1xuICAgICAgfSxcbiAgICAgIHN5c3RlbV9hcGlfdmVyc2lvbjoge1xuICAgICAgICB0eXBlOiAnc3RyaW5nJ1xuICAgICAgfSxcbiAgICAgIHR5cGU6IHtcbiAgICAgICAgdHlwZTogJ3N0cmluZydcbiAgICAgIH0sXG4gICAgICBpbnRlcnZhbDoge1xuICAgICAgICB0eXBlOiAnc3RyaW5nJ1xuICAgICAgfVxuICAgIH0sXG4gICAgdXJsczogW3tcbiAgICAgIGZtdDogJy9feHBhY2svbW9uaXRvcmluZy88JT10eXBlJT4vX2J1bGsnLFxuICAgICAgcmVxOiB7XG4gICAgICAgIHR5cGU6IHtcbiAgICAgICAgICB0eXBlOiAnc3RyaW5nJ1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSwge1xuICAgICAgZm10OiAnL194cGFjay9tb25pdG9yaW5nL19idWxrJ1xuICAgIH1dLFxuICAgIG5lZWRCb2R5OiB0cnVlLFxuICAgIGJ1bGtCb2R5OiB0cnVlLFxuICAgIG1ldGhvZDogJ1BPU1QnXG4gIH0pO1xuXG59O1xuIl19",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/monitoring/server/kibana_monitoring/lib/monitoring_bulk.js"
      ],
      "names": [],
      "mappings": ";;;;;qBAAwB,gBAAgB;;AAAzB,SAAS,gBAAgB,CAAC,MAAM,EAAE,OAAO,EAAE,UAAU,EAAE;AACpE,MAAM,EAAE,GAAG,UAAU,CAAC,YAAY,CAAC,OAAO,CAAC;AAC3C,QAAM,CAAC,SAAS,CAAC,UAAU,GAAG,UAAU,CAAC,YAAY,CAAC,gBAAgB,EAAE,CAAC;AACzE,MAAM,UAAU,GAAG,MAAM,CAAC,SAAS,CAAC,UAAU,CAAC,SAAS,CAAC;;;;;;;;;;;;;;;;AAgBzD,YAAU,CAAC,IAAI,GAAG,EAAE,CAAC;AACnB,UAAM,EAAE;AACN,eAAS,EAAE;AACT,YAAI,EAAE,QAAQ;OACf;AACD,wBAAkB,EAAE;AAClB,YAAI,EAAE,QAAQ;OACf;AACD,UAAI,EAAE;AACJ,YAAI,EAAE,QAAQ;OACf;AACD,cAAQ,EAAE;AACR,YAAI,EAAE,QAAQ;OACf;KACF;AACD,QAAI,EAAE,CAAC;AACL,SAAG,EAAE,oCAAoC;AACzC,SAAG,EAAE;AACH,YAAI,EAAE;AACJ,cAAI,EAAE,QAAQ;SACf;OACF;KACF,EAAE;AACD,SAAG,EAAE,0BAA0B;KAChC,CAAC;AACF,YAAQ,EAAE,IAAI;AACd,YAAQ,EAAE,IAAI;AACd,UAAM,EAAE,MAAM;GACf,CAAC,CAAC;CAEJ;;AAAA,CAAC",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/monitoring/server/kibana_monitoring/lib/monitoring_bulk.js",
      "sourcesContent": [
        "export default function addMonitoringApi(Client, _config, components) {\n  const ca = components.clientAction.factory;\n  Client.prototype.monitoring = components.clientAction.namespaceFactory();\n  const monitoring = Client.prototype.monitoring.prototype;\n\n /**\n  * Perform a [monitoring.bulk](http://www.elastic.co/guide/en/elasticsearch/reference/master/docs-bulk.html) request\n  *\n  * @param {Object} params - An object with parameters used to carry out this action\n  * @param {String} params.system_id - Reporting application id\n  * @param {String} params.system_api_version - Reporting application API version\n  * @param {Number} params.interval - Collection interval in string format (e.g., '10s' or '10000ms')\n  * @param {String} params.consistency - Explicit write consistency setting for the operation\n  * @param {Boolean} params.refresh - Refresh the index after performing the operation\n  * @param {String} params.routing - Specific routing value\n  * @param {Date, Number} params.timeout - Explicit operation timeout\n  * @param {String} params.type - Default document type for items which don't provide one\n  * @param {String, String[], Boolean} params.fields - Default comma-separated list of fields to return in the response for updates\n  */\n  monitoring.bulk = ca({\n    params: {\n      system_id: {\n        type: 'string'\n      },\n      system_api_version: {\n        type: 'string'\n      },\n      type: {\n        type: 'string'\n      },\n      interval: {\n        type: 'string'\n      }\n    },\n    urls: [{\n      fmt: '/_xpack/monitoring/<%=type%>/_bulk',\n      req: {\n        type: {\n          type: 'string'\n        }\n      }\n    }, {\n      fmt: '/_xpack/monitoring/_bulk'\n    }],\n    needBody: true,\n    bulkBody: true,\n    method: 'POST'\n  });\n\n};\n"
      ]
    },
    "mtime": 1491771513555
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/monitoring/server/kibana_monitoring/index.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "./lib/ops_buffer",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "opsBuffer"
              }
            ]
          },
          {
            "source": "lodash",
            "imported": [
              "get"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "get",
                "local": "get"
              }
            ]
          }
        ],
        "exports": {
          "exported": [],
          "specifiers": []
        }
      },
      "usedHelpers": [
        "interop-require-default"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _libOps_buffer = require('./lib/ops_buffer');\n\nvar _libOps_buffer2 = _interopRequireDefault(_libOps_buffer);\n\nvar _lodash = require('lodash');\n\nexports['default'] = function (serverInfo, server) {\n  var config = server.config();\n\n  var _server$plugins$elasticsearch$getCluster = server.plugins.elasticsearch.getCluster('admin');\n\n  var callWithInternalUser = _server$plugins$elasticsearch$getCluster.callWithInternalUser;\n\n  callWithInternalUser('transport.request', {\n    method: 'GET',\n    path: '/_xpack'\n  }).then(function (res) {\n    var isEnabledInAdminCluster = !!(0, _lodash.get)(res, 'features.monitoring.enabled');\n    if (isEnabledInAdminCluster && config.get('xpack.monitoring.kibana.collection.enabled')) {\n      (function () {\n        var onOps = function onOps(event) {\n          buffer.push(event);\n        };\n\n        var buffer = (0, _libOps_buffer2['default'])(serverInfo, server);\n        var monitor = server.plugins['even-better'].monitor;\n        var opsHandler = undefined;\n\n        server.plugins.elasticsearch.status.on('green', function () {\n          monitor.on('ops', onOps);\n          opsHandler = setInterval(function () {\n            return buffer.flush();\n          }, config.get('xpack.monitoring.kibana.collection.interval'));\n        });\n\n        server.plugins.elasticsearch.status.on('red', function () {\n          monitor.removeListener('ops', onOps);\n          clearInterval(opsHandler);\n        });\n      })();\n    }\n  })['catch'](function () {\n    var monitoringTag = config.get('xpack.monitoring.loggingTag');\n    server.log(['warning', monitoringTag], 'Unable to retrieve X-Pack info. Kibana monitoring will be disabled.');\n  });\n};\n\nmodule.exports = exports['default'];\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvbW9uaXRvcmluZy9zZXJ2ZXIva2liYW5hX21vbml0b3JpbmcvaW5kZXguanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7NkJBQXNCLGtCQUFrQjs7OztzQkFDcEIsUUFBUTs7cUJBRWIsVUFBVSxVQUFVLEVBQUUsTUFBTSxFQUFFO0FBQzNDLE1BQU0sTUFBTSxHQUFHLE1BQU0sQ0FBQyxNQUFNLEVBQUUsQ0FBQzs7aURBQ0MsTUFBTSxDQUFDLE9BQU8sQ0FBQyxhQUFhLENBQUMsVUFBVSxDQUFDLE9BQU8sQ0FBQzs7TUFBeEUsb0JBQW9CLDRDQUFwQixvQkFBb0I7O0FBQzVCLHNCQUFvQixDQUFDLG1CQUFtQixFQUFFO0FBQ3hDLFVBQU0sRUFBRSxLQUFLO0FBQ2IsUUFBSSxFQUFFLFNBQVM7R0FDaEIsQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFDLEdBQUcsRUFBSztBQUNmLFFBQU0sdUJBQXVCLEdBQUcsQ0FBQyxDQUFDLGlCQUFJLEdBQUcsRUFBRSw2QkFBNkIsQ0FBQyxDQUFDO0FBQzFFLFFBQUksdUJBQXVCLElBQUksTUFBTSxDQUFDLEdBQUcsQ0FBQyw0Q0FBNEMsQ0FBQyxFQUFFOztZQUs5RSxLQUFLLEdBQWQsU0FBUyxLQUFLLENBQUMsS0FBSyxFQUFFO0FBQ3BCLGdCQUFNLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1NBQ3BCOztBQU5ELFlBQU0sTUFBTSxHQUFHLGdDQUFVLFVBQVUsRUFBRSxNQUFNLENBQUMsQ0FBQztBQUM3QyxZQUFNLE9BQU8sR0FBRyxNQUFNLENBQUMsT0FBTyxDQUFDLGFBQWEsQ0FBQyxDQUFDLE9BQU8sQ0FBQztBQUN0RCxZQUFJLFVBQVUsWUFBQSxDQUFDOztBQU1mLGNBQU0sQ0FBQyxPQUFPLENBQUMsYUFBYSxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUMsT0FBTyxFQUFFLFlBQU07QUFDcEQsaUJBQU8sQ0FBQyxFQUFFLENBQUMsS0FBSyxFQUFFLEtBQUssQ0FBQyxDQUFDO0FBQ3pCLG9CQUFVLEdBQUcsV0FBVyxDQUFDO21CQUFNLE1BQU0sQ0FBQyxLQUFLLEVBQUU7V0FBQSxFQUFFLE1BQU0sQ0FBQyxHQUFHLENBQUMsNkNBQTZDLENBQUMsQ0FBQyxDQUFDO1NBQzNHLENBQUMsQ0FBQzs7QUFFSCxjQUFNLENBQUMsT0FBTyxDQUFDLGFBQWEsQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLEtBQUssRUFBRSxZQUFNO0FBQ2xELGlCQUFPLENBQUMsY0FBYyxDQUFDLEtBQUssRUFBRSxLQUFLLENBQUMsQ0FBQztBQUNyQyx1QkFBYSxDQUFDLFVBQVUsQ0FBQyxDQUFDO1NBQzNCLENBQUMsQ0FBQzs7S0FDSjtHQUNGLENBQUMsU0FBTSxDQUFDLFlBQU07QUFDYixRQUFNLGFBQWEsR0FBRyxNQUFNLENBQUMsR0FBRyxDQUFDLDZCQUE2QixDQUFDLENBQUM7QUFDaEUsVUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLFNBQVMsRUFBRSxhQUFhLENBQUMsRUFBRSxxRUFBcUUsQ0FBQyxDQUFDO0dBQy9HLENBQUMsQ0FBQztDQUNKIiwiZmlsZSI6Ii91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvbW9uaXRvcmluZy9zZXJ2ZXIva2liYW5hX21vbml0b3JpbmcvaW5kZXguanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgb3BzQnVmZmVyIGZyb20gJy4vbGliL29wc19idWZmZXInO1xuaW1wb3J0IHsgZ2V0IH0gZnJvbSAnbG9kYXNoJztcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gKHNlcnZlckluZm8sIHNlcnZlcikge1xuICBjb25zdCBjb25maWcgPSBzZXJ2ZXIuY29uZmlnKCk7XG4gIGNvbnN0IHsgY2FsbFdpdGhJbnRlcm5hbFVzZXJ9ID0gc2VydmVyLnBsdWdpbnMuZWxhc3RpY3NlYXJjaC5nZXRDbHVzdGVyKCdhZG1pbicpO1xuICBjYWxsV2l0aEludGVybmFsVXNlcigndHJhbnNwb3J0LnJlcXVlc3QnLCB7XG4gICAgbWV0aG9kOiAnR0VUJyxcbiAgICBwYXRoOiAnL194cGFjaydcbiAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgY29uc3QgaXNFbmFibGVkSW5BZG1pbkNsdXN0ZXIgPSAhIWdldChyZXMsICdmZWF0dXJlcy5tb25pdG9yaW5nLmVuYWJsZWQnKTtcbiAgICBpZiAoaXNFbmFibGVkSW5BZG1pbkNsdXN0ZXIgJiYgY29uZmlnLmdldCgneHBhY2subW9uaXRvcmluZy5raWJhbmEuY29sbGVjdGlvbi5lbmFibGVkJykpIHtcbiAgICAgIGNvbnN0IGJ1ZmZlciA9IG9wc0J1ZmZlcihzZXJ2ZXJJbmZvLCBzZXJ2ZXIpO1xuICAgICAgY29uc3QgbW9uaXRvciA9IHNlcnZlci5wbHVnaW5zWydldmVuLWJldHRlciddLm1vbml0b3I7XG4gICAgICBsZXQgb3BzSGFuZGxlcjtcblxuICAgICAgZnVuY3Rpb24gb25PcHMoZXZlbnQpIHtcbiAgICAgICAgYnVmZmVyLnB1c2goZXZlbnQpO1xuICAgICAgfVxuXG4gICAgICBzZXJ2ZXIucGx1Z2lucy5lbGFzdGljc2VhcmNoLnN0YXR1cy5vbignZ3JlZW4nLCAoKSA9PiB7XG4gICAgICAgIG1vbml0b3Iub24oJ29wcycsIG9uT3BzKTtcbiAgICAgICAgb3BzSGFuZGxlciA9IHNldEludGVydmFsKCgpID0+IGJ1ZmZlci5mbHVzaCgpLCBjb25maWcuZ2V0KCd4cGFjay5tb25pdG9yaW5nLmtpYmFuYS5jb2xsZWN0aW9uLmludGVydmFsJykpO1xuICAgICAgfSk7XG5cbiAgICAgIHNlcnZlci5wbHVnaW5zLmVsYXN0aWNzZWFyY2guc3RhdHVzLm9uKCdyZWQnLCAoKSA9PiB7XG4gICAgICAgIG1vbml0b3IucmVtb3ZlTGlzdGVuZXIoJ29wcycsIG9uT3BzKTtcbiAgICAgICAgY2xlYXJJbnRlcnZhbChvcHNIYW5kbGVyKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfSkuY2F0Y2goKCkgPT4ge1xuICAgIGNvbnN0IG1vbml0b3JpbmdUYWcgPSBjb25maWcuZ2V0KCd4cGFjay5tb25pdG9yaW5nLmxvZ2dpbmdUYWcnKTtcbiAgICBzZXJ2ZXIubG9nKFsnd2FybmluZycsIG1vbml0b3JpbmdUYWddLCAnVW5hYmxlIHRvIHJldHJpZXZlIFgtUGFjayBpbmZvLiBLaWJhbmEgbW9uaXRvcmluZyB3aWxsIGJlIGRpc2FibGVkLicpO1xuICB9KTtcbn1cbiJdfQ==",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/monitoring/server/kibana_monitoring/index.js"
      ],
      "names": [],
      "mappings": ";;;;;;;;6BAAsB,kBAAkB;;;;sBACpB,QAAQ;;qBAEb,UAAU,UAAU,EAAE,MAAM,EAAE;AAC3C,MAAM,MAAM,GAAG,MAAM,CAAC,MAAM,EAAE,CAAC;;iDACC,MAAM,CAAC,OAAO,CAAC,aAAa,CAAC,UAAU,CAAC,OAAO,CAAC;;MAAxE,oBAAoB,4CAApB,oBAAoB;;AAC5B,sBAAoB,CAAC,mBAAmB,EAAE;AACxC,UAAM,EAAE,KAAK;AACb,QAAI,EAAE,SAAS;GAChB,CAAC,CAAC,IAAI,CAAC,UAAC,GAAG,EAAK;AACf,QAAM,uBAAuB,GAAG,CAAC,CAAC,iBAAI,GAAG,EAAE,6BAA6B,CAAC,CAAC;AAC1E,QAAI,uBAAuB,IAAI,MAAM,CAAC,GAAG,CAAC,4CAA4C,CAAC,EAAE;;YAK9E,KAAK,GAAd,SAAS,KAAK,CAAC,KAAK,EAAE;AACpB,gBAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;SACpB;;AAND,YAAM,MAAM,GAAG,gCAAU,UAAU,EAAE,MAAM,CAAC,CAAC;AAC7C,YAAM,OAAO,GAAG,MAAM,CAAC,OAAO,CAAC,aAAa,CAAC,CAAC,OAAO,CAAC;AACtD,YAAI,UAAU,YAAA,CAAC;;AAMf,cAAM,CAAC,OAAO,CAAC,aAAa,CAAC,MAAM,CAAC,EAAE,CAAC,OAAO,EAAE,YAAM;AACpD,iBAAO,CAAC,EAAE,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC;AACzB,oBAAU,GAAG,WAAW,CAAC;mBAAM,MAAM,CAAC,KAAK,EAAE;WAAA,EAAE,MAAM,CAAC,GAAG,CAAC,6CAA6C,CAAC,CAAC,CAAC;SAC3G,CAAC,CAAC;;AAEH,cAAM,CAAC,OAAO,CAAC,aAAa,CAAC,MAAM,CAAC,EAAE,CAAC,KAAK,EAAE,YAAM;AAClD,iBAAO,CAAC,cAAc,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC;AACrC,uBAAa,CAAC,UAAU,CAAC,CAAC;SAC3B,CAAC,CAAC;;KACJ;GACF,CAAC,SAAM,CAAC,YAAM;AACb,QAAM,aAAa,GAAG,MAAM,CAAC,GAAG,CAAC,6BAA6B,CAAC,CAAC;AAChE,UAAM,CAAC,GAAG,CAAC,CAAC,SAAS,EAAE,aAAa,CAAC,EAAE,qEAAqE,CAAC,CAAC;GAC/G,CAAC,CAAC;CACJ",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/monitoring/server/kibana_monitoring/index.js",
      "sourcesContent": [
        "import opsBuffer from './lib/ops_buffer';\nimport { get } from 'lodash';\n\nexport default function (serverInfo, server) {\n  const config = server.config();\n  const { callWithInternalUser} = server.plugins.elasticsearch.getCluster('admin');\n  callWithInternalUser('transport.request', {\n    method: 'GET',\n    path: '/_xpack'\n  }).then((res) => {\n    const isEnabledInAdminCluster = !!get(res, 'features.monitoring.enabled');\n    if (isEnabledInAdminCluster && config.get('xpack.monitoring.kibana.collection.enabled')) {\n      const buffer = opsBuffer(serverInfo, server);\n      const monitor = server.plugins['even-better'].monitor;\n      let opsHandler;\n\n      function onOps(event) {\n        buffer.push(event);\n      }\n\n      server.plugins.elasticsearch.status.on('green', () => {\n        monitor.on('ops', onOps);\n        opsHandler = setInterval(() => buffer.flush(), config.get('xpack.monitoring.kibana.collection.interval'));\n      });\n\n      server.plugins.elasticsearch.status.on('red', () => {\n        monitor.removeListener('ops', onOps);\n        clearInterval(opsHandler);\n      });\n    }\n  }).catch(() => {\n    const monitoringTag = config.get('xpack.monitoring.loggingTag');\n    server.log(['warning', monitoringTag], 'Unable to retrieve X-Pack info. Kibana monitoring will be disabled.');\n  });\n}\n"
      ]
    },
    "mtime": 1491771510476
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/monitoring/server/kibana_monitoring/lib/ops_buffer.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "../../../common/constants",
            "imported": [
              "MONITORING_SYSTEM_API_VERSION",
              "KIBANA_SYSTEM_ID",
              "KIBANA_STATS_TYPE"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "MONITORING_SYSTEM_API_VERSION",
                "local": "MONITORING_SYSTEM_API_VERSION"
              },
              {
                "kind": "named",
                "imported": "KIBANA_SYSTEM_ID",
                "local": "KIBANA_SYSTEM_ID"
              },
              {
                "kind": "named",
                "imported": "KIBANA_STATS_TYPE",
                "local": "KIBANA_STATS_TYPE"
              }
            ]
          },
          {
            "source": "lodash",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "_"
              }
            ]
          },
          {
            "source": "./map_event",
            "imported": [
              "mapEvent",
              "rollupEvent"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "mapEvent",
                "local": "mapEvent"
              },
              {
                "kind": "named",
                "imported": "rollupEvent",
                "local": "rollupEvent"
              }
            ]
          },
          {
            "source": "./monitoring_bulk",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "monitoringBulk"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "opsBuffer",
            "serverInfo",
            "server"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "opsBuffer",
              "exported": "default"
            },
            {
              "kind": "local",
              "local": "serverInfo",
              "exported": "default"
            },
            {
              "kind": "local",
              "local": "server",
              "exported": "default"
            }
          ]
        }
      },
      "usedHelpers": [
        "interop-require-default"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nexports['default'] = opsBuffer;\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _commonConstants = require('../../../common/constants');\n\nvar _lodash = require('lodash');\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _map_event = require('./map_event');\n\nvar _monitoring_bulk = require('./monitoring_bulk');\n\nvar _monitoring_bulk2 = _interopRequireDefault(_monitoring_bulk);\n\nfunction opsBuffer(serverInfo, server) {\n  var config = server.config();\n  var interval = config.get('xpack.monitoring.kibana.collection.interval') + 'ms';\n  var monitoringTag = config.get('xpack.monitoring.loggingTag');\n  var client = server.plugins.elasticsearch.getCluster('admin').createClient({\n    plugins: [_monitoring_bulk2['default']]\n  });\n\n  var lastOp = null;\n\n  return {\n    push: function push(event) {\n      lastOp = {\n        host: event.host,\n        rollup: (0, _map_event.rollupEvent)(event, lastOp)\n      };\n\n      server.log(['debug', monitoringTag], 'Received Monitoring event data');\n    },\n    flush: function flush() {\n      if (!lastOp) return;\n\n      // grab the last operation\n      var payload = (0, _map_event.mapEvent)(lastOp, config, serverInfo);\n      var body = [\n      // Push the time-based information to .monitoring-kibana-*\n      { index: { _type: _commonConstants.KIBANA_STATS_TYPE } }, payload,\n      // Push the latest ops data to .monitoring-data index\n      { index: { _index: '_data', _type: _commonConstants.KIBANA_SYSTEM_ID, _id: _lodash2['default'].get(payload, 'kibana.uuid') } }, payload];\n\n      // reset lastOp\n      lastOp = null;\n\n      server.log(['debug', monitoringTag], 'Sending Monitoring payload to Elasticsearch');\n\n      return client.monitoring.bulk({\n        system_id: _commonConstants.KIBANA_SYSTEM_ID,\n        system_api_version: _commonConstants.MONITORING_SYSTEM_API_VERSION,\n        interval: interval,\n        body: body\n      })['catch'](function (err) {\n        server.log(['error', monitoringTag], err);\n      });\n    }\n  };\n}\n\nmodule.exports = exports['default'];\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvbW9uaXRvcmluZy9zZXJ2ZXIva2liYW5hX21vbml0b3JpbmcvbGliL29wc19idWZmZXIuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7cUJBT3dCLFNBQVM7Ozs7K0JBTDFCLDJCQUEyQjs7c0JBQ3BCLFFBQVE7Ozs7eUJBQ2dCLGFBQWE7OytCQUN4QixtQkFBbUI7Ozs7QUFFL0IsU0FBUyxTQUFTLENBQUMsVUFBVSxFQUFFLE1BQU0sRUFBRTtBQUNwRCxNQUFNLE1BQU0sR0FBRyxNQUFNLENBQUMsTUFBTSxFQUFFLENBQUM7QUFDL0IsTUFBTSxRQUFRLEdBQUcsTUFBTSxDQUFDLEdBQUcsQ0FBQyw2Q0FBNkMsQ0FBQyxHQUFHLElBQUksQ0FBQztBQUNsRixNQUFNLGFBQWEsR0FBRyxNQUFNLENBQUMsR0FBRyxDQUFDLDZCQUE2QixDQUFDLENBQUM7QUFDaEUsTUFBTSxNQUFNLEdBQUcsTUFBTSxDQUFDLE9BQU8sQ0FBQyxhQUFhLENBQUMsVUFBVSxDQUFDLE9BQU8sQ0FBQyxDQUFDLFlBQVksQ0FBQztBQUMzRSxXQUFPLEVBQUUsOEJBQWdCO0dBQzFCLENBQUMsQ0FBQzs7QUFFSCxNQUFJLE1BQU0sR0FBRyxJQUFJLENBQUM7O0FBRWxCLFNBQU87QUFDTCxRQUFJLEVBQUEsY0FBQyxLQUFLLEVBQUU7QUFDVixZQUFNLEdBQUc7QUFDUCxZQUFJLEVBQUUsS0FBSyxDQUFDLElBQUk7QUFDaEIsY0FBTSxFQUFFLDRCQUFZLEtBQUssRUFBRSxNQUFNLENBQUM7T0FDbkMsQ0FBQzs7QUFFRixZQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsT0FBTyxFQUFFLGFBQWEsQ0FBQyxFQUFFLGdDQUFnQyxDQUFDLENBQUM7S0FDeEU7QUFDRCxTQUFLLEVBQUEsaUJBQUc7QUFDTixVQUFJLENBQUMsTUFBTSxFQUFFLE9BQU87OztBQUdwQixVQUFNLE9BQU8sR0FBRyx5QkFBUyxNQUFNLEVBQUUsTUFBTSxFQUFFLFVBQVUsQ0FBQyxDQUFDO0FBQ3JELFVBQU0sSUFBSSxHQUFHOztBQUVYLFFBQUUsS0FBSyxFQUFFLEVBQUUsS0FBSyxvQ0FBbUIsRUFBRSxFQUFDLEVBQ3RDLE9BQU87O0FBRVAsUUFBQyxLQUFLLEVBQUUsRUFBRSxNQUFNLEVBQUUsT0FBTyxFQUFFLEtBQUssbUNBQWtCLEVBQUUsR0FBRyxFQUFFLG9CQUFFLEdBQUcsQ0FBQyxPQUFPLEVBQUUsYUFBYSxDQUFDLEVBQUUsRUFBQyxFQUN6RixPQUFPLENBQ1IsQ0FBQzs7O0FBR0YsWUFBTSxHQUFHLElBQUksQ0FBQzs7QUFFZCxZQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsT0FBTyxFQUFFLGFBQWEsQ0FBQyxFQUFFLDZDQUE2QyxDQUFDLENBQUM7O0FBRXBGLGFBQU8sTUFBTSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUM7QUFDNUIsaUJBQVMsbUNBQWtCO0FBQzNCLDBCQUFrQixnREFBK0I7QUFDakQsZ0JBQVEsRUFBUixRQUFRO0FBQ1IsWUFBSSxFQUFKLElBQUk7T0FDTCxDQUFDLFNBQ0ksQ0FBQyxVQUFDLEdBQUcsRUFBSztBQUNkLGNBQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxPQUFPLEVBQUUsYUFBYSxDQUFDLEVBQUUsR0FBRyxDQUFDLENBQUM7T0FDM0MsQ0FBQyxDQUFDO0tBQ0o7R0FDRixDQUFDO0NBQ0giLCJmaWxlIjoiL3Vzci9zaGFyZS9raWJhbmEvcGx1Z2lucy94LXBhY2svcGx1Z2lucy9tb25pdG9yaW5nL3NlcnZlci9raWJhbmFfbW9uaXRvcmluZy9saWIvb3BzX2J1ZmZlci5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIE1PTklUT1JJTkdfU1lTVEVNX0FQSV9WRVJTSU9OLCBLSUJBTkFfU1lTVEVNX0lELCBLSUJBTkFfU1RBVFNfVFlQRVxufSBmcm9tICcuLi8uLi8uLi9jb21tb24vY29uc3RhbnRzJztcbmltcG9ydCBfIGZyb20gJ2xvZGFzaCc7XG5pbXBvcnQgeyBtYXBFdmVudCwgcm9sbHVwRXZlbnQgfSBmcm9tICcuL21hcF9ldmVudCc7XG5pbXBvcnQgbW9uaXRvcmluZ0J1bGsgZnJvbSAnLi9tb25pdG9yaW5nX2J1bGsnO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBvcHNCdWZmZXIoc2VydmVySW5mbywgc2VydmVyKSB7XG4gIGNvbnN0IGNvbmZpZyA9IHNlcnZlci5jb25maWcoKTtcbiAgY29uc3QgaW50ZXJ2YWwgPSBjb25maWcuZ2V0KCd4cGFjay5tb25pdG9yaW5nLmtpYmFuYS5jb2xsZWN0aW9uLmludGVydmFsJykgKyAnbXMnO1xuICBjb25zdCBtb25pdG9yaW5nVGFnID0gY29uZmlnLmdldCgneHBhY2subW9uaXRvcmluZy5sb2dnaW5nVGFnJyk7XG4gIGNvbnN0IGNsaWVudCA9IHNlcnZlci5wbHVnaW5zLmVsYXN0aWNzZWFyY2guZ2V0Q2x1c3RlcignYWRtaW4nKS5jcmVhdGVDbGllbnQoe1xuICAgIHBsdWdpbnM6IFttb25pdG9yaW5nQnVsa11cbiAgfSk7XG5cbiAgbGV0IGxhc3RPcCA9IG51bGw7XG5cbiAgcmV0dXJuIHtcbiAgICBwdXNoKGV2ZW50KSB7XG4gICAgICBsYXN0T3AgPSB7XG4gICAgICAgIGhvc3Q6IGV2ZW50Lmhvc3QsXG4gICAgICAgIHJvbGx1cDogcm9sbHVwRXZlbnQoZXZlbnQsIGxhc3RPcClcbiAgICAgIH07XG5cbiAgICAgIHNlcnZlci5sb2coWydkZWJ1ZycsIG1vbml0b3JpbmdUYWddLCAnUmVjZWl2ZWQgTW9uaXRvcmluZyBldmVudCBkYXRhJyk7XG4gICAgfSxcbiAgICBmbHVzaCgpIHtcbiAgICAgIGlmICghbGFzdE9wKSByZXR1cm47XG5cbiAgICAgIC8vIGdyYWIgdGhlIGxhc3Qgb3BlcmF0aW9uXG4gICAgICBjb25zdCBwYXlsb2FkID0gbWFwRXZlbnQobGFzdE9wLCBjb25maWcsIHNlcnZlckluZm8pO1xuICAgICAgY29uc3QgYm9keSA9IFtcbiAgICAgICAgLy8gUHVzaCB0aGUgdGltZS1iYXNlZCBpbmZvcm1hdGlvbiB0byAubW9uaXRvcmluZy1raWJhbmEtKlxuICAgICAgICB7IGluZGV4OiB7IF90eXBlOiBLSUJBTkFfU1RBVFNfVFlQRSB9fSxcbiAgICAgICAgcGF5bG9hZCxcbiAgICAgICAgLy8gUHVzaCB0aGUgbGF0ZXN0IG9wcyBkYXRhIHRvIC5tb25pdG9yaW5nLWRhdGEgaW5kZXhcbiAgICAgICAge2luZGV4OiB7IF9pbmRleDogJ19kYXRhJywgX3R5cGU6IEtJQkFOQV9TWVNURU1fSUQsIF9pZDogXy5nZXQocGF5bG9hZCwgJ2tpYmFuYS51dWlkJykgfX0sXG4gICAgICAgIHBheWxvYWRcbiAgICAgIF07XG5cbiAgICAgIC8vIHJlc2V0IGxhc3RPcFxuICAgICAgbGFzdE9wID0gbnVsbDtcblxuICAgICAgc2VydmVyLmxvZyhbJ2RlYnVnJywgbW9uaXRvcmluZ1RhZ10sICdTZW5kaW5nIE1vbml0b3JpbmcgcGF5bG9hZCB0byBFbGFzdGljc2VhcmNoJyk7XG5cbiAgICAgIHJldHVybiBjbGllbnQubW9uaXRvcmluZy5idWxrKHtcbiAgICAgICAgc3lzdGVtX2lkOiBLSUJBTkFfU1lTVEVNX0lELFxuICAgICAgICBzeXN0ZW1fYXBpX3ZlcnNpb246IE1PTklUT1JJTkdfU1lTVEVNX0FQSV9WRVJTSU9OLFxuICAgICAgICBpbnRlcnZhbCxcbiAgICAgICAgYm9keVxuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIHNlcnZlci5sb2coWydlcnJvcicsIG1vbml0b3JpbmdUYWddLCBlcnIpO1xuICAgICAgfSk7XG4gICAgfVxuICB9O1xufVxuIl19",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/monitoring/server/kibana_monitoring/lib/ops_buffer.js"
      ],
      "names": [],
      "mappings": ";;;;;qBAOwB,SAAS;;;;+BAL1B,2BAA2B;;sBACpB,QAAQ;;;;yBACgB,aAAa;;+BACxB,mBAAmB;;;;AAE/B,SAAS,SAAS,CAAC,UAAU,EAAE,MAAM,EAAE;AACpD,MAAM,MAAM,GAAG,MAAM,CAAC,MAAM,EAAE,CAAC;AAC/B,MAAM,QAAQ,GAAG,MAAM,CAAC,GAAG,CAAC,6CAA6C,CAAC,GAAG,IAAI,CAAC;AAClF,MAAM,aAAa,GAAG,MAAM,CAAC,GAAG,CAAC,6BAA6B,CAAC,CAAC;AAChE,MAAM,MAAM,GAAG,MAAM,CAAC,OAAO,CAAC,aAAa,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC,YAAY,CAAC;AAC3E,WAAO,EAAE,8BAAgB;GAC1B,CAAC,CAAC;;AAEH,MAAI,MAAM,GAAG,IAAI,CAAC;;AAElB,SAAO;AACL,QAAI,EAAA,cAAC,KAAK,EAAE;AACV,YAAM,GAAG;AACP,YAAI,EAAE,KAAK,CAAC,IAAI;AAChB,cAAM,EAAE,4BAAY,KAAK,EAAE,MAAM,CAAC;OACnC,CAAC;;AAEF,YAAM,CAAC,GAAG,CAAC,CAAC,OAAO,EAAE,aAAa,CAAC,EAAE,gCAAgC,CAAC,CAAC;KACxE;AACD,SAAK,EAAA,iBAAG;AACN,UAAI,CAAC,MAAM,EAAE,OAAO;;;AAGpB,UAAM,OAAO,GAAG,yBAAS,MAAM,EAAE,MAAM,EAAE,UAAU,CAAC,CAAC;AACrD,UAAM,IAAI,GAAG;;AAEX,QAAE,KAAK,EAAE,EAAE,KAAK,oCAAmB,EAAE,EAAC,EACtC,OAAO;;AAEP,QAAC,KAAK,EAAE,EAAE,MAAM,EAAE,OAAO,EAAE,KAAK,mCAAkB,EAAE,GAAG,EAAE,oBAAE,GAAG,CAAC,OAAO,EAAE,aAAa,CAAC,EAAE,EAAC,EACzF,OAAO,CACR,CAAC;;;AAGF,YAAM,GAAG,IAAI,CAAC;;AAEd,YAAM,CAAC,GAAG,CAAC,CAAC,OAAO,EAAE,aAAa,CAAC,EAAE,6CAA6C,CAAC,CAAC;;AAEpF,aAAO,MAAM,CAAC,UAAU,CAAC,IAAI,CAAC;AAC5B,iBAAS,mCAAkB;AAC3B,0BAAkB,gDAA+B;AACjD,gBAAQ,EAAR,QAAQ;AACR,YAAI,EAAJ,IAAI;OACL,CAAC,SACI,CAAC,UAAC,GAAG,EAAK;AACd,cAAM,CAAC,GAAG,CAAC,CAAC,OAAO,EAAE,aAAa,CAAC,EAAE,GAAG,CAAC,CAAC;OAC3C,CAAC,CAAC;KACJ;GACF,CAAC;CACH",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/monitoring/server/kibana_monitoring/lib/ops_buffer.js",
      "sourcesContent": [
        "import {\n  MONITORING_SYSTEM_API_VERSION, KIBANA_SYSTEM_ID, KIBANA_STATS_TYPE\n} from '../../../common/constants';\nimport _ from 'lodash';\nimport { mapEvent, rollupEvent } from './map_event';\nimport monitoringBulk from './monitoring_bulk';\n\nexport default function opsBuffer(serverInfo, server) {\n  const config = server.config();\n  const interval = config.get('xpack.monitoring.kibana.collection.interval') + 'ms';\n  const monitoringTag = config.get('xpack.monitoring.loggingTag');\n  const client = server.plugins.elasticsearch.getCluster('admin').createClient({\n    plugins: [monitoringBulk]\n  });\n\n  let lastOp = null;\n\n  return {\n    push(event) {\n      lastOp = {\n        host: event.host,\n        rollup: rollupEvent(event, lastOp)\n      };\n\n      server.log(['debug', monitoringTag], 'Received Monitoring event data');\n    },\n    flush() {\n      if (!lastOp) return;\n\n      // grab the last operation\n      const payload = mapEvent(lastOp, config, serverInfo);\n      const body = [\n        // Push the time-based information to .monitoring-kibana-*\n        { index: { _type: KIBANA_STATS_TYPE }},\n        payload,\n        // Push the latest ops data to .monitoring-data index\n        {index: { _index: '_data', _type: KIBANA_SYSTEM_ID, _id: _.get(payload, 'kibana.uuid') }},\n        payload\n      ];\n\n      // reset lastOp\n      lastOp = null;\n\n      server.log(['debug', monitoringTag], 'Sending Monitoring payload to Elasticsearch');\n\n      return client.monitoring.bulk({\n        system_id: KIBANA_SYSTEM_ID,\n        system_api_version: MONITORING_SYSTEM_API_VERSION,\n        interval,\n        body\n      })\n      .catch((err) => {\n        server.log(['error', monitoringTag], err);\n      });\n    }\n  };\n}\n"
      ]
    },
    "mtime": 1491771513555
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/monitoring/common/constants.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [],
        "exports": {
          "exported": [
            "MONITORING_SYSTEM_API_VERSION",
            "KIBANA_SYSTEM_ID",
            "KIBANA_STATS_TYPE",
            "PHONE_HOME_FEATURE",
            "PHONE_HOME_NOTIFICATION_SEEN",
            "CHART_LINE_COLOR",
            "CHART_TEXT_COLOR"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "MONITORING_SYSTEM_API_VERSION",
              "exported": "MONITORING_SYSTEM_API_VERSION"
            },
            {
              "kind": "local",
              "local": "KIBANA_SYSTEM_ID",
              "exported": "KIBANA_SYSTEM_ID"
            },
            {
              "kind": "local",
              "local": "KIBANA_STATS_TYPE",
              "exported": "KIBANA_STATS_TYPE"
            },
            {
              "kind": "local",
              "local": "PHONE_HOME_FEATURE",
              "exported": "PHONE_HOME_FEATURE"
            },
            {
              "kind": "local",
              "local": "PHONE_HOME_NOTIFICATION_SEEN",
              "exported": "PHONE_HOME_NOTIFICATION_SEEN"
            },
            {
              "kind": "local",
              "local": "CHART_LINE_COLOR",
              "exported": "CHART_LINE_COLOR"
            },
            {
              "kind": "local",
              "local": "CHART_TEXT_COLOR",
              "exported": "CHART_TEXT_COLOR"
            }
          ]
        }
      },
      "usedHelpers": []
    },
    "ignored": false,
    "code": "/**\n * The Monitoring API version is the expected API format that we export and expect to import.\n * @type {string}\n */\n'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nvar MONITORING_SYSTEM_API_VERSION = '2';\nexports.MONITORING_SYSTEM_API_VERSION = MONITORING_SYSTEM_API_VERSION;\n/**\n * The name of the Kibana System ID used to publish Kibana stats through the Monitoring system.\n * @type {string}\n */\nvar KIBANA_SYSTEM_ID = 'kibana';\nexports.KIBANA_SYSTEM_ID = KIBANA_SYSTEM_ID;\n/**\n * The type name used within the Monitoring index to publish Kibana stats.\n * @type {string}\n */\nvar KIBANA_STATS_TYPE = 'kibana_stats';\n\nexports.KIBANA_STATS_TYPE = KIBANA_STATS_TYPE;\n/*\n * name of the boolean feature flag for phone home in local storage\n */\nvar PHONE_HOME_FEATURE = 'report';\nexports.PHONE_HOME_FEATURE = PHONE_HOME_FEATURE;\n/*\n * name of the boolean for phone home if the notification has been dismissed\n */\nvar PHONE_HOME_NOTIFICATION_SEEN = 'report_notification_seen';\n\nexports.PHONE_HOME_NOTIFICATION_SEEN = PHONE_HOME_NOTIFICATION_SEEN;\n/*\n * Chart colors\n */\nvar CHART_LINE_COLOR = '#d2d2d2';\nexports.CHART_LINE_COLOR = CHART_LINE_COLOR;\nvar CHART_TEXT_COLOR = '#9c9c9c';\nexports.CHART_TEXT_COLOR = CHART_TEXT_COLOR;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvbW9uaXRvcmluZy9jb21tb24vY29uc3RhbnRzLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUlPLElBQU0sNkJBQTZCLEdBQUcsR0FBRyxDQUFDOzs7Ozs7QUFLMUMsSUFBTSxnQkFBZ0IsR0FBRyxRQUFRLENBQUM7Ozs7OztBQUtsQyxJQUFNLGlCQUFpQixHQUFHLGNBQWMsQ0FBQzs7Ozs7O0FBS3pDLElBQU0sa0JBQWtCLEdBQUcsUUFBUSxDQUFDOzs7OztBQUlwQyxJQUFNLDRCQUE0QixHQUFHLDBCQUEwQixDQUFDOzs7Ozs7QUFLaEUsSUFBTSxnQkFBZ0IsR0FBRyxTQUFTLENBQUM7O0FBQ25DLElBQU0sZ0JBQWdCLEdBQUcsU0FBUyxDQUFDIiwiZmlsZSI6Ii91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvbW9uaXRvcmluZy9jb21tb24vY29uc3RhbnRzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBUaGUgTW9uaXRvcmluZyBBUEkgdmVyc2lvbiBpcyB0aGUgZXhwZWN0ZWQgQVBJIGZvcm1hdCB0aGF0IHdlIGV4cG9ydCBhbmQgZXhwZWN0IHRvIGltcG9ydC5cbiAqIEB0eXBlIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBjb25zdCBNT05JVE9SSU5HX1NZU1RFTV9BUElfVkVSU0lPTiA9ICcyJztcbi8qKlxuICogVGhlIG5hbWUgb2YgdGhlIEtpYmFuYSBTeXN0ZW0gSUQgdXNlZCB0byBwdWJsaXNoIEtpYmFuYSBzdGF0cyB0aHJvdWdoIHRoZSBNb25pdG9yaW5nIHN5c3RlbS5cbiAqIEB0eXBlIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBjb25zdCBLSUJBTkFfU1lTVEVNX0lEID0gJ2tpYmFuYSc7XG4vKipcbiAqIFRoZSB0eXBlIG5hbWUgdXNlZCB3aXRoaW4gdGhlIE1vbml0b3JpbmcgaW5kZXggdG8gcHVibGlzaCBLaWJhbmEgc3RhdHMuXG4gKiBAdHlwZSB7c3RyaW5nfVxuICovXG5leHBvcnQgY29uc3QgS0lCQU5BX1NUQVRTX1RZUEUgPSAna2liYW5hX3N0YXRzJztcblxuLypcbiAqIG5hbWUgb2YgdGhlIGJvb2xlYW4gZmVhdHVyZSBmbGFnIGZvciBwaG9uZSBob21lIGluIGxvY2FsIHN0b3JhZ2VcbiAqL1xuZXhwb3J0IGNvbnN0IFBIT05FX0hPTUVfRkVBVFVSRSA9ICdyZXBvcnQnO1xuLypcbiAqIG5hbWUgb2YgdGhlIGJvb2xlYW4gZm9yIHBob25lIGhvbWUgaWYgdGhlIG5vdGlmaWNhdGlvbiBoYXMgYmVlbiBkaXNtaXNzZWRcbiAqL1xuZXhwb3J0IGNvbnN0IFBIT05FX0hPTUVfTk9USUZJQ0FUSU9OX1NFRU4gPSAncmVwb3J0X25vdGlmaWNhdGlvbl9zZWVuJztcblxuLypcbiAqIENoYXJ0IGNvbG9yc1xuICovXG5leHBvcnQgY29uc3QgQ0hBUlRfTElORV9DT0xPUiA9ICcjZDJkMmQyJztcbmV4cG9ydCBjb25zdCBDSEFSVF9URVhUX0NPTE9SID0gJyM5YzljOWMnO1xuIl19",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/monitoring/common/constants.js"
      ],
      "names": [],
      "mappings": ";;;;;;;;;AAIO,IAAM,6BAA6B,GAAG,GAAG,CAAC;;;;;;AAK1C,IAAM,gBAAgB,GAAG,QAAQ,CAAC;;;;;;AAKlC,IAAM,iBAAiB,GAAG,cAAc,CAAC;;;;;;AAKzC,IAAM,kBAAkB,GAAG,QAAQ,CAAC;;;;;AAIpC,IAAM,4BAA4B,GAAG,0BAA0B,CAAC;;;;;;AAKhE,IAAM,gBAAgB,GAAG,SAAS,CAAC;;AACnC,IAAM,gBAAgB,GAAG,SAAS,CAAC",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/monitoring/common/constants.js",
      "sourcesContent": [
        "/**\n * The Monitoring API version is the expected API format that we export and expect to import.\n * @type {string}\n */\nexport const MONITORING_SYSTEM_API_VERSION = '2';\n/**\n * The name of the Kibana System ID used to publish Kibana stats through the Monitoring system.\n * @type {string}\n */\nexport const KIBANA_SYSTEM_ID = 'kibana';\n/**\n * The type name used within the Monitoring index to publish Kibana stats.\n * @type {string}\n */\nexport const KIBANA_STATS_TYPE = 'kibana_stats';\n\n/*\n * name of the boolean feature flag for phone home in local storage\n */\nexport const PHONE_HOME_FEATURE = 'report';\n/*\n * name of the boolean for phone home if the notification has been dismissed\n */\nexport const PHONE_HOME_NOTIFICATION_SEEN = 'report_notification_seen';\n\n/*\n * Chart colors\n */\nexport const CHART_LINE_COLOR = '#d2d2d2';\nexport const CHART_TEXT_COLOR = '#9c9c9c';\n"
      ]
    },
    "mtime": 1491771507910
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/monitoring/server/kibana_monitoring/lib/map_event.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "./map_requests",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "mapRequests"
              }
            ]
          },
          {
            "source": "./map_response_times",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "mapResponseTimes"
              }
            ]
          },
          {
            "source": "./map_concurrent_connections",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "mapConcurrents"
              }
            ]
          },
          {
            "source": "moment",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "moment"
              }
            ]
          },
          {
            "source": "v8",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "v8"
              }
            ]
          },
          {
            "source": "lodash",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "_"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "rollupEvent",
            "event",
            "lastOp",
            "mapEvent",
            "lastOp",
            "config",
            "serverInfo"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "rollupEvent",
              "exported": "rollupEvent"
            },
            {
              "kind": "local",
              "local": "event",
              "exported": "event"
            },
            {
              "kind": "local",
              "local": "lastOp",
              "exported": "lastOp"
            },
            {
              "kind": "local",
              "local": "mapEvent",
              "exported": "mapEvent"
            },
            {
              "kind": "local",
              "local": "lastOp",
              "exported": "lastOp"
            },
            {
              "kind": "local",
              "local": "config",
              "exported": "config"
            },
            {
              "kind": "local",
              "local": "serverInfo",
              "exported": "serverInfo"
            }
          ]
        }
      },
      "usedHelpers": [
        "extends",
        "interop-require-default"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nexports.rollupEvent = rollupEvent;\nexports.mapEvent = mapEvent;\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _map_requests = require('./map_requests');\n\nvar _map_requests2 = _interopRequireDefault(_map_requests);\n\nvar _map_response_times = require('./map_response_times');\n\nvar _map_response_times2 = _interopRequireDefault(_map_response_times);\n\nvar _map_concurrent_connections = require('./map_concurrent_connections');\n\nvar _map_concurrent_connections2 = _interopRequireDefault(_map_concurrent_connections);\n\nvar _moment = require('moment');\n\nvar _moment2 = _interopRequireDefault(_moment);\n\nvar _v8 = require('v8');\n\nvar _v82 = _interopRequireDefault(_v8);\n\nvar _lodash = require('lodash');\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nfunction secondsToMilliseconds(seconds) {\n  return seconds * 1000;\n}\n\nvar snapshotRegex = /-snapshot/i;\n// rollup functions are for objects with unpredictable keys (e.g., {'200': 1, '201': 2} + {'200':2} = {'200': 3, '201': 2})\nvar maxRollup = _lodash2['default'].partialRight(_lodash2['default'].assign, function (latest, prev) {\n  return _lodash2['default'].max([latest, prev]);\n});\nvar sumRollup = _lodash2['default'].partialRight(_lodash2['default'].assign, function (latest, prev) {\n  return _lodash2['default'].sum([latest, prev]);\n});\n\n/**\n * Some components of the {@code event} need to be combined with any previous events that haven't been sent in order to not lose information\n * if the collection interval is faster than the flushing interval.\n *\n * @param event {Object} The current event\n * @param lastOp {Object} The previous event details\n */\n\nfunction rollupEvent(event, lastOp) {\n  var heapStats = _v82['default'].getHeapStatistics();\n  var requests = (0, _map_requests2['default'])(event.requests);\n  var rollup = _lodash2['default'].get(lastOp, 'rollup');\n  return {\n    concurrent_connections: _lodash2['default'].sum([(0, _map_concurrent_connections2['default'])(event.concurrents), _lodash2['default'].get(rollup, 'concurrent_connections')]),\n    // memory/os stats use the latest event's details\n    os: {\n      load: {\n        '1m': event.osload[0],\n        '5m': event.osload[1],\n        '15m': event.osload[2]\n      },\n      memory: {\n        total_in_bytes: event.osmem.total,\n        free_in_bytes: event.osmem.free,\n        used_in_bytes: event.osmem.total - event.osmem.free\n      },\n      uptime_in_millis: secondsToMilliseconds(event.osup)\n    },\n    process: {\n      event_loop_delay: _lodash2['default'].sum([event.psdelay, _lodash2['default'].get(rollup, 'process.event_loop_delay')]),\n      memory: {\n        heap: {\n          total_in_bytes: event.psmem.heapTotal,\n          used_in_bytes: event.psmem.heapUsed,\n          size_limit: heapStats.heap_size_limit\n        },\n        resident_set_size_in_bytes: event.psmem.rss\n      },\n      uptime_in_millis: secondsToMilliseconds(event.psup)\n    },\n    requests: {\n      disconnects: _lodash2['default'].sum([requests.disconnects, _lodash2['default'].get(rollup, 'requests.disconnects')]),\n      total: _lodash2['default'].sum([requests.total, _lodash2['default'].get(rollup, 'requests.total')]),\n      status_codes: sumRollup(requests.status_codes, _lodash2['default'].get(rollup, 'requests.status_codes'))\n    },\n    response_times: maxRollup((0, _map_response_times2['default'])(event.responseTimes), _lodash2['default'].get(rollup, 'response_times')),\n    timestamp: _moment2['default'].utc().toISOString()\n  };\n}\n\nfunction mapEvent(lastOp, config, serverInfo) {\n  var status = serverInfo.status.toJSON();\n  var host = lastOp.host;\n  var rollup = lastOp.rollup;\n\n  return _extends({\n    kibana: {\n      uuid: config.get('server.uuid'),\n      name: config.get('server.name'),\n      host: host,\n      transport_address: config.get('server.host') + ':' + config.get('server.port'),\n      version: serverInfo.version.replace(snapshotRegex, ''),\n      snapshot: snapshotRegex.test(serverInfo.version),\n      status: _lodash2['default'].get(status, 'overall.state')\n    }\n  }, rollup);\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvbW9uaXRvcmluZy9zZXJ2ZXIva2liYW5hX21vbml0b3JpbmcvbGliL21hcF9ldmVudC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OzRCQUF3QixnQkFBZ0I7Ozs7a0NBQ1gsc0JBQXNCOzs7OzBDQUN4Qiw4QkFBOEI7Ozs7c0JBQ3RDLFFBQVE7Ozs7a0JBQ1osSUFBSTs7OztzQkFFTCxRQUFROzs7O0FBRXRCLFNBQVMscUJBQXFCLENBQUMsT0FBTyxFQUFFO0FBQ3RDLFNBQU8sT0FBTyxHQUFHLElBQUksQ0FBQztDQUN2Qjs7QUFFRCxJQUFNLGFBQWEsR0FBRyxZQUFZLENBQUM7O0FBRW5DLElBQU0sU0FBUyxHQUFHLG9CQUFFLFlBQVksQ0FBQyxvQkFBRSxNQUFNLEVBQUUsVUFBQyxNQUFNLEVBQUUsSUFBSTtTQUFLLG9CQUFFLEdBQUcsQ0FBQyxDQUFDLE1BQU0sRUFBRSxJQUFJLENBQUMsQ0FBQztDQUFBLENBQUMsQ0FBQztBQUNwRixJQUFNLFNBQVMsR0FBRyxvQkFBRSxZQUFZLENBQUMsb0JBQUUsTUFBTSxFQUFFLFVBQUMsTUFBTSxFQUFFLElBQUk7U0FBSyxvQkFBRSxHQUFHLENBQUMsQ0FBQyxNQUFNLEVBQUUsSUFBSSxDQUFDLENBQUM7Q0FBQSxDQUFDLENBQUM7Ozs7Ozs7Ozs7QUFTN0UsU0FBUyxXQUFXLENBQUMsS0FBSyxFQUFFLE1BQU0sRUFBRTtBQUN6QyxNQUFNLFNBQVMsR0FBRyxnQkFBRyxpQkFBaUIsRUFBRSxDQUFDO0FBQ3pDLE1BQU0sUUFBUSxHQUFHLCtCQUFZLEtBQUssQ0FBQyxRQUFRLENBQUMsQ0FBQztBQUM3QyxNQUFNLE1BQU0sR0FBRyxvQkFBRSxHQUFHLENBQUMsTUFBTSxFQUFFLFFBQVEsQ0FBQyxDQUFDO0FBQ3ZDLFNBQU87QUFDTCwwQkFBc0IsRUFBRSxvQkFBRSxHQUFHLENBQUMsQ0FBRSw2Q0FBZSxLQUFLLENB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LEVBQUUsYUFBYSxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsT0FBTyxDQUFDO0FBQ2hELFlBQU0sRUFBRSxvQkFBRSxHQUFHLENBQUMsTUFBTSxFQUFFLGVBQWUsQ0FBQztLQUN2QztLQUNFLE1BQU0sRUFDVDtDQUNIIiwiZmlsZSI6Ii91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvbW9uaXRvcmluZy9zZXJ2ZXIva2liYW5hX21vbml0b3JpbmcvbGliL21hcF9ldmVudC5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBtYXBSZXF1ZXN0cyBmcm9tICcuL21hcF9yZXF1ZXN0cyc7XG5pbXBvcnQgbWFwUmVzcG9uc2VUaW1lcyBmcm9tICcuL21hcF9yZXNwb25zZV90aW1lcyc7XG5pbXBvcnQgbWFwQ29uY3VycmVudHMgZnJvbSAnLi9tYXBfY29uY3VycmVudF9jb25uZWN0aW9ucyc7XG5pbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCc7XG5pbXBvcnQgdjggZnJvbSAndjgnO1xuXG5pbXBvcnQgXyBmcm9tICdsb2Rhc2gnO1xuXG5mdW5jdGlvbiBzZWNvbmRzVG9NaWxsaXNlY29uZHMoc2Vjb25kcykge1xuICByZXR1cm4gc2Vjb25kcyAqIDEwMDA7XG59XG5cbmNvbnN0IHNuYXBzaG90UmVnZXggPSAvLXNuYXBzaG90L2k7XG4vLyByb2xsdXAgZnVuY3Rpb25zIGFyZSBmb3Igb2JqZWN0cyB3aXRoIHVucHJlZGljdGFibGUga2V5cyAoZS5nLiwgeycyMDAnOiAxLCAnMjAxJzogMn0gKyB7JzIwMCc6Mn0gPSB7JzIwMCc6IDMsICcyMDEnOiAyfSlcbmNvbnN0IG1heFJvbGx1cCA9IF8ucGFydGlhbFJpZ2h0KF8uYXNzaWduLCAobGF0ZXN0LCBwcmV2KSA9PiBfLm1heChbbGF0ZXN0LCBwcmV2XSkpO1xuY29uc3Qgc3VtUm9sbHVwID0gXy5wYXJ0aWFsUmlnaHQoXy5hc3NpZ24sIChsYXRlc3QsIHByZXYpID0+IF8uc3VtKFtsYXRlc3QsIHByZXZdKSk7XG5cbi8qKlxuICogU29tZSBjb21wb25lbnRzIG9mIHRoZSB7QGNvZGUgZXZlbnR9IG5lZWQgdG8gYmUgY29tYmluZWQgd2l0aCBhbnkgcHJldmlvdXMgZXZlbnRzIHRoYXQgaGF2ZW4ndCBiZWVuIHNlbnQgaW4gb3JkZXIgdG8gbm90IGxvc2UgaW5mb3JtYXRpb25cbiAqIGlmIHRoZSBjb2xsZWN0aW9uIGludGVydmFsIGlzIGZhc3RlciB0aGFuIHRoZSBmbHVzaGluZyBpbnRlcnZhbC5cbiAqXG4gKiBAcGFyYW0gZXZlbnQge09iamVjdH0gVGhlIGN1cnJlbnQgZXZlbnRcbiAqIEBwYXJhbSBsYXN0T3Age09iamVjdH0gVGhlIHByZXZpb3VzIGV2ZW50IGRldGFpbHNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJvbGx1cEV2ZW50KGV2ZW50LCBsYXN0T3ApIHtcbiAgY29uc3QgaGVhcFN0YXRzID0gdjguZ2V0SGVhcFN0YXRpc3RpY3MoKTtcbiAgY29uc3QgcmVxdWVzdHMgPSBtYXBSZXF1ZXN0cyhldmVudC5yZXF1ZXN0cyk7XG4gIGNvbnN0IHJvbGx1cCA9IF8uZ2V0KGxhc3RPcCwgJ3JvbGx1cCcpO1xuICByZXR1cm4ge1xuICAgIGNvbmN1cnJlbnRfY29ubmVjdGlvbnM6IF8uc3VtKFsgbWFwQ29uY3VycmVudHMoZXZlbnQuY29uY3VycmVudHMpLCBfLmdldChyb2xsdXAsICdjb25jdXJyZW50X2Nvbm5lY3Rpb25zJykgXSksXG4gICAgLy8gbWVtb3J5L29zIHN0YXRzIHVzZSB0aGUgbGF0ZXN0IGV2ZW50J3MgZGV0YWlsc1xuICAgIG9zOiB7XG4gICAgICBsb2FkOiB7XG4gICAgICAgICcxbSc6IGV2ZW50Lm9zbG9hZFswXSxcbiAgICAgICAgJzVtJzogZXZlbnQub3Nsb2FkWzFdLFxuICAgICAgICAnMTVtJzogZXZlbnQub3Nsb2FkWzJdXG4gICAgICB9LFxuICAgICAgbWVtb3J5OiB7XG4gICAgICAgIHRvdGFsX2luX2J5dGVzOiBldmVudC5vc21lbS50b3RhbCxcbiAgICAgICAgZnJlZV9pbl9ieXRlczogZXZlbnQub3NtZW0uZnJlZSxcbiAgICAgICAgdXNlZF9pbl9ieXRlczogZXZlbnQub3NtZW0udG90YWwgLSBldmVudC5vc21lbS5mcmVlXG4gICAgICB9LFxuICAgICAgdXB0aW1lX2luX21pbGxpczogc2Vjb25kc1RvTWlsbGlzZWNvbmRzKGV2ZW50Lm9zdXApXG4gICAgfSxcbiAgICBwcm9jZXNzOiB7XG4gICAgICBldmVudF9sb29wX2RlbGF5OiBfLnN1bShbIGV2ZW50LnBzZGVsYXksIF8uZ2V0KHJvbGx1cCwgJ3Byb2Nlc3MuZXZlbnRfbG9vcF9kZWxheScpIF0pLFxuICAgICAgbWVtb3J5OiB7XG4gICAgICAgIGhlYXA6IHtcbiAgICAgICAgICB0b3RhbF9pbl9ieXRlczogZXZlbnQucHNtZW0uaGVhcFRvdGFsLFxuICAgICAgICAgIHVzZWRfaW5fYnl0ZXM6IGV2ZW50LnBzbWVtLmhlYXBVc2VkLFxuICAgICAgICAgIHNpemVfbGltaXQ6IGhlYXBTdGF0cy5oZWFwX3NpemVfbGltaXRcbiAgICAgICAgfSxcbiAgICAgICAgcmVzaWRlbnRfc2V0X3NpemVfaW5fYnl0ZXM6IGV2ZW50LnBzbWVtLnJzc1xuICAgICAgfSxcbiAgICAgIHVwdGltZV9pbl9taWxsaXM6IHNlY29uZHNUb01pbGxpc2Vjb25kcyhldmVudC5wc3VwKVxuICAgIH0sXG4gICAgcmVxdWVzdHM6IHtcbiAgICAgIGRpc2Nvbm5lY3RzOiBfLnN1bShbIHJlcXVlc3RzLmRpc2Nvbm5lY3RzLCBfLmdldChyb2xsdXAsICdyZXF1ZXN0cy5kaXNjb25uZWN0cycpIF0pLFxuICAgICAgdG90YWw6IF8uc3VtKFsgcmVxdWVzdHMudG90YWwsIF8uZ2V0KHJvbGx1cCwgJ3JlcXVlc3RzLnRvdGFsJykgXSksXG4gICAgICBzdGF0dXNfY29kZXM6IHN1bVJvbGx1cChyZXF1ZXN0cy5zdGF0dXNfY29kZXMsIF8uZ2V0KHJvbGx1cCwgJ3JlcXVlc3RzLnN0YXR1c19jb2RlcycpKVxuICAgIH0sXG4gICAgcmVzcG9uc2VfdGltZXM6IG1heFJvbGx1cChtYXBSZXNwb25zZVRpbWVzKGV2ZW50LnJlc3BvbnNlVGltZXMpLCBfLmdldChyb2xsdXAsICdyZXNwb25zZV90aW1lcycpKSxcbiAgICB0aW1lc3RhbXA6IG1vbWVudC51dGMoKS50b0lTT1N0cmluZygpXG4gIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBtYXBFdmVudChsYXN0T3AsIGNvbmZpZywgc2VydmVySW5mbykge1xuICBjb25zdCBzdGF0dXMgPSBzZXJ2ZXJJbmZvLnN0YXR1cy50b0pTT04oKTtcbiAgY29uc3QgeyBob3N0LCByb2xsdXAgfSA9IGxhc3RPcDtcbiAgcmV0dXJuIHtcbiAgICBraWJhbmE6IHtcbiAgICAgIHV1aWQ6IGNvbmZpZy5nZXQoJ3NlcnZlci51dWlkJyksXG4gICAgICBuYW1lOiBjb25maWcuZ2V0KCdzZXJ2ZXIubmFtZScpLFxuICAgICAgaG9zdDogaG9zdCxcbiAgICAgIHRyYW5zcG9ydF9hZGRyZXNzOiBgJHtjb25maWcuZ2V0KCdzZXJ2ZXIuaG9zdCcpfToke2NvbmZpZy5nZXQoJ3NlcnZlci5wb3J0Jyl9YCxcbiAgICAgIHZlcnNpb246IHNlcnZlckluZm8udmVyc2lvbi5yZXBsYWNlKHNuYXBzaG90UmVnZXgsICcnKSxcbiAgICAgIHNuYXBzaG90OiBzbmFwc2hvdFJlZ2V4LnRlc3Qoc2VydmVySW5mby52ZXJzaW9uKSxcbiAgICAgIHN0YXR1czogXy5nZXQoc3RhdHVzLCAnb3ZlcmFsbC5zdGF0ZScpXG4gICAgfSxcbiAgICAuLi5yb2xsdXBcbiAgfTtcbn1cbiJdfQ==",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/monitoring/server/kibana_monitoring/lib/map_event.js"
      ],
      "names": [],
      "mappings": "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",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/monitoring/server/kibana_monitoring/lib/map_event.js",
      "sourcesContent": [
        "import mapRequests from './map_requests';\nimport mapResponseTimes from './map_response_times';\nimport mapConcurrents from './map_concurrent_connections';\nimport moment from 'moment';\nimport v8 from 'v8';\n\nimport _ from 'lodash';\n\nfunction secondsToMilliseconds(seconds) {\n  return seconds * 1000;\n}\n\nconst snapshotRegex = /-snapshot/i;\n// rollup functions are for objects with unpredictable keys (e.g., {'200': 1, '201': 2} + {'200':2} = {'200': 3, '201': 2})\nconst maxRollup = _.partialRight(_.assign, (latest, prev) => _.max([latest, prev]));\nconst sumRollup = _.partialRight(_.assign, (latest, prev) => _.sum([latest, prev]));\n\n/**\n * Some components of the {@code event} need to be combined with any previous events that haven't been sent in order to not lose information\n * if the collection interval is faster than the flushing interval.\n *\n * @param event {Object} The current event\n * @param lastOp {Object} The previous event details\n */\nexport function rollupEvent(event, lastOp) {\n  const heapStats = v8.getHeapStatistics();\n  const requests = mapRequests(event.requests);\n  const rollup = _.get(lastOp, 'rollup');\n  return {\n    concurrent_connections: _.sum([ mapConcurrents(event.concurrents), _.get(rollup, 'concurrent_connections') ]),\n    // memory/os stats use the latest event's details\n    os: {\n      load: {\n        '1m': event.osload[0],\n        '5m': event.osload[1],\n        '15m': event.osload[2]\n      },\n      memory: {\n        total_in_bytes: event.osmem.total,\n        free_in_bytes: event.osmem.free,\n        used_in_bytes: event.osmem.total - event.osmem.free\n      },\n      uptime_in_millis: secondsToMilliseconds(event.osup)\n    },\n    process: {\n      event_loop_delay: _.sum([ event.psdelay, _.get(rollup, 'process.event_loop_delay') ]),\n      memory: {\n        heap: {\n          total_in_bytes: event.psmem.heapTotal,\n          used_in_bytes: event.psmem.heapUsed,\n          size_limit: heapStats.heap_size_limit\n        },\n        resident_set_size_in_bytes: event.psmem.rss\n      },\n      uptime_in_millis: secondsToMilliseconds(event.psup)\n    },\n    requests: {\n      disconnects: _.sum([ requests.disconnects, _.get(rollup, 'requests.disconnects') ]),\n      total: _.sum([ requests.total, _.get(rollup, 'requests.total') ]),\n      status_codes: sumRollup(requests.status_codes, _.get(rollup, 'requests.status_codes'))\n    },\n    response_times: maxRollup(mapResponseTimes(event.responseTimes), _.get(rollup, 'response_times')),\n    timestamp: moment.utc().toISOString()\n  };\n}\n\nexport function mapEvent(lastOp, config, serverInfo) {\n  const status = serverInfo.status.toJSON();\n  const { host, rollup } = lastOp;\n  return {\n    kibana: {\n      uuid: config.get('server.uuid'),\n      name: config.get('server.name'),\n      host: host,\n      transport_address: `${config.get('server.host')}:${config.get('server.port')}`,\n      version: serverInfo.version.replace(snapshotRegex, ''),\n      snapshot: snapshotRegex.test(serverInfo.version),\n      status: _.get(status, 'overall.state')\n    },\n    ...rollup\n  };\n}\n"
      ]
    },
    "mtime": 1491771513555
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/monitoring/server/kibana_monitoring/lib/map_requests.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "lodash",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "_"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "mapRequests",
            "requests"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "mapRequests",
              "exported": "default"
            },
            {
              "kind": "local",
              "local": "requests",
              "exported": "default"
            }
          ]
        }
      },
      "usedHelpers": [
        "interop-require-default"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nexports['default'] = mapRequests;\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _lodash = require('lodash');\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nfunction mapRequests(requests) {\n  return _lodash2['default'].reduce(_lodash2['default'].values(requests), function (result, value) {\n    _lodash2['default'].each(value.statusCodes, function (count, code) {\n      if (_lodash2['default'].isUndefined(_lodash2['default'].get(result, 'status_codes.' + code))) _lodash2['default'].set(result, 'status_codes.' + code, 0);\n      result.status_codes[code] += count;\n    });\n    result.total += value.total;\n    result.disconnects += value.disconnects;\n    return result;\n  }, { total: 0, disconnects: 0, status_codes: {} });\n}\n\nmodule.exports = exports['default'];\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvbW9uaXRvcmluZy9zZXJ2ZXIva2liYW5hX21vbml0b3JpbmcvbGliL21hcF9yZXF1ZXN0cy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztxQkFFd0IsV0FBVzs7OztzQkFGckIsUUFBUTs7OztBQUVQLFNBQVMsV0FBVyxDQUFDLFFBQVEsRUFBRTtBQUM1QyxTQUFPLG9CQUFFLE1BQU0sQ0FBQyxvQkFBRSxNQUFNLENBQUMsUUFBUSxDQUFDLEVBQUUsVUFBQyxNQUFNLEVBQUUsS0FBSyxFQUFLO0FBQ3JELHdCQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsV0FBVyxFQUFFLFVBQUMsS0FBSyxFQUFFLElBQUksRUFBSztBQUN6QyxVQUFJLG9CQUFFLFdBQVcsQ0FBQyxvQkFBRSxHQUFHLENBQUMsTUFBTSxvQkFBa0IsSUFBSSxDQUFHLENBQUMsRUFBRSxvQkFBRSxHQUFHLENBQUMsTUFBTSxvQkFBa0IsSUFBSSxFQUFJLENBQUMsQ0FBQyxDQUFDO0FBQ25HLFlBQU0sQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLElBQUksS0FBSyxDQUFDO0tBQ3BDLENBQUMsQ0FBQztBQUNILFVBQU0sQ0FBQyxLQUFLLElBQUksS0FBSyxDQUFDLEtBQUssQ0FBQztBQUM1QixVQUFNLENBQUMsV0FBVyxJQUFJLEtBQUssQ0FBQyxXQUFXLENBQUM7QUFDeEMsV0FBTyxNQUFNLENBQUM7R0FDZixFQUFFLEVBQUMsS0FBSyxFQUFFLENBQUMsRUFBRSxXQUFXLEVBQUUsQ0FBQyxFQUFFLFlBQVksRUFBRSxFQUFFLEVBQUMsQ0FBQyxDQUFDO0NBQ2xEIiwiZmlsZSI6Ii91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvbW9uaXRvcmluZy9zZXJ2ZXIva2liYW5hX21vbml0b3JpbmcvbGliL21hcF9yZXF1ZXN0cy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBfIGZyb20gJ2xvZGFzaCc7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIG1hcFJlcXVlc3RzKHJlcXVlc3RzKSB7XG4gIHJldHVybiBfLnJlZHVjZShfLnZhbHVlcyhyZXF1ZXN0cyksIChyZXN1bHQsIHZhbHVlKSA9PiB7XG4gICAgXy5lYWNoKHZhbHVlLnN0YXR1c0NvZGVzLCAoY291bnQsIGNvZGUpID0+IHtcbiAgICAgIGlmIChfLmlzVW5kZWZpbmVkKF8uZ2V0KHJlc3VsdCwgYHN0YXR1c19jb2Rlcy4ke2NvZGV9YCkpKSBfLnNldChyZXN1bHQsIGBzdGF0dXNfY29kZXMuJHtjb2RlfWAsIDApO1xuICAgICAgcmVzdWx0LnN0YXR1c19jb2Rlc1tjb2RlXSArPSBjb3VudDtcbiAgICB9KTtcbiAgICByZXN1bHQudG90YWwgKz0gdmFsdWUudG90YWw7XG4gICAgcmVzdWx0LmRpc2Nvbm5lY3RzICs9IHZhbHVlLmRpc2Nvbm5lY3RzO1xuICAgIHJldHVybiByZXN1bHQ7XG4gIH0sIHt0b3RhbDogMCwgZGlzY29ubmVjdHM6IDAsIHN0YXR1c19jb2Rlczoge319KTtcbn1cbiJdfQ==",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/monitoring/server/kibana_monitoring/lib/map_requests.js"
      ],
      "names": [],
      "mappings": ";;;;;qBAEwB,WAAW;;;;sBAFrB,QAAQ;;;;AAEP,SAAS,WAAW,CAAC,QAAQ,EAAE;AAC5C,SAAO,oBAAE,MAAM,CAAC,oBAAE,MAAM,CAAC,QAAQ,CAAC,EAAE,UAAC,MAAM,EAAE,KAAK,EAAK;AACrD,wBAAE,IAAI,CAAC,KAAK,CAAC,WAAW,EAAE,UAAC,KAAK,EAAE,IAAI,EAAK;AACzC,UAAI,oBAAE,WAAW,CAAC,oBAAE,GAAG,CAAC,MAAM,oBAAkB,IAAI,CAAG,CAAC,EAAE,oBAAE,GAAG,CAAC,MAAM,oBAAkB,IAAI,EAAI,CAAC,CAAC,CAAC;AACnG,YAAM,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,KAAK,CAAC;KACpC,CAAC,CAAC;AACH,UAAM,CAAC,KAAK,IAAI,KAAK,CAAC,KAAK,CAAC;AAC5B,UAAM,CAAC,WAAW,IAAI,KAAK,CAAC,WAAW,CAAC;AACxC,WAAO,MAAM,CAAC;GACf,EAAE,EAAC,KAAK,EAAE,CAAC,EAAE,WAAW,EAAE,CAAC,EAAE,YAAY,EAAE,EAAE,EAAC,CAAC,CAAC;CAClD",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/monitoring/server/kibana_monitoring/lib/map_requests.js",
      "sourcesContent": [
        "import _ from 'lodash';\n\nexport default function mapRequests(requests) {\n  return _.reduce(_.values(requests), (result, value) => {\n    _.each(value.statusCodes, (count, code) => {\n      if (_.isUndefined(_.get(result, `status_codes.${code}`))) _.set(result, `status_codes.${code}`, 0);\n      result.status_codes[code] += count;\n    });\n    result.total += value.total;\n    result.disconnects += value.disconnects;\n    return result;\n  }, {total: 0, disconnects: 0, status_codes: {}});\n}\n"
      ]
    },
    "mtime": 1491771513555
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/monitoring/server/kibana_monitoring/lib/map_response_times.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "lodash",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "_"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "mapResponseTimes",
            "times"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "mapResponseTimes",
              "exported": "default"
            },
            {
              "kind": "local",
              "local": "times",
              "exported": "default"
            }
          ]
        }
      },
      "usedHelpers": [
        "interop-require-default"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nexports['default'] = mapResponseTimes;\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _lodash = require('lodash');\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nfunction mapResponseTimes(times) {\n  var responseTimes = _lodash2['default'].reduce(_lodash2['default'].values(times), function (result, value) {\n    if (value.avg) {\n      result.avg = Math.max(result.avg, value.avg);\n    }\n    result.max = Math.max(result.max, value.max);\n    return result;\n  }, { avg: 0, max: 0 });\n  return {\n    average: responseTimes.avg,\n    max: responseTimes.max\n  };\n}\n\nmodule.exports = exports['default'];\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvbW9uaXRvcmluZy9zZXJ2ZXIva2liYW5hX21vbml0b3JpbmcvbGliL21hcF9yZXNwb25zZV90aW1lcy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztxQkFFd0IsZ0JBQWdCOzs7O3NCQUYxQixRQUFROzs7O0FBRVAsU0FBUyxnQkFBZ0IsQ0FBQyxLQUFLLEVBQUU7QUFDOUMsTUFBTSxhQUFhLEdBQUcsb0JBQUUsTUFBTSxDQUFDLG9CQUFFLE1BQU0sQ0FBQyxLQUFLLENBQUMsRUFBRSxVQUFDLE1BQU0sRUFBRSxLQUFLLEVBQUs7QUFDakUsUUFBSSxLQUFLLENBQUMsR0FBRyxFQUFFO0FBQ2IsWUFBTSxDQUFDLEdBQUcsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxHQUFHLEVBQUUsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0tBQzlDO0FBQ0QsVUFBTSxDQUFDLEdBQUcsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxHQUFHLEVBQUUsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0FBQzdDLFdBQU8sTUFBTSxDQUFDO0dBQ2YsRUFBRSxFQUFDLEdBQUcsRUFBRSxDQUFDLEVBQUUsR0FBRyxFQUFFLENBQUMsRUFBQyxDQUFDLENBQUM7QUFDckIsU0FBTztBQUNMLFdBQU8sRUFBRSxhQUFhLENBQUMsR0FBRztBQUMxQixPQUFHLEVBQUUsYUFBYSxDQUFDLEdBQUc7R0FDdkIsQ0FBQztDQUNIIiwiZmlsZSI6Ii91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvbW9uaXRvcmluZy9zZXJ2ZXIva2liYW5hX21vbml0b3JpbmcvbGliL21hcF9yZXNwb25zZV90aW1lcy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBfIGZyb20gJ2xvZGFzaCc7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIG1hcFJlc3BvbnNlVGltZXModGltZXMpIHtcbiAgY29uc3QgcmVzcG9uc2VUaW1lcyA9IF8ucmVkdWNlKF8udmFsdWVzKHRpbWVzKSwgKHJlc3VsdCwgdmFsdWUpID0+IHtcbiAgICBpZiAodmFsdWUuYXZnKSB7XG4gICAgICByZXN1bHQuYXZnID0gTWF0aC5tYXgocmVzdWx0LmF2ZywgdmFsdWUuYXZnKTtcbiAgICB9XG4gICAgcmVzdWx0Lm1heCA9IE1hdGgubWF4KHJlc3VsdC5tYXgsIHZhbHVlLm1heCk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfSwge2F2ZzogMCwgbWF4OiAwfSk7XG4gIHJldHVybiB7XG4gICAgYXZlcmFnZTogcmVzcG9uc2VUaW1lcy5hdmcsXG4gICAgbWF4OiByZXNwb25zZVRpbWVzLm1heFxuICB9O1xufVxuIl19",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/monitoring/server/kibana_monitoring/lib/map_response_times.js"
      ],
      "names": [],
      "mappings": ";;;;;qBAEwB,gBAAgB;;;;sBAF1B,QAAQ;;;;AAEP,SAAS,gBAAgB,CAAC,KAAK,EAAE;AAC9C,MAAM,aAAa,GAAG,oBAAE,MAAM,CAAC,oBAAE,MAAM,CAAC,KAAK,CAAC,EAAE,UAAC,MAAM,EAAE,KAAK,EAAK;AACjE,QAAI,KAAK,CAAC,GAAG,EAAE;AACb,YAAM,CAAC,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,GAAG,EAAE,KAAK,CAAC,GAAG,CAAC,CAAC;KAC9C;AACD,UAAM,CAAC,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,GAAG,EAAE,KAAK,CAAC,GAAG,CAAC,CAAC;AAC7C,WAAO,MAAM,CAAC;GACf,EAAE,EAAC,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAC,CAAC,CAAC;AACrB,SAAO;AACL,WAAO,EAAE,aAAa,CAAC,GAAG;AAC1B,OAAG,EAAE,aAAa,CAAC,GAAG;GACvB,CAAC;CACH",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/monitoring/server/kibana_monitoring/lib/map_response_times.js",
      "sourcesContent": [
        "import _ from 'lodash';\n\nexport default function mapResponseTimes(times) {\n  const responseTimes = _.reduce(_.values(times), (result, value) => {\n    if (value.avg) {\n      result.avg = Math.max(result.avg, value.avg);\n    }\n    result.max = Math.max(result.max, value.max);\n    return result;\n  }, {avg: 0, max: 0});\n  return {\n    average: responseTimes.avg,\n    max: responseTimes.max\n  };\n}\n"
      ]
    },
    "mtime": 1491771513555
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/monitoring/server/kibana_monitoring/lib/map_concurrent_connections.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "lodash",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "_"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "mapConcurrents",
            "concurrents"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "mapConcurrents",
              "exported": "default"
            },
            {
              "kind": "local",
              "local": "concurrents",
              "exported": "default"
            }
          ]
        }
      },
      "usedHelpers": [
        "interop-require-default"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nexports['default'] = mapConcurrents;\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _lodash = require('lodash');\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nfunction mapConcurrents(concurrents) {\n  return _lodash2['default'].reduce(_lodash2['default'].values(concurrents), function (result, value) {\n    return result + value;\n  }, 0);\n}\n\nmodule.exports = exports['default'];\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvbW9uaXRvcmluZy9zZXJ2ZXIva2liYW5hX21vbml0b3JpbmcvbGliL21hcF9jb25jdXJyZW50X2Nvbm5lY3Rpb25zLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O3FCQUV3QixjQUFjOzs7O3NCQUZ4QixRQUFROzs7O0FBRVAsU0FBUyxjQUFjLENBQUMsV0FBVyxFQUFFO0FBQ2xELFNBQU8sb0JBQUUsTUFBTSxDQUFDLG9CQUFFLE1BQU0sQ0FBQyxXQUFXLENBQUMsRUFBRSxVQUFDLE1BQU0sRUFBRSxLQUFLLEVBQUs7QUFDeEQsV0FBTyxNQUFNLEdBQUcsS0FBSyxDQUFDO0dBQ3ZCLEVBQUUsQ0FBQyxDQUFDLENBQUM7Q0FDUCIsImZpbGUiOiIvdXNyL3NoYXJlL2tpYmFuYS9wbHVnaW5zL3gtcGFjay9wbHVnaW5zL21vbml0b3Jpbmcvc2VydmVyL2tpYmFuYV9tb25pdG9yaW5nL2xpYi9tYXBfY29uY3VycmVudF9jb25uZWN0aW9ucy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBfIGZyb20gJ2xvZGFzaCc7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIG1hcENvbmN1cnJlbnRzKGNvbmN1cnJlbnRzKSB7XG4gIHJldHVybiBfLnJlZHVjZShfLnZhbHVlcyhjb25jdXJyZW50cyksIChyZXN1bHQsIHZhbHVlKSA9PiB7XG4gICAgcmV0dXJuIHJlc3VsdCArIHZhbHVlO1xuICB9LCAwKTtcbn1cbiJdfQ==",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/monitoring/server/kibana_monitoring/lib/map_concurrent_connections.js"
      ],
      "names": [],
      "mappings": ";;;;;qBAEwB,cAAc;;;;sBAFxB,QAAQ;;;;AAEP,SAAS,cAAc,CAAC,WAAW,EAAE;AAClD,SAAO,oBAAE,MAAM,CAAC,oBAAE,MAAM,CAAC,WAAW,CAAC,EAAE,UAAC,MAAM,EAAE,KAAK,EAAK;AACxD,WAAO,MAAM,GAAG,KAAK,CAAC;GACvB,EAAE,CAAC,CAAC,CAAC;CACP",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/monitoring/server/kibana_monitoring/lib/map_concurrent_connections.js",
      "sourcesContent": [
        "import _ from 'lodash';\n\nexport default function mapConcurrents(concurrents) {\n  return _.reduce(_.values(concurrents), (result, value) => {\n    return result + value;\n  }, 0);\n}\n"
      ]
    },
    "mtime": 1491771513555
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/reporting/index.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "path",
            "imported": [
              "resolve"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "resolve",
                "local": "resolve"
              }
            ]
          },
          {
            "source": "../../server/lib/mirror_plugin_status",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "mirrorPluginStatus"
              }
            ]
          },
          {
            "source": "./server/routes/main",
            "imported": [
              "main"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "main",
                "local": "mainRoutes"
              }
            ]
          },
          {
            "source": "./server/routes/jobs",
            "imported": [
              "jobs"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "jobs",
                "local": "jobRoutes"
              }
            ]
          },
          {
            "source": "./server/lib/phantom",
            "imported": [
              "phantom"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "phantom",
                "local": "phantom"
              }
            ]
          },
          {
            "source": "./server/lib/create_queue",
            "imported": [
              "createQueueFactory"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "createQueueFactory",
                "local": "createQueueFactory"
              }
            ]
          },
          {
            "source": "./server/config/config",
            "imported": [
              "config"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "config",
                "local": "appConfig"
              }
            ]
          },
          {
            "source": "./server/lib/check_license",
            "imported": [
              "checkLicense"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "checkLicense",
                "local": "checkLicense"
              }
            ]
          },
          {
            "source": "./server/lib/validate_config",
            "imported": [
              "validateConfig"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "validateConfig",
                "local": "validateConfig"
              }
            ]
          },
          {
            "source": "./server/lib/extract",
            "imported": [
              "ExtractError"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "ExtractError",
                "local": "ExtractError"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "reporting",
            "kibana"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "reporting",
              "exported": "reporting"
            },
            {
              "kind": "local",
              "local": "kibana",
              "exported": "kibana"
            }
          ]
        }
      },
      "usedHelpers": [
        "interop-require-default"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nexports.reporting = reporting;\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _path = require('path');\n\nvar _serverLibMirror_plugin_status = require('../../server/lib/mirror_plugin_status');\n\nvar _serverLibMirror_plugin_status2 = _interopRequireDefault(_serverLibMirror_plugin_status);\n\nvar _serverRoutesMain = require('./server/routes/main');\n\nvar _serverRoutesJobs = require('./server/routes/jobs');\n\nvar _serverLibPhantom = require('./server/lib/phantom');\n\nvar _serverLibCreate_queue = require('./server/lib/create_queue');\n\nvar _serverConfigConfig = require('./server/config/config');\n\nvar _serverLibCheck_license = require('./server/lib/check_license');\n\nvar _serverLibValidate_config = require('./server/lib/validate_config');\n\nvar _serverLibExtract = require('./server/lib/extract');\n\nfunction reporting(kibana) {\n  return new kibana.Plugin({\n    id: 'reporting',\n    configPrefix: 'xpack.reporting',\n    publicDir: (0, _path.resolve)(__dirname, 'public'),\n    require: ['kibana', 'elasticsearch', 'xpack_main'],\n\n    uiExports: {\n      navbarExtensions: ['plugins/reporting/controls/discover', 'plugins/reporting/controls/visualize', 'plugins/reporting/controls/dashboard'],\n      hacks: ['plugins/reporting/hacks/job_completion_notifier'],\n      managementSections: ['plugins/reporting/views/management']\n    },\n\n    config: function config(Joi) {\n      return Joi.object({\n        enabled: Joi.boolean()['default'](true),\n        kibanaApp: Joi.string().regex(/^\\//)['default']('/app/kibana'),\n        kibanaServer: Joi.object({\n          protocol: Joi.string().valid(['http', 'https']),\n          hostname: Joi.string(),\n          port: Joi.number().integer()\n        })['default'](),\n        queue: Joi.object({\n          indexInterval: Joi.string()['default']('week'),\n          pollInterval: Joi.number().integer()['default'](3000),\n          timeout: Joi.number().integer()['default'](30000),\n          syncSocketTimeout: Joi.number().integer()\n        })['default'](),\n        generate: Joi.object({\n          socketTimeout: Joi.number().integer()\n        })['default'](),\n        capture: Joi.object({\n          zoom: Joi.number().integer()['default'](2),\n          viewport: Joi.object({\n            width: Joi.number().integer()['default'](1950),\n            height: Joi.number().integer()['default'](1200)\n          })['default'](),\n          timeout: Joi.number().integer()['default'](6000),\n          loadDelay: Joi.number().integer()['default'](3000),\n          settleTime: Joi.number().integer()['default'](1000),\n          concurrency: Joi.number().integer()['default'](_serverConfigConfig.config.concurrency)\n        })['default'](),\n        encryptionKey: Joi.string()\n      })['default']();\n    },\n\n    init: function init(server) {\n      var thisPlugin = this;\n      var config = server.config();\n      (0, _serverLibValidate_config.validateConfig)(config, function (message) {\n        return server.log(['reporting', 'warning'], message);\n      });\n\n      var xpackMainPlugin = server.plugins.xpack_main;\n      (0, _serverLibMirror_plugin_status2['default'])(xpackMainPlugin, thisPlugin);\n      xpackMainPlugin.status.once('green', function () {\n        // Register a function that is called whenever the xpack info changes,\n        // to re-compute the license check results for this plugin\n        xpackMainPlugin.info.feature(thisPlugin.id).registerLicenseCheckResultsGenerator(_serverLibCheck_license.checkLicense);\n      });\n\n      function setup() {\n        // prepare phantom binary\n        return _serverLibPhantom.phantom.install(config.get('path.data')).then(function (phantomPackage) {\n          server.log(['reporting', 'debug'], 'Phantom installed at ' + phantomPackage.binary);\n\n          // intialize and register application components\n          server.expose('phantom', phantomPackage);\n          server.expose('queue', (0, _serverLibCreate_queue.createQueueFactory)(server));\n\n          // Reporting routes\n          (0, _serverRoutesMain.main)(server);\n          (0, _serverRoutesJobs.jobs)(server);\n        })['catch'](function (err) {\n          server.log(['reporting', 'error'], err);\n\n          if (!err instanceof _serverLibExtract.ExtractError) {\n            thisPlugin.status.red('Failed to install phantom.js. See kibana logs for more details.');\n            return;\n          }\n\n          server.log(['reporting', 'error'], err.cause);\n\n          if (['EACCES', 'EEXIST'].includes(err.cause.code)) {\n            thisPlugin.status.red('Insufficient permissions for extracting the phantom.js archive. ' + 'Make sure the Kibana data directory (path.data) is owned by the same user that is running Kibana.');\n          } else {\n            thisPlugin.status.red('Failed to extract the phantom.js archive. See kibana logs for more details.');\n          }\n        });\n      }\n\n      return setup();\n    }\n  });\n}\n\n;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvcmVwb3J0aW5nL2luZGV4LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7OztvQkFBd0IsTUFBTTs7NkNBQ0MsdUNBQXVDOzs7O2dDQUNuQyxzQkFBc0I7O2dDQUN2QixzQkFBc0I7O2dDQUVoQyxzQkFBc0I7O3FDQUNYLDJCQUEyQjs7a0NBQzFCLHdCQUF3Qjs7c0NBQy9CLDRCQUE0Qjs7d0NBQzFCLDhCQUE4Qjs7Z0NBQ2hDLHNCQUFzQjs7QUFFNUMsU0FBUyxTQUFTLENBQUMsTUFBTSxFQUFFO0FBQ2hDLFNBQU8sSUFBSSxNQUFNLENBQUMsTUFBTSxDQUFDO0FBQ3ZCLE1BQUUsRUFBRSxXQUFXO0FBQ2YsZ0JBQVksRUFBRSxpQkFBaUI7QUFDL0IsYUFBUyxFQUFFLG1CQUFRLFNBQVMsRUFBRSxRQUFRLENBQUM7QUFDdkMsV0FBTyxFQUFFLENBQUMsUUFBUSxFQUFFLGVBQWUsRUFBRSxZQUFZLENBQUM7O0FBRWxELGFBQVMsRUFBRTtBQUNULHNCQUFnQixFQUFFLENBQ2hCLHFDQUFxQyxFQUNyQyxzQ0FBc0MsRUFDdEMsc0NBQXNDLENBQ3ZDO0FBQ0QsV0FBSyxFQUFFLENBQUUsaURBQWlELENBQUM7QUFDM0Qsd0JBQWtCLEVBQUUsQ0FBQyxvQ0FBb0MsQ0FBQztLQUMzRDs7QUFFRCxVQUFNLEVBQUUsZ0JBQVUsR0FBRyxFQUFFO0FBQ3JCLGFBQU8sR0FBRyxDQUFDLE1BQU0sQ0FBQztBQUNoQixlQUFPLEVBQUUsR0FBRyxDQUFDLE9BQU8sRUFBRSxXQUFRLENBQUMsSUFBSSxDQUFDO0FBQ3BDLGlCQUFTLEVBQUUsR0FBRyxDQUFDLE1BQU0sRUFBRSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsV0FBUSxDQUFDLGFBQWEsQ0FBQztBQUMzRCxvQkFBWSxFQUFFLEdBQUcsQ0FBQyxNQUFNLENBQUM7QUFDdkIsa0JBQVEsRUFBRSxHQUFHLENBQUMsTUFBTSxFQUFFLENB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ZSI6Ii91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvcmVwb3J0aW5nL2luZGV4LmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgcmVzb2x2ZSB9IGZyb20gJ3BhdGgnO1xuaW1wb3J0IG1pcnJvclBsdWdpblN0YXR1cyBmcm9tICcuLi8uLi9zZXJ2ZXIvbGliL21pcnJvcl9wbHVnaW5fc3RhdHVzJztcbmltcG9ydCB7IG1haW4gYXMgbWFpblJvdXRlcyB9IGZyb20gJy4vc2VydmVyL3JvdXRlcy9tYWluJztcbmltcG9ydCB7IGpvYnMgYXMgam9iUm91dGVzIH0gZnJvbSAnLi9zZXJ2ZXIvcm91dGVzL2pvYnMnO1xuXG5pbXBvcnQgeyBwaGFudG9tIH0gZnJvbSAnLi9zZXJ2ZXIvbGliL3BoYW50b20nO1xuaW1wb3J0IHsgY3JlYXRlUXVldWVGYWN0b3J5IH0gZnJvbSAnLi9zZXJ2ZXIvbGliL2NyZWF0ZV9xdWV1ZSc7XG5pbXBvcnQgeyBjb25maWcgYXMgYXBwQ29uZmlnIH0gZnJvbSAnLi9zZXJ2ZXIvY29uZmlnL2NvbmZpZyc7XG5pbXBvcnQgeyBjaGVja0xpY2Vuc2UgfSBmcm9tICcuL3NlcnZlci9saWIvY2hlY2tfbGljZW5zZSc7XG5pbXBvcnQgeyB2YWxpZGF0ZUNvbmZpZyB9IGZyb20gJy4vc2VydmVyL2xpYi92YWxpZGF0ZV9jb25maWcnO1xuaW1wb3J0IHsgRXh0cmFjdEVycm9yIH0gZnJvbSAnLi9zZXJ2ZXIvbGliL2V4dHJhY3QnO1xuXG5leHBvcnQgZnVuY3Rpb24gcmVwb3J0aW5nKGtpYmFuYSkge1xuICByZXR1cm4gbmV3IGtpYmFuYS5QbHVnaW4oe1xuICAgIGlkOiAncmVwb3J0aW5nJyxcbiAgICBjb25maWdQcmVmaXg6ICd4cGFjay5yZXBvcnRpbmcnLFxuICAgIHB1YmxpY0RpcjogcmVzb2x2ZShfX2Rpcm5hbWUsICdwdWJsaWMnKSxcbiAgICByZXF1aXJlOiBbJ2tpYmFuYScsICdlbGFzdGljc2VhcmNoJywgJ3hwYWNrX21haW4nXSxcblxuICAgIHVpRXhwb3J0czoge1xuICAgICAgbmF2YmFyRXh0ZW5zaW9uczogW1xuICAgICAgICAncGx1Z2lucy9yZXBvcnRpbmcvY29udHJvbHMvZGlzY292ZXInLFxuICAgICAgICAncGx1Z2lucy9yZXBvcnRpbmcvY29udHJvbHMvdmlzdWFsaXplJyxcbiAgICAgICAgJ3BsdWdpbnMvcmVwb3J0aW5nL2NvbnRyb2xzL2Rhc2hib2FyZCcsXG4gICAgICBdLFxuICAgICAgaGFja3M6IFsgJ3BsdWdpbnMvcmVwb3J0aW5nL2hhY2tzL2pvYl9jb21wbGV0aW9uX25vdGlmaWVyJ10sXG4gICAgICBtYW5hZ2VtZW50U2VjdGlvbnM6IFsncGx1Z2lucy9yZXBvcnRpbmcvdmlld3MvbWFuYWdlbWVudCddLFxuICAgIH0sXG5cbiAgICBjb25maWc6IGZ1bmN0aW9uIChKb2kpIHtcbiAgICAgIHJldHVybiBKb2kub2JqZWN0KHtcbiAgICAgICAgZW5hYmxlZDogSm9pLmJvb2xlYW4oKS5kZWZhdWx0KHRydWUpLFxuICAgICAgICBraWJhbmFBcHA6IEpvaS5zdHJpbmcoKS5yZWdleCgvXlxcLy8pLmRlZmF1bHQoJy9hcHAva2liYW5hJyksXG4gICAgICAgIGtpYmFuYVNlcnZlcjogSm9pLm9iamVjdCh7XG4gICAgICAgICAgcHJvdG9jb2w6IEpvaS5zdHJpbmcoKS52YWxpZChbJ2h0dHAnLCAnaHR0cHMnXSksXG4gICAgICAgICAgaG9zdG5hbWU6IEpvaS5zdHJpbmcoKSxcbiAgICAgICAgICBwb3J0OiBKb2kubnVtYmVyKCkuaW50ZWdlcigpXG4gICAgICAgIH0pLmRlZmF1bHQoKSxcbiAgICAgICAgcXVldWU6IEpvaS5vYmplY3Qoe1xuICAgICAgICAgIGluZGV4SW50ZXJ2YWw6IEpvaS5zdHJpbmcoKS5kZWZhdWx0KCd3ZWVrJyksXG4gICAgICAgICAgcG9sbEludGVydmFsOiBKb2kubnVtYmVyKCkuaW50ZWdlcigpLmRlZmF1bHQoMzAwMCksXG4gICAgICAgICAgdGltZW91dDogSm9pLm51bWJlcigpLmludGVnZXIoKS5kZWZhdWx0KDMwMDAwKSxcbiAgICAgICAgICBzeW5jU29ja2V0VGltZW91dDogSm9pLm51bWJlcigpLmludGVnZXIoKSxcbiAgICAgICAgfSkuZGVmYXVsdCgpLFxuICAgICAgICBnZW5lcmF0ZTogSm9pLm9iamVjdCh7XG4gICAgICAgICAgc29ja2V0VGltZW91dDogSm9pLm51bWJlcigpLmludGVnZXIoKSxcbiAgICAgICAgfSkuZGVmYXVsdCgpLFxuICAgICAgICBjYXB0dXJlOiBKb2kub2JqZWN0KHtcbiAgICAgICAgICB6b29tOiBKb2kubnVtYmVyKCkuaW50ZWdlcigpLmRlZmF1bHQoMiksXG4gICAgICAgICAgdmlld3BvcnQ6IEpvaS5vYmplY3Qoe1xuICAgICAgICAgICAgd2lkdGg6IEpvaS5udW1iZXIoKS5pbnRlZ2VyKCkuZGVmYXVsdCgxOTUwKSxcbiAgICAgICAgICAgIGhlaWdodDogSm9pLm51bWJlcigpLmludGVnZXIoKS5kZWZhdWx0KDEyMDApXG4gICAgICAgICAgfSkuZGVmYXVsdCgpLFxuICAgICAgICAgIHRpbWVvdXQ6IEpvaS5udW1iZXIoKS5pbnRlZ2VyKCkuZGVmYXVsdCg2MDAwKSxcbiAgICAgICAgICBsb2FkRGVsYXk6IEpvaS5udW1iZXIoKS5pbnRlZ2VyKCkuZGVmYXVsdCgzMDAwKSxcbiAgICAgICAgICBzZXR0bGVUaW1lOiBKb2kubnVtYmVyKCkuaW50ZWdlcigpLmRlZmF1bHQoMTAwMCksXG4gICAgICAgICAgY29uY3VycmVuY3k6IEpvaS5udW1iZXIoKS5pbnRlZ2VyKCkuZGVmYXVsdChhcHBDb25maWcuY29uY3VycmVuY3kpLFxuICAgICAgICB9KS5kZWZhdWx0KCksXG4gICAgICAgIGVuY3J5cHRpb25LZXk6IEpvaS5zdHJpbmcoKVxuICAgICAgfSkuZGVmYXVsdCgpO1xuICAgIH0sXG5cbiAgICBpbml0OiBmdW5jdGlvbiAoc2VydmVyKSB7XG4gICAgICBjb25zdCB0aGlzUGx1Z2luID0gdGhpcztcbiAgICAgIGNvbnN0IGNvbmZpZyA9IHNlcnZlci5jb25maWcoKTtcbiAgICAgIHZhbGlkYXRlQ29uZmlnKGNvbmZpZywgbWVzc2FnZSA9PiBzZXJ2ZXIubG9nKFsncmVwb3J0aW5nJywgJ3dhcm5pbmcnXSwgbWVzc2FnZSkpO1xuXG4gICAgICBjb25zdCB4cGFja01haW5QbHVnaW4gPSBzZXJ2ZXIucGx1Z2lucy54cGFja19tYWluO1xuICAgICAgbWlycm9yUGx1Z2luU3RhdHVzKHhwYWNrTWFpblBsdWdpbiwgdGhpc1BsdWdpbik7XG4gICAgICB4cGFja01haW5QbHVnaW4uc3RhdHVzLm9uY2UoJ2dyZWVuJywgKCkgPT4ge1xuICAgICAgICAvLyBSZWdpc3RlciBhIGZ1bmN0aW9uIHRoYXQgaXMgY2FsbGVkIHdoZW5ldmVyIHRoZSB4cGFjayBpbmZvIGNoYW5nZXMsXG4gICAgICAgIC8vIHRvIHJlLWNvbXB1dGUgdGhlIGxpY2Vuc2UgY2hlY2sgcmVzdWx0cyBmb3IgdGhpcyBwbHVnaW5cbiAgICAgICAgeHBhY2tNYWluUGx1Z2luLmluZm8uZmVhdHVyZSh0aGlzUGx1Z2luLmlkKS5yZWdpc3RlckxpY2Vuc2VDaGVja1Jlc3VsdHNHZW5lcmF0b3IoY2hlY2tMaWNlbnNlKTtcbiAgICAgIH0pO1xuXG4gICAgICBmdW5jdGlvbiBzZXR1cCgpIHtcbiAgICAgICAgLy8gcHJlcGFyZSBwaGFudG9tIGJpbmFyeVxuICAgICAgICByZXR1cm4gcGhhbnRvbS5pbnN0YWxsKGNvbmZpZy5nZXQoJ3BhdGguZGF0YScpKVxuICAgICAgICAudGhlbihmdW5jdGlvbiAocGhhbnRvbVBhY2thZ2UpIHtcbiAgICAgICAgICBzZXJ2ZXIubG9nKFsncmVwb3J0aW5nJywgJ2RlYnVnJ10sIGBQaGFudG9tIGluc3RhbGxlZCBhdCAke3BoYW50b21QYWNrYWdlLmJpbmFyeX1gKTtcblxuICAgICAgICAgIC8vIGludGlhbGl6ZSBhbmQgcmVnaXN0ZXIgYXBwbGljYXRpb24gY29tcG9uZW50c1xuICAgICAgICAgIHNlcnZlci5leHBvc2UoJ3BoYW50b20nLCBwaGFudG9tUGFja2FnZSk7XG4gICAgICAgICAgc2VydmVyLmV4cG9zZSgncXVldWUnLCBjcmVhdGVRdWV1ZUZhY3Rvcnkoc2VydmVyKSk7XG5cbiAgICAgICAgICAvLyBSZXBvcnRpbmcgcm91dGVzXG4gICAgICAgICAgbWFpblJvdXRlcyhzZXJ2ZXIpO1xuICAgICAgICAgIGpvYlJvdXRlcyhzZXJ2ZXIpO1xuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgIHNlcnZlci5sb2coWydyZXBvcnRpbmcnLCAnZXJyb3InXSwgZXJyKTtcblxuICAgICAgICAgIGlmICghZXJyIGluc3RhbmNlb2YgRXh0cmFjdEVycm9yKSB7XG4gICAgICAgICAgICB0aGlzUGx1Z2luLnN0YXR1cy5yZWQoJ0ZhaWxlZCB0byBpbnN0YWxsIHBoYW50b20uanMuIFNlZSBraWJhbmEgbG9ncyBmb3IgbW9yZSBkZXRhaWxzLicpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHNlcnZlci5sb2coWydyZXBvcnRpbmcnLCAnZXJyb3InXSwgZXJyLmNhdXNlKTtcblxuICAgICAgICAgIGlmIChbJ0VBQ0NFUycsICdFRVhJU1QnXS5pbmNsdWRlcyhlcnIuY2F1c2UuY29kZSkpIHtcbiAgICAgICAgICAgIHRoaXNQbHVnaW4uc3RhdHVzLnJlZChcbiAgICAgICAgICAgICAgJ0luc3VmZmljaWVudCBwZXJtaXNzaW9ucyBmb3IgZXh0cmFjdGluZyB0aGUgcGhhbnRvbS5qcyBhcmNoaXZlLiAnICtcbiAgICAgICAgICAgICAgJ01ha2Ugc3VyZSB0aGUgS2liYW5hIGRhdGEgZGlyZWN0b3J5IChwYXRoLmRhdGEpIGlzIG93bmVkIGJ5IHRoZSBzYW1lIHVzZXIgdGhhdCBpcyBydW5uaW5nIEtpYmFuYS4nXG4gICAgICAgICAgICApO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzUGx1Z2luLnN0YXR1cy5yZWQoJ0ZhaWxlZCB0byBleHRyYWN0IHRoZSBwaGFudG9tLmpzIGFyY2hpdmUuIFNlZSBraWJhbmEgbG9ncyBmb3IgbW9yZSBkZXRhaWxzLicpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBzZXR1cCgpO1xuICAgIH1cbiAgfSk7XG59O1xuIl19",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/reporting/index.js"
      ],
      "names": [],
      "mappings": "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",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/reporting/index.js",
      "sourcesContent": [
        "import { resolve } from 'path';\nimport mirrorPluginStatus from '../../server/lib/mirror_plugin_status';\nimport { main as mainRoutes } from './server/routes/main';\nimport { jobs as jobRoutes } from './server/routes/jobs';\n\nimport { phantom } from './server/lib/phantom';\nimport { createQueueFactory } from './server/lib/create_queue';\nimport { config as appConfig } from './server/config/config';\nimport { checkLicense } from './server/lib/check_license';\nimport { validateConfig } from './server/lib/validate_config';\nimport { ExtractError } from './server/lib/extract';\n\nexport function reporting(kibana) {\n  return new kibana.Plugin({\n    id: 'reporting',\n    configPrefix: 'xpack.reporting',\n    publicDir: resolve(__dirname, 'public'),\n    require: ['kibana', 'elasticsearch', 'xpack_main'],\n\n    uiExports: {\n      navbarExtensions: [\n        'plugins/reporting/controls/discover',\n        'plugins/reporting/controls/visualize',\n        'plugins/reporting/controls/dashboard',\n      ],\n      hacks: [ 'plugins/reporting/hacks/job_completion_notifier'],\n      managementSections: ['plugins/reporting/views/management'],\n    },\n\n    config: function (Joi) {\n      return Joi.object({\n        enabled: Joi.boolean().default(true),\n        kibanaApp: Joi.string().regex(/^\\//).default('/app/kibana'),\n        kibanaServer: Joi.object({\n          protocol: Joi.string().valid(['http', 'https']),\n          hostname: Joi.string(),\n          port: Joi.number().integer()\n        }).default(),\n        queue: Joi.object({\n          indexInterval: Joi.string().default('week'),\n          pollInterval: Joi.number().integer().default(3000),\n          timeout: Joi.number().integer().default(30000),\n          syncSocketTimeout: Joi.number().integer(),\n        }).default(),\n        generate: Joi.object({\n          socketTimeout: Joi.number().integer(),\n        }).default(),\n        capture: Joi.object({\n          zoom: Joi.number().integer().default(2),\n          viewport: Joi.object({\n            width: Joi.number().integer().default(1950),\n            height: Joi.number().integer().default(1200)\n          }).default(),\n          timeout: Joi.number().integer().default(6000),\n          loadDelay: Joi.number().integer().default(3000),\n          settleTime: Joi.number().integer().default(1000),\n          concurrency: Joi.number().integer().default(appConfig.concurrency),\n        }).default(),\n        encryptionKey: Joi.string()\n      }).default();\n    },\n\n    init: function (server) {\n      const thisPlugin = this;\n      const config = server.config();\n      validateConfig(config, message => server.log(['reporting', 'warning'], message));\n\n      const xpackMainPlugin = server.plugins.xpack_main;\n      mirrorPluginStatus(xpackMainPlugin, thisPlugin);\n      xpackMainPlugin.status.once('green', () => {\n        // Register a function that is called whenever the xpack info changes,\n        // to re-compute the license check results for this plugin\n        xpackMainPlugin.info.feature(thisPlugin.id).registerLicenseCheckResultsGenerator(checkLicense);\n      });\n\n      function setup() {\n        // prepare phantom binary\n        return phantom.install(config.get('path.data'))\n        .then(function (phantomPackage) {\n          server.log(['reporting', 'debug'], `Phantom installed at ${phantomPackage.binary}`);\n\n          // intialize and register application components\n          server.expose('phantom', phantomPackage);\n          server.expose('queue', createQueueFactory(server));\n\n          // Reporting routes\n          mainRoutes(server);\n          jobRoutes(server);\n        })\n        .catch(function (err) {\n          server.log(['reporting', 'error'], err);\n\n          if (!err instanceof ExtractError) {\n            thisPlugin.status.red('Failed to install phantom.js. See kibana logs for more details.');\n            return;\n          }\n\n          server.log(['reporting', 'error'], err.cause);\n\n          if (['EACCES', 'EEXIST'].includes(err.cause.code)) {\n            thisPlugin.status.red(\n              'Insufficient permissions for extracting the phantom.js archive. ' +\n              'Make sure the Kibana data directory (path.data) is owned by the same user that is running Kibana.'\n            );\n          } else {\n            thisPlugin.status.red('Failed to extract the phantom.js archive. See kibana logs for more details.');\n          }\n        });\n      }\n\n      return setup();\n    }\n  });\n};\n"
      ]
    },
    "mtime": 1491771506063
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/reporting/server/routes/main.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "boom",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "boom"
              }
            ]
          },
          {
            "source": "lodash",
            "imported": [
              "has"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "has",
                "local": "has"
              }
            ]
          },
          {
            "source": "../lib/constants",
            "imported": [
              "constants"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "constants",
                "local": "constants"
              }
            ]
          },
          {
            "source": "../lib/create_document_job",
            "imported": [
              "createDocumentJobFactory"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "createDocumentJobFactory",
                "local": "createDocumentJobFactory"
              }
            ]
          },
          {
            "source": "../lib/license_pre_routing",
            "imported": [
              "licensePreRoutingFactory"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "licensePreRoutingFactory",
                "local": "licensePreRoutingFactory"
              }
            ]
          },
          {
            "source": "../lib/user_pre_routing",
            "imported": [
              "userPreRoutingFactory"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "userPreRoutingFactory",
                "local": "userPreRoutingFactory"
              }
            ]
          },
          {
            "source": "../lib/job_response_handler",
            "imported": [
              "jobResponseHandlerFactory"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "jobResponseHandlerFactory",
                "local": "jobResponseHandlerFactory"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "main",
            "server"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "main",
              "exported": "main"
            },
            {
              "kind": "local",
              "local": "server",
              "exported": "server"
            }
          ]
        }
      },
      "usedHelpers": [
        "interop-require-default"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nexports.main = main;\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _boom = require('boom');\n\nvar _boom2 = _interopRequireDefault(_boom);\n\nvar _lodash = require('lodash');\n\nvar _libConstants = require('../lib/constants');\n\nvar _libCreate_document_job = require('../lib/create_document_job');\n\nvar _libLicense_pre_routing = require('../lib/license_pre_routing');\n\nvar _libUser_pre_routing = require('../lib/user_pre_routing');\n\nvar _libJob_response_handler = require('../lib/job_response_handler');\n\nvar mainEntry = _libConstants.constants.API_BASE_URL + '/generate';\nvar API_TAG = 'api';\n\nfunction main(server) {\n  var config = server.config();\n  var DOWNLOAD_BASE_URL = config.get('server.basePath') + (_libConstants.constants.API_BASE_URL + '/jobs/download');\n  var socketTimeout = config.get('xpack.reporting.generate.socketTimeout');\n\n  var _server$plugins$elasticsearch$getCluster = server.plugins.elasticsearch.getCluster('admin');\n\n  var esErrors = _server$plugins$elasticsearch$getCluster.errors;\n\n  var createDocumentJob = (0, _libCreate_document_job.createDocumentJobFactory)(server);\n  var licensePreRouting = (0, _libLicense_pre_routing.licensePreRoutingFactory)(server);\n  var userPreRouting = (0, _libUser_pre_routing.userPreRoutingFactory)(server);\n  var jobResponseHandler = (0, _libJob_response_handler.jobResponseHandlerFactory)(server);\n\n  function getConfig() {\n    return {\n      timeout: { socket: socketTimeout },\n      tags: [API_TAG],\n      pre: [userPreRouting, licensePreRouting]\n    };\n  };\n\n  // show error about method to user\n  server.route({\n    path: mainEntry + '/{p*}',\n    method: 'GET',\n    handler: function handler(request, reply) {\n      var err = _boom2['default'].methodNotAllowed('GET is not allowed');\n      err.output.headers.allow = 'POST';\n      reply(err);\n    },\n    config: getConfig()\n  });\n\n  // defined the public routes\n  server.route({\n    path: mainEntry + '/visualization/{savedId}',\n    method: 'POST',\n    handler: function handler(request, reply) {\n      return pdfHandler('visualization', request, reply);\n    },\n    config: getConfig()\n  });\n\n  server.route({\n    path: mainEntry + '/search/{savedId}',\n    method: 'POST',\n    handler: function handler(request, reply) {\n      return pdfHandler('search', request, reply);\n    },\n    config: getConfig()\n  });\n\n  server.route({\n    path: mainEntry + '/dashboard/{savedId}',\n    method: 'POST',\n    handler: function handler(request, reply) {\n      return pdfHandler('dashboard', request, reply);\n    },\n    config: getConfig()\n  });\n\n  function pdfHandler(objectType, request, reply) {\n    var jobType = _libConstants.constants.JOBTYPES.PRINTABLE_PDF;\n    var createJob = createDocumentJob[jobType];\n    var syncResponse = (0, _lodash.has)(request.query, 'sync');\n\n    return createJob(objectType, request).then(function (job) {\n      if (syncResponse) {\n        jobResponseHandler(request, reply, { docId: job.id, jobType: jobType }, { sync: true });\n      } else {\n        // return the queue's job information\n        var jobJson = job.toJSON();\n\n        var response = reply({\n          path: DOWNLOAD_BASE_URL + '/' + jobJson.id,\n          job: jobJson\n        });\n        response.type('application/json');\n      }\n    })['catch'](function (err) {\n      if (err instanceof esErrors['401']) return reply(_boom2['default'].unauthorized());\n      if (err instanceof esErrors['403']) return reply(_boom2['default'].forbidden('Sorry, you are not authorized to create reports'));\n      if (err instanceof esErrors['404']) return reply(_boom2['default'].wrap(err, 404));\n      reply(err);\n    });\n  }\n}\n\n;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvcmVwb3J0aW5nL3NlcnZlci9yb3V0ZXMvbWFpbi5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7b0JBQWlCLE1BQU07Ozs7c0JBQ0gsUUFBUTs7NEJBQ0Ysa0JBQWtCOztzQ0FDSCw0QkFBNEI7O3NDQUM1Qiw0QkFBNEI7O21DQUMvQix5QkFBeUI7O3VDQUNyQiw2QkFBNkI7O0FBRXZFLElBQU0sU0FBUyxHQUFNLHdCQUFVLFlBQVksY0FBVyxDQUFDO0FBQ3ZELElBQU0sT0FBTyxHQUFHLEtBQUssQ0FBQzs7QUFFZixTQUFTLElBQUksQ0FBQyxNQUFNLEVBQUU7QUFDM0IsTUFBTSxNQUFNLEdBQUcsTUFBTSxDQUFDLE1BQU0sRUFBRSxDQUFDO0FBQy9CLE1BQU0saUJBQWlCLEdBQUcsTUFBTSxDQUFDLEdBQUcsQ0FBQyxpQkFBaUIsQ0FBQyxJQUFNLHdCQUFVLFlBQVksb0JBQWdCLENBQUM7QUFDcEcsTUFBTSxhQUFhLEdBQUcsTUFBTSxDQUFDLEdBQUcsQ0FBQyx3Q0FBd0MsQ0FBQyxDQUFDOztpREFDL0MsTUFBTSxDQUFDLE9BQU8sQ0FBQyxhQUFhLENBQUMsVUFBVSxDQUFDLE9BQU8sQ0FBQzs7TUFBN0QsUUFBUSw0Q0FBZixNQUFNOztBQUVkLE1BQU0saUJBQWlCLEdBQUcsc0RBQXlCLE1BQU0sQ0FBQyxDQUFDO0FBQzNELE1BQU0saUJBQWlCLEdBQUcsc0RBQXlCLE1BQU0sQ0FBQyxDQUFDO0FBQzNELE1BQU0sY0FBYyxHQUFHLGdEQUFzQixNQUFNLENBQUMsQ0FBQztBQUNyRCxNQUFNLGtCQUFrQixHQUFHLHdEQUEwQixNQUFNLENBQUMsQ0FBQzs7QUFFN0QsV0FBUyxTQUFTLEdBQUc7QUFDbkIsV0FBTztBQUNMLGFBQU8sRUFBRSxFQUFFLE1BQU0sRUFBRSxhQUFhLEVBQUU7QUFDbEMsVUFBSSxFQUFFLENBQUMsT0FBTyxDQUFDO0FBQ2YsU0FBRyxFQUFF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QUssU0FBUyxDQUFDLGlEQUFpRCxDQUFDLENBQUMsQ0FBQztBQUNwSCxVQUFJLEdBQUcsWUFBWSxRQUFRLENBQUMsS0FBSyxDQUFDLEVBQUUsT0FBTyxLQUFLLENBQUMsa0JBQUssSUFBSSxDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUMsQ0FBQyxDQUFDO0FBQ3RFLFdBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQztLQUNaLENBQUMsQ0FBQztHQUNKO0NBQ0Y7O0FBQUEsQ0FBQyIsImZpbGUiOiIvdXNyL3NoYXJlL2tpYmFuYS9wbHVnaW5zL3gtcGFjay9wbHVnaW5zL3JlcG9ydGluZy9zZXJ2ZXIvcm91dGVzL21haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgYm9vbSBmcm9tICdib29tJztcbmltcG9ydCB7IGhhcyB9IGZyb20gJ2xvZGFzaCc7XG5pbXBvcnQgeyBjb25zdGFudHMgfSBmcm9tICcuLi9saWIvY29uc3RhbnRzJztcbmltcG9ydCB7IGNyZWF0ZURvY3VtZW50Sm9iRmFjdG9yeSB9IGZyb20gJy4uL2xpYi9jcmVhdGVfZG9jdW1lbnRfam9iJztcbmltcG9ydCB7IGxpY2Vuc2VQcmVSb3V0aW5nRmFjdG9yeSB9IGZyb20gJy4uL2xpYi9saWNlbnNlX3ByZV9yb3V0aW5nJztcbmltcG9ydCB7IHVzZXJQcmVSb3V0aW5nRmFjdG9yeSB9IGZyb20gJy4uL2xpYi91c2VyX3ByZV9yb3V0aW5nJztcbmltcG9ydCB7IGpvYlJlc3BvbnNlSGFuZGxlckZhY3RvcnkgfSBmcm9tICcuLi9saWIvam9iX3Jlc3BvbnNlX2hhbmRsZXInO1xuXG5jb25zdCBtYWluRW50cnkgPSBgJHtjb25zdGFudHMuQVBJX0JBU0VfVVJMfS9nZW5lcmF0ZWA7XG5jb25zdCBBUElfVEFHID0gJ2FwaSc7XG5cbmV4cG9ydCBmdW5jdGlvbiBtYWluKHNlcnZlcikge1xuICBjb25zdCBjb25maWcgPSBzZXJ2ZXIuY29uZmlnKCk7XG4gIGNvbnN0IERPV05MT0FEX0JBU0VfVVJMID0gY29uZmlnLmdldCgnc2VydmVyLmJhc2VQYXRoJykgKyBgJHtjb25zdGFudHMuQVBJX0JBU0VfVVJMfS9qb2JzL2Rvd25sb2FkYDtcbiAgY29uc3Qgc29ja2V0VGltZW91dCA9IGNvbmZpZy5nZXQoJ3hwYWNrLnJlcG9ydGluZy5nZW5lcmF0ZS5zb2NrZXRUaW1lb3V0Jyk7XG4gIGNvbnN0IHsgZXJyb3JzOmVzRXJyb3JzIH0gPSBzZXJ2ZXIucGx1Z2lucy5lbGFzdGljc2VhcmNoLmdldENsdXN0ZXIoJ2FkbWluJyk7XG5cbiAgY29uc3QgY3JlYXRlRG9jdW1lbnRKb2IgPSBjcmVhdGVEb2N1bWVudEpvYkZhY3Rvcnkoc2VydmVyKTtcbiAgY29uc3QgbGljZW5zZVByZVJvdXRpbmcgPSBsaWNlbnNlUHJlUm91dGluZ0ZhY3Rvcnkoc2VydmVyKTtcbiAgY29uc3QgdXNlclByZVJvdXRpbmcgPSB1c2VyUHJlUm91dGluZ0ZhY3Rvcnkoc2VydmVyKTtcbiAgY29uc3Qgam9iUmVzcG9uc2VIYW5kbGVyID0gam9iUmVzcG9uc2VIYW5kbGVyRmFjdG9yeShzZXJ2ZXIpO1xuXG4gIGZ1bmN0aW9uIGdldENvbmZpZygpIHtcbiAgICByZXR1cm4ge1xuICAgICAgdGltZW91dDogeyBzb2NrZXQ6IHNvY2tldFRpbWVvdXQgfSxcbiAgICAgIHRhZ3M6IFtBUElfVEFHXSxcbiAgICAgIHByZTogWyB1c2VyUHJlUm91dGluZywgbGljZW5zZVByZVJvdXRpbmcgXSxcbiAgICB9O1xuICB9O1xuXG4gIC8vIHNob3cgZXJyb3IgYWJvdXQgbWV0aG9kIHRvIHVzZXJcbiAgc2VydmVyLnJvdXRlKHtcbiAgICBwYXRoOiBgJHttYWluRW50cnl9L3twKn1gLFxuICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgaGFuZGxlcjogKHJlcXVlc3QsIHJlcGx5KSA9PiB7XG4gICAgICBjb25zdCBlcnIgPSBib29tLm1ldGhvZE5vdEFsbG93ZWQoJ0dFVCBpcyBub3QgYWxsb3dlZCcpO1xuICAgICAgZXJyLm91dHB1dC5oZWFkZXJzLmFsbG93ID0gJ1BPU1QnO1xuICAgICAgcmVwbHkoZXJyKTtcbiAgICB9LFxuICAgIGNvbmZpZzogZ2V0Q29uZmlnKCksXG4gIH0pO1xuXG4gIC8vIGRlZmluZWQgdGhlIHB1YmxpYyByb3V0ZXNcbiAgc2VydmVyLnJvdXRlKHtcbiAgICBwYXRoOiBgJHttYWluRW50cnl9L3Zpc3VhbGl6YXRpb24ve3NhdmVkSWR9YCxcbiAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICBoYW5kbGVyOiAocmVxdWVzdCwgcmVwbHkpID0+IHBkZkhhbmRsZXIoJ3Zpc3VhbGl6YXRpb24nLCByZXF1ZXN0LCByZXBseSksXG4gICAgY29uZmlnOiBnZXRDb25maWcoKSxcbiAgfSk7XG5cbiAgc2VydmVyLnJvdXRlKHtcbiAgICBwYXRoOiBgJHttYWluRW50cnl9L3NlYXJjaC97c2F2ZWRJZH1gLFxuICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgIGhhbmRsZXI6IChyZXF1ZXN0LCByZXBseSkgPT4gcGRmSGFuZGxlcignc2VhcmNoJywgcmVxdWVzdCwgcmVwbHkpLFxuICAgIGNvbmZpZzogZ2V0Q29uZmlnKCksXG4gIH0pO1xuXG4gIHNlcnZlci5yb3V0ZSh7XG4gICAgcGF0aDogYCR7bWFpbkVudHJ5fS9kYXNoYm9hcmQve3NhdmVkSWR9YCxcbiAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICBoYW5kbGVyOiAocmVxdWVzdCwgcmVwbHkpID0+IHBkZkhhbmRsZXIoJ2Rhc2hib2FyZCcsIHJlcXVlc3QsIHJlcGx5KSxcbiAgICBjb25maWc6IGdldENvbmZpZygpLFxuICB9KTtcblxuICBmdW5jdGlvbiBwZGZIYW5kbGVyKG9iamVjdFR5cGUsIHJlcXVlc3QsIHJlcGx5KSB7XG4gICAgY29uc3Qgam9iVHlwZSA9IGNvbnN0YW50cy5KT0JUWVBFUy5QUklOVEFCTEVfUERGO1xuICAgIGNvbnN0IGNyZWF0ZUpvYiA9IGNyZWF0ZURvY3VtZW50Sm9iW2pvYlR5cGVdO1xuICAgIGNvbnN0IHN5bmNSZXNwb25zZSA9IGhhcyhyZXF1ZXN0LnF1ZXJ5LCAnc3luYycpO1xuXG4gICAgcmV0dXJuIGNyZWF0ZUpvYihvYmplY3RUeXBlLCByZXF1ZXN0KVxuICAgIC50aGVuKChqb2IpID0+IHtcbiAgICAgIGlmIChzeW5jUmVzcG9uc2UpIHtcbiAgICAgICAgam9iUmVzcG9uc2VIYW5kbGVyKHJlcXVlc3QsIHJlcGx5LCB7IGRvY0lkOiBqb2IuaWQsIGpvYlR5cGUgfSwgeyBzeW5jOiB0cnVlIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gcmV0dXJuIHRoZSBxdWV1ZSdzIGpvYiBpbmZvcm1hdGlvblxuICAgICAgICBjb25zdCBqb2JKc29uID0gam9iLnRvSlNPTigpO1xuXG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gcmVwbHkoe1xuICAgICAgICAgIHBhdGg6IGAke0RPV05MT0FEX0JBU0VfVVJMfS8ke2pvYkpzb24uaWR9YCxcbiAgICAgICAgICBqb2I6IGpvYkpzb24sXG4gICAgICAgIH0pO1xuICAgICAgICByZXNwb25zZS50eXBlKCdhcHBsaWNhdGlvbi9qc29uJyk7XG4gICAgICB9XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgaWYgKGVyciBpbnN0YW5jZW9mIGVzRXJyb3JzWyc0MDEnXSkgcmV0dXJuIHJlcGx5KGJvb20udW5hdXRob3JpemVkKCkpO1xuICAgICAgaWYgKGVyciBpbnN0YW5jZW9mIGVzRXJyb3JzWyc0MDMnXSkgcmV0dXJuIHJlcGx5KGJvb20uZm9yYmlkZGVuKCdTb3JyeSwgeW91IGFyZSBub3QgYXV0aG9yaXplZCB0byBjcmVhdGUgcmVwb3J0cycpKTtcbiAgICAgIGlmIChlcnIgaW5zdGFuY2VvZiBlc0Vycm9yc1snNDA0J10pIHJldHVybiByZXBseShib29tLndyYXAoZXJyLCA0MDQpKTtcbiAgICAgIHJlcGx5KGVycik7XG4gICAgfSk7XG4gIH1cbn07XG4iXX0=",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/routes/main.js"
      ],
      "names": [],
      "mappings": "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",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/routes/main.js",
      "sourcesContent": [
        "import boom from 'boom';\nimport { has } from 'lodash';\nimport { constants } from '../lib/constants';\nimport { createDocumentJobFactory } from '../lib/create_document_job';\nimport { licensePreRoutingFactory } from '../lib/license_pre_routing';\nimport { userPreRoutingFactory } from '../lib/user_pre_routing';\nimport { jobResponseHandlerFactory } from '../lib/job_response_handler';\n\nconst mainEntry = `${constants.API_BASE_URL}/generate`;\nconst API_TAG = 'api';\n\nexport function main(server) {\n  const config = server.config();\n  const DOWNLOAD_BASE_URL = config.get('server.basePath') + `${constants.API_BASE_URL}/jobs/download`;\n  const socketTimeout = config.get('xpack.reporting.generate.socketTimeout');\n  const { errors:esErrors } = server.plugins.elasticsearch.getCluster('admin');\n\n  const createDocumentJob = createDocumentJobFactory(server);\n  const licensePreRouting = licensePreRoutingFactory(server);\n  const userPreRouting = userPreRoutingFactory(server);\n  const jobResponseHandler = jobResponseHandlerFactory(server);\n\n  function getConfig() {\n    return {\n      timeout: { socket: socketTimeout },\n      tags: [API_TAG],\n      pre: [ userPreRouting, licensePreRouting ],\n    };\n  };\n\n  // show error about method to user\n  server.route({\n    path: `${mainEntry}/{p*}`,\n    method: 'GET',\n    handler: (request, reply) => {\n      const err = boom.methodNotAllowed('GET is not allowed');\n      err.output.headers.allow = 'POST';\n      reply(err);\n    },\n    config: getConfig(),\n  });\n\n  // defined the public routes\n  server.route({\n    path: `${mainEntry}/visualization/{savedId}`,\n    method: 'POST',\n    handler: (request, reply) => pdfHandler('visualization', request, reply),\n    config: getConfig(),\n  });\n\n  server.route({\n    path: `${mainEntry}/search/{savedId}`,\n    method: 'POST',\n    handler: (request, reply) => pdfHandler('search', request, reply),\n    config: getConfig(),\n  });\n\n  server.route({\n    path: `${mainEntry}/dashboard/{savedId}`,\n    method: 'POST',\n    handler: (request, reply) => pdfHandler('dashboard', request, reply),\n    config: getConfig(),\n  });\n\n  function pdfHandler(objectType, request, reply) {\n    const jobType = constants.JOBTYPES.PRINTABLE_PDF;\n    const createJob = createDocumentJob[jobType];\n    const syncResponse = has(request.query, 'sync');\n\n    return createJob(objectType, request)\n    .then((job) => {\n      if (syncResponse) {\n        jobResponseHandler(request, reply, { docId: job.id, jobType }, { sync: true });\n      } else {\n        // return the queue's job information\n        const jobJson = job.toJSON();\n\n        const response = reply({\n          path: `${DOWNLOAD_BASE_URL}/${jobJson.id}`,\n          job: jobJson,\n        });\n        response.type('application/json');\n      }\n    })\n    .catch((err) => {\n      if (err instanceof esErrors['401']) return reply(boom.unauthorized());\n      if (err instanceof esErrors['403']) return reply(boom.forbidden('Sorry, you are not authorized to create reports'));\n      if (err instanceof esErrors['404']) return reply(boom.wrap(err, 404));\n      reply(err);\n    });\n  }\n};\n"
      ]
    },
    "mtime": 1491771510542
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/constants.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [],
        "exports": {
          "exported": [
            "constants"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "constants",
              "exported": "constants"
            }
          ]
        }
      },
      "usedHelpers": []
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nvar constants = {\n  QUEUE_INDEX: '.reporting',\n  QUEUE_DOCTYPE: 'esqueue',\n\n  JOBTYPES: {\n    PRINTABLE_PDF: 'printable_pdf'\n  },\n\n  JOB_COMPLETION_CHECK_FREQUENCY_IN_MS: 10000,\n  JOB_COMPLETION_STORAGE_KEY_LAST_CHECK: 'xpack.reporting.jobCompletionLastCheckedOn',\n\n  PHANTOM_MAX_LOAD_TIMEOUT: 30000,\n\n  API_BASE_URL: '/api/reporting'\n};\nexports.constants = constants;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvcmVwb3J0aW5nL3NlcnZlci9saWIvY29uc3RhbnRzLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQU8sSUFBTSxTQUFTLEdBQUc7QUFDdkIsYUFBVyxFQUFFLFlBQVk7QUFDekIsZUFBYSxFQUFFLFNBQVM7O0FBRXhCLFVBQVEsRUFBRTtBQUNSLGlCQUFhLEVBQUUsZUFBZTtHQUMvQjs7QUFFRCxzQ0FBb0MsRUFBRSxLQUFLO0FBQzNDLHVDQUFxQyxFQUFFLDRDQUE0Qzs7QUFFbkYsMEJBQXdCLEVBQUUsS0FBSzs7QUFFL0IsY0FBWSxFQUFFLGdCQUFnQjtDQUMvQixDQUFDIiwiZmlsZSI6Ii91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvcmVwb3J0aW5nL3NlcnZlci9saWIvY29uc3RhbnRzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNvbnN0IGNvbnN0YW50cyA9IHtcbiAgUVVFVUVfSU5ERVg6ICcucmVwb3J0aW5nJyxcbiAgUVVFVUVfRE9DVFlQRTogJ2VzcXVldWUnLFxuXG4gIEpPQlRZUEVTOiB7XG4gICAgUFJJTlRBQkxFX1BERjogJ3ByaW50YWJsZV9wZGYnLFxuICB9LFxuXG4gIEpPQl9DT01QTEVUSU9OX0NIRUNLX0ZSRVFVRU5DWV9JTl9NUzogMTAwMDAsXG4gIEpPQl9DT01QTEVUSU9OX1NUT1JBR0VfS0VZX0xBU1RfQ0hFQ0s6ICd4cGFjay5yZXBvcnRpbmcuam9iQ29tcGxldGlvbkxhc3RDaGVja2VkT24nLFxuXG4gIFBIQU5UT01fTUFYX0xPQURfVElNRU9VVDogMzAwMDAsXG5cbiAgQVBJX0JBU0VfVVJMOiAnL2FwaS9yZXBvcnRpbmcnXG59O1xuIl19",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/constants.js"
      ],
      "names": [],
      "mappings": ";;;;;AAAO,IAAM,SAAS,GAAG;AACvB,aAAW,EAAE,YAAY;AACzB,eAAa,EAAE,SAAS;;AAExB,UAAQ,EAAE;AACR,iBAAa,EAAE,eAAe;GAC/B;;AAED,sCAAoC,EAAE,KAAK;AAC3C,uCAAqC,EAAE,4CAA4C;;AAEnF,0BAAwB,EAAE,KAAK;;AAE/B,cAAY,EAAE,gBAAgB;CAC/B,CAAC",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/constants.js",
      "sourcesContent": [
        "export const constants = {\n  QUEUE_INDEX: '.reporting',\n  QUEUE_DOCTYPE: 'esqueue',\n\n  JOBTYPES: {\n    PRINTABLE_PDF: 'printable_pdf',\n  },\n\n  JOB_COMPLETION_CHECK_FREQUENCY_IN_MS: 10000,\n  JOB_COMPLETION_STORAGE_KEY_LAST_CHECK: 'xpack.reporting.jobCompletionLastCheckedOn',\n\n  PHANTOM_MAX_LOAD_TIMEOUT: 30000,\n\n  API_BASE_URL: '/api/reporting'\n};\n"
      ]
    },
    "mtime": 1491771510540
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/create_document_job.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "moment",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "moment"
              }
            ]
          },
          {
            "source": "lodash",
            "imported": [
              "get"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "get",
                "local": "get"
              }
            ]
          },
          {
            "source": "esqueue/lib/constants/events",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "esqueueEvents"
              }
            ]
          },
          {
            "source": "./constants",
            "imported": [
              "constants"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "constants",
                "local": "constants"
              }
            ]
          },
          {
            "source": "./get_user",
            "imported": [
              "getUserFactory"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "getUserFactory",
                "local": "getUserFactory"
              }
            ]
          },
          {
            "source": "./get_object_queue",
            "imported": [
              "getObjectQueueFactory"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "getObjectQueueFactory",
                "local": "getObjectQueueFactory"
              }
            ]
          },
          {
            "source": "./crypto",
            "imported": [
              "cryptoFactory"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "cryptoFactory",
                "local": "cryptoFactory"
              }
            ]
          },
          {
            "source": "./once_per_server",
            "imported": [
              "oncePerServer"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "oncePerServer",
                "local": "oncePerServer"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "createDocumentJobFactory"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "createDocumentJobFactory",
              "exported": "createDocumentJobFactory"
            }
          ]
        }
      },
      "usedHelpers": [
        "interop-require-default"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _moment = require('moment');\n\nvar _moment2 = _interopRequireDefault(_moment);\n\nvar _lodash = require('lodash');\n\nvar _esqueueLibConstantsEvents = require('esqueue/lib/constants/events');\n\nvar _esqueueLibConstantsEvents2 = _interopRequireDefault(_esqueueLibConstantsEvents);\n\nvar _constants = require('./constants');\n\nvar _get_user = require('./get_user');\n\nvar _get_object_queue = require('./get_object_queue');\n\nvar _crypto = require('./crypto');\n\nvar _once_per_server = require('./once_per_server');\n\nfunction createDocumentJobFn(server) {\n  var jobQueue = server.plugins.reporting.queue;\n  var filterHeaders = server.plugins.elasticsearch.filterHeaders;\n  var queueConfig = server.config().get('xpack.reporting.queue');\n  var whitelistHeaders = server.config().get('elasticsearch.requestHeadersWhitelist');\n\n  var getObjectQueue = (0, _get_object_queue.getObjectQueueFactory)(server);\n  var getUser = (0, _get_user.getUserFactory)(server);\n  var crypto = (0, _crypto.cryptoFactory)(server);\n\n  var JOBTYPES = _constants.constants.JOBTYPES;\n\n  var jobTypes = {};\n\n  jobTypes[JOBTYPES.PRINTABLE_PDF] = function callee$1$0(objectType, request) {\n    var date, objId, query, headers, serializedEncryptedHeaders;\n    return regeneratorRuntime.async(function callee$1$0$(context$2$0) {\n      while (1) switch (context$2$0.prev = context$2$0.next) {\n        case 0:\n          date = (0, _moment2['default'])().toISOString();\n          objId = request.params.savedId;\n          query = request.query;\n          headers = (0, _lodash.get)(request, 'headers');\n          context$2$0.next = 6;\n          return regeneratorRuntime.awrap(crypto.encrypt(headers));\n\n        case 6:\n          serializedEncryptedHeaders = context$2$0.sent;\n          return context$2$0.abrupt('return', getUser(request).then(function (user) {\n            // get resulting kibana saved object documents\n            return getObjectQueue(request, objectType, objId).then(function (objectQueue) {\n              server.log(['reporting', 'debug'], objectQueue.objects.length + ' saved object(s) to process');\n\n              var savedObjects = objectQueue.objects.map(function (savedObj) {\n                return savedObj.toJSON(query);\n              });\n\n              var payload = {\n                id: objectQueue.id,\n                title: objectQueue.title,\n                description: objectQueue.description,\n                type: objectQueue.type,\n                objects: savedObjects,\n                date: date,\n                query: query,\n                headers: serializedEncryptedHeaders\n              };\n\n              var options = {\n                timeout: queueConfig.timeout * objectQueue.objects.length,\n                created_by: (0, _lodash.get)(user, 'username', false),\n                headers: filterHeaders(headers, whitelistHeaders)\n              };\n\n              return { payload: payload, options: options };\n            }).then(function (params) {\n              var payload = params.payload;\n              var options = params.options;\n\n              return new Promise(function (resolve, reject) {\n                var job = jobQueue.addJob(JOBTYPES.PRINTABLE_PDF, payload, options);\n                job.on(_esqueueLibConstantsEvents2['default'].EVENT_JOB_CREATED, function () {\n                  return resolve(job);\n                });\n                job.on(_esqueueLibConstantsEvents2['default'].EVENT_JOB_CREATE_ERROR, reject);\n              });\n            });\n          }));\n\n        case 8:\n        case 'end':\n          return context$2$0.stop();\n      }\n    }, null, this);\n  };\n\n  return jobTypes;\n}\n\nvar createDocumentJobFactory = (0, _once_per_server.oncePerServer)(createDocumentJobFn);\nexports.createDocumentJobFactory = createDocumentJobFactory;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvcmVwb3J0aW5nL3NlcnZlci9saWIvY3JlYXRlX2RvY3VtZW50X2pvYi5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7OztzQkFBbUIsUUFBUTs7OztzQkFDUCxRQUFROzt5Q0FDRiw4QkFBOEI7Ozs7eUJBQzlCLGFBQWE7O3dCQUNSLFlBQVk7O2dDQUNMLG9CQUFvQjs7c0JBQzVCLFVBQVU7OytCQUNWLG1CQUFtQjs7QUFFakQsU0FBUyxtQkFBbUIsQ0FBQyxNQUFNLEVBQUU7QUFDbkMsTUFBTSxRQUFRLEdBQUcsTUFBTSxDQUFDLE9BQU8sQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDO0FBQ2hELE1BQU0sYUFBYSxHQUFHLE1BQU0sQ0FBQyxPQUFPLENBQUMsYUFBYSxDQUFDLGFBQWEsQ0FBQztBQUNqRSxNQUFNLFdBQVcsR0FBRyxNQUFNLENBQUMsTUFBTSxFQUFFLENBQUMsR0FBRyxDQUFDLHVCQUF1QixDQUFDLENBQUM7QUFDakUsTUFBTSxnQkFBZ0IsR0FBRyxNQUFNLENBQUMsTUFBTSxFQUFFLENBQUMsR0FBRyxDQUFDLHVDQUF1QyxDQUFDLENBQUM7O0FBRXRGLE1BQU0sY0FBYyxHQUFHLDZDQUFzQixNQUFNLENBQUMsQ0FBQztBQUNyRCxNQUFNLE9BQU8sR0FBRyw4QkFBZSxNQUFNLENBQUMsQ0FBQztBQUN2QyxNQUFNLE1BQU0sR0FBRywyQkFBYyxNQUFNLENBQUMsQ0FBQzs7TUFFN0IsUUFBUSx3QkFBUixRQUFROztBQUNoQixNQUFNLFFBQVEsR0FBRyxFQUFFLENBQUM7O0FBRXBCLFVBQVEsQ0FBQyxRQUFRLENBQUMsYUFBYSxDQUFDLEdBQUcsb0JBQWdCLFVBQVUsRUFBRSxPQUFPO1FBQzlELElBQUksRUFDSixLQUFLLEVBQ0wsS0FBSyxFQUVMLE9BQU8sRUFDUCwwQkFBMEI7Ozs7QUFMMUIsY0FBSSxHQUFHLDBCQUFRLENBQUMsV0FBVyxFQUFFO0FBQzdCLGVBQUssR0FBRyxPQUFPLENBQUMsTUFBTSxDQUFDLE9BQU87QUFDOUIsZUFBSyxHQUFHLE9BQU8sQ0FBQyxLQUFLO0FBRXJCLGlCQUFPLEdBQUcsaUJBQUksT0FBTyxFQUFFLFNBQVMsQ0FBQzs7MENBQ0UsTUFBTSxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUM7OztBQUExRCxvQ0FBMEI7OENBRXpCLE9BQU8sQ0FBQyxPQUFPLENBQUMsQ0FDdEIsSUFBSSxDQUFDLFVBQUMsSUFBSSxFQUFLOztBQUVkLG1CQUFPLGNBQWMsQ0FBQyxPQUFPLEVBQUUsVUFBVSxFQUFFLEtBQUssQ0FBQyxDQUNoRCxJQUFJLENBQUMsVUFBVSxXQUFXLEVBQUU7QUFDM0Isb0JBQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxXQUFXLEVBQUUsT0FBTyxDQUFDLEVBQUssV0FBVyxDQUFDLE9BQU8sQ0FBQyxNQUFNLGlDQUE4QixDQUFDOztBQUUvRixrQkFBTSxZQUFZLEdBQUcsV0FBVyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsVUFBQyxRQUFRO3VCQUFLLFFBQVEsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDO2VBQUEsQ0FBQyxDQUFDOztBQUVuRixrQkFBTSxPQUFPLEdBQUc7QUFDZCxrQkFBRSxFQUFFLFdBQVcsQ0FBQyxFQUFFO0FBQ2xCLHFCQUFLLEVBQUUsV0FBVyxDQUFDLEtBQUs7QUFDeEIsMkJBQVcsRUFBRSxXQUFXLENBQUMsV0FBVztBQUNwQyxvQkFBSSxFQUFFLFdBQVcsQ0FBQyxJQUFJO0FBQ3RCLHVCQUFPLEVBQUUsWUFBWTtBQUNyQixvQkFBSSxFQUFKLElBQUk7QUFDSixxQkFBSyxFQUFMLEtBQUs7QUFDTCx1QkFBTyxFQUFFLDBCQUEwQjtlQUNwQyxDQUFDOztBQUVGLGtCQUFNLE9BQU8sR0FBRztBQUNkLHVCQUFPLEVBQUUsV0FBVyxDQUFDLE9BQU8sR0FBRyxXQUFXLENBQUMsT0FBTyxDQUFDLE1BQU07QUFDekQsMEJBQVUsRUFBRSxpQkFBSSxJQUFJLEVBQUUsVUFBVSxFQUFFLEtBQUssQ0FBQztBQUN4Qyx1QkFBTyxFQUFFLGFBQWEsQ0FBQyxPQUFPLEVBQUUsZ0JBQWdCLENBQUM7ZUFDbEQsQ0FBQzs7QUFFRixxQkFBTyxFQUFFLE9BQU8sRUFBUCxPQUFPLEVBQUUsT0FBTyxFQUFQLE9BQU8sRUFBRSxDQUFDO2FBQzdCLENBQUMsQ0FDRCxJQUFJLENBQUMsVUFBQSxNQUFNLEVBQUk7a0JBQ04sT0FBTyxHQUFjLE1BQU0sQ0FBM0IsT0FBTztrQkFBRSxPQUFPLEdBQUssTUFBTSxDQUFsQixPQUFPOztBQUV4QixxQkFBTyxJQUFJLE9BQU8sQ0FBQyxVQUFDLE9BQU8sRUFBRSxNQUFNLEVBQUs7QUFDdEMsb0JBQU0sR0FBRyxHQUFHLFFBQVEsQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLGFBQWEsRUFBRSxPQUFPLEVBQUUsT0FBTyxDQUFDLENBQUM7QUFDdEUsbUJBQUcsQ0FBQyxFQUFFLENBQUMsdUNBQWMsaUJBQWlCLEVBQUU7eUJBQU0sT0FBTyxDQUFDLEdBQUcsQ0FBQztpQkFBQSxDQUFDLENBQUM7QUFDNUQsbUJBQUcsQ0FBQyxFQUFFLENBQUMsdUNBQWMsc0JBQXNCLEVBQUUsTUFBTSxDQUFDLENBQUM7ZUFDdEQsQ0FBQyxDQUFDO2FBQ0osQ0FBQyxDQUFDO1dBQ0osQ0FBQzs7Ozs7OztHQUNILENBQUM7O0FBRUYsU0FBTyxRQUFRLENBQUM7Q0FDakI7O0FBRU0sSUFBTSx3QkFBd0IsR0FBRyxvQ0FBYyxtQkFBbUIsQ0FBQyxDQUFDIiwiZmlsZSI6Ii91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvcmVwb3J0aW5nL3NlcnZlci9saWIvY3JlYXRlX2RvY3VtZW50X2pvYi5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50JztcbmltcG9ydCB7IGdldCB9IGZyb20gJ2xvZGFzaCc7XG5pbXBvcnQgZXNxdWV1ZUV2ZW50cyBmcm9tICdlc3F1ZXVlL2xpYi9jb25zdGFudHMvZXZlbnRzJztcbmltcG9ydCB7IGNvbnN0YW50cyB9IGZyb20gJy4vY29uc3RhbnRzJztcbmltcG9ydCB7IGdldFVzZXJGYWN0b3J5IH0gZnJvbSAnLi9nZXRfdXNlcic7XG5pbXBvcnQgeyBnZXRPYmplY3RRdWV1ZUZhY3RvcnkgfSBmcm9tICcuL2dldF9vYmplY3RfcXVldWUnO1xuaW1wb3J0IHsgY3J5cHRvRmFjdG9yeSB9IGZyb20gJy4vY3J5cHRvJztcbmltcG9ydCB7IG9uY2VQZXJTZXJ2ZXIgfSBmcm9tICcuL29uY2VfcGVyX3NlcnZlcic7XG5cbmZ1bmN0aW9uIGNyZWF0ZURvY3VtZW50Sm9iRm4oc2VydmVyKSB7XG4gIGNvbnN0IGpvYlF1ZXVlID0gc2VydmVyLnBsdWdpbnMucmVwb3J0aW5nLnF1ZXVlO1xuICBjb25zdCBmaWx0ZXJIZWFkZXJzID0gc2VydmVyLnBsdWdpbnMuZWxhc3RpY3NlYXJjaC5maWx0ZXJIZWFkZXJzO1xuICBjb25zdCBxdWV1ZUNvbmZpZyA9IHNlcnZlci5jb25maWcoKS5nZXQoJ3hwYWNrLnJlcG9ydGluZy5xdWV1ZScpO1xuICBjb25zdCB3aGl0ZWxpc3RIZWFkZXJzID0gc2VydmVyLmNvbmZpZygpLmdldCgnZWxhc3RpY3NlYXJjaC5yZXF1ZXN0SGVhZGVyc1doaXRlbGlzdCcpO1xuXG4gIGNvbnN0IGdldE9iamVjdFF1ZXVlID0gZ2V0T2JqZWN0UXVldWVGYWN0b3J5KHNlcnZlcik7XG4gIGNvbnN0IGdldFVzZXIgPSBnZXRVc2VyRmFjdG9yeShzZXJ2ZXIpO1xuICBjb25zdCBjcnlwdG8gPSBjcnlwdG9GYWN0b3J5KHNlcnZlcik7XG5cbiAgY29uc3QgeyBKT0JUWVBFUyB9ID0gY29uc3RhbnRzO1xuICBjb25zdCBqb2JUeXBlcyA9IHt9O1xuXG4gIGpvYlR5cGVzW0pPQlRZUEVTLlBSSU5UQUJMRV9QREZdID0gYXN5bmMgZnVuY3Rpb24gKG9iamVjdFR5cGUsIHJlcXVlc3QpIHtcbiAgICBjb25zdCBkYXRlID0gbW9tZW50KCkudG9JU09TdHJpbmcoKTtcbiAgICBjb25zdCBvYmpJZCA9IHJlcXVlc3QucGFyYW1zLnNhdmVkSWQ7XG4gICAgY29uc3QgcXVlcnkgPSByZXF1ZXN0LnF1ZXJ5O1xuXG4gICAgY29uc3QgaGVhZGVycyA9IGdldChyZXF1ZXN0LCAnaGVhZGVycycpO1xuICAgIGNvbnN0IHNlcmlhbGl6ZWRFbmNyeXB0ZWRIZWFkZXJzID0gYXdhaXQgY3J5cHRvLmVuY3J5cHQoaGVhZGVycyk7XG5cbiAgICByZXR1cm4gZ2V0VXNlcihyZXF1ZXN0KVxuICAgIC50aGVuKCh1c2VyKSA9PiB7XG4gICAgICAvLyBnZXQgcmVzdWx0aW5nIGtpYmFuYSBzYXZlZCBvYmplY3QgZG9jdW1lbnRzXG4gICAgICByZXR1cm4gZ2V0T2JqZWN0UXVldWUocmVxdWVzdCwgb2JqZWN0VHlwZSwgb2JqSWQpXG4gICAgICAudGhlbihmdW5jdGlvbiAob2JqZWN0UXVldWUpIHtcbiAgICAgICAgc2VydmVyLmxvZyhbJ3JlcG9ydGluZycsICdkZWJ1ZyddLCBgJHtvYmplY3RRdWV1ZS5vYmplY3RzLmxlbmd0aH0gc2F2ZWQgb2JqZWN0KHMpIHRvIHByb2Nlc3NgKTtcblxuICAgICAgICBjb25zdCBzYXZlZE9iamVjdHMgPSBvYmplY3RRdWV1ZS5vYmplY3RzLm1hcCgoc2F2ZWRPYmopID0+IHNhdmVkT2JqLnRvSlNPTihxdWVyeSkpO1xuXG4gICAgICAgIGNvbnN0IHBheWxvYWQgPSB7XG4gICAgICAgICAgaWQ6IG9iamVjdFF1ZXVlLmlkLFxuICAgICAgICAgIHRpdGxlOiBvYmplY3RRdWV1ZS50aXRsZSxcbiAgICAgICAgICBkZXNjcmlwdGlvbjogb2JqZWN0UXVldWUuZGVzY3JpcHRpb24sXG4gICAgICAgICAgdHlwZTogb2JqZWN0UXVldWUudHlwZSxcbiAgICAgICAgICBvYmplY3RzOiBzYXZlZE9iamVjdHMsXG4gICAgICAgICAgZGF0ZSxcbiAgICAgICAgICBxdWVyeSxcbiAgICAgICAgICBoZWFkZXJzOiBzZXJpYWxpemVkRW5jcnlwdGVkSGVhZGVycyxcbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdCBvcHRpb25zID0ge1xuICAgICAgICAgIHRpbWVvdXQ6IHF1ZXVlQ29uZmlnLnRpbWVvdXQgKiBvYmplY3RRdWV1ZS5vYmplY3RzLmxlbmd0aCxcbiAgICAgICAgICBjcmVhdGVkX2J5OiBnZXQodXNlciwgJ3VzZXJuYW1lJywgZmFsc2UpLFxuICAgICAgICAgIGhlYWRlcnM6IGZpbHRlckhlYWRlcnMoaGVhZGVycywgd2hpdGVsaXN0SGVhZGVycyksXG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIHsgcGF5bG9hZCwgb3B0aW9ucyB9O1xuICAgICAgfSlcbiAgICAgIC50aGVuKHBhcmFtcyA9PiB7XG4gICAgICAgIGNvbnN0IHsgcGF5bG9hZCwgb3B0aW9ucyB9ID0gcGFyYW1zO1xuXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgY29uc3Qgam9iID0gam9iUXVldWUuYWRkSm9iKEpPQlRZUEVTLlBSSU5UQUJMRV9QREYsIHBheWxvYWQsIG9wdGlvbnMpO1xuICAgICAgICAgIGpvYi5vbihlc3F1ZXVlRXZlbnRzLkVWRU5UX0pPQl9DUkVBVEVELCAoKSA9PiByZXNvbHZlKGpvYikpO1xuICAgICAgICAgIGpvYi5vbihlc3F1ZXVlRXZlbnRzLkVWRU5UX0pPQl9DUkVBVEVfRVJST1IsIHJlamVjdCk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH07XG5cbiAgcmV0dXJuIGpvYlR5cGVzO1xufVxuXG5leHBvcnQgY29uc3QgY3JlYXRlRG9jdW1lbnRKb2JGYWN0b3J5ID0gb25jZVBlclNlcnZlcihjcmVhdGVEb2N1bWVudEpvYkZuKTtcbiJdfQ==",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/create_document_job.js"
      ],
      "names": [],
      "mappings": "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",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/create_document_job.js",
      "sourcesContent": [
        "import moment from 'moment';\nimport { get } from 'lodash';\nimport esqueueEvents from 'esqueue/lib/constants/events';\nimport { constants } from './constants';\nimport { getUserFactory } from './get_user';\nimport { getObjectQueueFactory } from './get_object_queue';\nimport { cryptoFactory } from './crypto';\nimport { oncePerServer } from './once_per_server';\n\nfunction createDocumentJobFn(server) {\n  const jobQueue = server.plugins.reporting.queue;\n  const filterHeaders = server.plugins.elasticsearch.filterHeaders;\n  const queueConfig = server.config().get('xpack.reporting.queue');\n  const whitelistHeaders = server.config().get('elasticsearch.requestHeadersWhitelist');\n\n  const getObjectQueue = getObjectQueueFactory(server);\n  const getUser = getUserFactory(server);\n  const crypto = cryptoFactory(server);\n\n  const { JOBTYPES } = constants;\n  const jobTypes = {};\n\n  jobTypes[JOBTYPES.PRINTABLE_PDF] = async function (objectType, request) {\n    const date = moment().toISOString();\n    const objId = request.params.savedId;\n    const query = request.query;\n\n    const headers = get(request, 'headers');\n    const serializedEncryptedHeaders = await crypto.encrypt(headers);\n\n    return getUser(request)\n    .then((user) => {\n      // get resulting kibana saved object documents\n      return getObjectQueue(request, objectType, objId)\n      .then(function (objectQueue) {\n        server.log(['reporting', 'debug'], `${objectQueue.objects.length} saved object(s) to process`);\n\n        const savedObjects = objectQueue.objects.map((savedObj) => savedObj.toJSON(query));\n\n        const payload = {\n          id: objectQueue.id,\n          title: objectQueue.title,\n          description: objectQueue.description,\n          type: objectQueue.type,\n          objects: savedObjects,\n          date,\n          query,\n          headers: serializedEncryptedHeaders,\n        };\n\n        const options = {\n          timeout: queueConfig.timeout * objectQueue.objects.length,\n          created_by: get(user, 'username', false),\n          headers: filterHeaders(headers, whitelistHeaders),\n        };\n\n        return { payload, options };\n      })\n      .then(params => {\n        const { payload, options } = params;\n\n        return new Promise((resolve, reject) => {\n          const job = jobQueue.addJob(JOBTYPES.PRINTABLE_PDF, payload, options);\n          job.on(esqueueEvents.EVENT_JOB_CREATED, () => resolve(job));\n          job.on(esqueueEvents.EVENT_JOB_CREATE_ERROR, reject);\n        });\n      });\n    });\n  };\n\n  return jobTypes;\n}\n\nexport const createDocumentJobFactory = oncePerServer(createDocumentJobFn);\n"
      ]
    },
    "mtime": 1491771510540
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/get_user.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "lodash",
            "imported": [
              "get"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "get",
                "local": "get"
              }
            ]
          },
          {
            "source": "./once_per_server",
            "imported": [
              "oncePerServer"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "oncePerServer",
                "local": "oncePerServer"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "getUserFactory"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "getUserFactory",
              "exported": "getUserFactory"
            }
          ]
        }
      },
      "usedHelpers": []
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nvar _lodash = require('lodash');\n\nvar _once_per_server = require('./once_per_server');\n\nfunction getUserFactoryFn(server) {\n  return function (request) {\n    var getUser = (0, _lodash.get)(server.plugins, 'security.getUser', function () {});\n    return Promise.resolve(getUser(request));\n  };\n}\n\nvar getUserFactory = (0, _once_per_server.oncePerServer)(getUserFactoryFn);\nexports.getUserFactory = getUserFactory;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvcmVwb3J0aW5nL3NlcnZlci9saWIvZ2V0X3VzZXIuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7O3NCQUFvQixRQUFROzsrQkFDRSxtQkFBbUI7O0FBRWpELFNBQVMsZ0JBQWdCLENBQUMsTUFBTSxFQUFFO0FBQ2hDLFNBQU8sVUFBQyxPQUFPLEVBQUs7QUFDbEIsUUFBTSxPQUFPLEdBQUcsaUJBQUksTUFBTSxDQUFDLE9BQU8sRUFBRSxrQkFBa0IsRUFBRSxZQUFZLEVBQUUsQ0FBQyxDQUFDO0FBQ3hFLFdBQU8sT0FBTyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQztHQUMxQyxDQUFDO0NBQ0g7O0FBRU0sSUFBTSxjQUFjLEdBQUcsb0NBQWMsZ0JBQWdCLENBQUMsQ0FBQyIsImZpbGUiOiIvdXNyL3NoYXJlL2tpYmFuYS9wbHVnaW5zL3gtcGFjay9wbHVnaW5zL3JlcG9ydGluZy9zZXJ2ZXIvbGliL2dldF91c2VyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZ2V0IH0gZnJvbSAnbG9kYXNoJztcbmltcG9ydCB7IG9uY2VQZXJTZXJ2ZXIgfSBmcm9tICcuL29uY2VfcGVyX3NlcnZlcic7XG5cbmZ1bmN0aW9uIGdldFVzZXJGYWN0b3J5Rm4oc2VydmVyKSB7XG4gIHJldHVybiAocmVxdWVzdCkgPT4ge1xuICAgIGNvbnN0IGdldFVzZXIgPSBnZXQoc2VydmVyLnBsdWdpbnMsICdzZWN1cml0eS5nZXRVc2VyJywgZnVuY3Rpb24gKCkge30pO1xuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoZ2V0VXNlcihyZXF1ZXN0KSk7XG4gIH07XG59XG5cbmV4cG9ydCBjb25zdCBnZXRVc2VyRmFjdG9yeSA9IG9uY2VQZXJTZXJ2ZXIoZ2V0VXNlckZhY3RvcnlGbik7XG4iXX0=",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/get_user.js"
      ],
      "names": [],
      "mappings": ";;;;;;sBAAoB,QAAQ;;+BACE,mBAAmB;;AAEjD,SAAS,gBAAgB,CAAC,MAAM,EAAE;AAChC,SAAO,UAAC,OAAO,EAAK;AAClB,QAAM,OAAO,GAAG,iBAAI,MAAM,CAAC,OAAO,EAAE,kBAAkB,EAAE,YAAY,EAAE,CAAC,CAAC;AACxE,WAAO,OAAO,CAAC,OAAO,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,CAAC;GAC1C,CAAC;CACH;;AAEM,IAAM,cAAc,GAAG,oCAAc,gBAAgB,CAAC,CAAC",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/get_user.js",
      "sourcesContent": [
        "import { get } from 'lodash';\nimport { oncePerServer } from './once_per_server';\n\nfunction getUserFactoryFn(server) {\n  return (request) => {\n    const getUser = get(server.plugins, 'security.getUser', function () {});\n    return Promise.resolve(getUser(request));\n  };\n}\n\nexport const getUserFactory = oncePerServer(getUserFactoryFn);\n"
      ]
    },
    "mtime": 1491771510540
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/once_per_server.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "lodash",
            "imported": [
              "memoize"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "memoize",
                "local": "memoize"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "oncePerServer",
            "fn"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "oncePerServer",
              "exported": "oncePerServer"
            },
            {
              "kind": "local",
              "local": "fn",
              "exported": "fn"
            }
          ]
        }
      },
      "usedHelpers": []
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nexports.oncePerServer = oncePerServer;\n\nvar _lodash = require('lodash');\n\n/**\n * allow this function to be called multiple times, but\n * ensure that it only received one argument, the server,\n * and cache the return value so that subsequent calls get\n * the exact same value.\n *\n * This is intended to be used by service factories like getObjectQueueFactory\n *\n * @param  {Function} fn - the factory function\n * @return {any}\n */\n\nfunction oncePerServer(fn) {\n  var memoized = (0, _lodash.memoize)(function (server) {\n    if (arguments.length !== 1) {\n      throw new TypeError('This function expects to be called with a single argument');\n    }\n\n    if (!server || typeof server.expose !== 'function') {\n      throw new TypeError('This function expects to be passed the server');\n    }\n\n    return fn.call(this, server);\n  });\n\n  // use a weak map a the cache so that:\n  //  1. return values mapped to the actual server instance\n  //  2. return value lifecycle matches that of the server\n  memoized.cache = new WeakMap();\n\n  return memoized;\n}\n\n;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvcmVwb3J0aW5nL3NlcnZlci9saWIvb25jZV9wZXJfc2VydmVyLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7c0JBQXdCLFFBQVE7Ozs7Ozs7Ozs7Ozs7O0FBYXpCLFNBQVMsYUFBYSxDQUFDLEVBQUUsRUFBRTtBQUNoQyxNQUFNLFFBQVEsR0FBRyxxQkFBUSxVQUFVLE1BQU0sRUFBRTtBQUN6QyxRQUFJLFNBQVMsQ0FBQyxNQUFNLEtBQUssQ0FBQyxFQUFFO0FBQzFCLFlBQU0sSUFBSSxTQUFTLENBQUMsMkRBQTJELENBQUMsQ0FBQztLQUNsRjs7QUFFRCxRQUFJLENBQUMsTUFBTSxJQUFJLE9BQU8sTUFBTSxDQUFDLE1BQU0sS0FBSyxVQUFVLEVBQUU7QUFDbEQsWUFBTSxJQUFJLFNBQVMsQ0FBQywrQ0FBK0MsQ0FBQyxDQUFDO0tBQ3RFOztBQUVELFdBQU8sRUFBRSxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsTUFBTSxDQUFDLENBQUM7R0FDOUIsQ0FBQyxDQUFDOzs7OztBQUtILFVBQVEsQ0FBQyxLQUFLLEdBQUcsSUFBSSxPQUFPLEVBQUEsQ0FBQzs7QUFFN0IsU0FBTyxRQUFRLENBQUM7Q0FDakI7O0FBQUEsQ0FBQyIsImZpbGUiOiIvdXNyL3NoYXJlL2tpYmFuYS9wbHVnaW5zL3gtcGFjay9wbHVnaW5zL3JlcG9ydGluZy9zZXJ2ZXIvbGliL29uY2VfcGVyX3NlcnZlci5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IG1lbW9pemUgfSBmcm9tICdsb2Rhc2gnO1xuXG4vKipcbiAqIGFsbG93IHRoaXMgZnVuY3Rpb24gdG8gYmUgY2FsbGVkIG11bHRpcGxlIHRpbWVzLCBidXRcbiAqIGVuc3VyZSB0aGF0IGl0IG9ubHkgcmVjZWl2ZWQgb25lIGFyZ3VtZW50LCB0aGUgc2VydmVyLFxuICogYW5kIGNhY2hlIHRoZSByZXR1cm4gdmFsdWUgc28gdGhhdCBzdWJzZXF1ZW50IGNhbGxzIGdldFxuICogdGhlIGV4YWN0IHNhbWUgdmFsdWUuXG4gKlxuICogVGhpcyBpcyBpbnRlbmRlZCB0byBiZSB1c2VkIGJ5IHNlcnZpY2UgZmFjdG9yaWVzIGxpa2UgZ2V0T2JqZWN0UXVldWVGYWN0b3J5XG4gKlxuICogQHBhcmFtICB7RnVuY3Rpb259IGZuIC0gdGhlIGZhY3RvcnkgZnVuY3Rpb25cbiAqIEByZXR1cm4ge2FueX1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG9uY2VQZXJTZXJ2ZXIoZm4pIHtcbiAgY29uc3QgbWVtb2l6ZWQgPSBtZW1vaXplKGZ1bmN0aW9uIChzZXJ2ZXIpIHtcbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCAhPT0gMSkge1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignVGhpcyBmdW5jdGlvbiBleHBlY3RzIHRvIGJlIGNhbGxlZCB3aXRoIGEgc2luZ2xlIGFyZ3VtZW50Jyk7XG4gICAgfVxuXG4gICAgaWYgKCFzZXJ2ZXIgfHwgdHlwZW9mIHNlcnZlci5leHBvc2UgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1RoaXMgZnVuY3Rpb24gZXhwZWN0cyB0byBiZSBwYXNzZWQgdGhlIHNlcnZlcicpO1xuICAgIH1cblxuICAgIHJldHVybiBmbi5jYWxsKHRoaXMsIHNlcnZlcik7XG4gIH0pO1xuXG4gIC8vIHVzZSBhIHdlYWsgbWFwIGEgdGhlIGNhY2hlIHNvIHRoYXQ6XG4gIC8vICAxLiByZXR1cm4gdmFsdWVzIG1hcHBlZCB0byB0aGUgYWN0dWFsIHNlcnZlciBpbnN0YW5jZVxuICAvLyAgMi4gcmV0dXJuIHZhbHVlIGxpZmVjeWNsZSBtYXRjaGVzIHRoYXQgb2YgdGhlIHNlcnZlclxuICBtZW1vaXplZC5jYWNoZSA9IG5ldyBXZWFrTWFwO1xuXG4gIHJldHVybiBtZW1vaXplZDtcbn07XG4iXX0=",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/once_per_server.js"
      ],
      "names": [],
      "mappings": ";;;;;;;sBAAwB,QAAQ;;;;;;;;;;;;;;AAazB,SAAS,aAAa,CAAC,EAAE,EAAE;AAChC,MAAM,QAAQ,GAAG,qBAAQ,UAAU,MAAM,EAAE;AACzC,QAAI,SAAS,CAAC,MAAM,KAAK,CAAC,EAAE;AAC1B,YAAM,IAAI,SAAS,CAAC,2DAA2D,CAAC,CAAC;KAClF;;AAED,QAAI,CAAC,MAAM,IAAI,OAAO,MAAM,CAAC,MAAM,KAAK,UAAU,EAAE;AAClD,YAAM,IAAI,SAAS,CAAC,+CAA+C,CAAC,CAAC;KACtE;;AAED,WAAO,EAAE,CAAC,IAAI,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC;GAC9B,CAAC,CAAC;;;;;AAKH,UAAQ,CAAC,KAAK,GAAG,IAAI,OAAO,EAAA,CAAC;;AAE7B,SAAO,QAAQ,CAAC;CACjB;;AAAA,CAAC",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/once_per_server.js",
      "sourcesContent": [
        "import { memoize } from 'lodash';\n\n/**\n * allow this function to be called multiple times, but\n * ensure that it only received one argument, the server,\n * and cache the return value so that subsequent calls get\n * the exact same value.\n *\n * This is intended to be used by service factories like getObjectQueueFactory\n *\n * @param  {Function} fn - the factory function\n * @return {any}\n */\nexport function oncePerServer(fn) {\n  const memoized = memoize(function (server) {\n    if (arguments.length !== 1) {\n      throw new TypeError('This function expects to be called with a single argument');\n    }\n\n    if (!server || typeof server.expose !== 'function') {\n      throw new TypeError('This function expects to be passed the server');\n    }\n\n    return fn.call(this, server);\n  });\n\n  // use a weak map a the cache so that:\n  //  1. return values mapped to the actual server instance\n  //  2. return value lifecycle matches that of the server\n  memoized.cache = new WeakMap;\n\n  return memoized;\n};\n"
      ]
    },
    "mtime": 1491771510540
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/get_object_queue.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "./get_saved_objects",
            "imported": [
              "getSavedObjects"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "getSavedObjects",
                "local": "getSavedObjects"
              }
            ]
          },
          {
            "source": "./once_per_server",
            "imported": [
              "oncePerServer"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "oncePerServer",
                "local": "oncePerServer"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "getObjectQueueFactory"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "getObjectQueueFactory",
              "exported": "getObjectQueueFactory"
            }
          ]
        }
      },
      "usedHelpers": []
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nvar _get_saved_objects = require('./get_saved_objects');\n\nvar _once_per_server = require('./once_per_server');\n\nfunction getObjectQueueFn(server) {\n  var _server$plugins$elasticsearch$getCluster = server.plugins.elasticsearch.getCluster('admin');\n\n  var callWithRequest = _server$plugins$elasticsearch$getCluster.callWithRequest;\n\n  var config = server.config();\n  var requestConfig = Object.assign({\n    'kibanaApp': config.get('server.basePath') + config.get('xpack.reporting.kibanaApp'),\n    'kibanaIndex': config.get('kibana.index'),\n    'protocol': server.info.protocol,\n    'hostname': config.get('server.host'),\n    'port': config.get('server.port')\n  }, config.get('xpack.reporting.kibanaServer'));\n\n  var savedObjects = (0, _get_saved_objects.getSavedObjects)(callWithRequest, requestConfig);\n\n  function formatObject(parent, objects) {\n    return Object.assign({\n      id: parent.id,\n      title: parent.title,\n      description: parent.description,\n      type: parent.type,\n      objects: objects\n    });\n  }\n\n  function getDashboardPanels(request, savedObj) {\n    try {\n      var panels = JSON.parse(savedObj.panelsJSON);\n      return panels.map(function (panel) {\n        return savedObjects.get(request, panel.type, panel.id).then(function (obj) {\n          obj.panelIndex = panel.panelIndex;\n          return obj;\n        });\n      });\n    } catch (e) {\n      throw new Error('Failed to retrieve Panels from Saved Dashboard: ' + e.message);\n    }\n  }\n\n  return function getObjectQueue(request, type, objId) {\n    if (type === 'dashboard') {\n      return savedObjects.get(request, type, objId, ['panelsJSON']).then(function (savedObj) {\n        var panelObjects = getDashboardPanels(request, savedObj);\n\n        return Promise.all(panelObjects).then(function (objs) {\n          return formatObject(savedObj, objs);\n        });\n      });\n    }\n\n    return Promise.resolve(savedObjects.get(request, type, objId)).then(function (savedObj) {\n      return formatObject(savedObj, [savedObj]);\n    });\n  };\n}\n\nvar getObjectQueueFactory = (0, _once_per_server.oncePerServer)(getObjectQueueFn);\nexports.getObjectQueueFactory = getObjectQueueFactory;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvcmVwb3J0aW5nL3NlcnZlci9saWIvZ2V0X29iamVjdF9xdWV1ZS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7aUNBQWdDLHFCQUFxQjs7K0JBQ3ZCLG1CQUFtQjs7QUFFakQsU0FBUyxnQkFBZ0IsQ0FBQyxNQUFNLEVBQUU7aURBQ0osTUFBTSxDQUFDLE9BQU8sQ0FBQyxhQUFhLENBQUMsVUFBVSxDQUFDLE9BQU8sQ0FBQzs7TUFBcEUsZUFBZSw0Q0FBZixlQUFlOztBQUN2QixNQUFNLE1BQU0sR0FBRyxNQUFNLENBQUMsTUFBTSxFQUFFLENBQUM7QUFDL0IsTUFBTSxhQUFhLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQztBQUNsQyxlQUFXLEVBQUUsTUFBTSxDQUFDLEdBQUcsQ0FBQyxpQkFBaUIsQ0FBQyxHQUFHLE1BQU0sQ0FBQyxHQUFHLENBQUMsMkJBQTJCLENBQUM7QUFDcEYsaUJBQWEsRUFBRSxNQUFNLENBQUMsR0FBRyxDQUFDLGNBQWMsQ0FBQztBQUN6QyxjQUFVLEVBQUUsTUFBTSxDQUFDLElBQUksQ0FBQyxRQUFRO0FBQ2hDLGNBQVUsRUFBRSxNQUFNLENBQUMsR0FBRyxDQUFDLGFBQWEsQ0FBQztBQUNyQyxVQUFNLEVBQUUsTUFBTSxDQUFDLEdBQUcsQ0FBQyxhQUFhLENBQUM7R0FDbEMsRUFBRSxNQUFNLENBQUMsR0FBRyxDQUFDLDhCQUE4QixDQUFDLENBQUMsQ0FBQzs7QUFFL0MsTUFBTSxZQUFZLEdBQUcsd0NBQWdCLGVBQWUsRUFBRSxhQUFhLENBQUMsQ0FBQzs7QUFFckUsV0FBUyxZQUFZLENBQUMsTUFBTSxFQUFFLE9BQU8sRUFBRTtBQUNyQyxXQUFPLE1BQU0sQ0FBQyxNQUFNLENBQUM7QUFDbkIsUUFBRSxFQUFFLE1BQU0sQ0FBQyxFQUFFO0FBQ2IsV0FBSyxFQUFFLE1BQU0sQ0FBQyxLQUFLO0FBQ25CLGlCQUFXLEVBQUUsTUFBTSxDQUFDLFdBQVc7QUFDL0IsVUFBSSxFQUFFLE1BQU0sQ0FBQyxJQUFJO0FBQ2pCLGFBQU8sRUFBUCxPQUFPO0tBQ1IsQ0FBQyxDQUFDO0dBQ0o7O0FBRUQsV0FBUyxrQkFBa0IsQ0FBQyxPQUFPLEVBQUUsUUFBUSxFQUFFO0FBQzdDLFFBQUk7QUFDRixVQUFNLE1BQU0sR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxVQUFVLENBQUMsQ0FBQztBQUMvQyxhQUFPLE1BQU0sQ0FBQyxHQUFHLENBQUMsVUFBQyxLQUFLLEVBQUs7QUFDM0IsZUFBTyxZQUFZLENBQUMsR0FBRyxDQUFDLE9BQU8sRUFBRSxLQUFLLENBQUMsSUFBSSxFQUFFLEtBQUssQ0FBQyxFQUFFLENBQUMsQ0FDckQsSUFBSSxDQUFDLFVBQVUsR0FBRyxFQUFFO0FBQ25CLGFBQUcsQ0FBQyxVQUFVLEdBQUcsS0FBSyxDQUFDLFVBQVUsQ0FBQztBQUNsQyxpQkFBTyxHQUFHLENBQUM7U0FDWixDQUFDLENBQUM7T0FDSixDQUFDLENBQUM7S0FDSixDQUFDLE9BQU8sQ0FBQyxFQUFFO0FBQ1YsWUFBTSxJQUFJLEtBQUssQ0FBQyxrREFBa0QsR0FBRyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUM7S0FDakY7R0FDRjs7QUFFRCxTQUFPLFNBQVMsY0FBYyxDQUFDLE9BQU8sRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFO0FBQ25ELFFBQUksSUFBSSxLQUFLLFdBQVcsRUFBRTtBQUN4QixhQUFPLFlBQVksQ0FBQyxHQUFHLENBQUMsT0FBTyxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsQ0FBRSxZQUFZLENBQUMsQ0FBQyxDQUM3RCxJQUFJLENBQUMsVUFBVSxRQUFRLEVBQUU7QUFDeEIsWUFBTSxZQUFZLEdBQUcsa0JBQWtCLENBQUMsT0FBTyxFQUFFLFFBQVEsQ0FBQyxDQUFDOztBQUUzRCxlQUFPLE9BQU8sQ0FBQyxHQUFHLENBQUMsWUFBWSxDQUFDLENBQy9CLElBQUksQ0FBQyxVQUFDLElBQUk7aUJBQUssWUFBWSxDQUFDLFFBQVEsRUFBRSxJQUFJLENBQUM7U0FBQSxDQUFDLENBQUM7T0FDL0MsQ0FBQyxDQUFDO0tBQ0o7O0FBRUQsV0FBTyxPQUFPLENBQUMsT0FBTyxDQUFDLFlBQVksQ0FBQyxHQUFHLENBQUMsT0FBTyxFQUFFLElBQUksRUFBRSxLQUFLLENBQUMsQ0FBQyxDQUM3RCxJQUFJLENBQUMsVUFBQyxRQUFRO2FBQUssWUFBWSxDQUFDLFFBQVEsRUFBRSxDQUFFLFFBQVEsQ0FBRSxDQUFDO0tBQUEsQ0FBQyxDQUFDO0dBQzNELENBQUM7Q0FDSDs7QUFFTSxJQUFNLHFCQUFxQixHQUFHLG9DQUFjLGdCQUFnQixDQUFDLENBQUMiLCJmaWxlIjoiL3Vzci9zaGFyZS9raWJhbmEvcGx1Z2lucy94LXBhY2svcGx1Z2lucy9yZXBvcnRpbmcvc2VydmVyL2xpYi9nZXRfb2JqZWN0X3F1ZXVlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZ2V0U2F2ZWRPYmplY3RzIH0gZnJvbSAnLi9nZXRfc2F2ZWRfb2JqZWN0cyc7XG5pbXBvcnQgeyBvbmNlUGVyU2VydmVyIH0gZnJvbSAnLi9vbmNlX3Blcl9zZXJ2ZXInO1xuXG5mdW5jdGlvbiBnZXRPYmplY3RRdWV1ZUZuKHNlcnZlcikge1xuICBjb25zdCB7IGNhbGxXaXRoUmVxdWVzdCB9ID0gc2VydmVyLnBsdWdpbnMuZWxhc3RpY3NlYXJjaC5nZXRDbHVzdGVyKCdhZG1pbicpO1xuICBjb25zdCBjb25maWcgPSBzZXJ2ZXIuY29uZmlnKCk7XG4gIGNvbnN0IHJlcXVlc3RDb25maWcgPSBPYmplY3QuYXNzaWduKHtcbiAgICAna2liYW5hQXBwJzogY29uZmlnLmdldCgnc2VydmVyLmJhc2VQYXRoJykgKyBjb25maWcuZ2V0KCd4cGFjay5yZXBvcnRpbmcua2liYW5hQXBwJyksXG4gICAgJ2tpYmFuYUluZGV4JzogY29uZmlnLmdldCgna2liYW5hLmluZGV4JyksXG4gICAgJ3Byb3RvY29sJzogc2VydmVyLmluZm8ucHJvdG9jb2wsXG4gICAgJ2hvc3RuYW1lJzogY29uZmlnLmdldCgnc2VydmVyLmhvc3QnKSxcbiAgICAncG9ydCc6IGNvbmZpZy5nZXQoJ3NlcnZlci5wb3J0JyksXG4gIH0sIGNvbmZpZy5nZXQoJ3hwYWNrLnJlcG9ydGluZy5raWJhbmFTZXJ2ZXInKSk7XG5cbiAgY29uc3Qgc2F2ZWRPYmplY3RzID0gZ2V0U2F2ZWRPYmplY3RzKGNhbGxXaXRoUmVxdWVzdCwgcmVxdWVzdENvbmZpZyk7XG5cbiAgZnVuY3Rpb24gZm9ybWF0T2JqZWN0KHBhcmVudCwgb2JqZWN0cykge1xuICAgIHJldHVybiBPYmplY3QuYXNzaWduKHtcbiAgICAgIGlkOiBwYXJlbnQuaWQsXG4gICAgICB0aXRsZTogcGFyZW50LnRpdGxlLFxuICAgICAgZGVzY3JpcHRpb246IHBhcmVudC5kZXNjcmlwdGlvbixcbiAgICAgIHR5cGU6IHBhcmVudC50eXBlLFxuICAgICAgb2JqZWN0c1xuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gZ2V0RGFzaGJvYXJkUGFuZWxzKHJlcXVlc3QsIHNhdmVkT2JqKSB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHBhbmVscyA9IEpTT04ucGFyc2Uoc2F2ZWRPYmoucGFuZWxzSlNPTik7XG4gICAgICByZXR1cm4gcGFuZWxzLm1hcCgocGFuZWwpID0+IHtcbiAgICAgICAgcmV0dXJuIHNhdmVkT2JqZWN0cy5nZXQocmVxdWVzdCwgcGFuZWwudHlwZSwgcGFuZWwuaWQpXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uIChvYmopIHtcbiAgICAgICAgICBvYmoucGFuZWxJbmRleCA9IHBhbmVsLnBhbmVsSW5kZXg7XG4gICAgICAgICAgcmV0dXJuIG9iajtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byByZXRyaWV2ZSBQYW5lbHMgZnJvbSBTYXZlZCBEYXNoYm9hcmQ6ICcgKyBlLm1lc3NhZ2UpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBmdW5jdGlvbiBnZXRPYmplY3RRdWV1ZShyZXF1ZXN0LCB0eXBlLCBvYmpJZCkge1xuICAgIGlmICh0eXBlID09PSAnZGFzaGJvYXJkJykge1xuICAgICAgcmV0dXJuIHNhdmVkT2JqZWN0cy5nZXQocmVxdWVzdCwgdHlwZSwgb2JqSWQsIFsgJ3BhbmVsc0pTT04nXSlcbiAgICAgIC50aGVuKGZ1bmN0aW9uIChzYXZlZE9iaikge1xuICAgICAgICBjb25zdCBwYW5lbE9iamVjdHMgPSBnZXREYXNoYm9hcmRQYW5lbHMocmVxdWVzdCwgc2F2ZWRPYmopO1xuXG4gICAgICAgIHJldHVybiBQcm9taXNlLmFsbChwYW5lbE9iamVjdHMpXG4gICAgICAgIC50aGVuKChvYmpzKSA9PiBmb3JtYXRPYmplY3Qoc2F2ZWRPYmosIG9ianMpKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoc2F2ZWRPYmplY3RzLmdldChyZXF1ZXN0LCB0eXBlLCBvYmpJZCkpXG4gICAgLnRoZW4oKHNhdmVkT2JqKSA9PiBmb3JtYXRPYmplY3Qoc2F2ZWRPYmosIFsgc2F2ZWRPYmogXSkpO1xuICB9O1xufVxuXG5leHBvcnQgY29uc3QgZ2V0T2JqZWN0UXVldWVGYWN0b3J5ID0gb25jZVBlclNlcnZlcihnZXRPYmplY3RRdWV1ZUZuKTtcbiJdfQ==",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/get_object_queue.js"
      ],
      "names": [],
      "mappings": ";;;;;;iCAAgC,qBAAqB;;+BACvB,mBAAmB;;AAEjD,SAAS,gBAAgB,CAAC,MAAM,EAAE;iDACJ,MAAM,CAAC,OAAO,CAAC,aAAa,CAAC,UAAU,CAAC,OAAO,CAAC;;MAApE,eAAe,4CAAf,eAAe;;AACvB,MAAM,MAAM,GAAG,MAAM,CAAC,MAAM,EAAE,CAAC;AAC/B,MAAM,aAAa,GAAG,MAAM,CAAC,MAAM,CAAC;AAClC,eAAW,EAAE,MAAM,CAAC,GAAG,CAAC,iBAAiB,CAAC,GAAG,MAAM,CAAC,GAAG,CAAC,2BAA2B,CAAC;AACpF,iBAAa,EAAE,MAAM,CAAC,GAAG,CAAC,cAAc,CAAC;AACzC,cAAU,EAAE,MAAM,CAAC,IAAI,CAAC,QAAQ;AAChC,cAAU,EAAE,MAAM,CAAC,GAAG,CAAC,aAAa,CAAC;AACrC,UAAM,EAAE,MAAM,CAAC,GAAG,CAAC,aAAa,CAAC;GAClC,EAAE,MAAM,CAAC,GAAG,CAAC,8BAA8B,CAAC,CAAC,CAAC;;AAE/C,MAAM,YAAY,GAAG,wCAAgB,eAAe,EAAE,aAAa,CAAC,CAAC;;AAErE,WAAS,YAAY,CAAC,MAAM,EAAE,OAAO,EAAE;AACrC,WAAO,MAAM,CAAC,MAAM,CAAC;AACnB,QAAE,EAAE,MAAM,CAAC,EAAE;AACb,WAAK,EAAE,MAAM,CAAC,KAAK;AACnB,iBAAW,EAAE,MAAM,CAAC,WAAW;AAC/B,UAAI,EAAE,MAAM,CAAC,IAAI;AACjB,aAAO,EAAP,OAAO;KACR,CAAC,CAAC;GACJ;;AAED,WAAS,kBAAkB,CAAC,OAAO,EAAE,QAAQ,EAAE;AAC7C,QAAI;AACF,UAAM,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC;AAC/C,aAAO,MAAM,CAAC,GAAG,CAAC,UAAC,KAAK,EAAK;AAC3B,eAAO,YAAY,CAAC,GAAG,CAAC,OAAO,EAAE,KAAK,CAAC,IAAI,EAAE,KAAK,CAAC,EAAE,CAAC,CACrD,IAAI,CAAC,UAAU,GAAG,EAAE;AACnB,aAAG,CAAC,UAAU,GAAG,KAAK,CAAC,UAAU,CAAC;AAClC,iBAAO,GAAG,CAAC;SACZ,CAAC,CAAC;OACJ,CAAC,CAAC;KACJ,CAAC,OAAO,CAAC,EAAE;AACV,YAAM,IAAI,KAAK,CAAC,kDAAkD,GAAG,CAAC,CAAC,OAAO,CAAC,CAAC;KACjF;GACF;;AAED,SAAO,SAAS,cAAc,CAAC,OAAO,EAAE,IAAI,EAAE,KAAK,EAAE;AACnD,QAAI,IAAI,KAAK,WAAW,EAAE;AACxB,aAAO,YAAY,CAAC,GAAG,CAAC,OAAO,EAAE,IAAI,EAAE,KAAK,EAAE,CAAE,YAAY,CAAC,CAAC,CAC7D,IAAI,CAAC,UAAU,QAAQ,EAAE;AACxB,YAAM,YAAY,GAAG,kBAAkB,CAAC,OAAO,EAAE,QAAQ,CAAC,CAAC;;AAE3D,eAAO,OAAO,CAAC,GAAG,CAAC,YAAY,CAAC,CAC/B,IAAI,CAAC,UAAC,IAAI;iBAAK,YAAY,CAAC,QAAQ,EAAE,IAAI,CAAC;SAAA,CAAC,CAAC;OAC/C,CAAC,CAAC;KACJ;;AAED,WAAO,OAAO,CAAC,OAAO,CAAC,YAAY,CAAC,GAAG,CAAC,OAAO,EAAE,IAAI,EAAE,KAAK,CAAC,CAAC,CAC7D,IAAI,CAAC,UAAC,QAAQ;aAAK,YAAY,CAAC,QAAQ,EAAE,CAAE,QAAQ,CAAE,CAAC;KAAA,CAAC,CAAC;GAC3D,CAAC;CACH;;AAEM,IAAM,qBAAqB,GAAG,oCAAc,gBAAgB,CAAC,CAAC",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/get_object_queue.js",
      "sourcesContent": [
        "import { getSavedObjects } from './get_saved_objects';\nimport { oncePerServer } from './once_per_server';\n\nfunction getObjectQueueFn(server) {\n  const { callWithRequest } = server.plugins.elasticsearch.getCluster('admin');\n  const config = server.config();\n  const requestConfig = Object.assign({\n    'kibanaApp': config.get('server.basePath') + config.get('xpack.reporting.kibanaApp'),\n    'kibanaIndex': config.get('kibana.index'),\n    'protocol': server.info.protocol,\n    'hostname': config.get('server.host'),\n    'port': config.get('server.port'),\n  }, config.get('xpack.reporting.kibanaServer'));\n\n  const savedObjects = getSavedObjects(callWithRequest, requestConfig);\n\n  function formatObject(parent, objects) {\n    return Object.assign({\n      id: parent.id,\n      title: parent.title,\n      description: parent.description,\n      type: parent.type,\n      objects\n    });\n  }\n\n  function getDashboardPanels(request, savedObj) {\n    try {\n      const panels = JSON.parse(savedObj.panelsJSON);\n      return panels.map((panel) => {\n        return savedObjects.get(request, panel.type, panel.id)\n        .then(function (obj) {\n          obj.panelIndex = panel.panelIndex;\n          return obj;\n        });\n      });\n    } catch (e) {\n      throw new Error('Failed to retrieve Panels from Saved Dashboard: ' + e.message);\n    }\n  }\n\n  return function getObjectQueue(request, type, objId) {\n    if (type === 'dashboard') {\n      return savedObjects.get(request, type, objId, [ 'panelsJSON'])\n      .then(function (savedObj) {\n        const panelObjects = getDashboardPanels(request, savedObj);\n\n        return Promise.all(panelObjects)\n        .then((objs) => formatObject(savedObj, objs));\n      });\n    }\n\n    return Promise.resolve(savedObjects.get(request, type, objId))\n    .then((savedObj) => formatObject(savedObj, [ savedObj ]));\n  };\n}\n\nexport const getObjectQueueFactory = oncePerServer(getObjectQueueFn);\n"
      ]
    },
    "mtime": 1491771510540
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/get_saved_objects.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "url",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "url"
              }
            ]
          },
          {
            "source": "lodash",
            "imported": [
              "get",
              "pick",
              "find",
              "merge"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "get",
                "local": "get"
              },
              {
                "kind": "named",
                "imported": "pick",
                "local": "pick"
              },
              {
                "kind": "named",
                "imported": "find",
                "local": "find"
              },
              {
                "kind": "named",
                "imported": "merge",
                "local": "merge"
              }
            ]
          },
          {
            "source": "joi",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "Joi"
              }
            ]
          },
          {
            "source": "../../../../server/lib/parse_kibana_state",
            "imported": [
              "parseKibanaState"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "parseKibanaState",
                "local": "parseKibanaState"
              }
            ]
          },
          {
            "source": "./uri_encode",
            "imported": [
              "uriEncode"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "uriEncode",
                "local": "uriEncode"
              }
            ]
          },
          {
            "source": "./get_absolute_time",
            "imported": [
              "getAbsoluteTime"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "getAbsoluteTime",
                "local": "getAbsoluteTime"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "getSavedObjects",
            "callWithRequest",
            "config"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "getSavedObjects",
              "exported": "getSavedObjects"
            },
            {
              "kind": "local",
              "local": "callWithRequest",
              "exported": "callWithRequest"
            },
            {
              "kind": "local",
              "local": "config",
              "exported": "config"
            }
          ]
        }
      },
      "usedHelpers": [
        "interop-require-default"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nexports.getSavedObjects = getSavedObjects;\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _url = require('url');\n\nvar _url2 = _interopRequireDefault(_url);\n\nvar _lodash = require('lodash');\n\nvar _joi = require('joi');\n\nvar _joi2 = _interopRequireDefault(_joi);\n\nvar _serverLibParse_kibana_state = require('../../../../server/lib/parse_kibana_state');\n\nvar _uri_encode = require('./uri_encode');\n\nvar _get_absolute_time = require('./get_absolute_time');\n\nfunction getSavedObjects(callWithRequest, config) {\n  var schema = _joi2['default'].object().keys({\n    kibanaApp: _joi2['default'].string().required(),\n    kibanaIndex: _joi2['default'].string().required(),\n    protocol: _joi2['default'].string().valid(['http', 'https'])['default']('http'),\n    hostname: _joi2['default'].string()['default']('localhost'),\n    port: _joi2['default'].number().integer()['default'](5601)\n  });\n\n  var result = _joi2['default'].validate(config, schema);\n\n  if (result.error) throw result.error;\n  var opts = result.value;\n\n  var appTypes = {\n    dashboard: {\n      getUrlParams: function getUrlParams(id) {\n        return {\n          pathname: opts.kibanaApp,\n          hash: '/dashboard/' + _uri_encode.uriEncode.string(id, true)\n        };\n      },\n      searchSourceIndex: 'kibanaSavedObjectMeta.searchSourceJSON',\n      stateIndex: 'uiStateJSON'\n    },\n    visualization: {\n      getUrlParams: function getUrlParams(id) {\n        return {\n          pathname: opts.kibanaApp,\n          hash: '/visualize/edit/' + _uri_encode.uriEncode.string(id, true)\n        };\n      },\n      searchSourceIndex: 'kibanaSavedObjectMeta.searchSourceJSON',\n      stateIndex: 'uiStateJSON'\n    },\n    search: {\n      getUrlParams: function getUrlParams(id) {\n        return {\n          pathname: opts.kibanaApp,\n          hash: '/discover/' + _uri_encode.uriEncode.string(id, true)\n        };\n      },\n      searchSourceIndex: 'kibanaSavedObjectMeta.searchSourceJSON',\n      stateIndex: 'uiStateJSON'\n    }\n  };\n\n  function getIndexPatternObject(request, indexPattern) {\n    var body = {\n      index: opts.kibanaIndex,\n      type: 'index-pattern',\n      id: indexPattern\n    };\n\n    return callWithRequest(request, 'get', body).then(function (response) {\n      return response._source;\n    });\n  }\n\n  function hasTimeBasedIndexPattern(request, savedObjSearchSourceIndex) {\n    var indexPattern, indexPatternObj;\n    return regeneratorRuntime.async(function hasTimeBasedIndexPattern$(context$2$0) {\n      while (1) switch (context$2$0.prev = context$2$0.next) {\n        case 0:\n          indexPattern = savedObjSearchSourceIndex.index;\n\n          if (indexPattern) {\n            context$2$0.next = 3;\n            break;\n          }\n\n          return context$2$0.abrupt('return', Promise.resolve(false));\n\n        case 3:\n          context$2$0.next = 5;\n          return regeneratorRuntime.awrap(getIndexPatternObject(request, indexPattern));\n\n        case 5:\n          indexPatternObj = context$2$0.sent;\n          return context$2$0.abrupt('return', !!indexPatternObj.timeFieldName);\n\n        case 7:\n        case 'end':\n          return context$2$0.stop();\n      }\n    }, null, this);\n  }\n\n  function getObject(request, type, id) {\n    var fields = arguments.length <= 3 || arguments[3] === undefined ? [] : arguments[3];\n\n    fields = ['title', 'description'].concat(fields);\n    validateType(type);\n    var body = {\n      index: opts.kibanaIndex,\n      type: type,\n      id: id\n    };\n\n    function parseJsonObjects(source) {\n      var searchSourceJson = (0, _lodash.get)(source, appTypes[type].searchSourceIndex, '{}');\n      var uiStateJson = (0, _lodash.get)(source, appTypes[type].stateIndex, '{}');\n      var searchSource = undefined;\n      var uiState = undefined;\n\n      try {\n        searchSource = JSON.parse(searchSourceJson);\n      } catch (e) {\n        searchSource = {};\n      }\n\n      try {\n        uiState = JSON.parse(uiStateJson);\n      } catch (e) {\n        uiState = {};\n      }\n\n      return { searchSource: searchSource, uiState: uiState };\n    }\n\n    return callWithRequest(request, 'get', body).then(function _getRecord(response) {\n      return response._source;\n    }).then(function _buildObject(source) {\n      var _parseJsonObjects, searchSource, uiState, isUsingTimeBasedIndexPattern, obj;\n\n      return regeneratorRuntime.async(function _buildObject$(context$3$0) {\n        while (1) switch (context$3$0.prev = context$3$0.next) {\n          case 0:\n            _parseJsonObjects = parseJsonObjects(source);\n            searchSource = _parseJsonObjects.searchSource;\n            uiState = _parseJsonObjects.uiState;\n            context$3$0.next = 5;\n            return regeneratorRuntime.awrap(hasTimeBasedIndexPattern(request, searchSource));\n\n          case 5:\n            isUsingTimeBasedIndexPattern = context$3$0.sent;\n            obj = Object.assign((0, _lodash.pick)(source, fields), {\n              id: body.id,\n              type: type,\n              searchSource: searchSource,\n              uiState: uiState,\n              isUsingTimeBasedIndexPattern: isUsingTimeBasedIndexPattern,\n              getUrl: function getAppUrl() {\n                var query = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];\n                var urlOptions = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\n                var options = Object.assign({\n                  useAbsoluteTime: true\n                }, urlOptions);\n                var app = appTypes[this.type];\n                if (!app) throw new Error('Unexpected app type: ' + this.type);\n\n                // map panel state to panel from app state part of the query\n                var cleanQuery = this.getState(query);\n\n                // modify the global state in the query\n                var globalState = (0, _serverLibParse_kibana_state.parseKibanaState)(query, 'global');\n                if (globalState.exists) {\n                  globalState.removeProps('refreshInterval');\n\n                  // transform to absolute time based on option\n                  if (options.useAbsoluteTime) {\n                    globalState.set('time', (0, _get_absolute_time.getAbsoluteTime)(globalState.get('time')));\n                  }\n\n                  Object.assign(cleanQuery, globalState.toQuery());\n                }\n\n                var urlParams = Object.assign({\n                  protocol: opts.protocol,\n                  hostname: opts.hostname,\n                  port: opts.port\n                }, app.getUrlParams(this.id));\n\n                // Kibana appends querystrings to the hash, and parses them as such,\n                // so we'll do the same internally so kibana understands what we want\n                // const encoder = (str) => str;\n                // const unencodedQueryString = qs.stringify(cleanQuery, null, null, { encodeURIComponent: encoder });\n                var unencodedQueryString = _uri_encode.uriEncode.stringify(cleanQuery);\n                urlParams.hash += '?' + unencodedQueryString;\n\n                return _url2['default'].format(urlParams);\n              },\n              getState: function mergeQueryState() {\n                var query = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];\n\n                var appState = (0, _serverLibParse_kibana_state.parseKibanaState)(query, 'app');\n                if (!appState.exists || !this.panelIndex) return query;\n\n                var panel = (0, _lodash.find)(appState.get('panels', []), { panelIndex: this.panelIndex });\n                var panelState = appState.get(['uiState', 'P-' + this.panelIndex]);\n\n                appState.removeProps(['uiState', 'panels', 'vis']);\n\n                // if uiState doesn't match panel, simply strip uiState\n                if (panel && panelState) {\n                  appState.set('uiState', (0, _lodash.merge)({}, this.uiState, panelState));\n                }\n\n                return Object.assign({}, query, appState.toQuery());\n              },\n              toJSON: function toJSON(query, urlOptions) {\n                var _this = this;\n\n                var savedObj = {\n                  id: this.id,\n                  type: this.type,\n                  searchSource: this.searchSource,\n                  uiState: this.uiState,\n                  isUsingTimeBasedIndexPattern: isUsingTimeBasedIndexPattern,\n                  url: this.getUrl(query, urlOptions)\n                };\n\n                fields.forEach(function (field) {\n                  savedObj[field] = _this[field];\n                });\n\n                return savedObj;\n              }\n            });\n            return context$3$0.abrupt('return', obj);\n\n          case 8:\n          case 'end':\n            return context$3$0.stop();\n        }\n      }, null, this);\n    })['catch'](function () {\n      var isMissing = true;\n      var savedObj = {\n        id: id,\n        type: type,\n        isMissing: isMissing,\n        toJSON: function toJSON() {\n          return {\n            id: id,\n            type: type,\n            isMissing: isMissing\n          };\n        }\n      };\n      return savedObj;\n    });\n  }\n\n  function validateType(type) {\n    var app = appTypes[type];\n    if (!app) throw new Error('Invalid object type: ' + type);\n  }\n\n  // exported methods\n  return {\n    get: getObject\n  };\n}\n\n;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvcmVwb3J0aW5nL3NlcnZlci9saWIvZ2V0X3NhdmVkX29iamVjdHMuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O21CQUFnQixLQUFLOzs7O3NCQUNrQixRQUFROzttQkFDL0IsS0FBSzs7OzsyQ0FDWSwyQ0FBMkM7OzBCQUNsRCxjQUFjOztpQ0FDUixxQkFBcUI7O0FBRTlDLFNBQVMsZUFBZSxDQUFDLGVBQWUsRUFBRSxNQUFNLEVBQUU7QUFDdkQsTUFBTSxNQUFNLEdBQUcsaUJBQUksTUFBTSxFQUFFLENBQUMsSUFBSSxDQUFDO0FBQy9CLGFBQVMsRUFBRSxpQkFBSSxNQUFNLEVBQUUsQ0FBQyxRQUFRLEVBQUU7QUFDbEMsZUFBVyxFQUFFLGlCQUFJLE1BQU0sRUFBRSxDQUFDLFFBQVEsRUFBRTtBQUNwQyxZQUFRLEVBQUUsaUJBQUksTUFBTSxFQUFFLENBQUMsS0FBSyxDQUFDLENBQUMsTUFBTSxFQUFFLE9BQU8sQ0FBQyxDQUFDLFdBQVEsQ0FBQyxNQUFNLENBQUM7QUFDL0QsWUFBUSxFQUFFLGlCQUFJLE1BQU0sRUFBRSxXQUFRLENBQUMsV0FBVyxDQUFDO0FBQzNDLFFBQUksRUFBRSxpQkFBSSxNQUFNLEVBQUUsQ0FBQyxPQUFPLEVBQUUsV0FBUSxDQUFDLElBQUksQ0FBQztHQUMzQyxDQUFDLENBQUM7O0FBRUgsTUFBTSxNQUFNLEdBQUcsaUJBQUksUUFBUSxDQUFDLE1BQU0sRUFBRSxNQUFNLENBQUMsQ0FBQzs7QUFFNUMsTUFBSSxNQUFNLENBQUMsS0FBSyxFQUFFLE1BQU0sTUFBTSxDQUFDLEtBQUssQ0FBQztBQUNyQyxNQUFNLElBQUksR0FBRyxNQUFNLENBQUMsS0FBSyxDQUFDOztBQUUxQixNQUFNLFFBQVEsR0FBRztBQUNmLGFBQVMsRUFBRTtBQUNULGtCQUFZLEVBQUUsc0JBQVUsRUFBRSxFQUFFO0FBQzFCLGVBQU87QUFDTCxrQkFBUSxFQUFF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RUFBRSxVQUFVLENBQUM7aUJBQ3BDLENBQUM7O0FBRUYsc0JBQU0sQ0FBQyxPQUFPLENBQUMsVUFBQyxLQUFLLEVBQUs7QUFDeEIsMEJBQVEsQ0FBQyxLQUFLLENBQUMsR0FBRyxNQUFLLEtBQUssQ0FBQyxDQUFDO2lCQUMvQixDQUFDLENBQUM7O0FBRUgsdUJBQU8sUUFBUSxDQUFDO2VBQ2pCO2FBQ0YsQ0FBQztnREFFSyxHQUFHOzs7Ozs7O0tBQ1gsQ0FBQyxTQUNJLENBQUMsWUFBTTtBQUNYLFVBQU0sU0FBUyxHQUFHLElBQUksQ0FBQztBQUN2QixVQUFNLFFBQVEsR0FBRztBQUNmLFVBQUUsRUFBRixFQUFFO0FBQ0YsWUFBSSxFQUFKLElBQUk7QUFDSixpQkFBUyxFQUFULFNBQVM7QUFDVCxjQUFNLEVBQUEsa0JBQUc7QUFDUCxpQkFBTztBQUNMLGNBQUUsRUFBRixFQUFFO0FBQ0YsZ0JBQUksRUFBSixJQUFJO0FBQ0oscUJBQVMsRUFBVCxTQUFTO1dBQ1YsQ0FBQztTQUNIO09BQ0YsQ0FBQztBQUNGLGFBQU8sUUFBUSxDQUFDO0tBQ2pCLENBQUMsQ0FBQztHQUNKOztBQUVELFdBQVMsWUFBWSxDQUFDLElBQUksRUFBRTtBQUMxQixRQUFNLEdBQUcsR0FBRyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUM7QUFDM0IsUUFBSSxDQUFDLEdBQUcsRUFBRSxNQUFNLElBQUksS0FBSyxDQUFDLHVCQUF1QixHQUFHLElBQUksQ0FBQyxDQUFDO0dBQzNEOzs7QUFHRCxTQUFPO0FBQ0wsT0FBRyxFQUFFLFNBQVM7R0FDZixDQUFDO0NBQ0g7O0FBQUEsQ0FBQyIsImZpbGUiOiIvdXNyL3NoYXJlL2tpYmFuYS9wbHVnaW5zL3gtcGFjay9wbHVnaW5zL3JlcG9ydGluZy9zZXJ2ZXIvbGliL2dldF9zYXZlZF9vYmplY3RzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHVybCBmcm9tICd1cmwnO1xuaW1wb3J0IHsgZ2V0LCBwaWNrLCBmaW5kLCBtZXJnZSB9IGZyb20gJ2xvZGFzaCc7XG5pbXBvcnQgSm9pIGZyb20gJ2pvaSc7XG5pbXBvcnQgeyBwYXJzZUtpYmFuYVN0YXRlIH0gZnJvbSAnLi4vLi4vLi4vLi4vc2VydmVyL2xpYi9wYXJzZV9raWJhbmFfc3RhdGUnO1xuaW1wb3J0IHsgdXJpRW5jb2RlIH0gZnJvbSAnLi91cmlfZW5jb2RlJztcbmltcG9ydCB7IGdldEFic29sdXRlVGltZSB9IGZyb20gJy4vZ2V0X2Fic29sdXRlX3RpbWUnO1xuXG5leHBvcnQgZnVuY3Rpb24gZ2V0U2F2ZWRPYmplY3RzKGNhbGxXaXRoUmVxdWVzdCwgY29uZmlnKSB7XG4gIGNvbnN0IHNjaGVtYSA9IEpvaS5vYmplY3QoKS5rZXlzKHtcbiAgICBraWJhbmFBcHA6IEpvaS5zdHJpbmcoKS5yZXF1aXJlZCgpLFxuICAgIGtpYmFuYUluZGV4OiBKb2kuc3RyaW5nKCkucmVxdWlyZWQoKSxcbiAgICBwcm90b2NvbDogSm9pLnN0cmluZygpLnZhbGlkKFsnaHR0cCcsICdodHRwcyddKS5kZWZhdWx0KCdodHRwJyksXG4gICAgaG9zdG5hbWU6IEpvaS5zdHJpbmcoKS5kZWZhdWx0KCdsb2NhbGhvc3QnKSxcbiAgICBwb3J0OiBKb2kubnVtYmVyKCkuaW50ZWdlcigpLmRlZmF1bHQoNTYwMSksXG4gIH0pO1xuXG4gIGNvbnN0IHJlc3VsdCA9IEpvaS52YWxpZGF0ZShjb25maWcsIHNjaGVtYSk7XG5cbiAgaWYgKHJlc3VsdC5lcnJvcikgdGhyb3cgcmVzdWx0LmVycm9yO1xuICBjb25zdCBvcHRzID0gcmVzdWx0LnZhbHVlO1xuXG4gIGNvbnN0IGFwcFR5cGVzID0ge1xuICAgIGRhc2hib2FyZDoge1xuICAgICAgZ2V0VXJsUGFyYW1zOiBmdW5jdGlvbiAoaWQpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBwYXRobmFtZTogb3B0cy5raWJhbmFBcHAsXG4gICAgICAgICAgaGFzaDogJy9kYXNoYm9hcmQvJyArIHVyaUVuY29kZS5zdHJpbmcoaWQsIHRydWUpLFxuICAgICAgICB9O1xuICAgICAgfSxcbiAgICAgIHNlYXJjaFNvdXJjZUluZGV4OiAna2liYW5hU2F2ZWRPYmplY3RNZXRhLnNlYXJjaFNvdXJjZUpTT04nLFxuICAgICAgc3RhdGVJbmRleDogJ3VpU3RhdGVKU09OJyxcbiAgICB9LFxuICAgIHZpc3VhbGl6YXRpb246IHtcbiAgICAgIGdldFVybFBhcmFtczogZnVuY3Rpb24gKGlkKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgcGF0aG5hbWU6IG9wdHMua2liYW5hQXBwLFxuICAgICAgICAgIGhhc2g6ICcvdmlzdWFsaXplL2VkaXQvJyArIHVyaUVuY29kZS5zdHJpbmcoaWQsIHRydWUpLFxuICAgICAgICB9O1xuICAgICAgfSxcbiAgICAgIHNlYXJjaFNvdXJjZUluZGV4OiAna2liYW5hU2F2ZWRPYmplY3RNZXRhLnNlYXJjaFNvdXJjZUpTT04nLFxuICAgICAgc3RhdGVJbmRleDogJ3VpU3RhdGVKU09OJyxcbiAgICB9LFxuICAgIHNlYXJjaDoge1xuICAgICAgZ2V0VXJsUGFyYW1zOiBmdW5jdGlvbiAoaWQpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBwYXRobmFtZTogb3B0cy5raWJhbmFBcHAsXG4gICAgICAgICAgaGFzaDogJy9kaXNjb3Zlci8nICsgdXJpRW5jb2RlLnN0cmluZyhpZCwgdHJ1ZSksXG4gICAgICAgIH07XG4gICAgICB9LFxuICAgICAgc2VhcmNoU291cmNlSW5kZXg6ICdraWJhbmFTYXZlZE9iamVjdE1ldGEuc2VhcmNoU291cmNlSlNPTicsXG4gICAgICBzdGF0ZUluZGV4OiAndWlTdGF0ZUpTT04nLFxuICAgIH1cbiAgfTtcblxuICBmdW5jdGlvbiBnZXRJbmRleFBhdHRlcm5PYmplY3QocmVxdWVzdCwgaW5kZXhQYXR0ZXJuKSB7XG4gICAgY29uc3QgYm9keSA9IHtcbiAgICAgIGluZGV4OiBvcHRzLmtpYmFuYUluZGV4LFxuICAgICAgdHlwZTogJ2luZGV4LXBhdHRlcm4nLFxuICAgICAgaWQ6IGluZGV4UGF0dGVyblxuICAgIH07XG5cbiAgICByZXR1cm4gY2FsbFdpdGhSZXF1ZXN0KHJlcXVlc3QsICdnZXQnLCBib2R5KS50aGVuKHJlc3BvbnNlID0+IHJlc3BvbnNlLl9zb3VyY2UpO1xuICB9XG5cbiAgYXN5bmMgZnVuY3Rpb24gaGFzVGltZUJhc2VkSW5kZXhQYXR0ZXJuKHJlcXVlc3QsIHNhdmVkT2JqU2VhcmNoU291cmNlSW5kZXgpIHtcbiAgICBjb25zdCBpbmRleFBhdHRlcm4gPSBzYXZlZE9ialNlYXJjaFNvdXJjZUluZGV4LmluZGV4O1xuICAgIGlmICghaW5kZXhQYXR0ZXJuKSB7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGZhbHNlKTtcbiAgICB9XG5cbiAgICBjb25zdCBpbmRleFBhdHRlcm5PYmogPSBhd2FpdCBnZXRJbmRleFBhdHRlcm5PYmplY3QocmVxdWVzdCwgaW5kZXhQYXR0ZXJuKTtcbiAgICByZXR1cm4gISFpbmRleFBhdHRlcm5PYmoudGltZUZpZWxkTmFtZTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldE9iamVjdChyZXF1ZXN0LCB0eXBlLCBpZCwgZmllbGRzID0gW10pIHtcbiAgICBmaWVsZHMgPSBbJ3RpdGxlJywgJ2Rlc2NyaXB0aW9uJ10uY29uY2F0KGZpZWxkcyk7XG4gICAgdmFsaWRhdGVUeXBlKHR5cGUpO1xuICAgIGNvbnN0IGJvZHkgPSB7XG4gICAgICBpbmRleDogb3B0cy5raWJhbmFJbmRleCxcbiAgICAgIHR5cGU6IHR5cGUsXG4gICAgICBpZDogaWRcbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gcGFyc2VKc29uT2JqZWN0cyhzb3VyY2UpIHtcbiAgICAgIGNvbnN0IHNlYXJjaFNvdXJjZUpzb24gPSBnZXQoc291cmNlLCBhcHBUeXBlc1t0eXBlXS5zZWFyY2hTb3VyY2VJbmRleCwgJ3t9Jyk7XG4gICAgICBjb25zdCB1aVN0YXRlSnNvbiA9IGdldChzb3VyY2UsIGFwcFR5cGVzW3R5cGVdLnN0YXRlSW5kZXgsICd7fScpO1xuICAgICAgbGV0IHNlYXJjaFNvdXJjZTtcbiAgICAgIGxldCB1aVN0YXRlO1xuXG4gICAgICB0cnkge1xuICAgICAgICBzZWFyY2hTb3VyY2UgPSBKU09OLnBhcnNlKHNlYXJjaFNvdXJjZUpzb24pO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBzZWFyY2hTb3VyY2UgPSB7fTtcbiAgICAgIH1cblxuICAgICAgdHJ5IHtcbiAgICAgICAgdWlTdGF0ZSA9IEpTT04ucGFyc2UodWlTdGF0ZUpzb24pO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICB1aVN0YXRlID0ge307XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB7IHNlYXJjaFNvdXJjZSwgdWlTdGF0ZSB9O1xuICAgIH1cblxuICAgIHJldHVybiBjYWxsV2l0aFJlcXVlc3QocmVxdWVzdCwgJ2dldCcsIGJvZHkpXG4gICAgLnRoZW4oZnVuY3Rpb24gX2dldFJlY29yZChyZXNwb25zZSkge1xuICAgICAgcmV0dXJuIHJlc3BvbnNlLl9zb3VyY2U7XG4gICAgfSlcbiAgICAudGhlbihhc3luYyBmdW5jdGlvbiBfYnVpbGRPYmplY3Qoc291cmNlKSB7XG4gICAgICBjb25zdCB7IHNlYXJjaFNvdXJjZSwgdWlTdGF0ZSB9ID0gcGFyc2VKc29uT2JqZWN0cyhzb3VyY2UpO1xuXG4gICAgICBjb25zdCBpc1VzaW5nVGltZUJhc2VkSW5kZXhQYXR0ZXJuID0gYXdhaXQgaGFzVGltZUJhc2VkSW5kZXhQYXR0ZXJuKHJlcXVlc3QsIHNlYXJjaFNvdXJjZSk7XG5cbiAgICAgIGNvbnN0IG9iaiA9IE9iamVjdC5hc3NpZ24ocGljayhzb3VyY2UsIGZpZWxkcyksIHtcbiAgICAgICAgaWQ6IGJvZHkuaWQsXG4gICAgICAgIHR5cGU6IHR5cGUsXG4gICAgICAgIHNlYXJjaFNvdXJjZTogc2VhcmNoU291cmNlLFxuICAgICAgICB1aVN0YXRlOiB1aVN0YXRlLFxuICAgICAgICBpc1VzaW5nVGltZUJhc2VkSW5kZXhQYXR0ZXJuLFxuICAgICAgICBnZXRVcmw6IGZ1bmN0aW9uIGdldEFwcFVybChxdWVyeSA9IHt9LCB1cmxPcHRpb25zID0ge30pIHtcbiAgICAgICAgICBjb25zdCBvcHRpb25zID0gT2JqZWN0LmFzc2lnbih7XG4gICAgICAgICAgICB1c2VBYnNvbHV0ZVRpbWU6IHRydWVcbiAgICAgICAgICB9LCB1cmxPcHRpb25zKTtcbiAgICAgICAgICBjb25zdCBhcHAgPSBhcHBUeXBlc1t0aGlzLnR5cGVdO1xuICAgICAgICAgIGlmICghYXBwKSB0aHJvdyBuZXcgRXJyb3IoJ1VuZXhwZWN0ZWQgYXBwIHR5cGU6ICcgKyB0aGlzLnR5cGUpO1xuXG4gICAgICAgICAgLy8gbWFwIHBhbmVsIHN0YXRlIHRvIHBhbmVsIGZyb20gYXBwIHN0YXRlIHBhcnQgb2YgdGhlIHF1ZXJ5XG4gICAgICAgICAgY29uc3QgY2xlYW5RdWVyeSA9IHRoaXMuZ2V0U3RhdGUocXVlcnkpO1xuXG4gICAgICAgICAgLy8gbW9kaWZ5IHRoZSBnbG9iYWwgc3RhdGUgaW4gdGhlIHF1ZXJ5XG4gICAgICAgICAgY29uc3QgZ2xvYmFsU3RhdGUgPSBwYXJzZUtpYmFuYVN0YXRlKHF1ZXJ5LCAnZ2xvYmFsJyk7XG4gICAgICAgICAgaWYgKGdsb2JhbFN0YXRlLmV4aXN0cykge1xuICAgICAgICAgICAgZ2xvYmFsU3RhdGUucmVtb3ZlUHJvcHMoJ3JlZnJlc2hJbnRlcnZhbCcpO1xuXG4gICAgICAgICAgICAvLyB0cmFuc2Zvcm0gdG8gYWJzb2x1dGUgdGltZSBiYXNlZCBvbiBvcHRpb25cbiAgICAgICAgICAgIGlmIChvcHRpb25zLnVzZUFic29sdXRlVGltZSkge1xuICAgICAgICAgICAgICBnbG9iYWxTdGF0ZS5zZXQoJ3RpbWUnLCBnZXRBYnNvbHV0ZVRpbWUoZ2xvYmFsU3RhdGUuZ2V0KCd0aW1lJykpKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihjbGVhblF1ZXJ5LCBnbG9iYWxTdGF0ZS50b1F1ZXJ5KCkpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGNvbnN0IHVybFBhcmFtcyA9IE9iamVjdC5hc3NpZ24oe1xuICAgICAgICAgICAgcHJvdG9jb2w6IG9wdHMucHJvdG9jb2wsXG4gICAgICAgICAgICBob3N0bmFtZTogb3B0cy5ob3N0bmFtZSxcbiAgICAgICAgICAgIHBvcnQ6IG9wdHMucG9ydCxcbiAgICAgICAgICB9LCBhcHAuZ2V0VXJsUGFyYW1zKHRoaXMuaWQpKTtcblxuICAgICAgICAgIC8vIEtpYmFuYSBhcHBlbmRzIHF1ZXJ5c3RyaW5ncyB0byB0aGUgaGFzaCwgYW5kIHBhcnNlcyB0aGVtIGFzIHN1Y2gsXG4gICAgICAgICAgLy8gc28gd2UnbGwgZG8gdGhlIHNhbWUgaW50ZXJuYWxseSBzbyBraWJhbmEgdW5kZXJzdGFuZHMgd2hhdCB3ZSB3YW50XG4gICAgICAgICAgLy8gY29uc3QgZW5jb2RlciA9IChzdHIpID0+IHN0cjtcbiAgICAgICAgICAvLyBjb25zdCB1bmVuY29kZWRRdWVyeVN0cmluZyA9IHFzLnN0cmluZ2lmeShjbGVhblF1ZXJ5LCBudWxsLCBudWxsLCB7IGVuY29kZVVSSUNvbXBvbmVudDogZW5jb2RlciB9KTtcbiAgICAgICAgICBjb25zdCB1bmVuY29kZWRRdWVyeVN0cmluZyA9IHVyaUVuY29kZS5zdHJpbmdpZnkoY2xlYW5RdWVyeSk7XG4gICAgICAgICAgdXJsUGFyYW1zLmhhc2ggKz0gJz8nICsgdW5lbmNvZGVkUXVlcnlTdHJpbmc7XG5cbiAgICAgICAgICByZXR1cm4gdXJsLmZvcm1hdCh1cmxQYXJhbXMpO1xuICAgICAgICB9LFxuICAgICAgICBnZXRTdGF0ZTogZnVuY3Rpb24gbWVyZ2VRdWVyeVN0YXRlKHF1ZXJ5ID0ge30pIHtcbiAgICAgICAgICBjb25zdCBhcHBTdGF0ZSA9IHBhcnNlS2liYW5hU3RhdGUocXVlcnksICdhcHAnKTtcbiAgICAgICAgICBpZiAoIWFwcFN0YXRlLmV4aXN0cyB8fCAhdGhpcy5wYW5lbEluZGV4KSByZXR1cm4gcXVlcnk7XG5cbiAgICAgICAgICBjb25zdCBwYW5lbCA9IGZpbmQoYXBwU3RhdGUuZ2V0KCdwYW5lbHMnLCBbXSksIHsgcGFuZWxJbmRleDogdGhpcy5wYW5lbEluZGV4IH0pO1xuICAgICAgICAgIGNvbnN0IHBhbmVsU3RhdGUgPSBhcHBTdGF0ZS5nZXQoWyd1aVN0YXRlJywgYFAtJHt0aGlzLnBhbmVsSW5kZXh9YF0pO1xuXG4gICAgICAgICAgYXBwU3RhdGUucmVtb3ZlUHJvcHMoWyd1aVN0YXRlJywgJ3BhbmVscycsICd2aXMnXSk7XG5cbiAgICAgICAgICAvLyBpZiB1aVN0YXRlIGRvZXNuJ3QgbWF0Y2ggcGFuZWwsIHNpbXBseSBzdHJpcCB1aVN0YXRlXG4gICAgICAgICAgaWYgKHBhbmVsICYmIHBhbmVsU3RhdGUpIHtcbiAgICAgICAgICAgIGFwcFN0YXRlLnNldCgndWlTdGF0ZScsIG1lcmdlKHt9LCB0aGlzLnVpU3RhdGUsIHBhbmVsU3RhdGUpKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbih7fSwgcXVlcnksIGFwcFN0YXRlLnRvUXVlcnkoKSk7XG4gICAgICAgIH0sXG4gICAgICAgIHRvSlNPTjogZnVuY3Rpb24gKHF1ZXJ5LCB1cmxPcHRpb25zKSB7XG4gICAgICAgICAgY29uc3Qgc2F2ZWRPYmogPSB7XG4gICAgICAgICAgICBpZDogdGhpcy5pZCxcbiAgICAgICAgICAgIHR5cGU6IHRoaXMudHlwZSxcbiAgICAgICAgICAgIHNlYXJjaFNvdXJjZTogdGhpcy5zZWFyY2hTb3VyY2UsXG4gICAgICAgICAgICB1aVN0YXRlOiB0aGlzLnVpU3RhdGUsXG4gICAgICAgICAgICBpc1VzaW5nVGltZUJhc2VkSW5kZXhQYXR0ZXJuLFxuICAgICAgICAgICAgdXJsOiB0aGlzLmdldFVybChxdWVyeSwgdXJsT3B0aW9ucylcbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgZmllbGRzLmZvckVhY2goKGZpZWxkKSA9PiB7XG4gICAgICAgICAgICBzYXZlZE9ialtmaWVsZF0gPSB0aGlzW2ZpZWxkXTtcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHJldHVybiBzYXZlZE9iajtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiBvYmo7XG4gICAgfSlcbiAgICAuY2F0Y2goKCkgPT4ge1xuICAgICAgY29uc3QgaXNNaXNzaW5nID0gdHJ1ZTtcbiAgICAgIGNvbnN0IHNhdmVkT2JqID0ge1xuICAgICAgICBpZCxcbiAgICAgICAgdHlwZSxcbiAgICAgICAgaXNNaXNzaW5nLFxuICAgICAgICB0b0pTT04oKSB7XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGlkLFxuICAgICAgICAgICAgdHlwZSxcbiAgICAgICAgICAgIGlzTWlzc2luZ1xuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICByZXR1cm4gc2F2ZWRPYmo7XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiB2YWxpZGF0ZVR5cGUodHlwZSkge1xuICAgIGNvbnN0IGFwcCA9IGFwcFR5cGVzW3R5cGVdO1xuICAgIGlmICghYXBwKSB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgb2JqZWN0IHR5cGU6ICcgKyB0eXBlKTtcbiAgfVxuXG4gIC8vIGV4cG9ydGVkIG1ldGhvZHNcbiAgcmV0dXJuIHtcbiAgICBnZXQ6IGdldE9iamVjdFxuICB9O1xufTtcbiJdfQ==",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/get_saved_objects.js"
      ],
      "names": [],
      "mappings": "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",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/get_saved_objects.js",
      "sourcesContent": [
        "import url from 'url';\nimport { get, pick, find, merge } from 'lodash';\nimport Joi from 'joi';\nimport { parseKibanaState } from '../../../../server/lib/parse_kibana_state';\nimport { uriEncode } from './uri_encode';\nimport { getAbsoluteTime } from './get_absolute_time';\n\nexport function getSavedObjects(callWithRequest, config) {\n  const schema = Joi.object().keys({\n    kibanaApp: Joi.string().required(),\n    kibanaIndex: Joi.string().required(),\n    protocol: Joi.string().valid(['http', 'https']).default('http'),\n    hostname: Joi.string().default('localhost'),\n    port: Joi.number().integer().default(5601),\n  });\n\n  const result = Joi.validate(config, schema);\n\n  if (result.error) throw result.error;\n  const opts = result.value;\n\n  const appTypes = {\n    dashboard: {\n      getUrlParams: function (id) {\n        return {\n          pathname: opts.kibanaApp,\n          hash: '/dashboard/' + uriEncode.string(id, true),\n        };\n      },\n      searchSourceIndex: 'kibanaSavedObjectMeta.searchSourceJSON',\n      stateIndex: 'uiStateJSON',\n    },\n    visualization: {\n      getUrlParams: function (id) {\n        return {\n          pathname: opts.kibanaApp,\n          hash: '/visualize/edit/' + uriEncode.string(id, true),\n        };\n      },\n      searchSourceIndex: 'kibanaSavedObjectMeta.searchSourceJSON',\n      stateIndex: 'uiStateJSON',\n    },\n    search: {\n      getUrlParams: function (id) {\n        return {\n          pathname: opts.kibanaApp,\n          hash: '/discover/' + uriEncode.string(id, true),\n        };\n      },\n      searchSourceIndex: 'kibanaSavedObjectMeta.searchSourceJSON',\n      stateIndex: 'uiStateJSON',\n    }\n  };\n\n  function getIndexPatternObject(request, indexPattern) {\n    const body = {\n      index: opts.kibanaIndex,\n      type: 'index-pattern',\n      id: indexPattern\n    };\n\n    return callWithRequest(request, 'get', body).then(response => response._source);\n  }\n\n  async function hasTimeBasedIndexPattern(request, savedObjSearchSourceIndex) {\n    const indexPattern = savedObjSearchSourceIndex.index;\n    if (!indexPattern) {\n      return Promise.resolve(false);\n    }\n\n    const indexPatternObj = await getIndexPatternObject(request, indexPattern);\n    return !!indexPatternObj.timeFieldName;\n  }\n\n  function getObject(request, type, id, fields = []) {\n    fields = ['title', 'description'].concat(fields);\n    validateType(type);\n    const body = {\n      index: opts.kibanaIndex,\n      type: type,\n      id: id\n    };\n\n    function parseJsonObjects(source) {\n      const searchSourceJson = get(source, appTypes[type].searchSourceIndex, '{}');\n      const uiStateJson = get(source, appTypes[type].stateIndex, '{}');\n      let searchSource;\n      let uiState;\n\n      try {\n        searchSource = JSON.parse(searchSourceJson);\n      } catch (e) {\n        searchSource = {};\n      }\n\n      try {\n        uiState = JSON.parse(uiStateJson);\n      } catch (e) {\n        uiState = {};\n      }\n\n      return { searchSource, uiState };\n    }\n\n    return callWithRequest(request, 'get', body)\n    .then(function _getRecord(response) {\n      return response._source;\n    })\n    .then(async function _buildObject(source) {\n      const { searchSource, uiState } = parseJsonObjects(source);\n\n      const isUsingTimeBasedIndexPattern = await hasTimeBasedIndexPattern(request, searchSource);\n\n      const obj = Object.assign(pick(source, fields), {\n        id: body.id,\n        type: type,\n        searchSource: searchSource,\n        uiState: uiState,\n        isUsingTimeBasedIndexPattern,\n        getUrl: function getAppUrl(query = {}, urlOptions = {}) {\n          const options = Object.assign({\n            useAbsoluteTime: true\n          }, urlOptions);\n          const app = appTypes[this.type];\n          if (!app) throw new Error('Unexpected app type: ' + this.type);\n\n          // map panel state to panel from app state part of the query\n          const cleanQuery = this.getState(query);\n\n          // modify the global state in the query\n          const globalState = parseKibanaState(query, 'global');\n          if (globalState.exists) {\n            globalState.removeProps('refreshInterval');\n\n            // transform to absolute time based on option\n            if (options.useAbsoluteTime) {\n              globalState.set('time', getAbsoluteTime(globalState.get('time')));\n            }\n\n            Object.assign(cleanQuery, globalState.toQuery());\n          }\n\n          const urlParams = Object.assign({\n            protocol: opts.protocol,\n            hostname: opts.hostname,\n            port: opts.port,\n          }, app.getUrlParams(this.id));\n\n          // Kibana appends querystrings to the hash, and parses them as such,\n          // so we'll do the same internally so kibana understands what we want\n          // const encoder = (str) => str;\n          // const unencodedQueryString = qs.stringify(cleanQuery, null, null, { encodeURIComponent: encoder });\n          const unencodedQueryString = uriEncode.stringify(cleanQuery);\n          urlParams.hash += '?' + unencodedQueryString;\n\n          return url.format(urlParams);\n        },\n        getState: function mergeQueryState(query = {}) {\n          const appState = parseKibanaState(query, 'app');\n          if (!appState.exists || !this.panelIndex) return query;\n\n          const panel = find(appState.get('panels', []), { panelIndex: this.panelIndex });\n          const panelState = appState.get(['uiState', `P-${this.panelIndex}`]);\n\n          appState.removeProps(['uiState', 'panels', 'vis']);\n\n          // if uiState doesn't match panel, simply strip uiState\n          if (panel && panelState) {\n            appState.set('uiState', merge({}, this.uiState, panelState));\n          }\n\n          return Object.assign({}, query, appState.toQuery());\n        },\n        toJSON: function (query, urlOptions) {\n          const savedObj = {\n            id: this.id,\n            type: this.type,\n            searchSource: this.searchSource,\n            uiState: this.uiState,\n            isUsingTimeBasedIndexPattern,\n            url: this.getUrl(query, urlOptions)\n          };\n\n          fields.forEach((field) => {\n            savedObj[field] = this[field];\n          });\n\n          return savedObj;\n        }\n      });\n\n      return obj;\n    })\n    .catch(() => {\n      const isMissing = true;\n      const savedObj = {\n        id,\n        type,\n        isMissing,\n        toJSON() {\n          return {\n            id,\n            type,\n            isMissing\n          };\n        }\n      };\n      return savedObj;\n    });\n  }\n\n  function validateType(type) {\n    const app = appTypes[type];\n    if (!app) throw new Error('Invalid object type: ' + type);\n  }\n\n  // exported methods\n  return {\n    get: getObject\n  };\n};\n"
      ]
    },
    "mtime": 1491771510540
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/server/lib/parse_kibana_state.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "lodash",
            "imported": [
              "isPlainObject",
              "omit",
              "get",
              "set"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "isPlainObject",
                "local": "isPlainObject"
              },
              {
                "kind": "named",
                "imported": "omit",
                "local": "omit"
              },
              {
                "kind": "named",
                "imported": "get",
                "local": "get"
              },
              {
                "kind": "named",
                "imported": "set",
                "local": "set"
              }
            ]
          },
          {
            "source": "rison-node",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "rison"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "parseKibanaState",
            "query",
            "type"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "parseKibanaState",
              "exported": "parseKibanaState"
            },
            {
              "kind": "local",
              "local": "query",
              "exported": "query"
            },
            {
              "kind": "local",
              "local": "type",
              "exported": "type"
            }
          ]
        }
      },
      "usedHelpers": [
        "create-class",
        "class-call-check",
        "interop-require-default"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nexports.parseKibanaState = parseKibanaState;\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\nvar _lodash = require('lodash');\n\nvar _risonNode = require('rison-node');\n\nvar _risonNode2 = _interopRequireDefault(_risonNode);\n\nvar stateTypeKeys = {\n  'global': '_g',\n  'app': '_a'\n};\n\nvar KibanaState = (function () {\n  function KibanaState(query) {\n    var type = arguments.length <= 1 || arguments[1] === undefined ? 'global' : arguments[1];\n\n    _classCallCheck(this, KibanaState);\n\n    var propId = stateTypeKeys[type];\n    if (!(0, _lodash.isPlainObject)(query)) throw new TypeError('Query parameter must be an object');\n    if (!propId) throw new TypeError('Unknown state type: \\'' + type + '\\'');\n\n    var queryValue = query[propId];\n\n    this.exists = Boolean(queryValue);\n    this.state = queryValue ? _risonNode2['default'].decode(queryValue) : {};\n    this.type = type;\n  }\n\n  _createClass(KibanaState, [{\n    key: 'removeProps',\n    value: function removeProps(props) {\n      this.state = (0, _lodash.omit)(this.state, props);\n    }\n  }, {\n    key: 'get',\n    value: function get(prop, defVal) {\n      return (0, _lodash.get)(this.state, prop, defVal);\n    }\n  }, {\n    key: 'set',\n    value: function set(prop, val) {\n      return (0, _lodash.set)(this.state, prop, val);\n    }\n  }, {\n    key: 'toString',\n    value: function toString() {\n      return _risonNode2['default'].encode(this.state);\n    }\n  }, {\n    key: 'toQuery',\n    value: function toQuery() {\n      var index = stateTypeKeys[this.type];\n      var output = {};\n      output[index] = this.toString();\n      return output;\n    }\n  }]);\n\n  return KibanaState;\n})();\n\nfunction parseKibanaState(query, type) {\n  return new KibanaState(query, type);\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3NlcnZlci9saWIvcGFyc2Vfa2liYW5hX3N0YXRlLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7O3NCQUE4QyxRQUFROzt5QkFDcEMsWUFBWTs7OztBQUU5QixJQUFNLGFBQWEsR0FBRztBQUNwQixVQUFRLEVBQUUsSUFBSTtBQUNkLE9BQUssRUFBRSxJQUFJO0NBQ1osQ0FBQzs7SUFFSSxXQUFXO0FBQ0osV0FEUCxXQUFXLENBQ0gsS0FBSyxFQUFtQjtRQUFqQixJQUFJLHlEQUFHLFFBQVE7OzBCQUQ5QixXQUFXOztBQUViLFFBQU0sTUFBTSxHQUFHLGFBQWEsQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUNuQyxRQUFJLENBQUMsMkJBQWMsS0FBSyxDQUFDLEVBQUUsTUFBTSxJQUFJLFNBQVMsQ0FBQyxtQ0FBbUMsQ0FBQyxDQUFDO0FBQ3BGLFFBQUksQ0FBQyxNQUFNLEVBQUUsTUFBTSxJQUFJLFNBQVMsNEJBQXlCLElBQUksUUFBSSxDQUFDOztBQUVsRSxRQUFNLFVBQVUsR0FBRyxLQUFLLENBQUMsTUFBTSxDQUFDLENBQUM7O0FBRWpDLFFBQUksQ0FBQyxNQUFNLEdBQUcsT0FBTyxDQUFDLFVBQVUsQ0FBQyxDQUFDO0FBQ2xDLFFBQUksQ0FBQyxLQUFLLEdBQUcsQUFBQyxVQUFVLEdBQUksdUJBQU0sTUFBTSxDQUFDLFVBQVUsQ0FBQyxHQUFHLEVBQUUsQ0FBQztBQUMxRCxRQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQztHQUNsQjs7ZUFYRyxXQUFXOztXQWFKLHFCQUFDLEtBQUssRUFBRTtBQUNqQixVQUFJLENBQUMsS0FBSyxHQUFHLGtCQUFLLElBQUksQ0FBQyxLQUFLLEVBQUUsS0FBSyxDQUFDLENBQUM7S0FDdEM7OztXQUVFLGFBQUMsSUFBSSxFQUFFLE1BQU0sRUFBRTtBQUNoQixhQUFPLGlCQUFJLElBQUksQ0FBQyxLQUFLLEVBQUUsSUFBSSxFQUFFLE1BQU0sQ0FBQyxDQUFDO0tBQ3RDOzs7V0FFRSxhQUFDLElBQUksRUFBRSxHQUFHLEVBQUU7QUFDYixhQUFPLGlCQUFJLElBQUksQ0FBQyxLQUFLLEVBQUUsSUFBSSxFQUFFLEdBQUcsQ0FBQyxDQUFDO0tBQ25DOzs7V0FFTyxvQkFBRztBQUNULGFBQU8sdUJBQU0sTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztLQUNqQzs7O1dBRU0sbUJBQUc7QUFDUixVQUFNLEtBQUssR0FBRyxhQUFhLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO0FBQ3ZDLFVBQU0sTUFBTSxHQUFHLEVBQUUsQ0FBQztBQUNsQixZQUFNLENBQUMsS0FBSyxDQUFDLEdBQUcsSUFBSSxDQUFDLFFBQVEsRUFBRSxDQUFDO0FBQ2hDLGFBQU8sTUFBTSxDQUFDO0tBQ2Y7OztTQWxDRyxXQUFXOzs7QUFxQ1YsU0FBUyxnQkFBZ0IsQ0FBQyxLQUFLLEVBQUUsSUFBSSxFQUFFO0FBQzVDLFNBQU8sSUFBSSxXQUFXLENBQUMsS0FBSyxFQUFFLElBQUksQ0FBQyxDQUFDO0NBQ3JDIiwiZmlsZSI6Ii91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3NlcnZlci9saWIvcGFyc2Vfa2liYW5hX3N0YXRlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgaXNQbGFpbk9iamVjdCwgb21pdCwgZ2V0LCBzZXQgfSBmcm9tICdsb2Rhc2gnO1xuaW1wb3J0IHJpc29uIGZyb20gJ3Jpc29uLW5vZGUnO1xuXG5jb25zdCBzdGF0ZVR5cGVLZXlzID0ge1xuICAnZ2xvYmFsJzogJ19nJyxcbiAgJ2FwcCc6ICdfYScsXG59O1xuXG5jbGFzcyBLaWJhbmFTdGF0ZSB7XG4gIGNvbnN0cnVjdG9yKHF1ZXJ5LCB0eXBlID0gJ2dsb2JhbCcpIHtcbiAgICBjb25zdCBwcm9wSWQgPSBzdGF0ZVR5cGVLZXlzW3R5cGVdO1xuICAgIGlmICghaXNQbGFpbk9iamVjdChxdWVyeSkpIHRocm93IG5ldyBUeXBlRXJyb3IoJ1F1ZXJ5IHBhcmFtZXRlciBtdXN0IGJlIGFuIG9iamVjdCcpO1xuICAgIGlmICghcHJvcElkKSB0aHJvdyBuZXcgVHlwZUVycm9yKGBVbmtub3duIHN0YXRlIHR5cGU6ICcke3R5cGV9J2ApO1xuXG4gICAgY29uc3QgcXVlcnlWYWx1ZSA9IHF1ZXJ5W3Byb3BJZF07XG5cbiAgICB0aGlzLmV4aXN0cyA9IEJvb2xlYW4ocXVlcnlWYWx1ZSk7XG4gICAgdGhpcy5zdGF0ZSA9IChxdWVyeVZhbHVlKSA/IHJpc29uLmRlY29kZShxdWVyeVZhbHVlKSA6IHt9O1xuICAgIHRoaXMudHlwZSA9IHR5cGU7XG4gIH1cblxuICByZW1vdmVQcm9wcyhwcm9wcykge1xuICAgIHRoaXMuc3RhdGUgPSBvbWl0KHRoaXMuc3RhdGUsIHByb3BzKTtcbiAgfVxuXG4gIGdldChwcm9wLCBkZWZWYWwpIHtcbiAgICByZXR1cm4gZ2V0KHRoaXMuc3RhdGUsIHByb3AsIGRlZlZhbCk7XG4gIH1cblxuICBzZXQocHJvcCwgdmFsKSB7XG4gICAgcmV0dXJuIHNldCh0aGlzLnN0YXRlLCBwcm9wLCB2YWwpO1xuICB9XG5cbiAgdG9TdHJpbmcoKSB7XG4gICAgcmV0dXJuIHJpc29uLmVuY29kZSh0aGlzLnN0YXRlKTtcbiAgfVxuXG4gIHRvUXVlcnkoKSB7XG4gICAgY29uc3QgaW5kZXggPSBzdGF0ZVR5cGVLZXlzW3RoaXMudHlwZV07XG4gICAgY29uc3Qgb3V0cHV0ID0ge307XG4gICAgb3V0cHV0W2luZGV4XSA9IHRoaXMudG9TdHJpbmcoKTtcbiAgICByZXR1cm4gb3V0cHV0O1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZUtpYmFuYVN0YXRlKHF1ZXJ5LCB0eXBlKSB7XG4gIHJldHVybiBuZXcgS2liYW5hU3RhdGUocXVlcnksIHR5cGUpO1xufSJdfQ==",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/server/lib/parse_kibana_state.js"
      ],
      "names": [],
      "mappings": ";;;;;;;;;;;;;;sBAA8C,QAAQ;;yBACpC,YAAY;;;;AAE9B,IAAM,aAAa,GAAG;AACpB,UAAQ,EAAE,IAAI;AACd,OAAK,EAAE,IAAI;CACZ,CAAC;;IAEI,WAAW;AACJ,WADP,WAAW,CACH,KAAK,EAAmB;QAAjB,IAAI,yDAAG,QAAQ;;0BAD9B,WAAW;;AAEb,QAAM,MAAM,GAAG,aAAa,CAAC,IAAI,CAAC,CAAC;AACnC,QAAI,CAAC,2BAAc,KAAK,CAAC,EAAE,MAAM,IAAI,SAAS,CAAC,mCAAmC,CAAC,CAAC;AACpF,QAAI,CAAC,MAAM,EAAE,MAAM,IAAI,SAAS,4BAAyB,IAAI,QAAI,CAAC;;AAElE,QAAM,UAAU,GAAG,KAAK,CAAC,MAAM,CAAC,CAAC;;AAEjC,QAAI,CAAC,MAAM,GAAG,OAAO,CAAC,UAAU,CAAC,CAAC;AAClC,QAAI,CAAC,KAAK,GAAG,AAAC,UAAU,GAAI,uBAAM,MAAM,CAAC,UAAU,CAAC,GAAG,EAAE,CAAC;AAC1D,QAAI,CAAC,IAAI,GAAG,IAAI,CAAC;GAClB;;eAXG,WAAW;;WAaJ,qBAAC,KAAK,EAAE;AACjB,UAAI,CAAC,KAAK,GAAG,kBAAK,IAAI,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC;KACtC;;;WAEE,aAAC,IAAI,EAAE,MAAM,EAAE;AAChB,aAAO,iBAAI,IAAI,CAAC,KAAK,EAAE,IAAI,EAAE,MAAM,CAAC,CAAC;KACtC;;;WAEE,aAAC,IAAI,EAAE,GAAG,EAAE;AACb,aAAO,iBAAI,IAAI,CAAC,KAAK,EAAE,IAAI,EAAE,GAAG,CAAC,CAAC;KACnC;;;WAEO,oBAAG;AACT,aAAO,uBAAM,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;KACjC;;;WAEM,mBAAG;AACR,UAAM,KAAK,GAAG,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;AACvC,UAAM,MAAM,GAAG,EAAE,CAAC;AAClB,YAAM,CAAC,KAAK,CAAC,GAAG,IAAI,CAAC,QAAQ,EAAE,CAAC;AAChC,aAAO,MAAM,CAAC;KACf;;;SAlCG,WAAW;;;AAqCV,SAAS,gBAAgB,CAAC,KAAK,EAAE,IAAI,EAAE;AAC5C,SAAO,IAAI,WAAW,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC;CACrC",
      "file": "/usr/share/kibana/plugins/x-pack/server/lib/parse_kibana_state.js",
      "sourcesContent": [
        "import { isPlainObject, omit, get, set } from 'lodash';\nimport rison from 'rison-node';\n\nconst stateTypeKeys = {\n  'global': '_g',\n  'app': '_a',\n};\n\nclass KibanaState {\n  constructor(query, type = 'global') {\n    const propId = stateTypeKeys[type];\n    if (!isPlainObject(query)) throw new TypeError('Query parameter must be an object');\n    if (!propId) throw new TypeError(`Unknown state type: '${type}'`);\n\n    const queryValue = query[propId];\n\n    this.exists = Boolean(queryValue);\n    this.state = (queryValue) ? rison.decode(queryValue) : {};\n    this.type = type;\n  }\n\n  removeProps(props) {\n    this.state = omit(this.state, props);\n  }\n\n  get(prop, defVal) {\n    return get(this.state, prop, defVal);\n  }\n\n  set(prop, val) {\n    return set(this.state, prop, val);\n  }\n\n  toString() {\n    return rison.encode(this.state);\n  }\n\n  toQuery() {\n    const index = stateTypeKeys[this.type];\n    const output = {};\n    output[index] = this.toString();\n    return output;\n  }\n}\n\nexport function parseKibanaState(query, type) {\n  return new KibanaState(query, type);\n}"
      ]
    },
    "mtime": 1491771505397
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/uri_encode.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "lodash",
            "imported": [
              "forEach",
              "isArray"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "forEach",
                "local": "forEach"
              },
              {
                "kind": "named",
                "imported": "isArray",
                "local": "isArray"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "uriEncode"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "uriEncode",
              "exported": "uriEncode"
            }
          ]
        }
      },
      "usedHelpers": []
    },
    "ignored": false,
    "code": "// Stolen from Angular, used to get reliable encoded URIs\n'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nvar _lodash = require('lodash');\n\nfunction encodeUriQuery(val, pctEncodeSpaces) {\n  return encodeURIComponent(val).replace(/%40/gi, '@').replace(/%3A/gi, ':').replace(/%24/g, '$').replace(/%2C/gi, ',').replace(/%3B/gi, ';').replace(/%20/g, pctEncodeSpaces ? '%20' : '+');\n};\n\nfunction toKeyValue(obj) {\n  var parts = [];\n  (0, _lodash.forEach)(obj, function (value, key) {\n    if ((0, _lodash.isArray)(value)) {\n      (0, _lodash.forEach)(value, function (arrayValue) {\n        var keyStr = encodeUriQuery(key, true);\n        var valStr = arrayValue === true ? '' : '=' + encodeUriQuery(arrayValue, true);\n        parts.push(keyStr + valStr);\n      });\n    } else {\n      var keyStr = encodeUriQuery(key, true);\n      var valStr = value === true ? '' : '=' + encodeUriQuery(value, true);\n      parts.push(keyStr + valStr);\n    }\n  });\n  return parts.length ? parts.join('&') : '';\n};\n\nvar uriEncode = {\n  stringify: toKeyValue,\n  string: encodeUriQuery\n};\nexports.uriEncode = uriEncode;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvcmVwb3J0aW5nL3NlcnZlci9saWIvdXJpX2VuY29kZS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7O3NCQUNpQyxRQUFROztBQUV6QyxTQUFTLGNBQWMsQ0FBQyxHQUFHLEVBQUUsZUFBZSxFQUFFO0FBQzVDLFNBQU8sa0JBQWtCLENBQUMsR0FBRyxDQUFDLENBQzdCLE9BQU8sQ0FBQyxPQUFPLEVBQUUsR0FBRyxDQUFDLENBQ3JCLE9BQU8sQ0FBQyxPQUFPLEVBQUUsR0FBRyxDQUFDLENBQ3JCLE9BQU8sQ0FBQyxNQUFNLEVBQUUsR0FBRyxDQUFDLENBQ3BCLE9BQU8sQ0FBQyxPQUFPLEVBQUUsR0FBRyxDQUFDLENBQ3JCLE9BQU8sQ0FBQyxPQUFPLEVBQUUsR0FBRyxDQUFDLENBQ3JCLE9BQU8sQ0FBQyxNQUFNLEVBQUcsZUFBZSxHQUFHLEtBQUssR0FBRyxHQUFHLENBQUUsQ0FBQztDQUNuRCxDQUFDOztBQUVGLFNBQVMsVUFBVSxDQUFDLEdBQUcsRUFBRTtBQUN2QixNQUFNLEtBQUssR0FBRyxFQUFFLENBQUM7QUFDakIsdUJBQVEsR0FBRyxFQUFFLFVBQVUsS0FBSyxFQUFFLEdBQUcsRUFBRTtBQUNqQyxRQUFJLHFCQUFRLEtBQUssQ0FBQyxFQUFFO0FBQ2xCLDJCQUFRLEtBQUssRUFBRSxVQUFVLFVBQVUsRUFBRTtBQUNuQyxZQUFNLE1BQU0sR0FBRyxjQUFjLENBQUMsR0FBRyxFQUFFLElBQUksQ0FBQyxDQUFDO0FBQ3pDLFlBQU0sTUFBTSxHQUFJLFVBQVUsS0FBSyxJQUFJLEdBQUcsRUFBRSxHQUFHLEdBQUcsR0FBRyxjQUFjLENBQUMsVUFBVSxFQUFFLElBQUksQ0FBQyxBQUFDLENBQUM7QUFDbkYsYUFBSyxDQUFDLElBQUksQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFDLENBQUM7T0FDN0IsQ0FBQyxDQUFDO0tBQ0osTUFBTTtBQUNMLFVBQU0sTUFBTSxHQUFHLGNBQWMsQ0FBQyxHQUFHLEVBQUUsSUFBSSxDQUFDLENBQUM7QUFDekMsVUFBTSxNQUFNLEdBQUksS0FBSyxLQUFLLElBQUksR0FBRyxFQUFFLEdBQUcsR0FBRyxHQUFHLGNBQWMsQ0FBQyxLQUFLLEVBQUUsSUFBSSxDQUFDLEFBQUMsQ0FBQztBQUN6RSxXQUFLLENBQUMsSUFBSSxDQUFDLE1BQU0sR0FBRyxNQUFNLENBQUMsQ0FBQztLQUM3QjtHQUNGLENBQUMsQ0FBQztBQUNILFNBQU8sS0FBSyxDQUFDLE1BQU0sR0FBRyxLQUFLLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxHQUFHLEVBQUUsQ0FBQztDQUM1QyxDQUFDOztBQUVLLElBQU0sU0FBUyxHQUFHO0FBQ3ZCLFdBQVMsRUFBRSxVQUFVO0FBQ3JCLFFBQU0sRUFBRSxjQUFjO0NBQ3ZCLENBQUMiLCJmaWxlIjoiL3Vzci9zaGFyZS9raWJhbmEvcGx1Z2lucy94LXBhY2svcGx1Z2lucy9yZXBvcnRpbmcvc2VydmVyL2xpYi91cmlfZW5jb2RlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy8gU3RvbGVuIGZyb20gQW5ndWxhciwgdXNlZCB0byBnZXQgcmVsaWFibGUgZW5jb2RlZCBVUklzXG5pbXBvcnQgeyBmb3JFYWNoLCBpc0FycmF5IH0gZnJvbSAnbG9kYXNoJztcblxuZnVuY3Rpb24gZW5jb2RlVXJpUXVlcnkodmFsLCBwY3RFbmNvZGVTcGFjZXMpIHtcbiAgcmV0dXJuIGVuY29kZVVSSUNvbXBvbmVudCh2YWwpXG4gIC5yZXBsYWNlKC8lNDAvZ2ksICdAJylcbiAgLnJlcGxhY2UoLyUzQS9naSwgJzonKVxuICAucmVwbGFjZSgvJTI0L2csICckJylcbiAgLnJlcGxhY2UoLyUyQy9naSwgJywnKVxuICAucmVwbGFjZSgvJTNCL2dpLCAnOycpXG4gIC5yZXBsYWNlKC8lMjAvZywgKHBjdEVuY29kZVNwYWNlcyA/ICclMjAnIDogJysnKSk7XG59O1xuXG5mdW5jdGlvbiB0b0tleVZhbHVlKG9iaikge1xuICBjb25zdCBwYXJ0cyA9IFtdO1xuICBmb3JFYWNoKG9iaiwgZnVuY3Rpb24gKHZhbHVlLCBrZXkpIHtcbiAgICBpZiAoaXNBcnJheSh2YWx1ZSkpIHtcbiAgICAgIGZvckVhY2godmFsdWUsIGZ1bmN0aW9uIChhcnJheVZhbHVlKSB7XG4gICAgICAgIGNvbnN0IGtleVN0ciA9IGVuY29kZVVyaVF1ZXJ5KGtleSwgdHJ1ZSk7XG4gICAgICAgIGNvbnN0IHZhbFN0ciA9IChhcnJheVZhbHVlID09PSB0cnVlID8gJycgOiAnPScgKyBlbmNvZGVVcmlRdWVyeShhcnJheVZhbHVlLCB0cnVlKSk7XG4gICAgICAgIHBhcnRzLnB1c2goa2V5U3RyICsgdmFsU3RyKTtcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCBrZXlTdHIgPSBlbmNvZGVVcmlRdWVyeShrZXksIHRydWUpO1xuICAgICAgY29uc3QgdmFsU3RyID0gKHZhbHVlID09PSB0cnVlID8gJycgOiAnPScgKyBlbmNvZGVVcmlRdWVyeSh2YWx1ZSwgdHJ1ZSkpO1xuICAgICAgcGFydHMucHVzaChrZXlTdHIgKyB2YWxTdHIpO1xuICAgIH1cbiAgfSk7XG4gIHJldHVybiBwYXJ0cy5sZW5ndGggPyBwYXJ0cy5qb2luKCcmJykgOiAnJztcbn07XG5cbmV4cG9ydCBjb25zdCB1cmlFbmNvZGUgPSB7XG4gIHN0cmluZ2lmeTogdG9LZXlWYWx1ZSxcbiAgc3RyaW5nOiBlbmNvZGVVcmlRdWVyeSxcbn07Il19",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/uri_encode.js"
      ],
      "names": [],
      "mappings": ";;;;;;;sBACiC,QAAQ;;AAEzC,SAAS,cAAc,CAAC,GAAG,EAAE,eAAe,EAAE;AAC5C,SAAO,kBAAkB,CAAC,GAAG,CAAC,CAC7B,OAAO,CAAC,OAAO,EAAE,GAAG,CAAC,CACrB,OAAO,CAAC,OAAO,EAAE,GAAG,CAAC,CACrB,OAAO,CAAC,MAAM,EAAE,GAAG,CAAC,CACpB,OAAO,CAAC,OAAO,EAAE,GAAG,CAAC,CACrB,OAAO,CAAC,OAAO,EAAE,GAAG,CAAC,CACrB,OAAO,CAAC,MAAM,EAAG,eAAe,GAAG,KAAK,GAAG,GAAG,CAAE,CAAC;CACnD,CAAC;;AAEF,SAAS,UAAU,CAAC,GAAG,EAAE;AACvB,MAAM,KAAK,GAAG,EAAE,CAAC;AACjB,uBAAQ,GAAG,EAAE,UAAU,KAAK,EAAE,GAAG,EAAE;AACjC,QAAI,qBAAQ,KAAK,CAAC,EAAE;AAClB,2BAAQ,KAAK,EAAE,UAAU,UAAU,EAAE;AACnC,YAAM,MAAM,GAAG,cAAc,CAAC,GAAG,EAAE,IAAI,CAAC,CAAC;AACzC,YAAM,MAAM,GAAI,UAAU,KAAK,IAAI,GAAG,EAAE,GAAG,GAAG,GAAG,cAAc,CAAC,UAAU,EAAE,IAAI,CAAC,AAAC,CAAC;AACnF,aAAK,CAAC,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC,CAAC;OAC7B,CAAC,CAAC;KACJ,MAAM;AACL,UAAM,MAAM,GAAG,cAAc,CAAC,GAAG,EAAE,IAAI,CAAC,CAAC;AACzC,UAAM,MAAM,GAAI,KAAK,KAAK,IAAI,GAAG,EAAE,GAAG,GAAG,GAAG,cAAc,CAAC,KAAK,EAAE,IAAI,CAAC,AAAC,CAAC;AACzE,WAAK,CAAC,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC,CAAC;KAC7B;GACF,CAAC,CAAC;AACH,SAAO,KAAK,CAAC,MAAM,GAAG,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,EAAE,CAAC;CAC5C,CAAC;;AAEK,IAAM,SAAS,GAAG;AACvB,WAAS,EAAE,UAAU;AACrB,QAAM,EAAE,cAAc;CACvB,CAAC",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/uri_encode.js",
      "sourcesContent": [
        "// Stolen from Angular, used to get reliable encoded URIs\nimport { forEach, isArray } from 'lodash';\n\nfunction encodeUriQuery(val, pctEncodeSpaces) {\n  return encodeURIComponent(val)\n  .replace(/%40/gi, '@')\n  .replace(/%3A/gi, ':')\n  .replace(/%24/g, '$')\n  .replace(/%2C/gi, ',')\n  .replace(/%3B/gi, ';')\n  .replace(/%20/g, (pctEncodeSpaces ? '%20' : '+'));\n};\n\nfunction toKeyValue(obj) {\n  const parts = [];\n  forEach(obj, function (value, key) {\n    if (isArray(value)) {\n      forEach(value, function (arrayValue) {\n        const keyStr = encodeUriQuery(key, true);\n        const valStr = (arrayValue === true ? '' : '=' + encodeUriQuery(arrayValue, true));\n        parts.push(keyStr + valStr);\n      });\n    } else {\n      const keyStr = encodeUriQuery(key, true);\n      const valStr = (value === true ? '' : '=' + encodeUriQuery(value, true));\n      parts.push(keyStr + valStr);\n    }\n  });\n  return parts.length ? parts.join('&') : '';\n};\n\nexport const uriEncode = {\n  stringify: toKeyValue,\n  string: encodeUriQuery,\n};"
      ]
    },
    "mtime": 1491771510540
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/get_absolute_time.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "lodash",
            "imported": [
              "get"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "get",
                "local": "get"
              }
            ]
          },
          {
            "source": "@elastic/datemath",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "datemath"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "getAbsoluteTime",
            "time"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "getAbsoluteTime",
              "exported": "getAbsoluteTime"
            },
            {
              "kind": "local",
              "local": "time",
              "exported": "time"
            }
          ]
        }
      },
      "usedHelpers": [
        "interop-require-default"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nexports.getAbsoluteTime = getAbsoluteTime;\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _lodash = require('lodash');\n\nvar _elasticDatemath = require('@elastic/datemath');\n\nvar _elasticDatemath2 = _interopRequireDefault(_elasticDatemath);\n\nfunction getAbsoluteTime(time) {\n  var mode = (0, _lodash.get)(time, 'mode');\n  var timeFrom = (0, _lodash.get)(time, 'from');\n  var timeTo = (0, _lodash.get)(time, 'to');\n  var roundToEnd = true;\n\n  if (!mode || !timeFrom || !timeTo) return time;\n  if (mode === 'absolute') return time;\n\n  var output = { mode: 'absolute' };\n  output.from = _elasticDatemath2['default'].parse(timeFrom);\n  output.to = _elasticDatemath2['default'].parse(timeTo, roundToEnd);\n  return output;\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvcmVwb3J0aW5nL3NlcnZlci9saWIvZ2V0X2Fic29sdXRlX3RpbWUuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O3NCQUFvQixRQUFROzsrQkFDUCxtQkFBbUI7Ozs7QUFFakMsU0FBUyxlQUFlLENBQUMsSUFBSSxFQUFFO0FBQ3BDLE1BQU0sSUFBSSxHQUFHLGlCQUFJLElBQUksRUFBRSxNQUFNLENBQUMsQ0FBQztBQUMvQixNQUFNLFFBQVEsR0FBRyxpQkFBSSxJQUFJLEVBQUUsTUFBTSxDQUFDLENBQUM7QUFDbkMsTUFBTSxNQUFNLEdBQUcsaUJBQUksSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFDO0FBQy9CLE1BQU0sVUFBVSxHQUFHLElBQUksQ0FBQzs7QUFFeEIsTUFBSSxDQUFDLElBQUksSUFBSSxDQUFDLFFBQVEsSUFBSSxDQUFDLE1BQU0sRUFBRSxPQUFPLElBQUksQ0FBQztBQUMvQyxNQUFJLElBQUksS0FBSyxVQUFVLEVBQUUsT0FBTyxJQUFJLENBQUM7O0FBRXJDLE1BQU0sTUFBTSxHQUFHLEVBQUUsSUFBSSxFQUFFLFVBQVUsRUFBRSxDQUFDO0FBQ3BDLFFBQU0sQ0FBQyxJQUFJLEdBQUcsNkJBQVMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxDQUFDO0FBQ3ZDLFFBQU0sQ0FBQyxFQUFFLEdBQUcsNkJBQVMsS0FBSyxDQUFDLE1BQU0sRUFBRSxVQUFVLENBQUMsQ0FBQztBQUMvQyxTQUFPLE1BQU0sQ0FBQztDQUNmIiwiZmlsZSI6Ii91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvcmVwb3J0aW5nL3NlcnZlci9saWIvZ2V0X2Fic29sdXRlX3RpbWUuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBnZXQgfSBmcm9tICdsb2Rhc2gnO1xuaW1wb3J0IGRhdGVtYXRoIGZyb20gJ0BlbGFzdGljL2RhdGVtYXRoJztcblxuZXhwb3J0IGZ1bmN0aW9uIGdldEFic29sdXRlVGltZSh0aW1lKSB7XG4gIGNvbnN0IG1vZGUgPSBnZXQodGltZSwgJ21vZGUnKTtcbiAgY29uc3QgdGltZUZyb20gPSBnZXQodGltZSwgJ2Zyb20nKTtcbiAgY29uc3QgdGltZVRvID0gZ2V0KHRpbWUsICd0bycpO1xuICBjb25zdCByb3VuZFRvRW5kID0gdHJ1ZTtcblxuICBpZiAoIW1vZGUgfHwgIXRpbWVGcm9tIHx8ICF0aW1lVG8pIHJldHVybiB0aW1lO1xuICBpZiAobW9kZSA9PT0gJ2Fic29sdXRlJykgcmV0dXJuIHRpbWU7XG5cbiAgY29uc3Qgb3V0cHV0ID0geyBtb2RlOiAnYWJzb2x1dGUnIH07XG4gIG91dHB1dC5mcm9tID0gZGF0ZW1hdGgucGFyc2UodGltZUZyb20pO1xuICBvdXRwdXQudG8gPSBkYXRlbWF0aC5wYXJzZSh0aW1lVG8sIHJvdW5kVG9FbmQpO1xuICByZXR1cm4gb3V0cHV0O1xufSJdfQ==",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/get_absolute_time.js"
      ],
      "names": [],
      "mappings": ";;;;;;;;;sBAAoB,QAAQ;;+BACP,mBAAmB;;;;AAEjC,SAAS,eAAe,CAAC,IAAI,EAAE;AACpC,MAAM,IAAI,GAAG,iBAAI,IAAI,EAAE,MAAM,CAAC,CAAC;AAC/B,MAAM,QAAQ,GAAG,iBAAI,IAAI,EAAE,MAAM,CAAC,CAAC;AACnC,MAAM,MAAM,GAAG,iBAAI,IAAI,EAAE,IAAI,CAAC,CAAC;AAC/B,MAAM,UAAU,GAAG,IAAI,CAAC;;AAExB,MAAI,CAAC,IAAI,IAAI,CAAC,QAAQ,IAAI,CAAC,MAAM,EAAE,OAAO,IAAI,CAAC;AAC/C,MAAI,IAAI,KAAK,UAAU,EAAE,OAAO,IAAI,CAAC;;AAErC,MAAM,MAAM,GAAG,EAAE,IAAI,EAAE,UAAU,EAAE,CAAC;AACpC,QAAM,CAAC,IAAI,GAAG,6BAAS,KAAK,CAAC,QAAQ,CAAC,CAAC;AACvC,QAAM,CAAC,EAAE,GAAG,6BAAS,KAAK,CAAC,MAAM,EAAE,UAAU,CAAC,CAAC;AAC/C,SAAO,MAAM,CAAC;CACf",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/get_absolute_time.js",
      "sourcesContent": [
        "import { get } from 'lodash';\nimport datemath from '@elastic/datemath';\n\nexport function getAbsoluteTime(time) {\n  const mode = get(time, 'mode');\n  const timeFrom = get(time, 'from');\n  const timeTo = get(time, 'to');\n  const roundToEnd = true;\n\n  if (!mode || !timeFrom || !timeTo) return time;\n  if (mode === 'absolute') return time;\n\n  const output = { mode: 'absolute' };\n  output.from = datemath.parse(timeFrom);\n  output.to = datemath.parse(timeTo, roundToEnd);\n  return output;\n}"
      ]
    },
    "mtime": 1491771510540
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/crypto.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "@elastic/node-crypto",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "nodeCrypto"
              }
            ]
          },
          {
            "source": "./once_per_server",
            "imported": [
              "oncePerServer"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "oncePerServer",
                "local": "oncePerServer"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "cryptoFactory"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "cryptoFactory",
              "exported": "cryptoFactory"
            }
          ]
        }
      },
      "usedHelpers": [
        "interop-require-default"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _elasticNodeCrypto = require('@elastic/node-crypto');\n\nvar _elasticNodeCrypto2 = _interopRequireDefault(_elasticNodeCrypto);\n\nvar _once_per_server = require('./once_per_server');\n\nfunction cryptoFn(server) {\n  var encryptionKey = server.config().get('xpack.reporting.encryptionKey');\n  return (0, _elasticNodeCrypto2['default'])({ encryptionKey: encryptionKey });\n}\n\nvar cryptoFactory = (0, _once_per_server.oncePerServer)(cryptoFn);\nexports.cryptoFactory = cryptoFactory;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvcmVwb3J0aW5nL3NlcnZlci9saWIvY3J5cHRvLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7O2lDQUF1QixzQkFBc0I7Ozs7K0JBQ2YsbUJBQW1COztBQUVqRCxTQUFTLFFBQVEsQ0FBQyxNQUFNLEVBQUU7QUFDeEIsTUFBTSxhQUFhLEdBQUcsTUFBTSxDQUFDLE1BQU0sRUFBRSxDQUFDLEdBQUcsQ0FBQywrQkFBK0IsQ0FBQyxDQUFDO0FBQzNFLFNBQU8sb0NBQVcsRUFBRSxhQUFhLEVBQWIsYUFBYSxFQUFFLENBQUMsQ0FBQztDQUN0Qzs7QUFFTSxJQUFNLGFBQWEsR0FBRyxvQ0FBYyxRQUFRLENBQUMsQ0FBQyIsImZpbGUiOiIvdXNyL3NoYXJlL2tpYmFuYS9wbHVnaW5zL3gtcGFjay9wbHVnaW5zL3JlcG9ydGluZy9zZXJ2ZXIvbGliL2NyeXB0by5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBub2RlQ3J5cHRvIGZyb20gJ0BlbGFzdGljL25vZGUtY3J5cHRvJztcbmltcG9ydCB7IG9uY2VQZXJTZXJ2ZXIgfSBmcm9tICcuL29uY2VfcGVyX3NlcnZlcic7XG5cbmZ1bmN0aW9uIGNyeXB0b0ZuKHNlcnZlcikge1xuICBjb25zdCBlbmNyeXB0aW9uS2V5ID0gc2VydmVyLmNvbmZpZygpLmdldCgneHBhY2sucmVwb3J0aW5nLmVuY3J5cHRpb25LZXknKTtcbiAgcmV0dXJuIG5vZGVDcnlwdG8oeyBlbmNyeXB0aW9uS2V5IH0pO1xufVxuXG5leHBvcnQgY29uc3QgY3J5cHRvRmFjdG9yeSA9IG9uY2VQZXJTZXJ2ZXIoY3J5cHRvRm4pO1xuIl19",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/crypto.js"
      ],
      "names": [],
      "mappings": ";;;;;;;;iCAAuB,sBAAsB;;;;+BACf,mBAAmB;;AAEjD,SAAS,QAAQ,CAAC,MAAM,EAAE;AACxB,MAAM,aAAa,GAAG,MAAM,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,+BAA+B,CAAC,CAAC;AAC3E,SAAO,oCAAW,EAAE,aAAa,EAAb,aAAa,EAAE,CAAC,CAAC;CACtC;;AAEM,IAAM,aAAa,GAAG,oCAAc,QAAQ,CAAC,CAAC",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/crypto.js",
      "sourcesContent": [
        "import nodeCrypto from '@elastic/node-crypto';\nimport { oncePerServer } from './once_per_server';\n\nfunction cryptoFn(server) {\n  const encryptionKey = server.config().get('xpack.reporting.encryptionKey');\n  return nodeCrypto({ encryptionKey });\n}\n\nexport const cryptoFactory = oncePerServer(cryptoFn);\n"
      ]
    },
    "mtime": 1491771510540
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/license_pre_routing.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "boom",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "Boom"
              }
            ]
          },
          {
            "source": "./once_per_server",
            "imported": [
              "oncePerServer"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "oncePerServer",
                "local": "oncePerServer"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "licensePreRoutingFactory"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "licensePreRoutingFactory",
              "exported": "licensePreRoutingFactory"
            }
          ]
        }
      },
      "usedHelpers": [
        "interop-require-default"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _boom = require('boom');\n\nvar _boom2 = _interopRequireDefault(_boom);\n\nvar _once_per_server = require('./once_per_server');\n\nfunction licensePreRoutingFn(server) {\n  var xpackMainPlugin = server.plugins.xpack_main;\n  var pluginId = 'reporting';\n\n  // License checking and enable/disable logic\n  function licensePreRouting(request, reply) {\n    var licenseCheckResults = xpackMainPlugin.info.feature(pluginId).getLicenseCheckResults();\n    if (!licenseCheckResults.showLinks || !licenseCheckResults.enableLinks) {\n      reply(_boom2['default'].forbidden(licenseCheckResults.message));\n    } else {\n      reply();\n    }\n  };\n\n  return licensePreRouting;\n}\n\nvar licensePreRoutingFactory = (0, _once_per_server.oncePerServer)(licensePreRoutingFn);\nexports.licensePreRoutingFactory = licensePreRoutingFactory;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvcmVwb3J0aW5nL3NlcnZlci9saWIvbGljZW5zZV9wcmVfcm91dGluZy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7OztvQkFBaUIsTUFBTTs7OzsrQkFDTyxtQkFBbUI7O0FBRWpELFNBQVMsbUJBQW1CLENBQUMsTUFBTSxFQUFFO0FBQ25DLE1BQU0sZUFBZSxHQUFHLE1BQU0sQ0FBQyxPQUFPLENBQUMsVUFBVSxDQUFDO0FBQ2xELE1BQU0sUUFBUSxHQUFHLFdBQVcsQ0FBQzs7O0FBRzdCLFdBQVMsaUJBQWlCLENBQUMsT0FBTyxFQUFFLEtBQUssRUFBRTtBQUN6QyxRQUFNLG1CQUFtQixHQUFHLGVBQWUsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxDQUFDLHNCQUFzQixFQUFFLENBQUM7QUFDNUYsUUFBSSxDQUFDLG1CQUFtQixDQUFDLFNBQVMsSUFBSSxDQUFDLG1CQUFtQixDQUFDLFdBQVcsRUFBRTtBQUN0RSxXQUFLLENBQUMsa0JBQUssU0FBUyxDQUFDLG1CQUFtQixDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUM7S0FDcEQsTUFBTTtBQUNMLFdBQUssRUFBRSxDQUFDO0tBQ1Q7R0FDRixDQUFDOztBQUVGLFNBQU8saUJBQWlCLENBQUM7Q0FDMUI7O0FBRU0sSUFBTSx3QkFBd0IsR0FBRyxvQ0FBYyxtQkFBbUIsQ0FBQyxDQUFDIiwiZmlsZSI6Ii91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvcmVwb3J0aW5nL3NlcnZlci9saWIvbGljZW5zZV9wcmVfcm91dGluZy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBCb29tIGZyb20gJ2Jvb20nO1xuaW1wb3J0IHsgb25jZVBlclNlcnZlciB9IGZyb20gJy4vb25jZV9wZXJfc2VydmVyJztcblxuZnVuY3Rpb24gbGljZW5zZVByZVJvdXRpbmdGbihzZXJ2ZXIpIHtcbiAgY29uc3QgeHBhY2tNYWluUGx1Z2luID0gc2VydmVyLnBsdWdpbnMueHBhY2tfbWFpbjtcbiAgY29uc3QgcGx1Z2luSWQgPSAncmVwb3J0aW5nJztcblxuICAvLyBMaWNlbnNlIGNoZWNraW5nIGFuZCBlbmFibGUvZGlzYWJsZSBsb2dpY1xuICBmdW5jdGlvbiBsaWNlbnNlUHJlUm91dGluZyhyZXF1ZXN0LCByZXBseSkge1xuICAgIGNvbnN0IGxpY2Vuc2VDaGVja1Jlc3VsdHMgPSB4cGFja01haW5QbHVnaW4uaW5mby5mZWF0dXJlKHBsdWdpbklkKS5nZXRMaWNlbnNlQ2hlY2tSZXN1bHRzKCk7XG4gICAgaWYgKCFsaWNlbnNlQ2hlY2tSZXN1bHRzLnNob3dMaW5rcyB8fCAhbGljZW5zZUNoZWNrUmVzdWx0cy5lbmFibGVMaW5rcykge1xuICAgICAgcmVwbHkoQm9vbS5mb3JiaWRkZW4obGljZW5zZUNoZWNrUmVzdWx0cy5tZXNzYWdlKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJlcGx5KCk7XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiBsaWNlbnNlUHJlUm91dGluZztcbn1cblxuZXhwb3J0IGNvbnN0IGxpY2Vuc2VQcmVSb3V0aW5nRmFjdG9yeSA9IG9uY2VQZXJTZXJ2ZXIobGljZW5zZVByZVJvdXRpbmdGbik7XG5cbiJdfQ==",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/license_pre_routing.js"
      ],
      "names": [],
      "mappings": ";;;;;;;;oBAAiB,MAAM;;;;+BACO,mBAAmB;;AAEjD,SAAS,mBAAmB,CAAC,MAAM,EAAE;AACnC,MAAM,eAAe,GAAG,MAAM,CAAC,OAAO,CAAC,UAAU,CAAC;AAClD,MAAM,QAAQ,GAAG,WAAW,CAAC;;;AAG7B,WAAS,iBAAiB,CAAC,OAAO,EAAE,KAAK,EAAE;AACzC,QAAM,mBAAmB,GAAG,eAAe,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,sBAAsB,EAAE,CAAC;AAC5F,QAAI,CAAC,mBAAmB,CAAC,SAAS,IAAI,CAAC,mBAAmB,CAAC,WAAW,EAAE;AACtE,WAAK,CAAC,kBAAK,SAAS,CAAC,mBAAmB,CAAC,OAAO,CAAC,CAAC,CAAC;KACpD,MAAM;AACL,WAAK,EAAE,CAAC;KACT;GACF,CAAC;;AAEF,SAAO,iBAAiB,CAAC;CAC1B;;AAEM,IAAM,wBAAwB,GAAG,oCAAc,mBAAmB,CAAC,CAAC",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/license_pre_routing.js",
      "sourcesContent": [
        "import Boom from 'boom';\nimport { oncePerServer } from './once_per_server';\n\nfunction licensePreRoutingFn(server) {\n  const xpackMainPlugin = server.plugins.xpack_main;\n  const pluginId = 'reporting';\n\n  // License checking and enable/disable logic\n  function licensePreRouting(request, reply) {\n    const licenseCheckResults = xpackMainPlugin.info.feature(pluginId).getLicenseCheckResults();\n    if (!licenseCheckResults.showLinks || !licenseCheckResults.enableLinks) {\n      reply(Boom.forbidden(licenseCheckResults.message));\n    } else {\n      reply();\n    }\n  };\n\n  return licensePreRouting;\n}\n\nexport const licensePreRoutingFactory = oncePerServer(licensePreRoutingFn);\n\n"
      ]
    },
    "mtime": 1491771510540
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/user_pre_routing.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "./get_user",
            "imported": [
              "getUserFactory"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "getUserFactory",
                "local": "getUserFactory"
              }
            ]
          },
          {
            "source": "./once_per_server",
            "imported": [
              "oncePerServer"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "oncePerServer",
                "local": "oncePerServer"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "userPreRoutingFactory"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "userPreRoutingFactory",
              "exported": "userPreRoutingFactory"
            }
          ]
        }
      },
      "usedHelpers": []
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nvar _get_user = require('./get_user');\n\nvar _once_per_server = require('./once_per_server');\n\nfunction userPreRoutingFn(server) {\n  var getUser = (0, _get_user.getUserFactory)(server);\n\n  return function userPreRouting(request, reply) {\n    reply(getUser(request));\n  };\n}\n\nvar userPreRoutingFactory = (0, _once_per_server.oncePerServer)(userPreRoutingFn);\nexports.userPreRoutingFactory = userPreRoutingFactory;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvcmVwb3J0aW5nL3NlcnZlci9saWIvdXNlcl9wcmVfcm91dGluZy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7d0JBQStCLFlBQVk7OytCQUNiLG1CQUFtQjs7QUFFakQsU0FBUyxnQkFBZ0IsQ0FBQyxNQUFNLEVBQUU7QUFDaEMsTUFBTSxPQUFPLEdBQUcsOEJBQWUsTUFBTSxDQUFDLENBQUM7O0FBRXZDLFNBQU8sU0FBUyxjQUFjLENBQUMsT0FBTyxFQUFFLEtBQUssRUFBRTtBQUM3QyxTQUFLLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUM7R0FDekIsQ0FBQztDQUNIOztBQUVNLElBQU0scUJBQXFCLEdBQUcsb0NBQWMsZ0JBQWdCLENBQUMsQ0FBQyIsImZpbGUiOiIvdXNyL3NoYXJlL2tpYmFuYS9wbHVnaW5zL3gtcGFjay9wbHVnaW5zL3JlcG9ydGluZy9zZXJ2ZXIvbGliL3VzZXJfcHJlX3JvdXRpbmcuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBnZXRVc2VyRmFjdG9yeSB9IGZyb20gJy4vZ2V0X3VzZXInO1xuaW1wb3J0IHsgb25jZVBlclNlcnZlciB9IGZyb20gJy4vb25jZV9wZXJfc2VydmVyJztcblxuZnVuY3Rpb24gdXNlclByZVJvdXRpbmdGbihzZXJ2ZXIpIHtcbiAgY29uc3QgZ2V0VXNlciA9IGdldFVzZXJGYWN0b3J5KHNlcnZlcik7XG5cbiAgcmV0dXJuIGZ1bmN0aW9uIHVzZXJQcmVSb3V0aW5nKHJlcXVlc3QsIHJlcGx5KSB7XG4gICAgcmVwbHkoZ2V0VXNlcihyZXF1ZXN0KSk7XG4gIH07XG59XG5cbmV4cG9ydCBjb25zdCB1c2VyUHJlUm91dGluZ0ZhY3RvcnkgPSBvbmNlUGVyU2VydmVyKHVzZXJQcmVSb3V0aW5nRm4pO1xuXG4iXX0=",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/user_pre_routing.js"
      ],
      "names": [],
      "mappings": ";;;;;;wBAA+B,YAAY;;+BACb,mBAAmB;;AAEjD,SAAS,gBAAgB,CAAC,MAAM,EAAE;AAChC,MAAM,OAAO,GAAG,8BAAe,MAAM,CAAC,CAAC;;AAEvC,SAAO,SAAS,cAAc,CAAC,OAAO,EAAE,KAAK,EAAE;AAC7C,SAAK,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,CAAC;GACzB,CAAC;CACH;;AAEM,IAAM,qBAAqB,GAAG,oCAAc,gBAAgB,CAAC,CAAC",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/user_pre_routing.js",
      "sourcesContent": [
        "import { getUserFactory } from './get_user';\nimport { oncePerServer } from './once_per_server';\n\nfunction userPreRoutingFn(server) {\n  const getUser = getUserFactory(server);\n\n  return function userPreRouting(request, reply) {\n    reply(getUser(request));\n  };\n}\n\nexport const userPreRoutingFactory = oncePerServer(userPreRoutingFn);\n\n"
      ]
    },
    "mtime": 1491771510540
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/job_response_handler.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "boom",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "boom"
              }
            ]
          },
          {
            "source": "./once_per_server",
            "imported": [
              "oncePerServer"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "oncePerServer",
                "local": "oncePerServer"
              }
            ]
          },
          {
            "source": "./jobs_query",
            "imported": [
              "jobsQueryFactory"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "jobsQueryFactory",
                "local": "jobsQueryFactory"
              }
            ]
          },
          {
            "source": "./get_document_payload",
            "imported": [
              "getDocumentPayloadFactory"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "getDocumentPayloadFactory",
                "local": "getDocumentPayloadFactory"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "jobResponseHandlerFactory"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "jobResponseHandlerFactory",
              "exported": "jobResponseHandlerFactory"
            }
          ]
        }
      },
      "usedHelpers": [
        "interop-require-default"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _boom = require('boom');\n\nvar _boom2 = _interopRequireDefault(_boom);\n\nvar _once_per_server = require('./once_per_server');\n\nvar _jobs_query = require('./jobs_query');\n\nvar _get_document_payload = require('./get_document_payload');\n\nfunction jobResponseHandlerFn(server) {\n  var jobsQuery = (0, _jobs_query.jobsQueryFactory)(server);\n  var getDocumentPayload = (0, _get_document_payload.getDocumentPayloadFactory)(server);\n\n  return function jobResponseHandler(request, reply, params) {\n    var opts = arguments.length <= 3 || arguments[3] === undefined ? {} : arguments[3];\n    var docId = params.docId;\n    var jobType = params.jobType;\n\n    jobsQuery.get(request, docId, { includeContent: !opts.excludeContent }).then(function (doc) {\n      if (!doc) return reply(_boom2['default'].notFound());\n\n      return getDocumentPayload(doc, jobType, { sync: opts.sync }).then(function (output) {\n        var response = reply(output.content);\n        response.type(output.contentType);\n      })['catch'](function (err) {\n        // 503 here means that the document is still pending and we are not faking\n        // a synchronous response inside getDocumentPayload\n        if (err.statusCode === 503) {\n          // Boom 3.x hijacks the reply object\n          // since we need to add headers to the response, we can't use it here\n          // Boom 4.2.0+ is required to work completely, and without the header\n          var response = reply(err.content);\n          response.type(err.contentType);\n          response.code(err.statusCode);\n\n          // The Retry-After header is added to tell the client to check back later\n          // to see if the document is ready. We use it to indicate that the client\n          // should poll for a completed (or failed) state after a delay\n          // see https://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.37\n          response.header('Retry-After', 30);\n          return;\n        }\n\n        if (err.statusCode === 500) {\n          return reply(_boom2['default'].badImplementation(err.content)).type(err.contentType);\n        }\n\n        reply(_boom2['default'].badImplementation());\n      });\n    });\n  };\n}\n\nvar jobResponseHandlerFactory = (0, _once_per_server.oncePerServer)(jobResponseHandlerFn);\nexports.jobResponseHandlerFactory = jobResponseHandlerFactory;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvcmVwb3J0aW5nL3NlcnZlci9saWIvam9iX3Jlc3BvbnNlX2hhbmRsZXIuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7b0JBQWlCLE1BQU07Ozs7K0JBQ08sbUJBQW1COzswQkFDaEIsY0FBYzs7b0NBQ0wsd0JBQXdCOztBQUVsRSxTQUFTLG9CQUFvQixDQUFDLE1BQU0sRUFBRTtBQUNwQyxNQUFNLFNBQVMsR0FBRyxrQ0FBaUIsTUFBTSxDQUFDLENBQUM7QUFDM0MsTUFBTSxrQkFBa0IsR0FBRyxxREFBMEIsTUFBTSxDQUFDLENBQUM7O0FBRTdELFNBQU8sU0FBUyxrQkFBa0IsQ0FBQyxPQUFPLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBYTtRQUFYLElBQUkseURBQUcsRUFBRTtRQUMxRCxLQUFLLEdBQWMsTUFBTSxDQUF6QixLQUFLO1FBQUUsT0FBTyxHQUFLLE1BQU0sQ0FBbEIsT0FBTzs7QUFDdEIsYUFBUyxDQUFDLEdBQUcsQ0FBQyxPQUFPLEVBQUUsS0FBSyxFQUFFLEVBQUUsY0FBYyxFQUFFLENBQUMsSUFBSSxDQUFDLGNBQWMsRUFBRSxDQUFDLENBQ3RFLElBQUksQ0FBQyxVQUFDLEdBQUcsRUFBSztBQUNiLFVBQUksQ0FBQyxHQUFHLEVBQUUsT0FBTyxLQUFLLENBQUMsa0JBQUssUUFBUSxFQUFFLENBQUMsQ0FBQzs7QUFFeEMsYUFBTyxrQkFBa0IsQ0FBQyxHQUFHLEVBQUUsT0FBTyxFQUFFLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUMzRCxJQUFJLENBQUMsVUFBQyxNQUFNLEVBQUs7QUFDaEIsWUFBTSxRQUFRLEdBQUcsS0FBSyxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQztBQUN2QyxnQkFBUSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsV0FBVyxDQUFDLENBQUM7T0FDbkMsQ0FBQyxTQUNJLENBQUMsVUFBQyxHQUFHLEVBQUs7OztBQUdkLFlBQUksR0FBRyxDQUFDLFVBQVUsS0FBSyxHQUFHLEVBQUU7Ozs7QUFJMUIsY0FBTSxRQUFRLEdBQUcsS0FBSyxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsQ0FBQztBQUNwQyxrQkFBUSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsV0FBVyxDQUFDLENBQUM7QUFDL0Isa0JBQVEsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLFVBQVUsQ0FBQyxDQUFDOzs7Ozs7QUFNOUIsa0JBQVEsQ0FBQyxNQUFNLENBQUMsYUFBYSxFQUFFLEVBQUUsQ0FBQyxDQUFDO0FBQ25DLGlCQUFPO1NBQ1I7O0FBRUQsWUFBSSxHQUFHLENBQUMsVUFBVSxLQUFLLEdBQUcsRUFBRTtBQUMxQixpQkFBTyxLQUFLLENBQUMsa0JBQUssaUJBQWlCLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQ2hELElBQUksQ0FBQyxHQUFHLENBQUMsV0FBVyxDQUFDLENBQUM7U0FDeEI7O0FBRUQsYUFBSyxDQUFDLGtCQUFLLGlCQUFpQixFQUFFLENBQUMsQ0FBQztPQUNqQyxDQUFDLENBQUM7S0FDSixDQUFDLENBQUM7R0FDSixDQUFDO0NBQ0g7O0FBRU0sSUFBTSx5QkFBeUIsR0FBRyxvQ0FBYyxvQkFBb0IsQ0FBQyxDQUFDIiwiZmlsZSI6Ii91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvcmVwb3J0aW5nL3NlcnZlci9saWIvam9iX3Jlc3BvbnNlX2hhbmRsZXIuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgYm9vbSBmcm9tICdib29tJztcbmltcG9ydCB7IG9uY2VQZXJTZXJ2ZXIgfSBmcm9tICcuL29uY2VfcGVyX3NlcnZlcic7XG5pbXBvcnQgeyBqb2JzUXVlcnlGYWN0b3J5IH0gZnJvbSAnLi9qb2JzX3F1ZXJ5JztcbmltcG9ydCB7IGdldERvY3VtZW50UGF5bG9hZEZhY3RvcnkgfSBmcm9tICcuL2dldF9kb2N1bWVudF9wYXlsb2FkJztcblxuZnVuY3Rpb24gam9iUmVzcG9uc2VIYW5kbGVyRm4oc2VydmVyKSB7XG4gIGNvbnN0IGpvYnNRdWVyeSA9IGpvYnNRdWVyeUZhY3Rvcnkoc2VydmVyKTtcbiAgY29uc3QgZ2V0RG9jdW1lbnRQYXlsb2FkID0gZ2V0RG9jdW1lbnRQYXlsb2FkRmFjdG9yeShzZXJ2ZXIpO1xuXG4gIHJldHVybiBmdW5jdGlvbiBqb2JSZXNwb25zZUhhbmRsZXIocmVxdWVzdCwgcmVwbHksIHBhcmFtcywgb3B0cyA9IHt9KSB7XG4gICAgY29uc3QgeyBkb2NJZCwgam9iVHlwZSB9ID0gcGFyYW1zO1xuICAgIGpvYnNRdWVyeS5nZXQocmVxdWVzdCwgZG9jSWQsIHsgaW5jbHVkZUNvbnRlbnQ6ICFvcHRzLmV4Y2x1ZGVDb250ZW50IH0pXG4gICAgLnRoZW4oKGRvYykgPT4ge1xuICAgICAgaWYgKCFkb2MpIHJldHVybiByZXBseShib29tLm5vdEZvdW5kKCkpO1xuXG4gICAgICByZXR1cm4gZ2V0RG9jdW1lbnRQYXlsb2FkKGRvYywgam9iVHlwZSwgeyBzeW5jOiBvcHRzLnN5bmMgfSlcbiAgICAgIC50aGVuKChvdXRwdXQpID0+IHtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSByZXBseShvdXRwdXQuY29udGVudCk7XG4gICAgICAgIHJlc3BvbnNlLnR5cGUob3V0cHV0LmNvbnRlbnRUeXBlKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAvLyA1MDMgaGVyZSBtZWFucyB0aGF0IHRoZSBkb2N1bWVudCBpcyBzdGlsbCBwZW5kaW5nIGFuZCB3ZSBhcmUgbm90IGZha2luZ1xuICAgICAgICAvLyBhIHN5bmNocm9ub3VzIHJlc3BvbnNlIGluc2lkZSBnZXREb2N1bWVudFBheWxvYWRcbiAgICAgICAgaWYgKGVyci5zdGF0dXNDb2RlID09PSA1MDMpIHtcbiAgICAgICAgICAvLyBCb29tIDMueCBoaWphY2tzIHRoZSByZXBseSBvYmplY3RcbiAgICAgICAgICAvLyBzaW5jZSB3ZSBuZWVkIHRvIGFkZCBoZWFkZXJzIHRvIHRoZSByZXNwb25zZSwgd2UgY2FuJ3QgdXNlIGl0IGhlcmVcbiAgICAgICAgICAvLyBCb29tIDQuMi4wKyBpcyByZXF1aXJlZCB0byB3b3JrIGNvbXBsZXRlbHksIGFuZCB3aXRob3V0IHRoZSBoZWFkZXJcbiAgICAgICAgICBjb25zdCByZXNwb25zZSA9IHJlcGx5KGVyci5jb250ZW50KTtcbiAgICAgICAgICByZXNwb25zZS50eXBlKGVyci5jb250ZW50VHlwZSk7XG4gICAgICAgICAgcmVzcG9uc2UuY29kZShlcnIuc3RhdHVzQ29kZSk7XG5cbiAgICAgICAgICAvLyBUaGUgUmV0cnktQWZ0ZXIgaGVhZGVyIGlzIGFkZGVkIHRvIHRlbGwgdGhlIGNsaWVudCB0byBjaGVjayBiYWNrIGxhdGVyXG4gICAgICAgICAgLy8gdG8gc2VlIGlmIHRoZSBkb2N1bWVudCBpcyByZWFkeS4gV2UgdXNlIGl0IHRvIGluZGljYXRlIHRoYXQgdGhlIGNsaWVudFxuICAgICAgICAgIC8vIHNob3VsZCBwb2xsIGZvciBhIGNvbXBsZXRlZCAob3IgZmFpbGVkKSBzdGF0ZSBhZnRlciBhIGRlbGF5XG4gICAgICAgICAgLy8gc2VlIGh0dHBzOi8vd3d3LnczLm9yZy9Qcm90b2NvbHMvcmZjMjYxNi9yZmMyNjE2LXNlYzE0Lmh0bWwjc2VjMTQuMzdcbiAgICAgICAgICByZXNwb25zZS5oZWFkZXIoJ1JldHJ5LUFmdGVyJywgMzApO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChlcnIuc3RhdHVzQ29kZSA9PT0gNTAwKSB7XG4gICAgICAgICAgcmV0dXJuIHJlcGx5KGJvb20uYmFkSW1wbGVtZW50YXRpb24oZXJyLmNvbnRlbnQpKVxuICAgICAgICAgIC50eXBlKGVyci5jb250ZW50VHlwZSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXBseShib29tLmJhZEltcGxlbWVudGF0aW9uKCkpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH07XG59XG5cbmV4cG9ydCBjb25zdCBqb2JSZXNwb25zZUhhbmRsZXJGYWN0b3J5ID0gb25jZVBlclNlcnZlcihqb2JSZXNwb25zZUhhbmRsZXJGbik7XG4iXX0=",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/job_response_handler.js"
      ],
      "names": [],
      "mappings": ";;;;;;;;oBAAiB,MAAM;;;;+BACO,mBAAmB;;0BAChB,cAAc;;oCACL,wBAAwB;;AAElE,SAAS,oBAAoB,CAAC,MAAM,EAAE;AACpC,MAAM,SAAS,GAAG,kCAAiB,MAAM,CAAC,CAAC;AAC3C,MAAM,kBAAkB,GAAG,qDAA0B,MAAM,CAAC,CAAC;;AAE7D,SAAO,SAAS,kBAAkB,CAAC,OAAO,EAAE,KAAK,EAAE,MAAM,EAAa;QAAX,IAAI,yDAAG,EAAE;QAC1D,KAAK,GAAc,MAAM,CAAzB,KAAK;QAAE,OAAO,GAAK,MAAM,CAAlB,OAAO;;AACtB,aAAS,CAAC,GAAG,CAAC,OAAO,EAAE,KAAK,EAAE,EAAE,cAAc,EAAE,CAAC,IAAI,CAAC,cAAc,EAAE,CAAC,CACtE,IAAI,CAAC,UAAC,GAAG,EAAK;AACb,UAAI,CAAC,GAAG,EAAE,OAAO,KAAK,CAAC,kBAAK,QAAQ,EAAE,CAAC,CAAC;;AAExC,aAAO,kBAAkB,CAAC,GAAG,EAAE,OAAO,EAAE,EAAE,IAAI,EAAE,IAAI,CAAC,IAAI,EAAE,CAAC,CAC3D,IAAI,CAAC,UAAC,MAAM,EAAK;AAChB,YAAM,QAAQ,GAAG,KAAK,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;AACvC,gBAAQ,CAAC,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC,CAAC;OACnC,CAAC,SACI,CAAC,UAAC,GAAG,EAAK;;;AAGd,YAAI,GAAG,CAAC,UAAU,KAAK,GAAG,EAAE;;;;AAI1B,cAAM,QAAQ,GAAG,KAAK,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;AACpC,kBAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;AAC/B,kBAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC;;;;;;AAM9B,kBAAQ,CAAC,MAAM,CAAC,aAAa,EAAE,EAAE,CAAC,CAAC;AACnC,iBAAO;SACR;;AAED,YAAI,GAAG,CAAC,UAAU,KAAK,GAAG,EAAE;AAC1B,iBAAO,KAAK,CAAC,kBAAK,iBAAiB,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC,CAChD,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;SACxB;;AAED,aAAK,CAAC,kBAAK,iBAAiB,EAAE,CAAC,CAAC;OACjC,CAAC,CAAC;KACJ,CAAC,CAAC;GACJ,CAAC;CACH;;AAEM,IAAM,yBAAyB,GAAG,oCAAc,oBAAoB,CAAC,CAAC",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/job_response_handler.js",
      "sourcesContent": [
        "import boom from 'boom';\nimport { oncePerServer } from './once_per_server';\nimport { jobsQueryFactory } from './jobs_query';\nimport { getDocumentPayloadFactory } from './get_document_payload';\n\nfunction jobResponseHandlerFn(server) {\n  const jobsQuery = jobsQueryFactory(server);\n  const getDocumentPayload = getDocumentPayloadFactory(server);\n\n  return function jobResponseHandler(request, reply, params, opts = {}) {\n    const { docId, jobType } = params;\n    jobsQuery.get(request, docId, { includeContent: !opts.excludeContent })\n    .then((doc) => {\n      if (!doc) return reply(boom.notFound());\n\n      return getDocumentPayload(doc, jobType, { sync: opts.sync })\n      .then((output) => {\n        const response = reply(output.content);\n        response.type(output.contentType);\n      })\n      .catch((err) => {\n        // 503 here means that the document is still pending and we are not faking\n        // a synchronous response inside getDocumentPayload\n        if (err.statusCode === 503) {\n          // Boom 3.x hijacks the reply object\n          // since we need to add headers to the response, we can't use it here\n          // Boom 4.2.0+ is required to work completely, and without the header\n          const response = reply(err.content);\n          response.type(err.contentType);\n          response.code(err.statusCode);\n\n          // The Retry-After header is added to tell the client to check back later\n          // to see if the document is ready. We use it to indicate that the client\n          // should poll for a completed (or failed) state after a delay\n          // see https://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.37\n          response.header('Retry-After', 30);\n          return;\n        }\n\n        if (err.statusCode === 500) {\n          return reply(boom.badImplementation(err.content))\n          .type(err.contentType);\n        }\n\n        reply(boom.badImplementation());\n      });\n    });\n  };\n}\n\nexport const jobResponseHandlerFactory = oncePerServer(jobResponseHandlerFn);\n"
      ]
    },
    "mtime": 1491771510540
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/jobs_query.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "lodash",
            "imported": [
              "get",
              "set"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "get",
                "local": "get"
              },
              {
                "kind": "named",
                "imported": "set",
                "local": "set"
              }
            ]
          },
          {
            "source": "boom",
            "imported": [
              "badRequest"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "badRequest",
                "local": "badRequest"
              }
            ]
          },
          {
            "source": "./constants",
            "imported": [
              "constants"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "constants",
                "local": "constants"
              }
            ]
          },
          {
            "source": "./once_per_server",
            "imported": [
              "oncePerServer"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "oncePerServer",
                "local": "oncePerServer"
              }
            ]
          },
          {
            "source": "./get_user",
            "imported": [
              "getUserFactory"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "getUserFactory",
                "local": "getUserFactory"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "jobsQueryFactory"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "jobsQueryFactory",
              "exported": "jobsQueryFactory"
            }
          ]
        }
      },
      "usedHelpers": []
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nvar _lodash = require('lodash');\n\nvar _boom = require('boom');\n\nvar _constants = require('./constants');\n\nvar _once_per_server = require('./once_per_server');\n\nvar _get_user = require('./get_user');\n\nvar defaultSize = 10;\n\nfunction jobsQueryFn(server) {\n  var getUser = (0, _get_user.getUserFactory)(server);\n\n  var _server$plugins$elasticsearch$getCluster = server.plugins.elasticsearch.getCluster('admin');\n\n  var callWithRequest = _server$plugins$elasticsearch$getCluster.callWithRequest;\n  var esErrors = _server$plugins$elasticsearch$getCluster.errors;\n\n  function execQuery(type, body, request) {\n    var defaultBody = {\n      search: {\n        _source: {\n          excludes: ['output.content']\n        },\n        sort: [{ created_at: { order: 'desc' } }],\n        size: defaultSize\n      }\n    };\n\n    var query = {\n      index: _constants.constants.QUEUE_INDEX + '-*',\n      type: _constants.constants.QUEUE_DOCTYPE,\n      body: Object.assign(defaultBody[type] || {}, body)\n    };\n\n    return callWithRequest(request, type, query)['catch'](function (err) {\n      if (err instanceof esErrors['401']) return;\n      if (err instanceof esErrors['403']) return;\n      if (err instanceof esErrors['404']) return;\n      throw err;\n    });\n  }\n\n  function getHits(query) {\n    return query.then(function (res) {\n      return (0, _lodash.get)(res, 'hits.hits', []);\n    });\n  }\n\n  return {\n    list: function list(request) {\n      var page = arguments.length <= 1 || arguments[1] === undefined ? 0 : arguments[1];\n      var size = arguments.length <= 2 || arguments[2] === undefined ? defaultSize : arguments[2];\n\n      var showAll = (0, _lodash.get)(request, 'query.all', false);\n\n      return getUser(request).then(function (user) {\n        var body = {\n          size: size,\n          from: size * page\n        };\n\n        if (!showAll && !user) {\n          throw (0, _boom.badRequest)('Failed to get the current user\\'s reports because there is no user associated with this request');\n        }\n\n        if (!showAll) {\n          var username = (0, _lodash.get)(user, 'username');\n\n          (0, _lodash.set)(body, 'query', {\n            constant_score: {\n              filter: {\n                bool: {\n                  must: [{ term: { created_by: username } }]\n                }\n              }\n            }\n          });\n        }\n\n        return getHits(execQuery('search', body, request));\n      });\n    },\n\n    listCompletedSince: function listCompletedSince(request, size, sinceInMs) {\n      if (size === undefined) size = defaultSize;\n\n      return getUser(request).then(function (user) {\n        var filters = [{ range: { completed_at: { gt: sinceInMs, format: 'epoch_millis' } } }];\n        if (user) {\n          var username = (0, _lodash.get)(user, 'username');\n          filters.push({ term: { created_by: username } });\n        }\n\n        var body = {\n          size: size,\n          sort: { completed_at: 'asc' },\n          query: {\n            constant_score: {\n              filter: {\n                bool: {\n                  must: filters\n                }\n              }\n            }\n          }\n        };\n\n        return getHits(execQuery('search', body, request));\n      });\n    },\n\n    count: function count(request) {\n      var showAll = (0, _lodash.get)(request, 'query.all', false);\n\n      return getUser(request).then(function (user) {\n        var body = {};\n\n        if (!showAll) {\n          var username = (0, _lodash.get)(user, 'username');\n          body.query = {\n            constant_score: {\n              filter: {\n                bool: {\n                  must: [{ term: { created_by: username } }]\n                }\n              }\n            }\n          };\n        };\n\n        return execQuery('count', body, request).then(function (doc) {\n          if (!doc) return 0;\n          return doc.count;\n        });\n      });\n    },\n\n    get: function get(request, id) {\n      var opts = arguments.length <= 2 || arguments[2] === undefined ? {} : arguments[2];\n\n      if (!id) return Promise.resolve();\n\n      return getUser(request).then(function () {\n        if (!id) return;\n\n        var body = {\n          query: {\n            constant_score: {\n              filter: {\n                bool: {\n                  filter: [{ term: { _id: id } }]\n                }\n              }\n            }\n          },\n          size: 1\n        };\n\n        if (opts.includeContent) {\n          body._source = {\n            excludes: []\n          };\n        }\n\n        return getHits(execQuery('search', body, request)).then(function (hits) {\n          if (hits.length !== 1) return;\n          return hits[0];\n        });\n      });\n    }\n  };\n}\n\nvar jobsQueryFactory = (0, _once_per_server.oncePerServer)(jobsQueryFn);\nexports.jobsQueryFactory = jobsQueryFactory;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvcmVwb3J0aW5nL3NlcnZlci9saWIvam9ic19xdWVyeS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7c0JBQXlCLFFBQVE7O29CQUNOLE1BQU07O3lCQUNQLGFBQWE7OytCQUNULG1CQUFtQjs7d0JBQ2xCLFlBQVk7O0FBRTNDLElBQU0sV0FBVyxHQUFHLEVBQUUsQ0FBQzs7QUFFdkIsU0FBUyxXQUFXLENBQUMsTUFBTSxFQUFFO0FBQzNCLE1BQU0sT0FBTyxHQUFHLDhCQUFlLE1BQU0sQ0FBQyxDQUFDOztpREFDTSxNQUFNLENBQUMsT0FBTyxDQUFDLGFBQWEsQ0FBQyxVQUFVLENBQUMsT0FBTyxDQUFDOztNQUFyRixlQUFlLDRDQUFmLGVBQWU7TUFBUyxRQUFRLDRDQUFmLE1BQU07O0FBRS9CLFdBQVMsU0FBUyxDQUFDLElBQUksRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFO0FBQ3RDLFFBQU0sV0FBVyxHQUFHO0FBQ2xCLFlBQU0sRUFBRTtBQUNOLGVBQU8sRUFBRztBQUNSLGtCQUFRLEVBQUUsQ0FBRSxnQkFBZ0IsQ0FBRTtTQUMvQjtBQUNELFlBQUksRUFBRSxDQUNKLEVBQUUsVUFBVSxFQUFFLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRSxFQUFDLENBQ2pDO0FBQ0QsWUFBSSxFQUFFLFdBQVc7T0FDbEI7S0FDRixDQUFDOztBQUVGLFFBQU0sS0FBSyxHQUFHO0FBQ1osV0FBSyxFQUFLLHFCQUFVLFdBQVcsT0FBSTtBQUNuQyxVQUFJLEVBQUUscUJBQVUsYUFBYTtBQUM3QixVQUFJLEVBQUUsTUFBTSxDQUFDLE1BQU0sQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxFQUFFLElBQUksQ0FBQztLQUNuRCxDQUFDOztBQUVGLFdBQU8sZUFBZSxDQUFDLE9BQU8sRUFBRSxJQUFJLEVBQUUsS0FBSyxDQUFDLFNBQ3RDLENBQUMsVUFBQyxHQUFHLEVBQUs7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QUFFLENBQ04sRUFBRSxJQUFJLEVBQUUsRUFBRSxHQUFHLEVBQUUsRUFBRSxFQUFFLEVBQUUsQ0FDdEI7aUJBQ0Y7ZUFDRjthQUNGO1dBQ0Y7QUFDRCxjQUFJLEVBQUUsQ0FBQztTQUNSLENBQUM7O0FBRUYsWUFBSSxJQUFJLENBQUMsY0FBYyxFQUFFO0FBQ3ZCLGNBQUksQ0FBQyxPQUFPLEdBQUc7QUFDYixvQkFBUSxFQUFFLEVBQUU7V0FDYixDQUFDO1NBQ0g7O0FBRUQsZUFBTyxPQUFPLENBQUMsU0FBUyxDQUFDLFFBQVEsRUFBRSxJQUFJLEVBQUUsT0FBTyxDQUFDLENBQUMsQ0FDakQsSUFBSSxDQUFDLFVBQUMsSUFBSSxFQUFLO0FBQ2QsY0FBSSxJQUFJLENBQUMsTUFBTSxLQUFLLENBQUMsRUFBRSxPQUFPO0FBQzlCLGlCQUFPLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztTQUNoQixDQUFDLENBQUM7T0FDSixDQUFDLENBQUM7S0FDSjtHQUNGLENBQUM7Q0FDSDs7QUFFTSxJQUFNLGdCQUFnQixHQUFHLG9DQUFjLFdBQVcsQ0FBQyxDQUFDIiwiZmlsZSI6Ii91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvcmVwb3J0aW5nL3NlcnZlci9saWIvam9ic19xdWVyeS5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGdldCwgc2V0IH0gZnJvbSAnbG9kYXNoJztcbmltcG9ydCB7IGJhZFJlcXVlc3QgfSBmcm9tICdib29tJztcbmltcG9ydCB7IGNvbnN0YW50cyB9IGZyb20gJy4vY29uc3RhbnRzJztcbmltcG9ydCB7IG9uY2VQZXJTZXJ2ZXIgfSBmcm9tICcuL29uY2VfcGVyX3NlcnZlcic7XG5pbXBvcnQgeyBnZXRVc2VyRmFjdG9yeSB9IGZyb20gJy4vZ2V0X3VzZXInO1xuXG5jb25zdCBkZWZhdWx0U2l6ZSA9IDEwO1xuXG5mdW5jdGlvbiBqb2JzUXVlcnlGbihzZXJ2ZXIpIHtcbiAgY29uc3QgZ2V0VXNlciA9IGdldFVzZXJGYWN0b3J5KHNlcnZlcik7XG4gIGNvbnN0IHsgY2FsbFdpdGhSZXF1ZXN0LCBlcnJvcnM6ZXNFcnJvcnMgfSA9IHNlcnZlci5wbHVnaW5zLmVsYXN0aWNzZWFyY2guZ2V0Q2x1c3RlcignYWRtaW4nKTtcblxuICBmdW5jdGlvbiBleGVjUXVlcnkodHlwZSwgYm9keSwgcmVxdWVzdCkge1xuICAgIGNvbnN0IGRlZmF1bHRCb2R5ID0ge1xuICAgICAgc2VhcmNoOiB7XG4gICAgICAgIF9zb3VyY2UgOiB7XG4gICAgICAgICAgZXhjbHVkZXM6IFsgJ291dHB1dC5jb250ZW50JyBdXG4gICAgICAgIH0sXG4gICAgICAgIHNvcnQ6IFtcbiAgICAgICAgICB7IGNyZWF0ZWRfYXQ6IHsgb3JkZXI6ICdkZXNjJyB9fVxuICAgICAgICBdLFxuICAgICAgICBzaXplOiBkZWZhdWx0U2l6ZSxcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgY29uc3QgcXVlcnkgPSB7XG4gICAgICBpbmRleDogYCR7Y29uc3RhbnRzLlFVRVVFX0lOREVYfS0qYCxcbiAgICAgIHR5cGU6IGNvbnN0YW50cy5RVUVVRV9ET0NUWVBFLFxuICAgICAgYm9keTogT2JqZWN0LmFzc2lnbihkZWZhdWx0Qm9keVt0eXBlXSB8fCB7fSwgYm9keSlcbiAgICB9O1xuXG4gICAgcmV0dXJuIGNhbGxXaXRoUmVxdWVzdChyZXF1ZXN0LCB0eXBlLCBxdWVyeSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgaWYgKGVyciBpbnN0YW5jZW9mIGVzRXJyb3JzWyc0MDEnXSkgcmV0dXJuO1xuICAgICAgaWYgKGVyciBpbnN0YW5jZW9mIGVzRXJyb3JzWyc0MDMnXSkgcmV0dXJuO1xuICAgICAgaWYgKGVyciBpbnN0YW5jZW9mIGVzRXJyb3JzWyc0MDQnXSkgcmV0dXJuO1xuICAgICAgdGhyb3cgZXJyO1xuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gZ2V0SGl0cyhxdWVyeSkge1xuICAgIHJldHVybiBxdWVyeS50aGVuKChyZXMpID0+IGdldChyZXMsICdoaXRzLmhpdHMnLCBbXSkpO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBsaXN0KHJlcXVlc3QsIHBhZ2UgPSAwLCBzaXplID0gZGVmYXVsdFNpemUpIHtcbiAgICAgIGNvbnN0IHNob3dBbGwgPSBnZXQocmVxdWVzdCwgJ3F1ZXJ5LmFsbCcsIGZhbHNlKTtcblxuICAgICAgcmV0dXJuIGdldFVzZXIocmVxdWVzdClcbiAgICAgIC50aGVuKCh1c2VyKSA9PiB7XG4gICAgICAgIGNvbnN0IGJvZHkgPSB7XG4gICAgICAgICAgc2l6ZSxcbiAgICAgICAgICBmcm9tOiBzaXplICogcGFnZSxcbiAgICAgICAgfTtcblxuICAgICAgICBpZiAoIXNob3dBbGwgJiYgIXVzZXIpIHtcbiAgICAgICAgICB0aHJvdyBiYWRSZXF1ZXN0KFxuICAgICAgICAgICAgYEZhaWxlZCB0byBnZXQgdGhlIGN1cnJlbnQgdXNlcidzIHJlcG9ydHMgYmVjYXVzZSB0aGVyZSBpcyBubyB1c2VyIGFzc29jaWF0ZWQgd2l0aCB0aGlzIHJlcXVlc3RgXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghc2hvd0FsbCkge1xuICAgICAgICAgIGNvbnN0IHVzZXJuYW1lID0gZ2V0KHVzZXIsICd1c2VybmFtZScpO1xuXG4gICAgICAgICAgc2V0KGJvZHksICdxdWVyeScsIHtcbiAgICAgICAgICAgIGNvbnN0YW50X3Njb3JlOiB7XG4gICAgICAgICAgICAgIGZpbHRlcjoge1xuICAgICAgICAgICAgICAgIGJvb2w6IHtcbiAgICAgICAgICAgICAgICAgIG11c3Q6IFtcbiAgICAgICAgICAgICAgICAgICAgeyB0ZXJtOiB7IGNyZWF0ZWRfYnk6IHVzZXJuYW1lIH0gfSxcbiAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBnZXRIaXRzKGV4ZWNRdWVyeSgnc2VhcmNoJywgYm9keSwgcmVxdWVzdCkpO1xuICAgICAgfSk7XG4gICAgfSxcblxuICAgIGxpc3RDb21wbGV0ZWRTaW5jZShyZXF1ZXN0LCBzaXplID0gZGVmYXVsdFNpemUsIHNpbmNlSW5Ncykge1xuICAgICAgcmV0dXJuIGdldFVzZXIocmVxdWVzdClcbiAgICAgIC50aGVuKCh1c2VyKSA9PiB7XG4gICAgICAgIGNvbnN0IGZpbHRlcnMgPSBbXG4gICAgICAgICAgeyByYW5nZTogeyBjb21wbGV0ZWRfYXQ6IHsgZ3Q6IHNpbmNlSW5NcywgZm9ybWF0OiAnZXBvY2hfbWlsbGlzJyB9IH0gfVxuICAgICAgICBdO1xuICAgICAgICBpZiAodXNlcikge1xuICAgICAgICAgIGNvbnN0IHVzZXJuYW1lID0gZ2V0KHVzZXIsICd1c2VybmFtZScpO1xuICAgICAgICAgIGZpbHRlcnMucHVzaCh7IHRlcm06IHsgY3JlYXRlZF9ieTogdXNlcm5hbWUgfSB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGJvZHkgPSB7XG4gICAgICAgICAgc2l6ZSxcbiAgICAgICAgICBzb3J0OiB7IGNvbXBsZXRlZF9hdDogJ2FzYycgfSxcbiAgICAgICAgICBxdWVyeToge1xuICAgICAgICAgICAgY29uc3RhbnRfc2NvcmU6IHtcbiAgICAgICAgICAgICAgZmlsdGVyOiB7XG4gICAgICAgICAgICAgICAgYm9vbDoge1xuICAgICAgICAgICAgICAgICAgbXVzdDogZmlsdGVyc1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIGdldEhpdHMoZXhlY1F1ZXJ5KCdzZWFyY2gnLCBib2R5LCByZXF1ZXN0KSk7XG4gICAgICB9KTtcbiAgICB9LFxuXG4gICAgY291bnQocmVxdWVzdCkge1xuICAgICAgY29uc3Qgc2hvd0FsbCA9IGdldChyZXF1ZXN0LCAncXVlcnkuYWxsJywgZmFsc2UpO1xuXG4gICAgICByZXR1cm4gZ2V0VXNlcihyZXF1ZXN0KVxuICAgICAgLnRoZW4oKHVzZXIpID0+IHtcbiAgICAgICAgY29uc3QgYm9keSA9IHt9O1xuXG4gICAgICAgIGlmICghc2hvd0FsbCkge1xuICAgICAgICAgIGNvbnN0IHVzZXJuYW1lID0gZ2V0KHVzZXIsICd1c2VybmFtZScpO1xuICAgICAgICAgIGJvZHkucXVlcnkgPSB7XG4gICAgICAgICAgICBjb25zdGFudF9zY29yZToge1xuICAgICAgICAgICAgICBmaWx0ZXI6IHtcbiAgICAgICAgICAgICAgICBib29sOiB7XG4gICAgICAgICAgICAgICAgICBtdXN0OiBbXG4gICAgICAgICAgICAgICAgICAgIHsgdGVybTogeyBjcmVhdGVkX2J5OiB1c2VybmFtZSB9IH0sXG4gICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfTtcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gZXhlY1F1ZXJ5KCdjb3VudCcsIGJvZHksIHJlcXVlc3QpXG4gICAgICAgIC50aGVuKChkb2MpID0+IHtcbiAgICAgICAgICBpZiAoIWRvYykgcmV0dXJuIDA7XG4gICAgICAgICAgcmV0dXJuIGRvYy5jb3VudDtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9LFxuXG4gICAgZ2V0KHJlcXVlc3QsIGlkLCBvcHRzID0ge30pIHtcbiAgICAgIGlmICghaWQpIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcblxuICAgICAgcmV0dXJuIGdldFVzZXIocmVxdWVzdClcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgaWYgKCFpZCkgcmV0dXJuO1xuXG4gICAgICAgIGNvbnN0IGJvZHkgPSB7XG4gICAgICAgICAgcXVlcnk6IHtcbiAgICAgICAgICAgIGNvbnN0YW50X3Njb3JlOiB7XG4gICAgICAgICAgICAgIGZpbHRlcjoge1xuICAgICAgICAgICAgICAgIGJvb2w6IHtcbiAgICAgICAgICAgICAgICAgIGZpbHRlcjogW1xuICAgICAgICAgICAgICAgICAgICB7IHRlcm06IHsgX2lkOiBpZCB9IH0sXG4gICAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAgc2l6ZTogMSxcbiAgICAgICAgfTtcblxuICAgICAgICBpZiAob3B0cy5pbmNsdWRlQ29udGVudCkge1xuICAgICAgICAgIGJvZHkuX3NvdXJjZSA9IHtcbiAgICAgICAgICAgIGV4Y2x1ZGVzOiBbXVxuICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZ2V0SGl0cyhleGVjUXVlcnkoJ3NlYXJjaCcsIGJvZHksIHJlcXVlc3QpKVxuICAgICAgICAudGhlbigoaGl0cykgPT4ge1xuICAgICAgICAgIGlmIChoaXRzLmxlbmd0aCAhPT0gMSkgcmV0dXJuO1xuICAgICAgICAgIHJldHVybiBoaXRzWzBdO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcbn1cblxuZXhwb3J0IGNvbnN0IGpvYnNRdWVyeUZhY3RvcnkgPSBvbmNlUGVyU2VydmVyKGpvYnNRdWVyeUZuKTtcbiJdfQ==",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/jobs_query.js"
      ],
      "names": [],
      "mappings": "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",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/jobs_query.js",
      "sourcesContent": [
        "import { get, set } from 'lodash';\nimport { badRequest } from 'boom';\nimport { constants } from './constants';\nimport { oncePerServer } from './once_per_server';\nimport { getUserFactory } from './get_user';\n\nconst defaultSize = 10;\n\nfunction jobsQueryFn(server) {\n  const getUser = getUserFactory(server);\n  const { callWithRequest, errors:esErrors } = server.plugins.elasticsearch.getCluster('admin');\n\n  function execQuery(type, body, request) {\n    const defaultBody = {\n      search: {\n        _source : {\n          excludes: [ 'output.content' ]\n        },\n        sort: [\n          { created_at: { order: 'desc' }}\n        ],\n        size: defaultSize,\n      }\n    };\n\n    const query = {\n      index: `${constants.QUEUE_INDEX}-*`,\n      type: constants.QUEUE_DOCTYPE,\n      body: Object.assign(defaultBody[type] || {}, body)\n    };\n\n    return callWithRequest(request, type, query)\n    .catch((err) => {\n      if (err instanceof esErrors['401']) return;\n      if (err instanceof esErrors['403']) return;\n      if (err instanceof esErrors['404']) return;\n      throw err;\n    });\n  }\n\n  function getHits(query) {\n    return query.then((res) => get(res, 'hits.hits', []));\n  }\n\n  return {\n    list(request, page = 0, size = defaultSize) {\n      const showAll = get(request, 'query.all', false);\n\n      return getUser(request)\n      .then((user) => {\n        const body = {\n          size,\n          from: size * page,\n        };\n\n        if (!showAll && !user) {\n          throw badRequest(\n            `Failed to get the current user's reports because there is no user associated with this request`\n          );\n        }\n\n        if (!showAll) {\n          const username = get(user, 'username');\n\n          set(body, 'query', {\n            constant_score: {\n              filter: {\n                bool: {\n                  must: [\n                    { term: { created_by: username } },\n                  ]\n                }\n              }\n            }\n          });\n        }\n\n        return getHits(execQuery('search', body, request));\n      });\n    },\n\n    listCompletedSince(request, size = defaultSize, sinceInMs) {\n      return getUser(request)\n      .then((user) => {\n        const filters = [\n          { range: { completed_at: { gt: sinceInMs, format: 'epoch_millis' } } }\n        ];\n        if (user) {\n          const username = get(user, 'username');\n          filters.push({ term: { created_by: username } });\n        }\n\n        const body = {\n          size,\n          sort: { completed_at: 'asc' },\n          query: {\n            constant_score: {\n              filter: {\n                bool: {\n                  must: filters\n                }\n              }\n            }\n          },\n        };\n\n        return getHits(execQuery('search', body, request));\n      });\n    },\n\n    count(request) {\n      const showAll = get(request, 'query.all', false);\n\n      return getUser(request)\n      .then((user) => {\n        const body = {};\n\n        if (!showAll) {\n          const username = get(user, 'username');\n          body.query = {\n            constant_score: {\n              filter: {\n                bool: {\n                  must: [\n                    { term: { created_by: username } },\n                  ]\n                }\n              }\n            }\n          };\n        };\n\n        return execQuery('count', body, request)\n        .then((doc) => {\n          if (!doc) return 0;\n          return doc.count;\n        });\n      });\n    },\n\n    get(request, id, opts = {}) {\n      if (!id) return Promise.resolve();\n\n      return getUser(request)\n      .then(() => {\n        if (!id) return;\n\n        const body = {\n          query: {\n            constant_score: {\n              filter: {\n                bool: {\n                  filter: [\n                    { term: { _id: id } },\n                  ],\n                }\n              }\n            }\n          },\n          size: 1,\n        };\n\n        if (opts.includeContent) {\n          body._source = {\n            excludes: []\n          };\n        }\n\n        return getHits(execQuery('search', body, request))\n        .then((hits) => {\n          if (hits.length !== 1) return;\n          return hits[0];\n        });\n      });\n    }\n  };\n}\n\nexport const jobsQueryFactory = oncePerServer(jobsQueryFn);\n"
      ]
    },
    "mtime": 1491771510540
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/get_document_payload.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "esqueue/lib/constants/events",
            "imported": [
              "EVENT_WORKER_COMPLETE",
              "EVENT_WORKER_JOB_FAIL"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "EVENT_WORKER_COMPLETE",
                "local": "EVENT_WORKER_COMPLETE"
              },
              {
                "kind": "named",
                "imported": "EVENT_WORKER_JOB_FAIL",
                "local": "EVENT_WORKER_JOB_FAIL"
              }
            ]
          },
          {
            "source": "./once_per_server",
            "imported": [
              "oncePerServer"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "oncePerServer",
                "local": "oncePerServer"
              }
            ]
          },
          {
            "source": "./workers",
            "imported": [
              "workersFactory"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "workersFactory",
                "local": "workersFactory"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "getDocumentPayloadFactory"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "getDocumentPayloadFactory",
              "exported": "getDocumentPayloadFactory"
            }
          ]
        }
      },
      "usedHelpers": []
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nvar _esqueueLibConstantsEvents = require('esqueue/lib/constants/events');\n\nvar _once_per_server = require('./once_per_server');\n\nvar _workers = require('./workers');\n\nfunction getDocumentPayloadFn(server) {\n  var jobQueue = server.plugins.reporting.queue;\n  var workers = (0, _workers.workersFactory)(server);\n  var deprecationLog = function deprecationLog(message) {\n    return server.log(['reporting', 'deprecation', 'warning'], message);\n  };\n\n  function encodeContent(content, jobType) {\n    if (!jobType) {\n      return content;\n    }\n\n    var worker = workers[jobType];\n    switch (worker.encoding) {\n      case 'base64':\n        return new Buffer(content, 'base64');\n      default:\n        return content;\n    }\n  }\n\n  function getPayloadOutput(output, jobType) {\n    var statusCode = 200;\n    var content = encodeContent(output.content, jobType);\n    var contentType = output.content_type;\n    return { content: content, statusCode: statusCode, contentType: contentType };\n  }\n\n  function getFailureOutput(output) {\n    var statusCode = 500;\n    var content = {\n      message: 'Report generation failed',\n      reason: output.content\n    };\n    var contentType = 'text/json';\n    return { content: content, statusCode: statusCode, contentType: contentType };\n  }\n\n  function sendIncomplete(status) {\n    var statusCode = 503;\n    var content = status;\n    var contentType = 'text/json';\n    return { content: content, statusCode: statusCode, contentType: contentType };\n  }\n\n  function getDocumentPayload(doc, jobType) {\n    var opts = arguments.length <= 2 || arguments[2] === undefined ? {} : arguments[2];\n    var _doc$_source = doc._source;\n    var status = _doc$_source.status;\n    var output = _doc$_source.output;\n\n    return new Promise(function (resolve, reject) {\n      if (status === 'completed') {\n        return resolve(getPayloadOutput(output, jobType));\n      }\n\n      if (status === 'failed') {\n        return reject(getFailureOutput(output));\n      }\n\n      if (!opts.sync) {\n        // not faking sync, send a 503 indicating that the report isn't completed yet\n        return reject(sendIncomplete(status));\n      }\n\n      // force a synchronous style response, wait for report completion\n      return getDocumentPayloadSync(doc, jobType).then(resolve, reject);\n    });\n  }\n\n  function getDocumentPayloadSync(doc, jobType) {\n    deprecationLog('Use of the \\'sync\\' parameter will be removed in the next major version');\n\n    return new Promise(function (resolve, reject) {\n      // faking sync, wait for the job to be completed\n      function completeHandler(completed) {\n        // if the completed job matches this job\n        if (completed.job.id === doc._id) {\n          // remove event listener\n          cleanupListeners();\n          resolve(getPayloadOutput(completed.output, jobType));\n        }\n      };\n\n      function errorHandler(failed) {\n        if (failed.job.id === doc._id) {\n          // remove event listener\n          cleanupListeners();\n          reject(getFailureOutput(failed.output));\n        }\n      };\n\n      function cleanupListeners() {\n        jobQueue.removeListener(_esqueueLibConstantsEvents.EVENT_WORKER_COMPLETE, completeHandler);\n        jobQueue.removeListener(_esqueueLibConstantsEvents.EVENT_WORKER_JOB_FAIL, errorHandler);\n      }\n\n      jobQueue.on(_esqueueLibConstantsEvents.EVENT_WORKER_COMPLETE, completeHandler);\n      jobQueue.on(_esqueueLibConstantsEvents.EVENT_WORKER_JOB_FAIL, errorHandler);\n    });\n  }\n\n  return getDocumentPayload;\n}\n\nvar getDocumentPayloadFactory = (0, _once_per_server.oncePerServer)(getDocumentPayloadFn);\nexports.getDocumentPayloadFactory = getDocumentPayloadFactory;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvcmVwb3J0aW5nL3NlcnZlci9saWIvZ2V0X2RvY3VtZW50X3BheWxvYWQuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7O3lDQUE2RCw4QkFBOEI7OytCQUM3RCxtQkFBbUI7O3VCQUNsQixXQUFXOztBQUUxQyxTQUFTLG9CQUFvQixDQUFDLE1BQU0sRUFBRTtBQUNwQyxNQUFNLFFBQVEsR0FBRyxNQUFNLENBQUMsT0FBTyxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUM7QUFDaEQsTUFBTSxPQUFPLEdBQUcsNkJBQWUsTUFBTSxDQUFDLENBQUM7QUFDdkMsTUFBTSxjQUFjLEdBQUcsU0FBakIsY0FBYyxDQUFHLE9BQU87V0FBSSxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsV0FBVyxFQUFFLGFBQWEsRUFBRSxTQUFTLENBQUMsRUFBRSxPQUFPLENBQUM7R0FBQSxDQUFDOztBQUUvRixXQUFTLGFBQWEsQ0FBQyxPQUFPLEVBQUUsT0FBTyxFQUFFO0FBQ3ZDLFFBQUksQ0FBQyxPQUFPLEVBQUU7QUFDWixhQUFPLE9BQU8sQ0FBQztLQUNoQjs7QUFFRCxRQUFNLE1BQU0sR0FBRyxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUM7QUFDaEMsWUFBUSxNQUFNLENBQUMsUUFBUTtBQUNyQixXQUFLLFFBQVE7QUFDWCxlQUFPLElBQUksTUFBTSxDQUFDLE9BQU8sRUFBRSxRQUFRLENBQUMsQ0FBQztBQUFBLEFBQ3ZDO0FBQ0UsZUFBTyxPQUFPLENBQUM7QUFBQSxLQUNsQjtHQUNGOztBQUVELFdBQVMsZ0JBQWdCLENBQUMsTUFBTSxFQUFFLE9BQU8sRUFBRTtBQUN6QyxRQUFNLFVBQVUsR0FBRyxHQUFHLENBQUM7QUFDdkIsUUFBTSxPQUFPLEdBQUcsYUFBYSxDQUFDLE1BQU0sQ0FBQyxPQUFPLEVBQUUsT0FBTyxDQUFDLENBQUM7QUFDdkQsUUFBTSxXQUFXLEdBQUcsTUFBTSxDQUFDLFlB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QUFlLENBQUMsQ0FBQztBQUNwRCxjQUFRLENBQUMsRUFBRSxtREFBd0IsWUFBWSxDQUFDLENBQUM7S0FDbEQsQ0FBQyxDQUFDO0dBQ0o7O0FBRUQsU0FBTyxrQkFBa0IsQ0FBQztDQUMzQjs7QUFFTSxJQUFNLHlCQUF5QixHQUFHLG9DQUFjLG9CQUFvQixDQUFDLENBQUMiLCJmaWxlIjoiL3Vzci9zaGFyZS9raWJhbmEvcGx1Z2lucy94LXBhY2svcGx1Z2lucy9yZXBvcnRpbmcvc2VydmVyL2xpYi9nZXRfZG9jdW1lbnRfcGF5bG9hZC5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEVWRU5UX1dPUktFUl9DT01QTEVURSwgRVZFTlRfV09SS0VSX0pPQl9GQUlMIH0gZnJvbSAnZXNxdWV1ZS9saWIvY29uc3RhbnRzL2V2ZW50cyc7XG5pbXBvcnQgeyBvbmNlUGVyU2VydmVyIH0gZnJvbSAnLi9vbmNlX3Blcl9zZXJ2ZXInO1xuaW1wb3J0IHsgd29ya2Vyc0ZhY3RvcnkgfSBmcm9tICcuL3dvcmtlcnMnO1xuXG5mdW5jdGlvbiBnZXREb2N1bWVudFBheWxvYWRGbihzZXJ2ZXIpIHtcbiAgY29uc3Qgam9iUXVldWUgPSBzZXJ2ZXIucGx1Z2lucy5yZXBvcnRpbmcucXVldWU7XG4gIGNvbnN0IHdvcmtlcnMgPSB3b3JrZXJzRmFjdG9yeShzZXJ2ZXIpO1xuICBjb25zdCBkZXByZWNhdGlvbkxvZyA9IG1lc3NhZ2UgPT4gc2VydmVyLmxvZyhbJ3JlcG9ydGluZycsICdkZXByZWNhdGlvbicsICd3YXJuaW5nJ10sIG1lc3NhZ2UpO1xuXG4gIGZ1bmN0aW9uIGVuY29kZUNvbnRlbnQoY29udGVudCwgam9iVHlwZSkge1xuICAgIGlmICgham9iVHlwZSkge1xuICAgICAgcmV0dXJuIGNvbnRlbnQ7XG4gICAgfVxuXG4gICAgY29uc3Qgd29ya2VyID0gd29ya2Vyc1tqb2JUeXBlXTtcbiAgICBzd2l0Y2ggKHdvcmtlci5lbmNvZGluZykge1xuICAgICAgY2FzZSAnYmFzZTY0JzpcbiAgICAgICAgcmV0dXJuIG5ldyBCdWZmZXIoY29udGVudCwgJ2Jhc2U2NCcpO1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgcmV0dXJuIGNvbnRlbnQ7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gZ2V0UGF5bG9hZE91dHB1dChvdXRwdXQsIGpvYlR5cGUpIHtcbiAgICBjb25zdCBzdGF0dXNDb2RlID0gMjAwO1xuICAgIGNvbnN0IGNvbnRlbnQgPSBlbmNvZGVDb250ZW50KG91dHB1dC5jb250ZW50LCBqb2JUeXBlKTtcbiAgICBjb25zdCBjb250ZW50VHlwZSA9IG91dHB1dC5jb250ZW50X3R5cGU7XG4gICAgcmV0dXJuIHsgY29udGVudCwgc3RhdHVzQ29kZSwgY29udGVudFR5cGUgfTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldEZhaWx1cmVPdXRwdXQob3V0cHV0KSB7XG4gICAgY29uc3Qgc3RhdHVzQ29kZSA9IDUwMDtcbiAgICBjb25zdCBjb250ZW50ID0ge1xuICAgICAgbWVzc2FnZTogJ1JlcG9ydCBnZW5lcmF0aW9uIGZhaWxlZCcsXG4gICAgICByZWFzb246IG91dHB1dC5jb250ZW50LFxuICAgIH07XG4gICAgY29uc3QgY29udGVudFR5cGUgPSAndGV4dC9qc29uJztcbiAgICByZXR1cm4geyBjb250ZW50LCBzdGF0dXNDb2RlLCBjb250ZW50VHlwZSB9O1xuICB9XG5cbiAgZnVuY3Rpb24gc2VuZEluY29tcGxldGUoc3RhdHVzKSB7XG4gICAgY29uc3Qgc3RhdHVzQ29kZSA9IDUwMztcbiAgICBjb25zdCBjb250ZW50ID0gc3RhdHVzO1xuICAgIGNvbnN0IGNvbnRlbnRUeXBlID0gJ3RleHQvanNvbic7XG4gICAgcmV0dXJuIHsgY29udGVudCwgc3RhdHVzQ29kZSwgY29udGVudFR5cGUgfTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldERvY3VtZW50UGF5bG9hZChkb2MsIGpvYlR5cGUsIG9wdHMgPSB7fSkge1xuICAgIGNvbnN0IHsgc3RhdHVzLCBvdXRwdXQgfSA9IGRvYy5fc291cmNlO1xuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIGlmIChzdGF0dXMgPT09ICdjb21wbGV0ZWQnKSB7XG4gICAgICAgIHJldHVybiByZXNvbHZlKGdldFBheWxvYWRPdXRwdXQob3V0cHV0LCBqb2JUeXBlKSk7XG4gICAgICB9XG5cbiAgICAgIGlmIChzdGF0dXMgPT09ICdmYWlsZWQnKSB7XG4gICAgICAgIHJldHVybiByZWplY3QoZ2V0RmFpbHVyZU91dHB1dChvdXRwdXQpKTtcbiAgICAgIH1cblxuICAgICAgaWYgKCFvcHRzLnN5bmMpIHtcbiAgICAgICAgLy8gbm90IGZha2luZyBzeW5jLCBzZW5kIGEgNTAzIGluZGljYXRpbmcgdGhhdCB0aGUgcmVwb3J0IGlzbid0IGNvbXBsZXRlZCB5ZXRcbiAgICAgICAgcmV0dXJuIHJlamVjdChzZW5kSW5jb21wbGV0ZShzdGF0dXMpKTtcbiAgICAgIH1cblxuICAgICAgLy8gZm9yY2UgYSBzeW5jaHJvbm91cyBzdHlsZSByZXNwb25zZSwgd2FpdCBmb3IgcmVwb3J0IGNvbXBsZXRpb25cbiAgICAgIHJldHVybiBnZXREb2N1bWVudFBheWxvYWRTeW5jKGRvYywgam9iVHlwZSkudGhlbihyZXNvbHZlLCByZWplY3QpO1xuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gZ2V0RG9jdW1lbnRQYXlsb2FkU3luYyhkb2MsIGpvYlR5cGUpIHtcbiAgICBkZXByZWNhdGlvbkxvZyhgVXNlIG9mIHRoZSAnc3luYycgcGFyYW1ldGVyIHdpbGwgYmUgcmVtb3ZlZCBpbiB0aGUgbmV4dCBtYWpvciB2ZXJzaW9uYCk7XG5cbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgLy8gZmFraW5nIHN5bmMsIHdhaXQgZm9yIHRoZSBqb2IgdG8gYmUgY29tcGxldGVkXG4gICAgICBmdW5jdGlvbiBjb21wbGV0ZUhhbmRsZXIoY29tcGxldGVkKSB7XG4gICAgICAgIC8vIGlmIHRoZSBjb21wbGV0ZWQgam9iIG1hdGNoZXMgdGhpcyBqb2JcbiAgICAgICAgaWYgKGNvbXBsZXRlZC5qb2IuaWQgPT09IGRvYy5faWQpIHtcbiAgICAgICAgICAvLyByZW1vdmUgZXZlbnQgbGlzdGVuZXJcbiAgICAgICAgICBjbGVhbnVwTGlzdGVuZXJzKCk7XG4gICAgICAgICAgcmVzb2x2ZShnZXRQYXlsb2FkT3V0cHV0KGNvbXBsZXRlZC5vdXRwdXQsIGpvYlR5cGUpKTtcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgZnVuY3Rpb24gZXJyb3JIYW5kbGVyKGZhaWxlZCkge1xuICAgICAgICBpZiAoZmFpbGVkLmpvYi5pZCA9PT0gZG9jLl9pZCkge1xuICAgICAgICAgIC8vIHJlbW92ZSBldmVudCBsaXN0ZW5lclxuICAgICAgICAgIGNsZWFudXBMaXN0ZW5lcnMoKTtcbiAgICAgICAgICByZWplY3QoZ2V0RmFpbHVyZU91dHB1dChmYWlsZWQub3V0cHV0KSk7XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIGZ1bmN0aW9uIGNsZWFudXBMaXN0ZW5lcnMoKSB7XG4gICAgICAgIGpvYlF1ZXVlLnJlbW92ZUxpc3RlbmVyKEVWRU5UX1dPUktFUl9DT01QTEVURSwgY29tcGxldGVIYW5kbGVyKTtcbiAgICAgICAgam9iUXVldWUucmVtb3ZlTGlzdGVuZXIoRVZFTlRfV09SS0VSX0pPQl9GQUlMLCBlcnJvckhhbmRsZXIpO1xuICAgICAgfVxuXG4gICAgICBqb2JRdWV1ZS5vbihFVkVOVF9XT1JLRVJfQ09NUExFVEUsIGNvbXBsZXRlSGFuZGxlcik7XG4gICAgICBqb2JRdWV1ZS5vbihFVkVOVF9XT1JLRVJfSk9CX0ZBSUwsIGVycm9ySGFuZGxlcik7XG4gICAgfSk7XG4gIH1cblxuICByZXR1cm4gZ2V0RG9jdW1lbnRQYXlsb2FkO1xufVxuXG5leHBvcnQgY29uc3QgZ2V0RG9jdW1lbnRQYXlsb2FkRmFjdG9yeSA9IG9uY2VQZXJTZXJ2ZXIoZ2V0RG9jdW1lbnRQYXlsb2FkRm4pO1xuIl19",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/get_document_payload.js"
      ],
      "names": [],
      "mappings": "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",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/get_document_payload.js",
      "sourcesContent": [
        "import { EVENT_WORKER_COMPLETE, EVENT_WORKER_JOB_FAIL } from 'esqueue/lib/constants/events';\nimport { oncePerServer } from './once_per_server';\nimport { workersFactory } from './workers';\n\nfunction getDocumentPayloadFn(server) {\n  const jobQueue = server.plugins.reporting.queue;\n  const workers = workersFactory(server);\n  const deprecationLog = message => server.log(['reporting', 'deprecation', 'warning'], message);\n\n  function encodeContent(content, jobType) {\n    if (!jobType) {\n      return content;\n    }\n\n    const worker = workers[jobType];\n    switch (worker.encoding) {\n      case 'base64':\n        return new Buffer(content, 'base64');\n      default:\n        return content;\n    }\n  }\n\n  function getPayloadOutput(output, jobType) {\n    const statusCode = 200;\n    const content = encodeContent(output.content, jobType);\n    const contentType = output.content_type;\n    return { content, statusCode, contentType };\n  }\n\n  function getFailureOutput(output) {\n    const statusCode = 500;\n    const content = {\n      message: 'Report generation failed',\n      reason: output.content,\n    };\n    const contentType = 'text/json';\n    return { content, statusCode, contentType };\n  }\n\n  function sendIncomplete(status) {\n    const statusCode = 503;\n    const content = status;\n    const contentType = 'text/json';\n    return { content, statusCode, contentType };\n  }\n\n  function getDocumentPayload(doc, jobType, opts = {}) {\n    const { status, output } = doc._source;\n\n    return new Promise((resolve, reject) => {\n      if (status === 'completed') {\n        return resolve(getPayloadOutput(output, jobType));\n      }\n\n      if (status === 'failed') {\n        return reject(getFailureOutput(output));\n      }\n\n      if (!opts.sync) {\n        // not faking sync, send a 503 indicating that the report isn't completed yet\n        return reject(sendIncomplete(status));\n      }\n\n      // force a synchronous style response, wait for report completion\n      return getDocumentPayloadSync(doc, jobType).then(resolve, reject);\n    });\n  }\n\n  function getDocumentPayloadSync(doc, jobType) {\n    deprecationLog(`Use of the 'sync' parameter will be removed in the next major version`);\n\n    return new Promise((resolve, reject) => {\n      // faking sync, wait for the job to be completed\n      function completeHandler(completed) {\n        // if the completed job matches this job\n        if (completed.job.id === doc._id) {\n          // remove event listener\n          cleanupListeners();\n          resolve(getPayloadOutput(completed.output, jobType));\n        }\n      };\n\n      function errorHandler(failed) {\n        if (failed.job.id === doc._id) {\n          // remove event listener\n          cleanupListeners();\n          reject(getFailureOutput(failed.output));\n        }\n      };\n\n      function cleanupListeners() {\n        jobQueue.removeListener(EVENT_WORKER_COMPLETE, completeHandler);\n        jobQueue.removeListener(EVENT_WORKER_JOB_FAIL, errorHandler);\n      }\n\n      jobQueue.on(EVENT_WORKER_COMPLETE, completeHandler);\n      jobQueue.on(EVENT_WORKER_JOB_FAIL, errorHandler);\n    });\n  }\n\n  return getDocumentPayload;\n}\n\nexport const getDocumentPayloadFactory = oncePerServer(getDocumentPayloadFn);\n"
      ]
    },
    "mtime": 1491771510540
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/workers.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "./constants",
            "imported": [
              "constants"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "constants",
                "local": "constants"
              }
            ]
          },
          {
            "source": "./once_per_server",
            "imported": [
              "oncePerServer"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "oncePerServer",
                "local": "oncePerServer"
              }
            ]
          },
          {
            "source": "./doc_job_process",
            "imported": [
              "docJobProcessFactory"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "docJobProcessFactory",
                "local": "docJobProcessFactory"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "workersFactory"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "workersFactory",
              "exported": "workersFactory"
            }
          ]
        }
      },
      "usedHelpers": []
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nvar _constants = require('./constants');\n\nvar _once_per_server = require('./once_per_server');\n\nvar _doc_job_process = require('./doc_job_process');\n\nfunction workersFN(server) {\n  var docJobProcess = (0, _doc_job_process.docJobProcessFactory)(server);\n\n  var workers = {};\n\n  // printable PDFs\n  workers[_constants.constants.JOBTYPES.PRINTABLE_PDF] = function callee$1$0(payload) {\n    var workerType, _ref, contentType, buffer;\n\n    return regeneratorRuntime.async(function callee$1$0$(context$2$0) {\n      while (1) switch (context$2$0.prev = context$2$0.next) {\n        case 0:\n          workerType = _constants.constants.JOBTYPES.PRINTABLE_PDF;\n\n          server.log(['reporting', 'worker', 'debug'], 'Converting ' + payload.objects.length + ' saved object(s) to ' + workerType);\n          context$2$0.next = 4;\n          return regeneratorRuntime.awrap(docJobProcess(payload));\n\n        case 4:\n          _ref = context$2$0.sent;\n          contentType = _ref.contentType;\n          buffer = _ref.buffer;\n          return context$2$0.abrupt('return', {\n            content_type: contentType,\n            content: buffer.toString('base64')\n          });\n\n        case 8:\n        case 'end':\n          return context$2$0.stop();\n      }\n    }, null, this);\n  };\n  workers[_constants.constants.JOBTYPES.PRINTABLE_PDF].encoding = 'base64';\n  workers[_constants.constants.JOBTYPES.PRINTABLE_PDF].contentType = docJobProcess.contentType;\n\n  return workers;\n};\n\nvar workersFactory = (0, _once_per_server.oncePerServer)(workersFN);\nexports.workersFactory = workersFactory;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvcmVwb3J0aW5nL3NlcnZlci9saWIvd29ya2Vycy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7eUJBQTBCLGFBQWE7OytCQUNULG1CQUFtQjs7K0JBQ1osbUJBQW1COztBQUV4RCxTQUFTLFNBQVMsQ0FBQyxNQUFNLEVBQUU7QUFDekIsTUFBTSxhQUFhLEdBQUcsMkNBQXFCLE1BQU0sQ0FBQyxDQUFDOztBQUVuRCxNQUFNLE9BQU8sR0FBRyxFQUFFLENBQUM7OztBQUduQixTQUFPLENBQUMscUJBQVUsUUFBUSxDQUFDLGFBQWEsQ0FBQyxHQUFHLG9CQUFnQixPQUFPO1FBQzNELFVBQVUsUUFHUixXQUFXLEVBQUUsTUFBTTs7Ozs7QUFIckIsb0JBQVUsR0FBRyxxQkFBVSxRQUFRLENBQUMsYUFBYTs7QUFFbkQsZ0JBQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxXQUFXLEVBQUUsUUFBUSxFQUFFLE9BQU8sQ0FBQyxrQkFBZ0IsT0FBTyxDQUFDLE9BQU8sQ0FBQyxNQUFNLDRCQUF1QixVQUFVLENBQUcsQ0FBQzs7MENBQ2hGLGFBQWEsQ0FBQyxPQUFPLENBQUM7Ozs7QUFBcEQscUJBQVcsUUFBWCxXQUFXO0FBQUUsZ0JBQU0sUUFBTixNQUFNOzhDQUVwQjtBQUNMLHdCQUFZLEVBQUUsV0FBVztBQUN6QixtQkFBTyxFQUFFLE1BQU0sQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDO1dBQ25DOzs7Ozs7O0dBQ0YsQ0FBQztBQUNGLFNBQU8sQ0FBQyxxQkFBVSxRQUFRLENBQUMsYUFBYSxDQUFDLENBQUMsUUFBUSxHQUFHLFFBQVEsQ0FBQztBQUM5RCxTQUFPLENBQUMscUJBQVUsUUFBUSxDQUFDLGFBQWEsQ0FBQyxDQUFDLFdBQVcsR0FBRyxhQUFhLENBQUMsV0FBVyxDQUFDOztBQUVsRixTQUFPLE9BQU8sQ0FBQztDQUNoQixDQUFDOztBQUVLLElBQU0sY0FBYyxHQUFHLG9DQUFjLFNBQVMsQ0FBQyxDQUFDIiwiZmlsZSI6Ii91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvcmVwb3J0aW5nL3NlcnZlci9saWIvd29ya2Vycy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNvbnN0YW50cyB9IGZyb20gJy4vY29uc3RhbnRzJztcbmltcG9ydCB7IG9uY2VQZXJTZXJ2ZXIgfSBmcm9tICcuL29uY2VfcGVyX3NlcnZlcic7XG5pbXBvcnQgeyBkb2NKb2JQcm9jZXNzRmFjdG9yeSB9IGZyb20gJy4vZG9jX2pvYl9wcm9jZXNzJztcblxuZnVuY3Rpb24gd29ya2Vyc0ZOKHNlcnZlcikge1xuICBjb25zdCBkb2NKb2JQcm9jZXNzID0gZG9jSm9iUHJvY2Vzc0ZhY3Rvcnkoc2VydmVyKTtcblxuICBjb25zdCB3b3JrZXJzID0ge307XG5cbiAgLy8gcHJpbnRhYmxlIFBERnNcbiAgd29ya2Vyc1tjb25zdGFudHMuSk9CVFlQRVMuUFJJTlRBQkxFX1BERl0gPSBhc3luYyBmdW5jdGlvbiAocGF5bG9hZCkge1xuICAgIGNvbnN0IHdvcmtlclR5cGUgPSBjb25zdGFudHMuSk9CVFlQRVMuUFJJTlRBQkxFX1BERjtcblxuICAgIHNlcnZlci5sb2coWydyZXBvcnRpbmcnLCAnd29ya2VyJywgJ2RlYnVnJ10sIGBDb252ZXJ0aW5nICR7cGF5bG9hZC5vYmplY3RzLmxlbmd0aH0gc2F2ZWQgb2JqZWN0KHMpIHRvICR7d29ya2VyVHlwZX1gKTtcbiAgICBjb25zdCB7IGNvbnRlbnRUeXBlLCBidWZmZXIgfSA9IGF3YWl0IGRvY0pvYlByb2Nlc3MocGF5bG9hZCk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgY29udGVudF90eXBlOiBjb250ZW50VHlwZSxcbiAgICAgIGNvbnRlbnQ6IGJ1ZmZlci50b1N0cmluZygnYmFzZTY0JylcbiAgICB9O1xuICB9O1xuICB3b3JrZXJzW2NvbnN0YW50cy5KT0JUWVBFUy5QUklOVEFCTEVfUERGXS5lbmNvZGluZyA9ICdiYXNlNjQnO1xuICB3b3JrZXJzW2NvbnN0YW50cy5KT0JUWVBFUy5QUklOVEFCTEVfUERGXS5jb250ZW50VHlwZSA9IGRvY0pvYlByb2Nlc3MuY29udGVudFR5cGU7XG5cbiAgcmV0dXJuIHdvcmtlcnM7XG59O1xuXG5leHBvcnQgY29uc3Qgd29ya2Vyc0ZhY3RvcnkgPSBvbmNlUGVyU2VydmVyKHdvcmtlcnNGTik7Il19",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/workers.js"
      ],
      "names": [],
      "mappings": ";;;;;;yBAA0B,aAAa;;+BACT,mBAAmB;;+BACZ,mBAAmB;;AAExD,SAAS,SAAS,CAAC,MAAM,EAAE;AACzB,MAAM,aAAa,GAAG,2CAAqB,MAAM,CAAC,CAAC;;AAEnD,MAAM,OAAO,GAAG,EAAE,CAAC;;;AAGnB,SAAO,CAAC,qBAAU,QAAQ,CAAC,aAAa,CAAC,GAAG,oBAAgB,OAAO;QAC3D,UAAU,QAGR,WAAW,EAAE,MAAM;;;;;AAHrB,oBAAU,GAAG,qBAAU,QAAQ,CAAC,aAAa;;AAEnD,gBAAM,CAAC,GAAG,CAAC,CAAC,WAAW,EAAE,QAAQ,EAAE,OAAO,CAAC,kBAAgB,OAAO,CAAC,OAAO,CAAC,MAAM,4BAAuB,UAAU,CAAG,CAAC;;0CAChF,aAAa,CAAC,OAAO,CAAC;;;;AAApD,qBAAW,QAAX,WAAW;AAAE,gBAAM,QAAN,MAAM;8CAEpB;AACL,wBAAY,EAAE,WAAW;AACzB,mBAAO,EAAE,MAAM,CAAC,QAAQ,CAAC,QAAQ,CAAC;WACnC;;;;;;;GACF,CAAC;AACF,SAAO,CAAC,qBAAU,QAAQ,CAAC,aAAa,CAAC,CAAC,QAAQ,GAAG,QAAQ,CAAC;AAC9D,SAAO,CAAC,qBAAU,QAAQ,CAAC,aAAa,CAAC,CAAC,WAAW,GAAG,aAAa,CAAC,WAAW,CAAC;;AAElF,SAAO,OAAO,CAAC;CAChB,CAAC;;AAEK,IAAM,cAAc,GAAG,oCAAc,SAAS,CAAC,CAAC",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/workers.js",
      "sourcesContent": [
        "import { constants } from './constants';\nimport { oncePerServer } from './once_per_server';\nimport { docJobProcessFactory } from './doc_job_process';\n\nfunction workersFN(server) {\n  const docJobProcess = docJobProcessFactory(server);\n\n  const workers = {};\n\n  // printable PDFs\n  workers[constants.JOBTYPES.PRINTABLE_PDF] = async function (payload) {\n    const workerType = constants.JOBTYPES.PRINTABLE_PDF;\n\n    server.log(['reporting', 'worker', 'debug'], `Converting ${payload.objects.length} saved object(s) to ${workerType}`);\n    const { contentType, buffer } = await docJobProcess(payload);\n\n    return {\n      content_type: contentType,\n      content: buffer.toString('base64')\n    };\n  };\n  workers[constants.JOBTYPES.PRINTABLE_PDF].encoding = 'base64';\n  workers[constants.JOBTYPES.PRINTABLE_PDF].contentType = docJobProcess.contentType;\n\n  return workers;\n};\n\nexport const workersFactory = oncePerServer(workersFN);"
      ]
    },
    "mtime": 1491771510540
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/doc_job_process.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "lodash",
            "imported": [
              "omit"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "omit",
                "local": "omit"
              }
            ]
          },
          {
            "source": "./once_per_server",
            "imported": [
              "oncePerServer"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "oncePerServer",
                "local": "oncePerServer"
              }
            ]
          },
          {
            "source": "./generate_document",
            "imported": [
              "generateDocumentFactory"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "generateDocumentFactory",
                "local": "generateDocumentFactory"
              }
            ]
          },
          {
            "source": "./crypto",
            "imported": [
              "cryptoFactory"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "cryptoFactory",
                "local": "cryptoFactory"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "docJobProcessFactory"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "docJobProcessFactory",
              "exported": "docJobProcessFactory"
            }
          ]
        }
      },
      "usedHelpers": []
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nvar _lodash = require('lodash');\n\nvar _once_per_server = require('./once_per_server');\n\nvar _generate_document = require('./generate_document');\n\nvar _crypto = require('./crypto');\n\nvar KBN_SCREENSHOT_HEADER_BLACKLIST = ['accept-encoding', 'content-length', 'content-type'];\n\nfunction docJobProcessFn(server) {\n  var _generateDocumentFactory = (0, _generate_document.generateDocumentFactory)(server);\n\n  var printablePdf = _generateDocumentFactory.printablePdf;\n\n  var crypto = (0, _crypto.cryptoFactory)(server);\n\n  return function docJobProcess(job) {\n    var title, objects, query, serializedEncryptedHeaders, decryptedHeaders, headers, pdfDoc;\n    return regeneratorRuntime.async(function docJobProcess$(context$2$0) {\n      while (1) switch (context$2$0.prev = context$2$0.next) {\n        case 0:\n          title = job.title;\n          objects = job.objects;\n          query = job.query;\n          serializedEncryptedHeaders = job.headers;\n          decryptedHeaders = undefined;\n          context$2$0.prev = 5;\n          context$2$0.next = 8;\n          return regeneratorRuntime.awrap(crypto.decrypt(serializedEncryptedHeaders));\n\n        case 8:\n          decryptedHeaders = context$2$0.sent;\n          context$2$0.next = 14;\n          break;\n\n        case 11:\n          context$2$0.prev = 11;\n          context$2$0.t0 = context$2$0['catch'](5);\n          throw new Error('Failed to decrypt report job data. Please re-generate this report.');\n\n        case 14:\n          ;\n\n          headers = (0, _lodash.omit)(decryptedHeaders, KBN_SCREENSHOT_HEADER_BLACKLIST);\n          context$2$0.next = 18;\n          return regeneratorRuntime.awrap(printablePdf(title, objects, query, headers));\n\n        case 18:\n          pdfDoc = context$2$0.sent;\n          context$2$0.next = 21;\n          return regeneratorRuntime.awrap(pdfDoc.getBuffer());\n\n        case 21:\n          context$2$0.t1 = context$2$0.sent;\n          return context$2$0.abrupt('return', {\n            contentType: 'application/pdf',\n            buffer: context$2$0.t1\n          });\n\n        case 23:\n        case 'end':\n          return context$2$0.stop();\n      }\n    }, null, this, [[5, 11]]);\n  };\n}\n\nvar docJobProcessFactory = (0, _once_per_server.oncePerServer)(docJobProcessFn);\nexports.docJobProcessFactory = docJobProcessFactory;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvcmVwb3J0aW5nL3NlcnZlci9saWIvZG9jX2pvYl9wcm9jZXNzLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7OztzQkFBcUIsUUFBUTs7K0JBQ0MsbUJBQW1COztpQ0FDVCxxQkFBcUI7O3NCQUMvQixVQUFVOztBQUV4QyxJQUFNLCtCQUErQixHQUFHLENBQ3RDLGlCQUFpQixFQUNqQixnQkFBZ0IsRUFDaEIsY0FBYyxDQUNmLENBQUM7O0FBRUYsU0FBUyxlQUFlLENBQUMsTUFBTSxFQUFFO2lDQUNOLGdEQUF3QixNQUFNLENBQUM7O01BQWhELFlBQVksNEJBQVosWUFBWTs7QUFDcEIsTUFBTSxNQUFNLEdBQUcsMkJBQWMsTUFBTSxDQUFDLENBQUM7O0FBRXJDLFNBQU8sU0FBZSxhQUFhLENBQUMsR0FBRztRQUM3QixLQUFLLEVBQUUsT0FBTyxFQUFFLEtBQUssRUFBVSwwQkFBMEIsRUFDN0QsZ0JBQWdCLEVBUWQsT0FBTyxFQUNQLE1BQU07Ozs7QUFWSixlQUFLLEdBQXlELEdBQUcsQ0FBakUsS0FBSztBQUFFLGlCQUFPLEdBQWdELEdBQUcsQ0FBMUQsT0FBTztBQUFFLGVBQUssR0FBeUMsR0FBRyxDQUFqRCxLQUFLO0FBQVUsb0NBQTBCLEdBQUssR0FBRyxDQUExQyxPQUFPO0FBQ2xDLDBCQUFnQjs7OzBDQUdPLE1BQU0sQ0FBQyxPQUFPLENBQUMsMEJBQTBCLENBQUM7OztBQUFuRSwwQkFBZ0I7Ozs7Ozs7Z0JBRVYsSUFBSSxLQUFLLENBQUMsb0VBQW9FLENBQUM7OztBQUN0RixXQUFDOztBQUVJLGlCQUFPLEdBQUcsa0JBQUssZ0JBQWdCLEVBQUUsK0JBQStCLENBQUM7OzBDQUNsRCxZQUFZLENBQUMsS0FBSyxFQUFFLE9BQU8sRUFBRSxLQUFLLEVBQUUsT0FBTyxDQUFDOzs7QUFBM0QsZ0JBQU07OzBDQUdJLE1BQU0sQ0FBQyxTQUFTLEVBQUU7Ozs7O0FBRGhDLHVCQUFXLEVBQUUsaUJBQWlCO0FBQzlCLGtCQUFNOzs7Ozs7OztHQUVULENBQUM7Q0FDSDs7QUFFTSxJQUFNLG9CQUFvQixHQUFHLG9DQUFjLGVBQWUsQ0FBQyxDQUFDIiwiZmlsZSI6Ii91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvcmVwb3J0aW5nL3NlcnZlci9saWIvZG9jX2pvYl9wcm9jZXNzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgb21pdCB9IGZyb20gJ2xvZGFzaCc7XG5pbXBvcnQgeyBvbmNlUGVyU2VydmVyIH0gZnJvbSAnLi9vbmNlX3Blcl9zZXJ2ZXInO1xuaW1wb3J0IHsgZ2VuZXJhdGVEb2N1bWVudEZhY3RvcnkgfSBmcm9tICcuL2dlbmVyYXRlX2RvY3VtZW50JztcbmltcG9ydCB7IGNyeXB0b0ZhY3RvcnkgfSBmcm9tICcuL2NyeXB0byc7XG5cbmNvbnN0IEtCTl9TQ1JFRU5TSE9UX0hFQURFUl9CTEFDS0xJU1QgPSBbXG4gICdhY2NlcHQtZW5jb2RpbmcnLFxuICAnY29udGVudC1sZW5ndGgnLFxuICAnY29udGVudC10eXBlJ1xuXTtcblxuZnVuY3Rpb24gZG9jSm9iUHJvY2Vzc0ZuKHNlcnZlcikge1xuICBjb25zdCB7IHByaW50YWJsZVBkZiB9ID0gZ2VuZXJhdGVEb2N1bWVudEZhY3Rvcnkoc2VydmVyKTtcbiAgY29uc3QgY3J5cHRvID0gY3J5cHRvRmFjdG9yeShzZXJ2ZXIpO1xuXG4gIHJldHVybiBhc3luYyBmdW5jdGlvbiBkb2NKb2JQcm9jZXNzKGpvYikge1xuICAgIGNvbnN0IHsgdGl0bGUsIG9iamVjdHMsIHF1ZXJ5LCBoZWFkZXJzOnNlcmlhbGl6ZWRFbmNyeXB0ZWRIZWFkZXJzIH0gPSBqb2I7XG4gICAgbGV0IGRlY3J5cHRlZEhlYWRlcnM7XG5cbiAgICB0cnkge1xuICAgICAgZGVjcnlwdGVkSGVhZGVycyA9IGF3YWl0IGNyeXB0by5kZWNyeXB0KHNlcmlhbGl6ZWRFbmNyeXB0ZWRIZWFkZXJzKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byBkZWNyeXB0IHJlcG9ydCBqb2IgZGF0YS4gUGxlYXNlIHJlLWdlbmVyYXRlIHRoaXMgcmVwb3J0LicpO1xuICAgIH07XG5cbiAgICBjb25zdCBoZWFkZXJzID0gb21pdChkZWNyeXB0ZWRIZWFkZXJzLCBLQk5fU0NSRUVOU0hPVF9IRUFERVJfQkxBQ0tMSVNUKTtcbiAgICBjb25zdCBwZGZEb2MgPSBhd2FpdCBwcmludGFibGVQZGYodGl0bGUsIG9iamVjdHMsIHF1ZXJ5LCBoZWFkZXJzKTtcbiAgICByZXR1cm4ge1xuICAgICAgY29udGVudFR5cGU6ICdhcHBsaWNhdGlvbi9wZGYnLFxuICAgICAgYnVmZmVyOiBhd2FpdCBwZGZEb2MuZ2V0QnVmZmVyKCksXG4gICAgfTtcbiAgfTtcbn1cblxuZXhwb3J0IGNvbnN0IGRvY0pvYlByb2Nlc3NGYWN0b3J5ID0gb25jZVBlclNlcnZlcihkb2NKb2JQcm9jZXNzRm4pO1xuIl19",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/doc_job_process.js"
      ],
      "names": [],
      "mappings": ";;;;;;sBAAqB,QAAQ;;+BACC,mBAAmB;;iCACT,qBAAqB;;sBAC/B,UAAU;;AAExC,IAAM,+BAA+B,GAAG,CACtC,iBAAiB,EACjB,gBAAgB,EAChB,cAAc,CACf,CAAC;;AAEF,SAAS,eAAe,CAAC,MAAM,EAAE;iCACN,gDAAwB,MAAM,CAAC;;MAAhD,YAAY,4BAAZ,YAAY;;AACpB,MAAM,MAAM,GAAG,2BAAc,MAAM,CAAC,CAAC;;AAErC,SAAO,SAAe,aAAa,CAAC,GAAG;QAC7B,KAAK,EAAE,OAAO,EAAE,KAAK,EAAU,0BAA0B,EAC7D,gBAAgB,EAQd,OAAO,EACP,MAAM;;;;AAVJ,eAAK,GAAyD,GAAG,CAAjE,KAAK;AAAE,iBAAO,GAAgD,GAAG,CAA1D,OAAO;AAAE,eAAK,GAAyC,GAAG,CAAjD,KAAK;AAAU,oCAA0B,GAAK,GAAG,CAA1C,OAAO;AAClC,0BAAgB;;;0CAGO,MAAM,CAAC,OAAO,CAAC,0BAA0B,CAAC;;;AAAnE,0BAAgB;;;;;;;gBAEV,IAAI,KAAK,CAAC,oEAAoE,CAAC;;;AACtF,WAAC;;AAEI,iBAAO,GAAG,kBAAK,gBAAgB,EAAE,+BAA+B,CAAC;;0CAClD,YAAY,CAAC,KAAK,EAAE,OAAO,EAAE,KAAK,EAAE,OAAO,CAAC;;;AAA3D,gBAAM;;0CAGI,MAAM,CAAC,SAAS,EAAE;;;;;AADhC,uBAAW,EAAE,iBAAiB;AAC9B,kBAAM;;;;;;;;GAET,CAAC;CACH;;AAEM,IAAM,oBAAoB,GAAG,oCAAc,eAAe,CAAC,CAAC",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/doc_job_process.js",
      "sourcesContent": [
        "import { omit } from 'lodash';\nimport { oncePerServer } from './once_per_server';\nimport { generateDocumentFactory } from './generate_document';\nimport { cryptoFactory } from './crypto';\n\nconst KBN_SCREENSHOT_HEADER_BLACKLIST = [\n  'accept-encoding',\n  'content-length',\n  'content-type'\n];\n\nfunction docJobProcessFn(server) {\n  const { printablePdf } = generateDocumentFactory(server);\n  const crypto = cryptoFactory(server);\n\n  return async function docJobProcess(job) {\n    const { title, objects, query, headers:serializedEncryptedHeaders } = job;\n    let decryptedHeaders;\n\n    try {\n      decryptedHeaders = await crypto.decrypt(serializedEncryptedHeaders);\n    } catch (e) {\n      throw new Error('Failed to decrypt report job data. Please re-generate this report.');\n    };\n\n    const headers = omit(decryptedHeaders, KBN_SCREENSHOT_HEADER_BLACKLIST);\n    const pdfDoc = await printablePdf(title, objects, query, headers);\n    return {\n      contentType: 'application/pdf',\n      buffer: await pdfDoc.getBuffer(),\n    };\n  };\n}\n\nexport const docJobProcessFactory = oncePerServer(docJobProcessFn);\n"
      ]
    },
    "mtime": 1491771510540
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/generate_document.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "fs",
            "imported": [
              "unlink"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "unlink",
                "local": "unlink"
              }
            ]
          },
          {
            "source": "lodash",
            "imported": [
              "capitalize"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "capitalize",
                "local": "capitalize"
              }
            ]
          },
          {
            "source": "./get_time_filter_range",
            "imported": [
              "getTimeFilterRange"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "getTimeFilterRange",
                "local": "getTimeFilterRange"
              }
            ]
          },
          {
            "source": "./pdf",
            "imported": [
              "pdf"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "pdf",
                "local": "pdf"
              }
            ]
          },
          {
            "source": "./once_per_server",
            "imported": [
              "oncePerServer"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "oncePerServer",
                "local": "oncePerServer"
              }
            ]
          },
          {
            "source": "./get_screenshot",
            "imported": [
              "getScreenshotFactory"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "getScreenshotFactory",
                "local": "getScreenshotFactory"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "generateDocumentFactory"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "generateDocumentFactory",
              "exported": "generateDocumentFactory"
            }
          ]
        }
      },
      "usedHelpers": []
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nvar _fs = require('fs');\n\nvar _lodash = require('lodash');\n\nvar _get_time_filter_range = require('./get_time_filter_range');\n\nvar _pdf = require('./pdf');\n\nvar _once_per_server = require('./once_per_server');\n\nvar _get_screenshot = require('./get_screenshot');\n\nfunction generateDocumentFn(server) {\n  var getScreenshot = (0, _get_screenshot.getScreenshotFactory)(server);\n  var warningLog = function warningLog(msg) {\n    return server.log(['reporting', 'warning'], msg);\n  };\n\n  return {\n    printablePdf: printablePdf\n  };\n\n  function cleanImages(cleanupPaths) {\n    return Promise.all(cleanupPaths.map(function (imagePath) {\n      return new Promise(function (resolve, reject) {\n        return (0, _fs.unlink)(imagePath, function (err) {\n          if (err) {\n            return reject(err);\n          }\n          resolve();\n        });\n      });\n    }))['catch'](function (err) {\n      // any failures to remove images are silently swallowed\n      warningLog('Failed to remove screenshot image: ' + err.path);\n    });\n  }\n\n  function printablePdf(title, savedObjects, query, headers) {\n    var pdfOutput = _pdf.pdf.create();\n\n    if (title) {\n      var timeRange = (0, _get_time_filter_range.getTimeFilterRange)(savedObjects, query);\n      title += timeRange ? ' — ' + timeRange.from + ' to ' + timeRange.to : '';\n      pdfOutput.setTitle(title);\n    }\n\n    return Promise.all(savedObjects.map(function (savedObj) {\n      if (savedObj.isMissing) {\n        return { savedObj: savedObj };\n      } else {\n        return getScreenshot(savedObj.url, savedObj.type, headers).then(function (imagePath) {\n          server.log(['reporting', 'debug'], savedObj.id + ' -> ' + imagePath);\n          return { imagePath: imagePath, savedObj: savedObj };\n        });\n      }\n    })).then(function (objects) {\n      var cleanupPaths = [];\n\n      objects.forEach(function (object) {\n        var imagePath = object.imagePath;\n        var savedObj = object.savedObj;\n\n        if (imagePath) cleanupPaths.push(imagePath);\n\n        if (savedObj.isMissing) {\n          pdfOutput.addHeading((0, _lodash.capitalize)(savedObj.type) + ' with id \\'' + savedObj.id + '\\' not found', {\n            styles: 'warning'\n          });\n        } else {\n          pdfOutput.addImage(imagePath, {\n            title: savedObj.title,\n            description: savedObj.description\n          });\n        }\n      });\n\n      return cleanupPaths;\n    }).then(function (cleanupPaths) {\n      try {\n        var _ret = (function () {\n          var pdfInstance = pdfOutput.generate();\n          return {\n            v: cleanImages(cleanupPaths).then(function () {\n              return pdfInstance;\n            })\n          };\n        })();\n\n        if (typeof _ret === 'object') return _ret.v;\n      } catch (err) {\n        return cleanImages(cleanupPaths).then(function () {\n          throw err;\n        });\n      }\n    });\n  };\n}\n\nvar generateDocumentFactory = (0, _once_per_server.oncePerServer)(generateDocumentFn);\nexports.generateDocumentFactory = generateDocumentFactory;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvcmVwb3J0aW5nL3NlcnZlci9saWIvZ2VuZXJhdGVfZG9jdW1lbnQuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7O2tCQUF1QixJQUFJOztzQkFDQSxRQUFROztxQ0FDQSx5QkFBeUI7O21CQUN4QyxPQUFPOzsrQkFDRyxtQkFBbUI7OzhCQUNaLGtCQUFrQjs7QUFFdkQsU0FBUyxrQkFBa0IsQ0FBQyxNQUFNLEVBQUU7QUFDbEMsTUFBTSxhQUFhLEdBQUcsMENBQXFCLE1BQU0sQ0FBQyxDQUFDO0FBQ25ELE1BQU0sVUFBVSxHQUFHLFNBQWIsVUFBVSxDQUFJLEdBQUc7V0FBSyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsV0FBVyxFQUFFLFNBQVMsQ0FBQyxFQUFFLEdBQUcsQ0FBQztHQUFBLENBQUM7O0FBRXRFLFNBQU87QUFDTCxnQkFBWSxFQUFFLFlBQVk7R0FDM0IsQ0FBQzs7QUFFRixXQUFTLFdBQVcsQ0FBQyxZQUFZLEVBQUU7QUFDakMsV0FBTyxPQUFPLENBQUMsR0FBRyxDQUFDLFlBQVksQ0FBQyxHQUFHLENBQUMsVUFBQSxTQUFTLEVBQUk7QUFDL0MsYUFBTyxJQUFJLE9BQU8sQ0FBQyxVQUFDLE9BQU8sRUFBRSxNQUFNLEVBQUs7QUFDdEMsZUFBTyxnQkFBTyxTQUFTLEVBQUUsVUFBQyxHQUFHLEVBQUs7QUFDaEMsY0FBSSxHQUFHLEVBQUU7QUFBRSxtQkFBTyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUM7V0FBRTtBQUNoQyxpQkFBTyxFQUFFLENBQUM7U0FDWCxDQUFDLENBQUM7T0FDSixDQUFDLENBQUM7S0FDSixDQUFDLENBQUMsU0FDRyxDQUFDLFVBQUMsR0FBRyxFQUFLOztBQUVkLGdCQUFVLHlDQUF1QyxHQUFHLENBQUMsSUFBSSxDQUFHLENBQUM7S0FDOUQsQ0FBQyxDQUFDO0dBQ0o7O0FBRUQsV0FBUyxZQUFZLENBQUMsS0FBSyxFQUFFLFlBQVksRUFBRSxLQUFLLEVBQUUsT0FBTyxFQUFFO0FBQ3pELFFBQU0sU0FBUyxHQUFHLFNBQUksTUFBTSxFQUFFLENBQUM7O0FBRS9CLFFBQUksS0FBSyxFQUFFO0FBQ1QsVUFBTSxTQUFTLEdBQUcsK0NBQW1CLFlBQVksRUFBRSxLQUFLLENBQUMsQ0FBQztBQUMxRCxXQUFLLElBQUksQUFBQyxTQUFTLFdBQVUsU0FBUyxDQUFDLElBQUksWUFBTyxTQUFTLENBQUMsRUFBRSxHQUFLLEVBQUUsQ0FBQztBQUN0RSxlQUFTLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxDQUFDO0tBQzNCOztBQUVELFdBQU8sT0FBTyxDQUFDLEdBQUcsQ0FBQyxZQUFZLENBQUMsR0FBRyxDQUFDLFVBQUMsUUFBUSxFQUFLO0FBQ2hELFVBQUksUUFBUSxDQUFDLFNBQVMsRUFBRTtBQUN0QixlQUFRLEVBQUUsUUFBUSxFQUFSLFFBQVEsRUFBRSxDQUFDO09BQ3RCLE1BQU07QUFDTCxlQUFPLGFBQWEsQ0FBQyxRQUFRLENBQUMsR0FBRyxFQUFFLFFBQVEsQ0FBQyxJQUFJLEVBQUUsT0FBTyxDQUFDLENBQ3pELElBQUksQ0FBQyxVQUFDLFNBQVMsRUFBSztBQUNuQixnQkFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLFdBQVcsRUFBRSxPQUFPLENBQUMsRUFBSyxRQUFRLENBQUMsRUFBRSxZQUFPLFNBQVMsQ0FBRyxDQUFDO0FBQ3JFLGlCQUFPLEVBQUUsU0FBUyxFQUFULFNBQVMsRUFBRSxRQUFRLEVBQVIsUUFBUSxFQUFFLENBQUM7U0FDaEMsQ0FBQyxDQUFDO09BQ0o7S0FDRixDQUFDLENBQUMsQ0FDRixJQUFJLENBQUMsVUFBQSxPQUFPLEVBQUk7QUFDZixVQUFNLFlBQVksR0FBRyxFQUFFLENBQUM7O0FBRXhCLGFBQU8sQ0FBQyxPQUFPLENBQUMsVUFBQSxNQUFNLEVBQUk7WUFDaEIsU0FBUyxHQUFlLE1BQU0sQ0FBOUIsU0FBUztZQUFFLFFBQVEsR0FBSyxNQUFNLENBQW5CLFFBQVE7O0FBQzNCLFlBQUksU0FBUyxFQUFFLFlBQVksQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUM7O0FBRTVDLFlBQUksUUFBUSxDQUFDLFNBQVMsRUFBRTtBQUN0QixtQkFBUyxDQUFDLFVBQVUsQ0FBSSx3QkFBVyxRQUFRLENBQUMsSUFBSSxDQUFDLG1CQUFhLFFBQVEsQ0FBQyxFQUFFLG1CQUFlO0FBQ3RGLGtCQUFNLEVBQUUsU0FBUztXQUNsQixDQUFDLENBQUM7U0FDSixNQUFNO0FBQ0wsbUJBQVMsQ0FBQyxRQUFRLENBQUMsU0FBUyxFQUFFO0FBQzVCLGlCQUFLLEVBQUUsUUFBUSxDQUFDLEtBQUs7QUFDckIsdUJBQVcsRUFBRSxRQUFRLENBQUMsV0FBVztXQUNsQyxDQUFDLENBQUM7U0FDSjtPQUNGLENBQUMsQ0FBQzs7QUFFSCxhQUFPLFlBQVksQ0FBQztLQUNyQixDQUFDLENBQ0QsSUFBSSxDQUFDLFVBQUEsWUFBWSxFQUFJO0FBQ3BCLFVBQUk7O0FBQ0YsY0FBTSxXQUFXLEdBQUcsU0FBUyxDQUFDLFFBQVEsRUFBRSxDQUFDO0FBQ3pDO2VBQU8sV0FBVyxDQUFDLFlBQVksQ0FBQyxDQUFDLElBQUksQ0FBQztxQkFBTSxXQUFXO2FBQUEsQ0FBQztZQUFDOzs7O09BQzFELENBQUMsT0FBTyxHQUFHLEVBQUU7QUFDWixlQUFPLFdBQVcsQ0FBQyxZQUFZLENBQUMsQ0FBQyxJQUFJLENBQUMsWUFBTTtBQUFFLGdCQUFNLEdBQUcsQ0FBQztTQUFFLENBQUMsQ0FBQztPQUM3RDtLQUNGLENBQUMsQ0FBQztHQUNKLENBQUM7Q0FDSDs7QUFFTSxJQUFNLHVCQUF1QixHQUFHLG9DQUFjLGtCQUFrQixDQUFDLENBQUMiLCJmaWxlIjoiL3Vzci9zaGFyZS9raWJhbmEvcGx1Z2lucy94LXBhY2svcGx1Z2lucy9yZXBvcnRpbmcvc2VydmVyL2xpYi9nZW5lcmF0ZV9kb2N1bWVudC5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHVubGluayB9IGZyb20gJ2ZzJztcbmltcG9ydCB7IGNhcGl0YWxpemUgfSBmcm9tICdsb2Rhc2gnO1xuaW1wb3J0IHsgZ2V0VGltZUZpbHRlclJhbmdlIH0gZnJvbSAnLi9nZXRfdGltZV9maWx0ZXJfcmFuZ2UnO1xuaW1wb3J0IHsgcGRmIH0gZnJvbSAnLi9wZGYnO1xuaW1wb3J0IHsgb25jZVBlclNlcnZlciB9IGZyb20gJy4vb25jZV9wZXJfc2VydmVyJztcbmltcG9ydCB7IGdldFNjcmVlbnNob3RGYWN0b3J5IH0gZnJvbSAnLi9nZXRfc2NyZWVuc2hvdCc7XG5cbmZ1bmN0aW9uIGdlbmVyYXRlRG9jdW1lbnRGbihzZXJ2ZXIpIHtcbiAgY29uc3QgZ2V0U2NyZWVuc2hvdCA9IGdldFNjcmVlbnNob3RGYWN0b3J5KHNlcnZlcik7XG4gIGNvbnN0IHdhcm5pbmdMb2cgPSAobXNnKSA9PiBzZXJ2ZXIubG9nKFsncmVwb3J0aW5nJywgJ3dhcm5pbmcnXSwgbXNnKTtcblxuICByZXR1cm4ge1xuICAgIHByaW50YWJsZVBkZjogcHJpbnRhYmxlUGRmLFxuICB9O1xuXG4gIGZ1bmN0aW9uIGNsZWFuSW1hZ2VzKGNsZWFudXBQYXRocykge1xuICAgIHJldHVybiBQcm9taXNlLmFsbChjbGVhbnVwUGF0aHMubWFwKGltYWdlUGF0aCA9PiB7XG4gICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICByZXR1cm4gdW5saW5rKGltYWdlUGF0aCwgKGVycikgPT4ge1xuICAgICAgICAgIGlmIChlcnIpIHsgcmV0dXJuIHJlamVjdChlcnIpOyB9XG4gICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH0pKVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAvLyBhbnkgZmFpbHVyZXMgdG8gcmVtb3ZlIGltYWdlcyBhcmUgc2lsZW50bHkgc3dhbGxvd2VkXG4gICAgICB3YXJuaW5nTG9nKGBGYWlsZWQgdG8gcmVtb3ZlIHNjcmVlbnNob3QgaW1hZ2U6ICR7ZXJyLnBhdGh9YCk7XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBwcmludGFibGVQZGYodGl0bGUsIHNhdmVkT2JqZWN0cywgcXVlcnksIGhlYWRlcnMpIHtcbiAgICBjb25zdCBwZGZPdXRwdXQgPSBwZGYuY3JlYXRlKCk7XG5cbiAgICBpZiAodGl0bGUpIHtcbiAgICAgIGNvbnN0IHRpbWVSYW5nZSA9IGdldFRpbWVGaWx0ZXJSYW5nZShzYXZlZE9iamVjdHMsIHF1ZXJ5KTtcbiAgICAgIHRpdGxlICs9ICh0aW1lUmFuZ2UpID8gYCDigJQgJHt0aW1lUmFuZ2UuZnJvbX0gdG8gJHt0aW1lUmFuZ2UudG99YCA6ICcnO1xuICAgICAgcGRmT3V0cHV0LnNldFRpdGxlKHRpdGxlKTtcbiAgICB9XG5cbiAgICByZXR1cm4gUHJvbWlzZS5hbGwoc2F2ZWRPYmplY3RzLm1hcCgoc2F2ZWRPYmopID0+IHtcbiAgICAgIGlmIChzYXZlZE9iai5pc01pc3NpbmcpIHtcbiAgICAgICAgcmV0dXJuICB7IHNhdmVkT2JqIH07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gZ2V0U2NyZWVuc2hvdChzYXZlZE9iai51cmwsIHNhdmVkT2JqLnR5cGUsIGhlYWRlcnMpXG4gICAgICAgIC50aGVuKChpbWFnZVBhdGgpID0+IHtcbiAgICAgICAgICBzZXJ2ZXIubG9nKFsncmVwb3J0aW5nJywgJ2RlYnVnJ10sIGAke3NhdmVkT2JqLmlkfSAtPiAke2ltYWdlUGF0aH1gKTtcbiAgICAgICAgICByZXR1cm4geyBpbWFnZVBhdGgsIHNhdmVkT2JqIH07XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0pKVxuICAgIC50aGVuKG9iamVjdHMgPT4ge1xuICAgICAgY29uc3QgY2xlYW51cFBhdGhzID0gW107XG5cbiAgICAgIG9iamVjdHMuZm9yRWFjaChvYmplY3QgPT4ge1xuICAgICAgICBjb25zdCB7IGltYWdlUGF0aCwgc2F2ZWRPYmogfSA9IG9iamVjdDtcbiAgICAgICAgaWYgKGltYWdlUGF0aCkgY2xlYW51cFBhdGhzLnB1c2goaW1hZ2VQYXRoKTtcblxuICAgICAgICBpZiAoc2F2ZWRPYmouaXNNaXNzaW5nKSB7XG4gICAgICAgICAgcGRmT3V0cHV0LmFkZEhlYWRpbmcoYCR7Y2FwaXRhbGl6ZShzYXZlZE9iai50eXBlKX0gd2l0aCBpZCAnJHtzYXZlZE9iai5pZH0nIG5vdCBmb3VuZGAsIHtcbiAgICAgICAgICAgIHN0eWxlczogJ3dhcm5pbmcnXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcGRmT3V0cHV0LmFkZEltYWdlKGltYWdlUGF0aCwge1xuICAgICAgICAgICAgdGl0bGU6IHNhdmVkT2JqLnRpdGxlLFxuICAgICAgICAgICAgZGVzY3JpcHRpb246IHNhdmVkT2JqLmRlc2NyaXB0aW9uLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIGNsZWFudXBQYXRocztcbiAgICB9KVxuICAgIC50aGVuKGNsZWFudXBQYXRocyA9PiB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBwZGZJbnN0YW5jZSA9IHBkZk91dHB1dC5nZW5lcmF0ZSgpO1xuICAgICAgICByZXR1cm4gY2xlYW5JbWFnZXMoY2xlYW51cFBhdGhzKS50aGVuKCgpID0+IHBkZkluc3RhbmNlKTtcbiAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICByZXR1cm4gY2xlYW5JbWFnZXMoY2xlYW51cFBhdGhzKS50aGVuKCgpID0+IHsgdGhyb3cgZXJyOyB9KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfTtcbn1cblxuZXhwb3J0IGNvbnN0IGdlbmVyYXRlRG9jdW1lbnRGYWN0b3J5ID0gb25jZVBlclNlcnZlcihnZW5lcmF0ZURvY3VtZW50Rm4pO1xuIl19",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/generate_document.js"
      ],
      "names": [],
      "mappings": "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",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/generate_document.js",
      "sourcesContent": [
        "import { unlink } from 'fs';\nimport { capitalize } from 'lodash';\nimport { getTimeFilterRange } from './get_time_filter_range';\nimport { pdf } from './pdf';\nimport { oncePerServer } from './once_per_server';\nimport { getScreenshotFactory } from './get_screenshot';\n\nfunction generateDocumentFn(server) {\n  const getScreenshot = getScreenshotFactory(server);\n  const warningLog = (msg) => server.log(['reporting', 'warning'], msg);\n\n  return {\n    printablePdf: printablePdf,\n  };\n\n  function cleanImages(cleanupPaths) {\n    return Promise.all(cleanupPaths.map(imagePath => {\n      return new Promise((resolve, reject) => {\n        return unlink(imagePath, (err) => {\n          if (err) { return reject(err); }\n          resolve();\n        });\n      });\n    }))\n    .catch((err) => {\n      // any failures to remove images are silently swallowed\n      warningLog(`Failed to remove screenshot image: ${err.path}`);\n    });\n  }\n\n  function printablePdf(title, savedObjects, query, headers) {\n    const pdfOutput = pdf.create();\n\n    if (title) {\n      const timeRange = getTimeFilterRange(savedObjects, query);\n      title += (timeRange) ? ` — ${timeRange.from} to ${timeRange.to}` : '';\n      pdfOutput.setTitle(title);\n    }\n\n    return Promise.all(savedObjects.map((savedObj) => {\n      if (savedObj.isMissing) {\n        return  { savedObj };\n      } else {\n        return getScreenshot(savedObj.url, savedObj.type, headers)\n        .then((imagePath) => {\n          server.log(['reporting', 'debug'], `${savedObj.id} -> ${imagePath}`);\n          return { imagePath, savedObj };\n        });\n      }\n    }))\n    .then(objects => {\n      const cleanupPaths = [];\n\n      objects.forEach(object => {\n        const { imagePath, savedObj } = object;\n        if (imagePath) cleanupPaths.push(imagePath);\n\n        if (savedObj.isMissing) {\n          pdfOutput.addHeading(`${capitalize(savedObj.type)} with id '${savedObj.id}' not found`, {\n            styles: 'warning'\n          });\n        } else {\n          pdfOutput.addImage(imagePath, {\n            title: savedObj.title,\n            description: savedObj.description,\n          });\n        }\n      });\n\n      return cleanupPaths;\n    })\n    .then(cleanupPaths => {\n      try {\n        const pdfInstance = pdfOutput.generate();\n        return cleanImages(cleanupPaths).then(() => pdfInstance);\n      } catch (err) {\n        return cleanImages(cleanupPaths).then(() => { throw err; });\n      }\n    });\n  };\n}\n\nexport const generateDocumentFactory = oncePerServer(generateDocumentFn);\n"
      ]
    },
    "mtime": 1491771510540
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/get_time_filter_range.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "lodash",
            "imported": [
              "some"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "some",
                "local": "some"
              }
            ]
          },
          {
            "source": "moment",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "moment"
              }
            ]
          },
          {
            "source": "@elastic/datemath",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "datemath"
              }
            ]
          },
          {
            "source": "../../../../server/lib/parse_kibana_state",
            "imported": [
              "parseKibanaState"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "parseKibanaState",
                "local": "parseKibanaState"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "getTimeFilterRange",
            "savedObjects",
            "query"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "getTimeFilterRange",
              "exported": "getTimeFilterRange"
            },
            {
              "kind": "local",
              "local": "savedObjects",
              "exported": "savedObjects"
            },
            {
              "kind": "local",
              "local": "query",
              "exported": "query"
            }
          ]
        }
      },
      "usedHelpers": [
        "interop-require-default"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nexports.getTimeFilterRange = getTimeFilterRange;\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _lodash = require('lodash');\n\nvar _moment = require('moment');\n\nvar _moment2 = _interopRequireDefault(_moment);\n\nvar _elasticDatemath = require('@elastic/datemath');\n\nvar _elasticDatemath2 = _interopRequireDefault(_elasticDatemath);\n\nvar _serverLibParse_kibana_state = require('../../../../server/lib/parse_kibana_state');\n\nfunction getTimeFilterRange(savedObjects) {\n  var query = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\n  if (!query._g) {\n    return;\n  }\n\n  var hasTimeBasedIndexPattern = (0, _lodash.some)(savedObjects, { isUsingTimeBasedIndexPattern: true });\n  if (!hasTimeBasedIndexPattern) {\n    return;\n  }\n\n  var globalState = (0, _serverLibParse_kibana_state.parseKibanaState)(query, 'global');\n  var time = globalState.get('time');\n  if (!time) {\n    return;\n  }\n\n  var from = (0, _moment2['default'])(_elasticDatemath2['default'].parse(time.from).toISOString()).format('llll');\n  var to = (0, _moment2['default'])(_elasticDatemath2['default'].parse(time.to).toISOString()).format('llll');\n  return { from: from, to: to };\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvcmVwb3J0aW5nL3NlcnZlci9saWIvZ2V0X3RpbWVfZmlsdGVyX3JhbmdlLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7OztzQkFBcUIsUUFBUTs7c0JBQ1YsUUFBUTs7OzsrQkFDTixtQkFBbUI7Ozs7MkNBQ1AsMkNBQTJDOztBQUVyRSxTQUFTLGtCQUFrQixDQUFDLFlBQVksRUFBYztNQUFaLEtBQUsseURBQUcsRUFBRTs7QUFDekQsTUFBSSxDQUFDLEtBQUssQ0FBQyxFQUFFLEVBQUU7QUFDYixXQUFPO0dBQ1I7O0FBRUQsTUFBTSx3QkFBd0IsR0FBRyxrQkFBSyxZQUFZLEVBQUUsRUFBRSw0QkFBNEIsRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDO0FBQzVGLE1BQUksQ0FBQyx3QkFBd0IsRUFBRTtBQUM3QixXQUFPO0dBQ1I7O0FBRUQsTUFBTSxXQUFXLEdBQUcsbURBQWlCLEtBQUssRUFBRSxRQUFRLENBQUMsQ0FBQztBQUN0RCxNQUFNLElBQUksR0FBRyxXQUFXLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxDQUFDO0FBQ3JDLE1BQUksQ0FBQyxJQUFJLEVBQUU7QUFDVCxXQUFPO0dBQ1I7O0FBRUQsTUFBTSxJQUFJLEdBQUcseUJBQU8sNkJBQVMsS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQztBQUM1RSxNQUFNLEVBQUUsR0FBRyx5QkFBTyw2QkFBUyxLQUFLLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDO0FBQ3hFLFNBQU8sRUFBRSxJQUFJLEVBQUosSUFBSSxFQUFFLEVBQUUsRUFBRixFQUFFLEVBQUUsQ0FBQztDQUNyQiIsImZpbGUiOiIvdXNyL3NoYXJlL2tpYmFuYS9wbHVnaW5zL3gtcGFjay9wbHVnaW5zL3JlcG9ydGluZy9zZXJ2ZXIvbGliL2dldF90aW1lX2ZpbHRlcl9yYW5nZS5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHNvbWUgfSBmcm9tICdsb2Rhc2gnO1xuaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnO1xuaW1wb3J0IGRhdGVtYXRoIGZyb20gJ0BlbGFzdGljL2RhdGVtYXRoJztcbmltcG9ydCB7IHBhcnNlS2liYW5hU3RhdGUgfSBmcm9tICcuLi8uLi8uLi8uLi9zZXJ2ZXIvbGliL3BhcnNlX2tpYmFuYV9zdGF0ZSc7XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRUaW1lRmlsdGVyUmFuZ2Uoc2F2ZWRPYmplY3RzLCBxdWVyeSA9IHt9KSB7XG4gIGlmICghcXVlcnkuX2cpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBjb25zdCBoYXNUaW1lQmFzZWRJbmRleFBhdHRlcm4gPSBzb21lKHNhdmVkT2JqZWN0cywgeyBpc1VzaW5nVGltZUJhc2VkSW5kZXhQYXR0ZXJuOiB0cnVlIH0pO1xuICBpZiAoIWhhc1RpbWVCYXNlZEluZGV4UGF0dGVybikge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGNvbnN0IGdsb2JhbFN0YXRlID0gcGFyc2VLaWJhbmFTdGF0ZShxdWVyeSwgJ2dsb2JhbCcpO1xuICBjb25zdCB0aW1lID0gZ2xvYmFsU3RhdGUuZ2V0KCd0aW1lJyk7XG4gIGlmICghdGltZSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGNvbnN0IGZyb20gPSBtb21lbnQoZGF0ZW1hdGgucGFyc2UodGltZS5mcm9tKS50b0lTT1N0cmluZygpKS5mb3JtYXQoJ2xsbGwnKTtcbiAgY29uc3QgdG8gPSBtb21lbnQoZGF0ZW1hdGgucGFyc2UodGltZS50bykudG9JU09TdHJpbmcoKSkuZm9ybWF0KCdsbGxsJyk7XG4gIHJldHVybiB7IGZyb20sIHRvIH07XG59Il19",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/get_time_filter_range.js"
      ],
      "names": [],
      "mappings": ";;;;;;;;;sBAAqB,QAAQ;;sBACV,QAAQ;;;;+BACN,mBAAmB;;;;2CACP,2CAA2C;;AAErE,SAAS,kBAAkB,CAAC,YAAY,EAAc;MAAZ,KAAK,yDAAG,EAAE;;AACzD,MAAI,CAAC,KAAK,CAAC,EAAE,EAAE;AACb,WAAO;GACR;;AAED,MAAM,wBAAwB,GAAG,kBAAK,YAAY,EAAE,EAAE,4BAA4B,EAAE,IAAI,EAAE,CAAC,CAAC;AAC5F,MAAI,CAAC,wBAAwB,EAAE;AAC7B,WAAO;GACR;;AAED,MAAM,WAAW,GAAG,mDAAiB,KAAK,EAAE,QAAQ,CAAC,CAAC;AACtD,MAAM,IAAI,GAAG,WAAW,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;AACrC,MAAI,CAAC,IAAI,EAAE;AACT,WAAO;GACR;;AAED,MAAM,IAAI,GAAG,yBAAO,6BAAS,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,WAAW,EAAE,CAAC,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;AAC5E,MAAM,EAAE,GAAG,yBAAO,6BAAS,KAAK,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,WAAW,EAAE,CAAC,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;AACxE,SAAO,EAAE,IAAI,EAAJ,IAAI,EAAE,EAAE,EAAF,EAAE,EAAE,CAAC;CACrB",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/get_time_filter_range.js",
      "sourcesContent": [
        "import { some } from 'lodash';\nimport moment from 'moment';\nimport datemath from '@elastic/datemath';\nimport { parseKibanaState } from '../../../../server/lib/parse_kibana_state';\n\nexport function getTimeFilterRange(savedObjects, query = {}) {\n  if (!query._g) {\n    return;\n  }\n\n  const hasTimeBasedIndexPattern = some(savedObjects, { isUsingTimeBasedIndexPattern: true });\n  if (!hasTimeBasedIndexPattern) {\n    return;\n  }\n\n  const globalState = parseKibanaState(query, 'global');\n  const time = globalState.get('time');\n  if (!time) {\n    return;\n  }\n\n  const from = moment(datemath.parse(time.from).toISOString()).format('llll');\n  const to = moment(datemath.parse(time.to).toISOString()).format('llll');\n  return { from, to };\n}"
      ]
    },
    "mtime": 1491771510540
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/pdf.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "path",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "path"
              }
            ]
          },
          {
            "source": "lodash",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "_"
              }
            ]
          },
          {
            "source": "concat-stream",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "concat"
              }
            ]
          },
          {
            "source": "pdfmake",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "Printer"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "pdf"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "pdf",
              "exported": "pdf"
            }
          ]
        }
      },
      "usedHelpers": [
        "create-class",
        "class-call-check",
        "interop-require-default"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\nvar _path = require('path');\n\nvar _path2 = _interopRequireDefault(_path);\n\nvar _lodash = require('lodash');\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _concatStream = require('concat-stream');\n\nvar _concatStream2 = _interopRequireDefault(_concatStream);\n\nvar _pdfmake = require('pdfmake');\n\nvar _pdfmake2 = _interopRequireDefault(_pdfmake);\n\nvar assetPath = _path2['default'].resolve(__dirname, '..', '..', 'server', 'assets');\n\nvar PdfMaker = (function () {\n  function PdfMaker() {\n    _classCallCheck(this, PdfMaker);\n\n    var fontPath = function fontPath(filename) {\n      return _path2['default'].resolve(assetPath, 'fonts', filename);\n    };\n    var fonts = {\n      Roboto: {\n        normal: fontPath('Roboto-Regular.ttf'),\n        bold: fontPath('Roboto-Medium.ttf'),\n        italics: fontPath('Roboto-Italic.ttf'),\n        bolditalics: fontPath('Roboto-Italic.ttf')\n      }\n    };\n\n    this._title = '';\n    this._content = [];\n    this._printer = new _pdfmake2['default'](fonts);\n  }\n\n  _createClass(PdfMaker, [{\n    key: '_addContents',\n    value: function _addContents(contents) {\n      var groupCount = this._content.length;\n\n      // inject a page break for every 2 groups on the page\n      if (groupCount > 0 && groupCount % 2 === 0) {\n        contents = [{\n          text: '',\n          pageBreak: 'after'\n        }].concat(contents);\n      }\n\n      this._content.push(contents);\n    }\n  }, {\n    key: 'addImage',\n    value: function addImage(filePath) {\n      var opts = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\n      var contents = [];\n\n      if (opts.title && opts.title.length > 0) {\n        contents.push({\n          text: opts.title,\n          style: 'heading'\n        });\n      }\n\n      if (opts.description && opts.description.length > 0) {\n        contents.push({\n          text: opts.description,\n          style: 'subheading'\n        });\n      }\n\n      var img = {\n        image: filePath,\n        width: 500,\n        alignment: 'center'\n      };\n\n      var wrappedImg = {\n        table: {\n          body: [[img]]\n        },\n        layout: 'simpleBorder'\n      };\n\n      contents.push(_lodash2['default'].assign(wrappedImg, _lodash2['default'].omit(opts, ['title', 'description'])));\n\n      this._addContents(contents);\n    }\n  }, {\n    key: 'addHeading',\n    value: function addHeading(headingText) {\n      var opts = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\n      var contents = [];\n      contents.push({\n        text: headingText,\n        style: ['heading'].concat(opts.styles || [])\n      });\n      this._addContents(contents);\n    }\n  }, {\n    key: 'setTitle',\n    value: function setTitle(title) {\n      this._title = title;\n    }\n  }, {\n    key: 'generate',\n    value: function generate() {\n      var docTemplate = _lodash2['default'].assign(getTemplate(this._title), { content: this._content });\n      this._pdfDoc = this._printer.createPdfKitDocument(docTemplate, getDocOptions());\n      return this;\n    }\n  }, {\n    key: 'getBuffer',\n    value: function getBuffer() {\n      var _this = this;\n\n      if (!this._pdfDoc) throw new Error('Document stream has not been generated');\n      return new Promise(function (resolve, reject) {\n        var concatStream = (0, _concatStream2['default'])(function (pdfBuffer) {\n          resolve(pdfBuffer);\n        });\n\n        _this._pdfDoc.on('error', reject);\n        _this._pdfDoc.pipe(concatStream);\n        _this._pdfDoc.end();\n      });\n    }\n  }, {\n    key: 'getStream',\n    value: function getStream() {\n      if (!this._pdfDoc) throw new Error('Document stream has not been generated');\n      this._pdfDoc.end();\n      return this._pdfDoc;\n    }\n  }]);\n\n  return PdfMaker;\n})();\n\n;\n\nfunction getTemplate(title) {\n  var pageMarginTop = 40;\n  var pageMarginBottom = 80;\n  var pageMarginWidth = 40;\n\n  return {\n    // define page size\n    pageOrientation: 'portrait',\n    pageSize: 'A4',\n    pageMargins: [pageMarginWidth, pageMarginTop, pageMarginWidth, pageMarginBottom],\n\n    header: function header() {\n      return {\n        margin: [pageMarginWidth, pageMarginTop / 4, pageMarginWidth, 0],\n        text: title,\n        style: {\n          color: '#aaa'\n        },\n        fontSize: 10,\n        alignment: 'center'\n      };\n    },\n\n    footer: function footer(currentPage, pageCount) {\n      var logoPath = _path2['default'].resolve(assetPath, 'img', 'logo-grey.png');\n      return {\n        margin: [pageMarginWidth, pageMarginBottom / 4, pageMarginWidth, 0],\n        alignment: 'justify',\n        columns: [{\n          width: 100,\n          image: logoPath\n        }, {\n          margin: [120, 10, 0, 0],\n          text: 'Page ' + currentPage.toString() + ' of ' + pageCount,\n          style: {\n            color: '#aaa'\n          }\n        }]\n      };\n    },\n\n    styles: {\n      heading: {\n        alignment: 'left',\n        fontSize: 14,\n        bold: true,\n        marginTop: 10,\n        marginBottom: 5\n      },\n      subheading: {\n        alignment: 'left',\n        italics: true,\n        marginLeft: 20,\n        marginBottom: 5\n      },\n      warning: {\n        color: '#f39c12' // same as @brand-warning in Kibana colors.less\n      }\n    },\n\n    defaultStyle: {\n      fontSize: 12,\n      font: 'Roboto'\n    }\n  };\n}\n\nfunction getDocOptions() {\n  return {\n    tableLayouts: {\n      simpleBorder: {\n        // format is function (i, node) { ... };\n        hLineWidth: function hLineWidth() {\n          return 1;\n        },\n        vLineWidth: function vLineWidth() {\n          return 1;\n        },\n        hLineColor: function hLineColor() {\n          return 'silver';\n        },\n        vLineColor: function vLineColor() {\n          return 'silver';\n        },\n        paddingLeft: function paddingLeft() {\n          return 0;\n        },\n        paddingRight: function paddingRight() {\n          return 0;\n        },\n        paddingTop: function paddingTop() {\n          return 0;\n        },\n        paddingBottom: function paddingBottom() {\n          return 0;\n        }\n      }\n    }\n  };\n}\n\nvar pdf = {\n  create: function create() {\n    return new PdfMaker();\n  }\n};\nexports.pdf = pdf;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvcmVwb3J0aW5nL3NlcnZlci9saWIvcGRmLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztvQkFBaUIsTUFBTTs7OztzQkFDVCxRQUFROzs7OzRCQUNILGVBQWU7Ozs7dUJBQ2QsU0FBUzs7OztBQUU3QixJQUFNLFNBQVMsR0FBRyxrQkFBSyxPQUFPLENBQUMsU0FBUyxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsUUFBUSxFQUFFLFFBQVEsQ0FBQyxDQUFDOztJQUVwRSxRQUFRO0FBQ0QsV0FEUCxRQUFRLEdBQ0U7MEJBRFYsUUFBUTs7QUFFVixRQUFNLFFBQVEsR0FBRyxTQUFYLFFBQVEsQ0FBSSxRQUFRO2FBQUssa0JBQUssT0FBTyxDQUFDLFNBQVMsRUFBRSxPQUFPLEVBQUUsUUFBUSxDQUFDO0tBQUEsQ0FBQztBQUMxRSxRQUFNLEtBQUssR0FBRztBQUNaLFlBQU0sRUFBRTtBQUNOLGNBQU0sRUFBRSxRQUFRLENBQUMsb0JBQW9CLENBQUM7QUFDdEMsWUFBSSxFQUFFLFFBQVEsQ0FBQyxtQkFBbUIsQ0FBQztBQUNuQyxlQUFPLEVBQUUsUUFBUSxDQUFDLG1CQUFtQixDQUFDO0FBQ3RDLG1CQUFXLEVBQUUsUUFBUSxDQUFDLG1CQUFtQixDQUFDO09BQzNDO0tBQ0YsQ0FBQzs7QUFFRixRQUFJLENBQUMsTUFBTSxHQUFHLEVBQUUsQ0FBQztBQUNqQixRQUFJLENBQUMsUUFBUSxHQUFHLEVBQUUsQ0FBQztBQUNuQixRQUFJLENBQUMsUUFBUSxHQUFHLHlCQUFZLEtBQUssQ0FBQyxDQUFDO0dBQ3BDOztlQWZHLFFBQVE7O1dBaUJBLHNCQUFDLFFBQVEsRUFBRTtBQUNyQixVQUFNLFVBQVUsR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQzs7O0FBR3hDLFVBQUksVUFBVSxHQUFHLENBQUMsSUFBSSxVQUFVLEdBQUcsQ0FBQyxLQUFLLENBQUMsRUFB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QVUsRUFBRTtpQkFBTSxRQUFRO1NBQUE7QUFDMUIsbUJBQVcsRUFBRTtpQkFBTSxDQUFDO1NBQUE7QUFDcEIsb0JBQVksRUFBRTtpQkFBTSxDQUFDO1NBQUE7QUFDckIsa0JBQVUsRUFBRTtpQkFBTSxDQUFDO1NBQUE7QUFDbkIscUJBQWEsRUFBRTtpQkFBTSxDQUFDO1NBQUE7T0FDdkI7S0FDRjtHQUNGLENBQUM7Q0FDSDs7QUFFTSxJQUFNLEdBQUcsR0FBRztBQUNqQixRQUFNLEVBQUU7V0FBTSxJQUFJLFFBQVEsRUFBRTtHQUFBO0NBQzdCLENBQUMiLCJmaWxlIjoiL3Vzci9zaGFyZS9raWJhbmEvcGx1Z2lucy94LXBhY2svcGx1Z2lucy9yZXBvcnRpbmcvc2VydmVyL2xpYi9wZGYuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcbmltcG9ydCBfIGZyb20gJ2xvZGFzaCc7XG5pbXBvcnQgY29uY2F0IGZyb20gJ2NvbmNhdC1zdHJlYW0nO1xuaW1wb3J0IFByaW50ZXIgZnJvbSAncGRmbWFrZSc7XG5cbmNvbnN0IGFzc2V0UGF0aCA9IHBhdGgucmVzb2x2ZShfX2Rpcm5hbWUsICcuLicsICcuLicsICdzZXJ2ZXInLCAnYXNzZXRzJyk7XG5cbmNsYXNzIFBkZk1ha2VyIHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgY29uc3QgZm9udFBhdGggPSAoZmlsZW5hbWUpID0+IHBhdGgucmVzb2x2ZShhc3NldFBhdGgsICdmb250cycsIGZpbGVuYW1lKTtcbiAgICBjb25zdCBmb250cyA9IHtcbiAgICAgIFJvYm90bzoge1xuICAgICAgICBub3JtYWw6IGZvbnRQYXRoKCdSb2JvdG8tUmVndWxhci50dGYnKSxcbiAgICAgICAgYm9sZDogZm9udFBhdGgoJ1JvYm90by1NZWRpdW0udHRmJyksXG4gICAgICAgIGl0YWxpY3M6IGZvbnRQYXRoKCdSb2JvdG8tSXRhbGljLnR0ZicpLFxuICAgICAgICBib2xkaXRhbGljczogZm9udFBhdGgoJ1JvYm90by1JdGFsaWMudHRmJyksXG4gICAgICB9XG4gICAgfTtcblxuICAgIHRoaXMuX3RpdGxlID0gJyc7XG4gICAgdGhpcy5fY29udGVudCA9IFtdO1xuICAgIHRoaXMuX3ByaW50ZXIgPSBuZXcgUHJpbnRlcihmb250cyk7XG4gIH1cblxuICBfYWRkQ29udGVudHMoY29udGVudHMpIHtcbiAgICBjb25zdCBncm91cENvdW50ID0gdGhpcy5fY29udGVudC5sZW5ndGg7XG5cbiAgICAvLyBpbmplY3QgYSBwYWdlIGJyZWFrIGZvciBldmVyeSAyIGdyb3VwcyBvbiB0aGUgcGFnZVxuICAgIGlmIChncm91cENvdW50ID4gMCAmJiBncm91cENvdW50ICUgMiA9PT0gMCkge1xuICAgICAgY29udGVudHMgPSBbe1xuICAgICAgICB0ZXh0OiAnJyxcbiAgICAgICAgcGFnZUJyZWFrOiAnYWZ0ZXInLFxuICAgICAgfV0uY29uY2F0KGNvbnRlbnRzKTtcbiAgICB9XG5cbiAgICB0aGlzLl9jb250ZW50LnB1c2goY29udGVudHMpO1xuICB9XG5cbiAgYWRkSW1hZ2UoZmlsZVBhdGgsIG9wdHMgPSB7fSkge1xuICAgIGNvbnN0IGNvbnRlbnRzID0gW107XG5cbiAgICBpZiAob3B0cy50aXRsZSAmJiBvcHRzLnRpdGxlLmxlbmd0aCA+IDApIHtcbiAgICAgIGNvbnRlbnRzLnB1c2goe1xuICAgICAgICB0ZXh0OiBvcHRzLnRpdGxlLFxuICAgICAgICBzdHlsZTogJ2hlYWRpbmcnXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAob3B0cy5kZXNjcmlwdGlvbiAmJiBvcHRzLmRlc2NyaXB0aW9uLmxlbmd0aCA+IDApIHtcbiAgICAgIGNvbnRlbnRzLnB1c2goe1xuICAgICAgICB0ZXh0OiBvcHRzLmRlc2NyaXB0aW9uLFxuICAgICAgICBzdHlsZTogJ3N1YmhlYWRpbmcnXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBjb25zdCBpbWcgPSB7XG4gICAgICBpbWFnZTogZmlsZVBhdGgsXG4gICAgICB3aWR0aDogNTAwLFxuICAgICAgYWxpZ25tZW50OiAnY2VudGVyJyxcbiAgICB9O1xuXG4gICAgY29uc3Qgd3JhcHBlZEltZyA9IHtcbiAgICAgIHRhYmxlOiB7XG4gICAgICAgIGJvZHk6IFtcbiAgICAgICAgICBbIGltZyBdLFxuICAgICAgICBdLFxuICAgICAgfSxcbiAgICAgIGxheW91dDogJ3NpbXBsZUJvcmRlcidcbiAgICB9O1xuXG4gICAgY29udGVudHMucHVzaChfLmFzc2lnbih3cmFwcGVkSW1nLCBfLm9taXQob3B0cywgWyd0aXRsZScsICdkZXNjcmlwdGlvbiddKSkpO1xuXG4gICAgdGhpcy5fYWRkQ29udGVudHMoY29udGVudHMpO1xuICB9XG5cbiAgYWRkSGVhZGluZyhoZWFkaW5nVGV4dCwgb3B0cyA9IHt9KSB7XG4gICAgY29uc3QgY29udGVudHMgPSBbXTtcbiAgICBjb250ZW50cy5wdXNoKHtcbiAgICAgIHRleHQ6IGhlYWRpbmdUZXh0LFxuICAgICAgc3R5bGU6IFsnaGVhZGluZyddLmNvbmNhdChvcHRzLnN0eWxlcyB8fCBbXSlcbiAgICB9KTtcbiAgICB0aGlzLl9hZGRDb250ZW50cyhjb250ZW50cyk7XG4gIH1cblxuICBzZXRUaXRsZSh0aXRsZSkge1xuICAgIHRoaXMuX3RpdGxlID0gdGl0bGU7XG4gIH1cblxuICBnZW5lcmF0ZSgpIHtcbiAgICBjb25zdCBkb2NUZW1wbGF0ZSA9IF8uYXNzaWduKGdldFRlbXBsYXRlKHRoaXMuX3RpdGxlKSwgeyBjb250ZW50OiB0aGlzLl9jb250ZW50IH0pO1xuICAgIHRoaXMuX3BkZkRvYyA9IHRoaXMuX3ByaW50ZXIuY3JlYXRlUGRmS2l0RG9jdW1lbnQoZG9jVGVtcGxhdGUsIGdldERvY09wdGlvbnMoKSk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICBnZXRCdWZmZXIoKSB7XG4gICAgaWYgKCF0aGlzLl9wZGZEb2MpIHRocm93IG5ldyBFcnJvcignRG9jdW1lbnQgc3RyZWFtIGhhcyBub3QgYmVlbiBnZW5lcmF0ZWQnKTtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgY29uc3QgY29uY2F0U3RyZWFtID0gY29uY2F0KGZ1bmN0aW9uIChwZGZCdWZmZXIpIHtcbiAgICAgICAgcmVzb2x2ZShwZGZCdWZmZXIpO1xuICAgICAgfSk7XG5cbiAgICAgIHRoaXMuX3BkZkRvYy5vbignZXJyb3InLCByZWplY3QpO1xuICAgICAgdGhpcy5fcGRmRG9jLnBpcGUoY29uY2F0U3RyZWFtKTtcbiAgICAgIHRoaXMuX3BkZkRvYy5lbmQoKTtcbiAgICB9KTtcbiAgfVxuXG4gIGdldFN0cmVhbSgpIHtcbiAgICBpZiAoIXRoaXMuX3BkZkRvYykgdGhyb3cgbmV3IEVycm9yKCdEb2N1bWVudCBzdHJlYW0gaGFzIG5vdCBiZWVuIGdlbmVyYXRlZCcpO1xuICAgIHRoaXMuX3BkZkRvYy5lbmQoKTtcbiAgICByZXR1cm4gdGhpcy5fcGRmRG9jO1xuICB9XG59O1xuXG5mdW5jdGlvbiBnZXRUZW1wbGF0ZSh0aXRsZSkge1xuICBjb25zdCBwYWdlTWFyZ2luVG9wID0gNDA7XG4gIGNvbnN0IHBhZ2VNYXJnaW5Cb3R0b20gPSA4MDtcbiAgY29uc3QgcGFnZU1hcmdpbldpZHRoID0gNDA7XG5cbiAgcmV0dXJuIHtcbiAgICAvLyBkZWZpbmUgcGFnZSBzaXplXG4gICAgcGFnZU9yaWVudGF0aW9uOiAncG9ydHJhaXQnLFxuICAgIHBhZ2VTaXplOiAnQTQnLFxuICAgIHBhZ2VNYXJnaW5zOiBbIHBhZ2VNYXJnaW5XaWR0aCwgcGFnZU1hcmdpblRvcCwgcGFnZU1hcmdpbldpZHRoLCBwYWdlTWFyZ2luQm90dG9tIF0sXG5cbiAgICBoZWFkZXI6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIG1hcmdpbjogWyBwYWdlTWFyZ2luV2lkdGgsIHBhZ2VNYXJnaW5Ub3AgLyA0LCBwYWdlTWFyZ2luV2lkdGgsIDAgXSxcbiAgICAgICAgdGV4dDogdGl0bGUsXG4gICAgICAgIHN0eWxlOiB7XG4gICAgICAgICAgY29sb3I6ICcjYWFhJyxcbiAgICAgICAgfSxcbiAgICAgICAgZm9udFNpemU6IDEwLFxuICAgICAgICBhbGlnbm1lbnQ6ICdjZW50ZXInXG4gICAgICB9O1xuICAgIH0sXG5cbiAgICBmb290ZXI6IGZ1bmN0aW9uIChjdXJyZW50UGFnZSwgcGFnZUNvdW50KSB7XG4gICAgICBjb25zdCBsb2dvUGF0aCA9IHBhdGgucmVzb2x2ZShhc3NldFBhdGgsICdpbWcnLCAnbG9nby1ncmV5LnBuZycpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgbWFyZ2luOiBbIHBhZ2VNYXJnaW5XaWR0aCwgcGFnZU1hcmdpbkJvdHRvbSAvIDQsIHBhZ2VNYXJnaW5XaWR0aCwgMCBdLFxuICAgICAgICBhbGlnbm1lbnQ6ICdqdXN0aWZ5JyxcbiAgICAgICAgY29sdW1uczogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIHdpZHRoOiAxMDAsXG4gICAgICAgICAgICBpbWFnZTogbG9nb1BhdGgsXG4gICAgICAgICAgfSwge1xuICAgICAgICAgICAgbWFyZ2luOiBbIDEyMCwgMTAsIDAsIDAgXSxcbiAgICAgICAgICAgIHRleHQ6ICdQYWdlICcgKyBjdXJyZW50UGFnZS50b1N0cmluZygpICsgJyBvZiAnICsgcGFnZUNvdW50LFxuICAgICAgICAgICAgc3R5bGU6IHtcbiAgICAgICAgICAgICAgY29sb3I6ICcjYWFhJ1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9LFxuICAgICAgICBdXG4gICAgICB9O1xuICAgIH0sXG5cbiAgICBzdHlsZXM6IHtcbiAgICAgIGhlYWRpbmc6IHtcbiAgICAgICAgYWxpZ25tZW50OiAnbGVmdCcsXG4gICAgICAgIGZvbnRTaXplOiAxNCxcbiAgICAgICAgYm9sZDogdHJ1ZSxcbiAgICAgICAgbWFyZ2luVG9wOiAxMCxcbiAgICAgICAgbWFyZ2luQm90dG9tOiA1LFxuICAgICAgfSxcbiAgICAgIHN1YmhlYWRpbmc6IHtcbiAgICAgICAgYWxpZ25tZW50OiAnbGVmdCcsXG4gICAgICAgIGl0YWxpY3M6IHRydWUsXG4gICAgICAgIG1hcmdpbkxlZnQ6IDIwLFxuICAgICAgICBtYXJnaW5Cb3R0b206IDUsXG4gICAgICB9LFxuICAgICAgd2FybmluZzoge1xuICAgICAgICBjb2xvcjogJyNmMzljMTInIC8vIHNhbWUgYXMgQGJyYW5kLXdhcm5pbmcgaW4gS2liYW5hIGNvbG9ycy5sZXNzXG4gICAgICB9XG4gICAgfSxcblxuICAgIGRlZmF1bHRTdHlsZToge1xuICAgICAgZm9udFNpemU6IDEyLFxuICAgICAgZm9udDogJ1JvYm90bycsXG4gICAgfSxcbiAgfTtcbn1cblxuZnVuY3Rpb24gZ2V0RG9jT3B0aW9ucygpIHtcbiAgcmV0dXJuIHtcbiAgICB0YWJsZUxheW91dHM6IHtcbiAgICAgIHNpbXBsZUJvcmRlcjoge1xuICAgICAgICAvLyBmb3JtYXQgaXMgZnVuY3Rpb24gKGksIG5vZGUpIHsgLi4uIH07XG4gICAgICAgIGhMaW5lV2lkdGg6ICgpID0+IDEsXG4gICAgICAgIHZMaW5lV2lkdGg6ICgpID0+IDEsXG4gICAgICAgIGhMaW5lQ29sb3I6ICgpID0+ICdzaWx2ZXInLFxuICAgICAgICB2TGluZUNvbG9yOiAoKSA9PiAnc2lsdmVyJyxcbiAgICAgICAgcGFkZGluZ0xlZnQ6ICgpID0+IDAsXG4gICAgICAgIHBhZGRpbmdSaWdodDogKCkgPT4gMCxcbiAgICAgICAgcGFkZGluZ1RvcDogKCkgPT4gMCxcbiAgICAgICAgcGFkZGluZ0JvdHRvbTogKCkgPT4gMCxcbiAgICAgIH1cbiAgICB9XG4gIH07XG59XG5cbmV4cG9ydCBjb25zdCBwZGYgPSB7XG4gIGNyZWF0ZTogKCkgPT4gbmV3IFBkZk1ha2VyKClcbn07XG4iXX0=",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/pdf.js"
      ],
      "names": [],
      "mappings": "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",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/pdf.js",
      "sourcesContent": [
        "import path from 'path';\nimport _ from 'lodash';\nimport concat from 'concat-stream';\nimport Printer from 'pdfmake';\n\nconst assetPath = path.resolve(__dirname, '..', '..', 'server', 'assets');\n\nclass PdfMaker {\n  constructor() {\n    const fontPath = (filename) => path.resolve(assetPath, 'fonts', filename);\n    const fonts = {\n      Roboto: {\n        normal: fontPath('Roboto-Regular.ttf'),\n        bold: fontPath('Roboto-Medium.ttf'),\n        italics: fontPath('Roboto-Italic.ttf'),\n        bolditalics: fontPath('Roboto-Italic.ttf'),\n      }\n    };\n\n    this._title = '';\n    this._content = [];\n    this._printer = new Printer(fonts);\n  }\n\n  _addContents(contents) {\n    const groupCount = this._content.length;\n\n    // inject a page break for every 2 groups on the page\n    if (groupCount > 0 && groupCount % 2 === 0) {\n      contents = [{\n        text: '',\n        pageBreak: 'after',\n      }].concat(contents);\n    }\n\n    this._content.push(contents);\n  }\n\n  addImage(filePath, opts = {}) {\n    const contents = [];\n\n    if (opts.title && opts.title.length > 0) {\n      contents.push({\n        text: opts.title,\n        style: 'heading'\n      });\n    }\n\n    if (opts.description && opts.description.length > 0) {\n      contents.push({\n        text: opts.description,\n        style: 'subheading'\n      });\n    }\n\n    const img = {\n      image: filePath,\n      width: 500,\n      alignment: 'center',\n    };\n\n    const wrappedImg = {\n      table: {\n        body: [\n          [ img ],\n        ],\n      },\n      layout: 'simpleBorder'\n    };\n\n    contents.push(_.assign(wrappedImg, _.omit(opts, ['title', 'description'])));\n\n    this._addContents(contents);\n  }\n\n  addHeading(headingText, opts = {}) {\n    const contents = [];\n    contents.push({\n      text: headingText,\n      style: ['heading'].concat(opts.styles || [])\n    });\n    this._addContents(contents);\n  }\n\n  setTitle(title) {\n    this._title = title;\n  }\n\n  generate() {\n    const docTemplate = _.assign(getTemplate(this._title), { content: this._content });\n    this._pdfDoc = this._printer.createPdfKitDocument(docTemplate, getDocOptions());\n    return this;\n  }\n\n  getBuffer() {\n    if (!this._pdfDoc) throw new Error('Document stream has not been generated');\n    return new Promise((resolve, reject) => {\n      const concatStream = concat(function (pdfBuffer) {\n        resolve(pdfBuffer);\n      });\n\n      this._pdfDoc.on('error', reject);\n      this._pdfDoc.pipe(concatStream);\n      this._pdfDoc.end();\n    });\n  }\n\n  getStream() {\n    if (!this._pdfDoc) throw new Error('Document stream has not been generated');\n    this._pdfDoc.end();\n    return this._pdfDoc;\n  }\n};\n\nfunction getTemplate(title) {\n  const pageMarginTop = 40;\n  const pageMarginBottom = 80;\n  const pageMarginWidth = 40;\n\n  return {\n    // define page size\n    pageOrientation: 'portrait',\n    pageSize: 'A4',\n    pageMargins: [ pageMarginWidth, pageMarginTop, pageMarginWidth, pageMarginBottom ],\n\n    header: function () {\n      return {\n        margin: [ pageMarginWidth, pageMarginTop / 4, pageMarginWidth, 0 ],\n        text: title,\n        style: {\n          color: '#aaa',\n        },\n        fontSize: 10,\n        alignment: 'center'\n      };\n    },\n\n    footer: function (currentPage, pageCount) {\n      const logoPath = path.resolve(assetPath, 'img', 'logo-grey.png');\n      return {\n        margin: [ pageMarginWidth, pageMarginBottom / 4, pageMarginWidth, 0 ],\n        alignment: 'justify',\n        columns: [\n          {\n            width: 100,\n            image: logoPath,\n          }, {\n            margin: [ 120, 10, 0, 0 ],\n            text: 'Page ' + currentPage.toString() + ' of ' + pageCount,\n            style: {\n              color: '#aaa'\n            },\n          },\n        ]\n      };\n    },\n\n    styles: {\n      heading: {\n        alignment: 'left',\n        fontSize: 14,\n        bold: true,\n        marginTop: 10,\n        marginBottom: 5,\n      },\n      subheading: {\n        alignment: 'left',\n        italics: true,\n        marginLeft: 20,\n        marginBottom: 5,\n      },\n      warning: {\n        color: '#f39c12' // same as @brand-warning in Kibana colors.less\n      }\n    },\n\n    defaultStyle: {\n      fontSize: 12,\n      font: 'Roboto',\n    },\n  };\n}\n\nfunction getDocOptions() {\n  return {\n    tableLayouts: {\n      simpleBorder: {\n        // format is function (i, node) { ... };\n        hLineWidth: () => 1,\n        vLineWidth: () => 1,\n        hLineColor: () => 'silver',\n        vLineColor: () => 'silver',\n        paddingLeft: () => 0,\n        paddingRight: () => 0,\n        paddingTop: () => 0,\n        paddingBottom: () => 0,\n      }\n    }\n  };\n}\n\nexport const pdf = {\n  create: () => new PdfMaker()\n};\n"
      ]
    },
    "mtime": 1491771510540
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/get_screenshot.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "queue",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "queue"
              }
            ]
          },
          {
            "source": "./once_per_server",
            "imported": [
              "oncePerServer"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "oncePerServer",
                "local": "oncePerServer"
              }
            ]
          },
          {
            "source": "./screenshot",
            "imported": [
              "screenshot"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "screenshot",
                "local": "screenshot"
              }
            ]
          },
          {
            "source": "./create_tagged_logger",
            "imported": [
              "createTaggedLogger"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "createTaggedLogger",
                "local": "createTaggedLogger"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "getScreenshotFactory"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "getScreenshotFactory",
              "exported": "getScreenshotFactory"
            }
          ]
        }
      },
      "usedHelpers": [
        "interop-require-default"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _queue = require('queue');\n\nvar _queue2 = _interopRequireDefault(_queue);\n\nvar _once_per_server = require('./once_per_server');\n\nvar _screenshot = require('./screenshot');\n\nvar _create_tagged_logger = require('./create_tagged_logger');\n\n// bounding boxes for various saved object types\nvar boundingBoxes = {\n  visualization: {\n    top: 0,\n    left: 0,\n    bottom: 0,\n    right: 0\n  },\n  search: {\n    top: 0,\n    left: 0,\n    bottom: 0,\n    right: 16 }\n};\n\n// scrollbar in discover refuses to hide with ::-webkit-scrollbar css rule\nfunction getScreenshotFn(server) {\n  var config = server.config();\n\n  var logger = (0, _create_tagged_logger.createTaggedLogger)(server, ['reporting', 'debug']);\n\n  var phantomPath = server.plugins.reporting.phantom.binary;\n  var captureSettings = config.get('xpack.reporting.capture');\n  var screenshotSettings = { basePath: config.get('server.basePath'), imagePath: config.get('path.data') };\n  var captureConcurrency = captureSettings.concurrency;\n  logger('Screenshot concurrency: ' + captureConcurrency);\n\n  // init the screenshot module\n  var ss = (0, _screenshot.screenshot)(phantomPath, captureSettings, screenshotSettings, logger);\n\n  // create the process queue\n  var screenshotQueue = (0, _queue2['default'])({ concurrency: captureConcurrency });\n\n  return function getScreenshot(objUrl, type, headers) {\n    return new Promise(function (resolve, reject) {\n      screenshotQueue.push(function (cb) {\n        return ss.capture(objUrl, {\n          headers: headers,\n          bounding: boundingBoxes[type]\n        }).then(function (filename) {\n          resolve(filename);\n          cb();\n        }, function (err) {\n          screenshotQueue.end(err);\n          reject(err);\n          cb();\n        });\n      });\n\n      if (!screenshotQueue.running) screenshotQueue.start();\n    });\n  };\n};\n\nvar getScreenshotFactory = (0, _once_per_server.oncePerServer)(getScreenshotFn);\nexports.getScreenshotFactory = getScreenshotFactory;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvcmVwb3J0aW5nL3NlcnZlci9saWIvZ2V0X3NjcmVlbnNob3QuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7cUJBQWtCLE9BQU87Ozs7K0JBQ0ssbUJBQW1COzswQkFDdEIsY0FBYzs7b0NBQ04sd0JBQXdCOzs7QUFHM0QsSUFBTSxhQUFhLEdBQUc7QUFDcEIsZUFBYSxFQUFFO0FBQ2IsT0FBRyxFQUFFLENBQUM7QUFDTixRQUFJLEVBQUUsQ0FBQztBQUNQLFVBQU0sRUFBRSxDQUFDO0FBQ1QsU0FBSyxFQUFFLENBQUM7R0FDVDtBQUNELFFBQU0sRUFBRTtBQUNOLE9BQUcsRUFBRSxDQUFDO0FBQ04sUUFBSSxFQUFFLENBQUM7QUFDUCxVQUFNLEVBQUUsQ0FBQztBQUNULFNBQUssRUFBRSxFQUFFLEVBQ1Y7Q0FDRixDQUFDOzs7QUFFRixTQUFTLGVBQWUsQ0FBQyxNQUFNLEVBQUU7QUFDL0IsTUFBTSxNQUFNLEdBQUcsTUFBTSxDQUFDLE1BQU0sRUFBRSxDQUFDOztBQUUvQixNQUFNLE1BQU0sR0FBRyw4Q0FBbUIsTUFBTSxFQUFFLENBQUMsV0FBVyxFQUFFLE9BQU8sQ0FBQyxDQUFDLENBQUM7O0FBRWxFLE1BQU0sV0FBVyxHQUFHLE1BQU0sQ0FBQyxPQUFPLENBQUMsU0FBUyxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUM7QUFDNUQsTUFBTSxlQUFlLEdBQUcsTUFBTSxDQUFDLEdBQUcsQ0FBQyx5QkFBeUIsQ0FBQyxDQUFDO0FBQzlELE1BQU0sa0JBQWtCLEdBQUcsRUFBRSxRQUFRLEVBQUUsTUFBTSxDQUFDLEdBQUcsQ0FBQyxpQkFBaUIsQ0FBQyxFQUFFLFNBQVMsRUFBRSxNQUFNLENBQUMsR0FBRyxDQUFDLFdBQVcsQ0FBQyxFQUFFLENBQUM7QUFDM0csTUFBTSxrQkFBa0IsR0FBRyxlQUFlLENBQUMsV0FBVyxDQUFDO0FBQ3ZELFFBQU0sOEJBQTRCLGtCQUFrQixDQUFHLENBQUM7OztBQUd4RCxNQUFNLEVBQUUsR0FBRyw0QkFBVyxXQUFXLEVBQUUsZUFBZSxFQUFFLGtCQUFrQixFQUFFLE1BQU0sQ0FBQyxDQUFDOzs7QUFHaEYsTUFBTSxlQUFlLEdBQUcsd0JBQU0sRUFBRSxXQUFXLEVBQUUsa0JBQWtCLEVBQUUsQ0FBQyxDQUFDOztBQUVuRSxTQUFPLFNBQVMsYUFBYSxDQUFDLE1BQU0sRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFO0FBQ25ELFdBQU8sSUFBSSxPQUFPLENBQUMsVUFBVSxPQUFPLEVBQUUsTUFBTSxFQUFFO0FBQzVDLHFCQUFlLENBQUMsSUFBSSxDQUFDLFVBQVUsRUFBRSxFQUFFO0FBQ2pDLGVBQU8sRUFBRSxDQUFDLE9BQU8sQ0FBQyxNQUFNLEVBQUU7QUFDeEIsaUJBQU8sRUFBUCxPQUFPO0FBQ1Asa0JBQVEsRUFBRSxhQUFhLENBQUMsSUFBSSxDQUFDO1NBQzlCLENBQUMsQ0FDRCxJQUFJLENBQUMsVUFBQyxRQUFRLEVBQUs7QUFDbEIsaUJBQU8sQ0FBQyxRQUFRLENBQUMsQ0FBQztBQUNsQixZQUFFLEVBQUUsQ0FBQztTQUNOLEVBQUUsVUFBQyxHQUFHLEVBQUs7QUFDVix5QkFBZSxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQztBQUN6QixnQkFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDO0FBQ1osWUFBRSxFQUFFLENBQUM7U0FDTixDQUFDLENBQUM7T0FDSixDQUFDLENBQUM7O0FBRUgsVUFBSSxDQUFDLGVBQWUsQ0FBQyxPQUFPLEVBQUUsZUFBZSxDQUFDLEtBQUssRUFBRSxDQUFDO0tBQ3ZELENBQUMsQ0FBQztHQUNKLENBQUM7Q0FDSCxDQUFDOztBQUVLLElBQU0sb0JBQW9CLEdBQUcsb0NBQWMsZUFBZSxDQUFDLENBQUMiLCJmaWxlIjoiL3Vzci9zaGFyZS9raWJhbmEvcGx1Z2lucy94LXBhY2svcGx1Z2lucy9yZXBvcnRpbmcvc2VydmVyL2xpYi9nZXRfc2NyZWVuc2hvdC5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBxdWV1ZSBmcm9tICdxdWV1ZSc7XG5pbXBvcnQgeyBvbmNlUGVyU2VydmVyIH0gZnJvbSAnLi9vbmNlX3Blcl9zZXJ2ZXInO1xuaW1wb3J0IHsgc2NyZWVuc2hvdCB9IGZyb20gJy4vc2NyZWVuc2hvdCc7XG5pbXBvcnQgeyBjcmVhdGVUYWdnZWRMb2dnZXIgfSBmcm9tICcuL2NyZWF0ZV90YWdnZWRfbG9nZ2VyJztcblxuLy8gYm91bmRpbmcgYm94ZXMgZm9yIHZhcmlvdXMgc2F2ZWQgb2JqZWN0IHR5cGVzXG5jb25zdCBib3VuZGluZ0JveGVzID0ge1xuICB2aXN1YWxpemF0aW9uOiB7XG4gICAgdG9wOiAwLFxuICAgIGxlZnQ6IDAsXG4gICAgYm90dG9tOiAwLFxuICAgIHJpZ2h0OiAwLFxuICB9LFxuICBzZWFyY2g6IHtcbiAgICB0b3A6IDAsXG4gICAgbGVmdDogMCxcbiAgICBib3R0b206IDAsXG4gICAgcmlnaHQ6IDE2LCAvLyBzY3JvbGxiYXIgaW4gZGlzY292ZXIgcmVmdXNlcyB0byBoaWRlIHdpdGggOjotd2Via2l0LXNjcm9sbGJhciBjc3MgcnVsZVxuICB9LFxufTtcblxuZnVuY3Rpb24gZ2V0U2NyZWVuc2hvdEZuKHNlcnZlcikge1xuICBjb25zdCBjb25maWcgPSBzZXJ2ZXIuY29uZmlnKCk7XG5cbiAgY29uc3QgbG9nZ2VyID0gY3JlYXRlVGFnZ2VkTG9nZ2VyKHNlcnZlciwgWydyZXBvcnRpbmcnLCAnZGVidWcnXSk7XG5cbiAgY29uc3QgcGhhbnRvbVBhdGggPSBzZXJ2ZXIucGx1Z2lucy5yZXBvcnRpbmcucGhhbnRvbS5iaW5hcnk7XG4gIGNvbnN0IGNhcHR1cmVTZXR0aW5ncyA9IGNvbmZpZy5nZXQoJ3hwYWNrLnJlcG9ydGluZy5jYXB0dXJlJyk7XG4gIGNvbnN0IHNjcmVlbnNob3RTZXR0aW5ncyA9IHsgYmFzZVBhdGg6IGNvbmZpZy5nZXQoJ3NlcnZlci5iYXNlUGF0aCcpLCBpbWFnZVBhdGg6IGNvbmZpZy5nZXQoJ3BhdGguZGF0YScpIH07XG4gIGNvbnN0IGNhcHR1cmVDb25jdXJyZW5jeSA9IGNhcHR1cmVTZXR0aW5ncy5jb25jdXJyZW5jeTtcbiAgbG9nZ2VyKGBTY3JlZW5zaG90IGNvbmN1cnJlbmN5OiAke2NhcHR1cmVDb25jdXJyZW5jeX1gKTtcblxuICAvLyBpbml0IHRoZSBzY3JlZW5zaG90IG1vZHVsZVxuICBjb25zdCBzcyA9IHNjcmVlbnNob3QocGhhbnRvbVBhdGgsIGNhcHR1cmVTZXR0aW5ncywgc2NyZWVuc2hvdFNldHRpbmdzLCBsb2dnZXIpO1xuXG4gIC8vIGNyZWF0ZSB0aGUgcHJvY2VzcyBxdWV1ZVxuICBjb25zdCBzY3JlZW5zaG90UXVldWUgPSBxdWV1ZSh7IGNvbmN1cnJlbmN5OiBjYXB0dXJlQ29uY3VycmVuY3kgfSk7XG5cbiAgcmV0dXJuIGZ1bmN0aW9uIGdldFNjcmVlbnNob3Qob2JqVXJsLCB0eXBlLCBoZWFkZXJzKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgIHNjcmVlbnNob3RRdWV1ZS5wdXNoKGZ1bmN0aW9uIChjYikge1xuICAgICAgICByZXR1cm4gc3MuY2FwdHVyZShvYmpVcmwsIHtcbiAgICAgICAgICBoZWFkZXJzLFxuICAgICAgICAgIGJvdW5kaW5nOiBib3VuZGluZ0JveGVzW3R5cGVdLFxuICAgICAgICB9KVxuICAgICAgICAudGhlbigoZmlsZW5hbWUpID0+IHtcbiAgICAgICAgICByZXNvbHZlKGZpbGVuYW1lKTtcbiAgICAgICAgICBjYigpO1xuICAgICAgICB9LCAoZXJyKSA9PiB7XG4gICAgICAgICAgc2NyZWVuc2hvdFF1ZXVlLmVuZChlcnIpO1xuICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgIGNiKCk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG5cbiAgICAgIGlmICghc2NyZWVuc2hvdFF1ZXVlLnJ1bm5pbmcpIHNjcmVlbnNob3RRdWV1ZS5zdGFydCgpO1xuICAgIH0pO1xuICB9O1xufTtcblxuZXhwb3J0IGNvbnN0IGdldFNjcmVlbnNob3RGYWN0b3J5ID0gb25jZVBlclNlcnZlcihnZXRTY3JlZW5zaG90Rm4pO1xuIl19",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/get_screenshot.js"
      ],
      "names": [],
      "mappings": ";;;;;;;;qBAAkB,OAAO;;;;+BACK,mBAAmB;;0BACtB,cAAc;;oCACN,wBAAwB;;;AAG3D,IAAM,aAAa,GAAG;AACpB,eAAa,EAAE;AACb,OAAG,EAAE,CAAC;AACN,QAAI,EAAE,CAAC;AACP,UAAM,EAAE,CAAC;AACT,SAAK,EAAE,CAAC;GACT;AACD,QAAM,EAAE;AACN,OAAG,EAAE,CAAC;AACN,QAAI,EAAE,CAAC;AACP,UAAM,EAAE,CAAC;AACT,SAAK,EAAE,EAAE,EACV;CACF,CAAC;;;AAEF,SAAS,eAAe,CAAC,MAAM,EAAE;AAC/B,MAAM,MAAM,GAAG,MAAM,CAAC,MAAM,EAAE,CAAC;;AAE/B,MAAM,MAAM,GAAG,8CAAmB,MAAM,EAAE,CAAC,WAAW,EAAE,OAAO,CAAC,CAAC,CAAC;;AAElE,MAAM,WAAW,GAAG,MAAM,CAAC,OAAO,CAAC,SAAS,CAAC,OAAO,CAAC,MAAM,CAAC;AAC5D,MAAM,eAAe,GAAG,MAAM,CAAC,GAAG,CAAC,yBAAyB,CAAC,CAAC;AAC9D,MAAM,kBAAkB,GAAG,EAAE,QAAQ,EAAE,MAAM,CAAC,GAAG,CAAC,iBAAiB,CAAC,EAAE,SAAS,EAAE,MAAM,CAAC,GAAG,CAAC,WAAW,CAAC,EAAE,CAAC;AAC3G,MAAM,kBAAkB,GAAG,eAAe,CAAC,WAAW,CAAC;AACvD,QAAM,8BAA4B,kBAAkB,CAAG,CAAC;;;AAGxD,MAAM,EAAE,GAAG,4BAAW,WAAW,EAAE,eAAe,EAAE,kBAAkB,EAAE,MAAM,CAAC,CAAC;;;AAGhF,MAAM,eAAe,GAAG,wBAAM,EAAE,WAAW,EAAE,kBAAkB,EAAE,CAAC,CAAC;;AAEnE,SAAO,SAAS,aAAa,CAAC,MAAM,EAAE,IAAI,EAAE,OAAO,EAAE;AACnD,WAAO,IAAI,OAAO,CAAC,UAAU,OAAO,EAAE,MAAM,EAAE;AAC5C,qBAAe,CAAC,IAAI,CAAC,UAAU,EAAE,EAAE;AACjC,eAAO,EAAE,CAAC,OAAO,CAAC,MAAM,EAAE;AACxB,iBAAO,EAAP,OAAO;AACP,kBAAQ,EAAE,aAAa,CAAC,IAAI,CAAC;SAC9B,CAAC,CACD,IAAI,CAAC,UAAC,QAAQ,EAAK;AAClB,iBAAO,CAAC,QAAQ,CAAC,CAAC;AAClB,YAAE,EAAE,CAAC;SACN,EAAE,UAAC,GAAG,EAAK;AACV,yBAAe,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;AACzB,gBAAM,CAAC,GAAG,CAAC,CAAC;AACZ,YAAE,EAAE,CAAC;SACN,CAAC,CAAC;OACJ,CAAC,CAAC;;AAEH,UAAI,CAAC,eAAe,CAAC,OAAO,EAAE,eAAe,CAAC,KAAK,EAAE,CAAC;KACvD,CAAC,CAAC;GACJ,CAAC;CACH,CAAC;;AAEK,IAAM,oBAAoB,GAAG,oCAAc,eAAe,CAAC,CAAC",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/get_screenshot.js",
      "sourcesContent": [
        "import queue from 'queue';\nimport { oncePerServer } from './once_per_server';\nimport { screenshot } from './screenshot';\nimport { createTaggedLogger } from './create_tagged_logger';\n\n// bounding boxes for various saved object types\nconst boundingBoxes = {\n  visualization: {\n    top: 0,\n    left: 0,\n    bottom: 0,\n    right: 0,\n  },\n  search: {\n    top: 0,\n    left: 0,\n    bottom: 0,\n    right: 16, // scrollbar in discover refuses to hide with ::-webkit-scrollbar css rule\n  },\n};\n\nfunction getScreenshotFn(server) {\n  const config = server.config();\n\n  const logger = createTaggedLogger(server, ['reporting', 'debug']);\n\n  const phantomPath = server.plugins.reporting.phantom.binary;\n  const captureSettings = config.get('xpack.reporting.capture');\n  const screenshotSettings = { basePath: config.get('server.basePath'), imagePath: config.get('path.data') };\n  const captureConcurrency = captureSettings.concurrency;\n  logger(`Screenshot concurrency: ${captureConcurrency}`);\n\n  // init the screenshot module\n  const ss = screenshot(phantomPath, captureSettings, screenshotSettings, logger);\n\n  // create the process queue\n  const screenshotQueue = queue({ concurrency: captureConcurrency });\n\n  return function getScreenshot(objUrl, type, headers) {\n    return new Promise(function (resolve, reject) {\n      screenshotQueue.push(function (cb) {\n        return ss.capture(objUrl, {\n          headers,\n          bounding: boundingBoxes[type],\n        })\n        .then((filename) => {\n          resolve(filename);\n          cb();\n        }, (err) => {\n          screenshotQueue.end(err);\n          reject(err);\n          cb();\n        });\n      });\n\n      if (!screenshotQueue.running) screenshotQueue.start();\n    });\n  };\n};\n\nexport const getScreenshotFactory = oncePerServer(getScreenshotFn);\n"
      ]
    },
    "mtime": 1491771510540
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/screenshot.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "path",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "path"
              }
            ]
          },
          {
            "source": "get-port",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "getPort"
              }
            ]
          },
          {
            "source": "puid",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "Puid"
              }
            ]
          },
          {
            "source": "./phantom",
            "imported": [
              "phantom"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "phantom",
                "local": "phantom"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "screenshot",
            "phantomPath",
            "captureSettings",
            "screenshotSettings",
            "logger"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "screenshot",
              "exported": "screenshot"
            },
            {
              "kind": "local",
              "local": "phantomPath",
              "exported": "phantomPath"
            },
            {
              "kind": "local",
              "local": "captureSettings",
              "exported": "captureSettings"
            },
            {
              "kind": "local",
              "local": "screenshotSettings",
              "exported": "screenshotSettings"
            },
            {
              "kind": "local",
              "local": "logger",
              "exported": "logger"
            }
          ]
        }
      },
      "usedHelpers": [
        "create-class",
        "class-call-check",
        "interop-require-default"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nexports.screenshot = screenshot;\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\nvar _path = require('path');\n\nvar _path2 = _interopRequireDefault(_path);\n\nvar _getPort = require('get-port');\n\nvar _getPort2 = _interopRequireDefault(_getPort);\n\nvar _puid = require('puid');\n\nvar _puid2 = _interopRequireDefault(_puid);\n\nvar _phantom = require('./phantom');\n\nvar puid = new _puid2['default']();\nvar noop = function noop() {};\n\nvar Screenshot = (function () {\n  function Screenshot(phantomPath, captureSettings, screenshotSettings, logger) {\n    _classCallCheck(this, Screenshot);\n\n    this.phantomPath = phantomPath;\n    this.captureSettings = captureSettings;\n    this.screenshotSettings = screenshotSettings;\n    this.logger = logger || noop;\n  }\n\n  _createClass(Screenshot, [{\n    key: 'capture',\n    value: function capture(url, opts) {\n      var _this = this;\n\n      this.logger('fetching screenshot of ' + url);\n      opts = Object.assign({ basePath: this.screenshotSettings.basePath }, opts);\n\n      return createPhantom(this.phantomPath, this.captureSettings, this.logger).then(function (ph) {\n        var filepath = getTargetFile(_this.screenshotSettings.imagePath);\n\n        return loadUrl(ph, url, _this.captureSettings, opts).then(function () {\n          return ph.screenshot(filepath, { bounding: opts.bounding });\n        }).then(function () {\n          _this.logger('Screenshot saved to ' + filepath);\n          return ph.destroy().then(function () {\n            return filepath;\n          });\n        })['catch'](function (err) {\n          _this.logger('Screenshot failed ' + err.message);\n          return ph.destroy().then(function () {\n            throw err;\n          });\n        });\n      });\n    }\n  }]);\n\n  return Screenshot;\n})();\n\nfunction createPhantom(phantomPath, captureSettings, logger) {\n  var timeout = captureSettings.timeout;\n\n  return Promise.resolve((0, _getPort2['default'])()).then(function (port) {\n    return _phantom.phantom.create({\n      ignoreSSLErrors: true,\n      phantomPath: phantomPath,\n      bridgePort: port,\n      timeout: timeout,\n      logger: logger\n    });\n  });\n}\n\nfunction loadUrl(ph, url, captureSettings, opts) {\n  var timeout = captureSettings.timeout;\n  var viewport = captureSettings.viewport;\n  var zoom = captureSettings.zoom;\n  var loadDelay = captureSettings.loadDelay;\n  var settleTime = captureSettings.settleTime;\n\n  var waitForSelector = '.application';\n\n  return ph.open(url, {\n    headers: opts.headers,\n    waitForSelector: waitForSelector,\n    timeout: timeout,\n    zoom: zoom,\n    viewport: viewport\n  }).then(function () {\n    return ph.evaluate(function (basePath) {\n      // inject custom CSS rules\n      function injectCSS(cssPath) {\n        var node = document.createElement('link');\n        node.rel = 'stylesheet';\n        node.href = cssPath;\n        document.getElementsByTagName('head')[0].appendChild(node);\n      };\n\n      injectCSS(basePath + '/plugins/reporting/styles/reporting-overrides.css');\n    }, opts.basePath);\n  }).then(function () {\n    return ph.waitForSelector('[render-counter]');\n  }).then(function () {\n    // this is run in phantom\n    function listenForComplete(visLoadDelay, visLoadTimeout, visSettleTime) {\n      // wait for visualizations to finish loading\n      var visualizations = document.querySelectorAll('[render-counter]');\n      var visCount = visualizations.length;\n      var renderedTasks = [];\n\n      // used when visualizations have a render-count attribute\n      function waitForRenderCount(visualization) {\n        return new Promise(function (resolve, reject) {\n          var CHECK_DELAY = 300;\n          var start = Date.now();\n          var lastRenderCount = 0;\n\n          (function checkRenderCount() {\n            var renderCount = parseInt(visualization.getAttribute('render-counter'));\n\n            // if the timeout has exceeded, abort and reject\n            if (start + visLoadTimeout < Date.now()) {\n              return reject(new Error('Visualization took too long to load'));\n            }\n\n            // vis has rendered at least once\n            if (renderCount > 0) {\n              // resolve once the current and previous render count match\n              if (renderCount === lastRenderCount) {\n                return resolve();\n              }\n\n              // if they don't match, wait for the visualization to settle and try again\n              lastRenderCount = renderCount;\n              return setTimeout(checkRenderCount, visSettleTime);\n            }\n\n            setTimeout(checkRenderCount, CHECK_DELAY);\n          })();\n        });\n      }\n\n      // timeout resolution, used when visualizations don't have a render-count attribute\n      function waitForRenderDelay() {\n        return new Promise(function (resolve) {\n          setTimeout(resolve, visLoadDelay);\n        });\n      }\n\n      for (var i = 0; i < visCount; i++) {\n        var visualization = visualizations[i];\n        var renderCounter = visualization.getAttribute('render-counter');\n\n        if (renderCounter !== 'disabled') {\n          renderedTasks.push(waitForRenderCount(visualization));\n        } else {\n          renderedTasks.push(waitForRenderDelay());\n        }\n      }\n\n      return Promise.all(renderedTasks);\n    }\n\n    return ph.evaluate(listenForComplete, loadDelay, timeout, settleTime);\n  });\n};\n\nfunction getTargetFile(imagePath) {\n  return _path2['default'].join(imagePath, 'screenshot-' + puid.generate() + '.png');\n}\n\nfunction screenshot(phantomPath, captureSettings, screenshotSettings, logger) {\n  return new Screenshot(phantomPath, captureSettings, screenshotSettings, logger);\n}\n\n;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvcmVwb3J0aW5nL3NlcnZlci9saWIvc2NyZWVuc2hvdC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztvQkFBaUIsTUFBTTs7Ozt1QkFDSCxVQUFVOzs7O29CQUNiLE1BQU07Ozs7dUJBQ0MsV0FBVzs7QUFFbkMsSUFBTSxJQUFJLEdBQUcsdUJBQVUsQ0FBQztBQUN4QixJQUFNLElBQUksR0FBRyxTQUFQLElBQUksR0FBZSxFQUFFLENBQUM7O0lBRXRCLFVBQVU7QUFDSCxXQURQLFVBQVUsQ0FDRixXQUFXLEVBQUUsZUFBZSxFQUFFLGtCQUFrQixFQUFFLE1BQU0sRUFBRTswQkFEbEUsVUFBVTs7QUFFWixRQUFJLENBQUMsV0FBVyxHQUFHLFdBQVcsQ0FBQztBQUMvQixRQUFJLENBQUMsZUFBZSxHQUFHLGVBQWUsQ0FBQztBQUN2QyxRQUFJLENBQUMsa0JBQWtCLEdBQUcsa0JBQWtCLENBQUM7QUFDN0MsUUFBSSxDQUFDLE1BQU0sR0FBRyxNQUFNLElBQUksSUFBSSxDQUFDO0dBQzlCOztlQU5HLFVBQVU7O1dBUVAsaUJBQUMsR0FBRyxFQUFFLElBQUksRUFBRTs7O0FBQ2pCLFVBQUksQ0FBQyxNQUFNLDZCQUEyQixHQUFHLENBQUcsQ0FBQztBQUM3QyxVQUFJLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQyxFQUFFLFFBQVEsRUFBRSxJQUFJLENBQUMsa0JBQWtCLENBQUMsUUFBUSxFQUFFLEVBQUUsSUFBSSxDQUFDLENBQUM7O0FBRTNFLGFBQU8sYUFBYSxDQUFDLElBQUksQ0FBQyxXQUFXLEVBQUUsSUFBSSxDQUFDLGVBQWUsRUFBRSxJQUFJLENBQUMsTUFBTSxDQUFDLENBQ3hFLElBQUksQ0FBQyxVQUFBLEVBQUUsRUFBSTtBQUNWLFlBQU0sUUFBUSxHQUFHLGFBQWEsQ0FBQyxNQUFLLGtCQUFrQixDQUFDLFNBQVMsQ0FBQyxDQUFDOztBQUVsRSxlQUFP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QVUsT0FBTyxFQUFFO0FBQ3BDLG9CQUFVLENBQUMsT0FBTyxFQUFFLFlBQVksQ0FBQyxDQUFDO1NBQ25DLENBQUMsQ0FBQztPQUNKOztBQUVELFdBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxRQUFRLEVBQUUsQ0FBQyxFQUFFLEVBQUU7QUFDakMsWUFBTSxhQUFhLEdBQUcsY0FBYyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ3hDLFlBQU0sYUFBYSxHQUFHLGFBQWEsQ0FBQyxZQUFZLENBQUMsZ0JBQWdCLENBQUMsQ0FBQzs7QUFFbkUsWUFBSSxhQUFhLEtBQUssVUFBVSxFQUFFO0FBQ2hDLHVCQUFhLENBQUMsSUFBSSxDQUFDLGtCQUFrQixDQUFDLGFBQWEsQ0FBQyxDQUFDLENBQUM7U0FDdkQsTUFBTTtBQUNMLHVCQUFhLENBQUMsSUFBSSxDQUFDLGtCQUFrQixFQUFFLENBQUMsQ0FBQztTQUMxQztPQUNGOztBQUVELGFBQU8sT0FBTyxDQUFDLEdBQUcsQ0FBQyxhQUFhLENBQUMsQ0FBQztLQUNuQzs7QUFFRCxXQUFPLEVBQUUsQ0FBQyxRQUFRLENBQUMsaUJBQWlCLEVBQUUsU0FBUyxFQUFFLE9BQU8sRUFBRSxVQUFVLENBQUMsQ0FBQztHQUN2RSxDQUFDLENBQUM7Q0FDSixDQUFDOztBQUVGLFNBQVMsYUFBYSxDQUFDLFNBQVMsRUFBRTtBQUNoQyxTQUFPLGtCQUFLLElBQUksQ0FBQyxTQUFTLGtCQUFnQixJQUFJLENBQUMsUUFBUSxFQUFFLFVBQU8sQ0FBQztDQUNsRTs7QUFFTSxTQUFTLFVBQVUsQ0FBQyxXQUFXLEVBQUUsZUFBZSxFQUFFLGtCQUFrQixFQUFFLE1BQU0sRUFBRTtBQUNuRixTQUFPLElBQUksVUFBVSxDQUFDLFdBQVcsRUFBRSxlQUFlLEVBQUUsa0JBQWtCLEVBQUUsTUFBTSxDQUFDLENBQUM7Q0FDakY7O0FBQUEsQ0FBQyIsImZpbGUiOiIvdXNyL3NoYXJlL2tpYmFuYS9wbHVnaW5zL3gtcGFjay9wbHVnaW5zL3JlcG9ydGluZy9zZXJ2ZXIvbGliL3NjcmVlbnNob3QuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcbmltcG9ydCBnZXRQb3J0IGZyb20gJ2dldC1wb3J0JztcbmltcG9ydCBQdWlkIGZyb20gJ3B1aWQnO1xuaW1wb3J0IHsgcGhhbnRvbSB9IGZyb20gJy4vcGhhbnRvbSc7XG5cbmNvbnN0IHB1aWQgPSBuZXcgUHVpZCgpO1xuY29uc3Qgbm9vcCA9IGZ1bmN0aW9uICgpIHt9O1xuXG5jbGFzcyBTY3JlZW5zaG90IHtcbiAgY29uc3RydWN0b3IocGhhbnRvbVBhdGgsIGNhcHR1cmVTZXR0aW5ncywgc2NyZWVuc2hvdFNldHRpbmdzLCBsb2dnZXIpIHtcbiAgICB0aGlzLnBoYW50b21QYXRoID0gcGhhbnRvbVBhdGg7XG4gICAgdGhpcy5jYXB0dXJlU2V0dGluZ3MgPSBjYXB0dXJlU2V0dGluZ3M7XG4gICAgdGhpcy5zY3JlZW5zaG90U2V0dGluZ3MgPSBzY3JlZW5zaG90U2V0dGluZ3M7XG4gICAgdGhpcy5sb2dnZXIgPSBsb2dnZXIgfHwgbm9vcDtcbiAgfVxuXG4gIGNhcHR1cmUodXJsLCBvcHRzKSB7XG4gICAgdGhpcy5sb2dnZXIoYGZldGNoaW5nIHNjcmVlbnNob3Qgb2YgJHt1cmx9YCk7XG4gICAgb3B0cyA9IE9iamVjdC5hc3NpZ24oeyBiYXNlUGF0aDogdGhpcy5zY3JlZW5zaG90U2V0dGluZ3MuYmFzZVBhdGggfSwgb3B0cyk7XG5cbiAgICByZXR1cm4gY3JlYXRlUGhhbnRvbSh0aGlzLnBoYW50b21QYXRoLCB0aGlzLmNhcHR1cmVTZXR0aW5ncywgdGhpcy5sb2dnZXIpXG4gICAgLnRoZW4ocGggPT4ge1xuICAgICAgY29uc3QgZmlsZXBhdGggPSBnZXRUYXJnZXRGaWxlKHRoaXMuc2NyZWVuc2hvdFNldHRpbmdzLmltYWdlUGF0aCk7XG5cbiAgICAgIHJldHVybiBsb2FkVXJsKHBoLCB1cmwsIHRoaXMuY2FwdHVyZVNldHRpbmdzLCBvcHRzKVxuICAgICAgLnRoZW4oKCkgPT4gcGguc2NyZWVuc2hvdChmaWxlcGF0aCwgeyBib3VuZGluZzogb3B0cy5ib3VuZGluZyB9KSlcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgdGhpcy5sb2dnZXIoYFNjcmVlbnNob3Qgc2F2ZWQgdG8gJHtmaWxlcGF0aH1gKTtcbiAgICAgICAgcmV0dXJuIHBoLmRlc3Ryb3koKS50aGVuKCgpID0+IGZpbGVwYXRoKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goZXJyID0+IHtcbiAgICAgICAgdGhpcy5sb2dnZXIoYFNjcmVlbnNob3QgZmFpbGVkICR7ZXJyLm1lc3NhZ2V9YCk7XG4gICAgICAgIHJldHVybiBwaC5kZXN0cm95KCkudGhlbigoKSA9PiB7IHRocm93IGVycjsgfSk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxufVxuXG5mdW5jdGlvbiBjcmVhdGVQaGFudG9tKHBoYW50b21QYXRoLCBjYXB0dXJlU2V0dGluZ3MsIGxvZ2dlcikge1xuICBjb25zdCB7IHRpbWVvdXQgfSA9IGNhcHR1cmVTZXR0aW5ncztcblxuICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGdldFBvcnQoKSlcbiAgLnRoZW4ocG9ydCA9PiB7XG4gICAgcmV0dXJuIHBoYW50b20uY3JlYXRlKHtcbiAgICAgIGlnbm9yZVNTTEVycm9yczogdHJ1ZSxcbiAgICAgIHBoYW50b21QYXRoOiBwaGFudG9tUGF0aCxcbiAgICAgIGJyaWRnZVBvcnQ6IHBvcnQsXG4gICAgICB0aW1lb3V0LFxuICAgICAgbG9nZ2VyXG4gICAgfSk7XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBsb2FkVXJsKHBoLCB1cmwsIGNhcHR1cmVTZXR0aW5ncywgb3B0cykge1xuICBjb25zdCB7IHRpbWVvdXQsIHZpZXdwb3J0LCB6b29tLCBsb2FkRGVsYXksIHNldHRsZVRpbWUgfSA9IGNhcHR1cmVTZXR0aW5ncztcbiAgY29uc3Qgd2FpdEZvclNlbGVjdG9yID0gJy5hcHBsaWNhdGlvbic7XG5cbiAgcmV0dXJuIHBoLm9wZW4odXJsLCB7XG4gICAgaGVhZGVyczogb3B0cy5oZWFkZXJzLFxuICAgIHdhaXRGb3JTZWxlY3RvcixcbiAgICB0aW1lb3V0LFxuICAgIHpvb20sXG4gICAgdmlld3BvcnQsXG4gIH0pXG4gIC50aGVuKCgpID0+IHtcbiAgICByZXR1cm4gcGguZXZhbHVhdGUoZnVuY3Rpb24gKGJhc2VQYXRoKSB7XG4gICAgICAvLyBpbmplY3QgY3VzdG9tIENTUyBydWxlc1xuICAgICAgZnVuY3Rpb24gaW5qZWN0Q1NTKGNzc1BhdGgpIHtcbiAgICAgICAgY29uc3Qgbm9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpbmsnKTtcbiAgICAgICAgbm9kZS5yZWwgPSAnc3R5bGVzaGVldCc7XG4gICAgICAgIG5vZGUuaHJlZiA9IGNzc1BhdGg7XG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdoZWFkJylbMF0uYXBwZW5kQ2hpbGQobm9kZSk7XG4gICAgICB9O1xuXG4gICAgICBpbmplY3RDU1MoYmFzZVBhdGggKyAnL3BsdWdpbnMvcmVwb3J0aW5nL3N0eWxlcy9yZXBvcnRpbmctb3ZlcnJpZGVzLmNzcycpO1xuICAgIH0sIG9wdHMuYmFzZVBhdGgpO1xuICB9KVxuICAudGhlbigoKSA9PiB7XG4gICAgcmV0dXJuIHBoLndhaXRGb3JTZWxlY3RvcignW3JlbmRlci1jb3VudGVyXScpO1xuICB9KVxuICAudGhlbigoKSA9PiB7XG4gICAgLy8gdGhpcyBpcyBydW4gaW4gcGhhbnRvbVxuICAgIGZ1bmN0aW9uIGxpc3RlbkZvckNvbXBsZXRlKHZpc0xvYWREZWxheSwgdmlzTG9hZFRpbWVvdXQsIHZpc1NldHRsZVRpbWUpIHtcbiAgICAgIC8vIHdhaXQgZm9yIHZpc3VhbGl6YXRpb25zIHRvIGZpbmlzaCBsb2FkaW5nXG4gICAgICBjb25zdCB2aXN1YWxpemF0aW9ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1tyZW5kZXItY291bnRlcl0nKTtcbiAgICAgIGNvbnN0IHZpc0NvdW50ID0gdmlzdWFsaXphdGlvbnMubGVuZ3RoO1xuICAgICAgY29uc3QgcmVuZGVyZWRUYXNrcyA9IFtdO1xuXG4gICAgICAvLyB1c2VkIHdoZW4gdmlzdWFsaXphdGlvbnMgaGF2ZSBhIHJlbmRlci1jb3VudCBhdHRyaWJ1dGVcbiAgICAgIGZ1bmN0aW9uIHdhaXRGb3JSZW5kZXJDb3VudCh2aXN1YWxpemF0aW9uKSB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgY29uc3QgQ0hFQ0tfREVMQVkgPSAzMDA7XG4gICAgICAgICAgY29uc3Qgc3RhcnQgPSBEYXRlLm5vdygpO1xuICAgICAgICAgIGxldCBsYXN0UmVuZGVyQ291bnQgPSAwO1xuXG4gICAgICAgICAgKGZ1bmN0aW9uIGNoZWNrUmVuZGVyQ291bnQoKSB7XG4gICAgICAgICAgICBjb25zdCByZW5kZXJDb3VudCA9IHBhcnNlSW50KHZpc3VhbGl6YXRpb24uZ2V0QXR0cmlidXRlKCdyZW5kZXItY291bnRlcicpKTtcblxuICAgICAgICAgICAgLy8gaWYgdGhlIHRpbWVvdXQgaGFzIGV4Y2VlZGVkLCBhYm9ydCBhbmQgcmVqZWN0XG4gICAgICAgICAgICBpZiAoKHN0YXJ0ICsgdmlzTG9hZFRpbWVvdXQpIDwgRGF0ZS5ub3coKSkge1xuICAgICAgICAgICAgICByZXR1cm4gcmVqZWN0KG5ldyBFcnJvcignVmlzdWFsaXphdGlvbiB0b29rIHRvbyBsb25nIHRvIGxvYWQnKSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIHZpcyBoYXMgcmVuZGVyZWQgYXQgbGVhc3Qgb25jZVxuICAgICAgICAgICAgaWYgKHJlbmRlckNvdW50ID4gMCkge1xuICAgICAgICAgICAgICAvLyByZXNvbHZlIG9uY2UgdGhlIGN1cnJlbnQgYW5kIHByZXZpb3VzIHJlbmRlciBjb3VudCBtYXRjaFxuICAgICAgICAgICAgICBpZiAocmVuZGVyQ291bnQgPT09IGxhc3RSZW5kZXJDb3VudCkge1xuICAgICAgICAgICAgICAgIHJldHVybiByZXNvbHZlKCk7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAvLyBpZiB0aGV5IGRvbid0IG1hdGNoLCB3YWl0IGZvciB0aGUgdmlzdWFsaXphdGlvbiB0byBzZXR0bGUgYW5kIHRyeSBhZ2FpblxuICAgICAgICAgICAgICBsYXN0UmVuZGVyQ291bnQgPSByZW5kZXJDb3VudDtcbiAgICAgICAgICAgICAgcmV0dXJuIHNldFRpbWVvdXQoY2hlY2tSZW5kZXJDb3VudCwgdmlzU2V0dGxlVGltZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHNldFRpbWVvdXQoY2hlY2tSZW5kZXJDb3VudCwgQ0hFQ0tfREVMQVkpO1xuICAgICAgICAgIH0oKSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICAvLyB0aW1lb3V0IHJlc29sdXRpb24sIHVzZWQgd2hlbiB2aXN1YWxpemF0aW9ucyBkb24ndCBoYXZlIGEgcmVuZGVyLWNvdW50IGF0dHJpYnV0ZVxuICAgICAgZnVuY3Rpb24gd2FpdEZvclJlbmRlckRlbGF5KCkge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcbiAgICAgICAgICBzZXRUaW1lb3V0KHJlc29sdmUsIHZpc0xvYWREZWxheSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHZpc0NvdW50OyBpKyspIHtcbiAgICAgICAgY29uc3QgdmlzdWFsaXphdGlvbiA9IHZpc3VhbGl6YXRpb25zW2ldO1xuICAgICAgICBjb25zdCByZW5kZXJDb3VudGVyID0gdmlzdWFsaXphdGlvbi5nZXRBdHRyaWJ1dGUoJ3JlbmRlci1jb3VudGVyJyk7XG5cbiAgICAgICAgaWYgKHJlbmRlckNvdW50ZXIgIT09ICdkaXNhYmxlZCcpIHtcbiAgICAgICAgICByZW5kZXJlZFRhc2tzLnB1c2god2FpdEZvclJlbmRlckNvdW50KHZpc3VhbGl6YXRpb24pKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZW5kZXJlZFRhc2tzLnB1c2god2FpdEZvclJlbmRlckRlbGF5KCkpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBQcm9taXNlLmFsbChyZW5kZXJlZFRhc2tzKTtcbiAgICB9XG5cbiAgICByZXR1cm4gcGguZXZhbHVhdGUobGlzdGVuRm9yQ29tcGxldGUsIGxvYWREZWxheSwgdGltZW91dCwgc2V0dGxlVGltZSk7XG4gIH0pO1xufTtcblxuZnVuY3Rpb24gZ2V0VGFyZ2V0RmlsZShpbWFnZVBhdGgpIHtcbiAgcmV0dXJuIHBhdGguam9pbihpbWFnZVBhdGgsIGBzY3JlZW5zaG90LSR7cHVpZC5nZW5lcmF0ZSgpfS5wbmdgKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNjcmVlbnNob3QocGhhbnRvbVBhdGgsIGNhcHR1cmVTZXR0aW5ncywgc2NyZWVuc2hvdFNldHRpbmdzLCBsb2dnZXIpIHtcbiAgcmV0dXJuIG5ldyBTY3JlZW5zaG90KHBoYW50b21QYXRoLCBjYXB0dXJlU2V0dGluZ3MsIHNjcmVlbnNob3RTZXR0aW5ncywgbG9nZ2VyKTtcbn07XG4iXX0=",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/screenshot.js"
      ],
      "names": [],
      "mappings": "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",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/screenshot.js",
      "sourcesContent": [
        "import path from 'path';\nimport getPort from 'get-port';\nimport Puid from 'puid';\nimport { phantom } from './phantom';\n\nconst puid = new Puid();\nconst noop = function () {};\n\nclass Screenshot {\n  constructor(phantomPath, captureSettings, screenshotSettings, logger) {\n    this.phantomPath = phantomPath;\n    this.captureSettings = captureSettings;\n    this.screenshotSettings = screenshotSettings;\n    this.logger = logger || noop;\n  }\n\n  capture(url, opts) {\n    this.logger(`fetching screenshot of ${url}`);\n    opts = Object.assign({ basePath: this.screenshotSettings.basePath }, opts);\n\n    return createPhantom(this.phantomPath, this.captureSettings, this.logger)\n    .then(ph => {\n      const filepath = getTargetFile(this.screenshotSettings.imagePath);\n\n      return loadUrl(ph, url, this.captureSettings, opts)\n      .then(() => ph.screenshot(filepath, { bounding: opts.bounding }))\n      .then(() => {\n        this.logger(`Screenshot saved to ${filepath}`);\n        return ph.destroy().then(() => filepath);\n      })\n      .catch(err => {\n        this.logger(`Screenshot failed ${err.message}`);\n        return ph.destroy().then(() => { throw err; });\n      });\n    });\n  }\n}\n\nfunction createPhantom(phantomPath, captureSettings, logger) {\n  const { timeout } = captureSettings;\n\n  return Promise.resolve(getPort())\n  .then(port => {\n    return phantom.create({\n      ignoreSSLErrors: true,\n      phantomPath: phantomPath,\n      bridgePort: port,\n      timeout,\n      logger\n    });\n  });\n}\n\nfunction loadUrl(ph, url, captureSettings, opts) {\n  const { timeout, viewport, zoom, loadDelay, settleTime } = captureSettings;\n  const waitForSelector = '.application';\n\n  return ph.open(url, {\n    headers: opts.headers,\n    waitForSelector,\n    timeout,\n    zoom,\n    viewport,\n  })\n  .then(() => {\n    return ph.evaluate(function (basePath) {\n      // inject custom CSS rules\n      function injectCSS(cssPath) {\n        const node = document.createElement('link');\n        node.rel = 'stylesheet';\n        node.href = cssPath;\n        document.getElementsByTagName('head')[0].appendChild(node);\n      };\n\n      injectCSS(basePath + '/plugins/reporting/styles/reporting-overrides.css');\n    }, opts.basePath);\n  })\n  .then(() => {\n    return ph.waitForSelector('[render-counter]');\n  })\n  .then(() => {\n    // this is run in phantom\n    function listenForComplete(visLoadDelay, visLoadTimeout, visSettleTime) {\n      // wait for visualizations to finish loading\n      const visualizations = document.querySelectorAll('[render-counter]');\n      const visCount = visualizations.length;\n      const renderedTasks = [];\n\n      // used when visualizations have a render-count attribute\n      function waitForRenderCount(visualization) {\n        return new Promise(function (resolve, reject) {\n          const CHECK_DELAY = 300;\n          const start = Date.now();\n          let lastRenderCount = 0;\n\n          (function checkRenderCount() {\n            const renderCount = parseInt(visualization.getAttribute('render-counter'));\n\n            // if the timeout has exceeded, abort and reject\n            if ((start + visLoadTimeout) < Date.now()) {\n              return reject(new Error('Visualization took too long to load'));\n            }\n\n            // vis has rendered at least once\n            if (renderCount > 0) {\n              // resolve once the current and previous render count match\n              if (renderCount === lastRenderCount) {\n                return resolve();\n              }\n\n              // if they don't match, wait for the visualization to settle and try again\n              lastRenderCount = renderCount;\n              return setTimeout(checkRenderCount, visSettleTime);\n            }\n\n            setTimeout(checkRenderCount, CHECK_DELAY);\n          }());\n        });\n      }\n\n      // timeout resolution, used when visualizations don't have a render-count attribute\n      function waitForRenderDelay() {\n        return new Promise(function (resolve) {\n          setTimeout(resolve, visLoadDelay);\n        });\n      }\n\n      for (let i = 0; i < visCount; i++) {\n        const visualization = visualizations[i];\n        const renderCounter = visualization.getAttribute('render-counter');\n\n        if (renderCounter !== 'disabled') {\n          renderedTasks.push(waitForRenderCount(visualization));\n        } else {\n          renderedTasks.push(waitForRenderDelay());\n        }\n      }\n\n      return Promise.all(renderedTasks);\n    }\n\n    return ph.evaluate(listenForComplete, loadDelay, timeout, settleTime);\n  });\n};\n\nfunction getTargetFile(imagePath) {\n  return path.join(imagePath, `screenshot-${puid.generate()}.png`);\n}\n\nexport function screenshot(phantomPath, captureSettings, screenshotSettings, logger) {\n  return new Screenshot(phantomPath, captureSettings, screenshotSettings, logger);\n};\n"
      ]
    },
    "mtime": 1491771510540
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/phantom.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "path",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "path"
              }
            ]
          },
          {
            "source": "fs",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "fs"
              }
            ]
          },
          {
            "source": "crypto",
            "imported": [
              "randomBytes"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "randomBytes",
                "local": "randomBytes"
              }
            ]
          },
          {
            "source": "bluebird",
            "imported": [
              "fromCallback"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "fromCallback",
                "local": "fromCallback"
              }
            ]
          },
          {
            "source": "@elastic/node-phantom-simple",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "driver"
              }
            ]
          },
          {
            "source": "./extract",
            "imported": [
              "unzip",
              "bunzip2"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "unzip",
                "local": "unzip"
              },
              {
                "kind": "named",
                "imported": "bunzip2",
                "local": "bunzip2"
              }
            ]
          },
          {
            "source": "./constants",
            "imported": [
              "constants"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "constants",
                "local": "constants"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "phantom"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "phantom",
              "exported": "phantom"
            }
          ]
        }
      },
      "usedHelpers": [
        "interop-require-default"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _path = require('path');\n\nvar _path2 = _interopRequireDefault(_path);\n\nvar _fs = require('fs');\n\nvar _fs2 = _interopRequireDefault(_fs);\n\nvar _crypto = require('crypto');\n\nvar _bluebird = require('bluebird');\n\nvar _elasticNodePhantomSimple = require('@elastic/node-phantom-simple');\n\nvar _elasticNodePhantomSimple2 = _interopRequireDefault(_elasticNodePhantomSimple);\n\nvar _extract = require('./extract');\n\nvar _constants = require('./constants');\n\nvar version = '2.1.1';\nvar basename = 'phantomjs-' + version;\nvar sourcePath = _path2['default'].resolve(__dirname, '..', '..', '..', '..', '.phantom');\n\nvar noop = function noop() {};\n\nvar phantom = {\n  install: function install() {\n    var installPath = arguments.length <= 0 || arguments[0] === undefined ? sourcePath : arguments[0];\n\n    return new Promise(function (resolve, reject) {\n      var phantomPackage = _getPackage(installPath);\n\n      try {\n        _fs2['default'].accessSync(phantomPackage.binary, _fs2['default'].X_OK);\n        resolve(phantomPackage);\n      } catch (accessErr) {\n        // error here means the binary does not exist, so install it\n        var phantomSource = _getPackage(sourcePath);\n        var fileType = phantomSource.ext.substring(1);\n        var filepath = phantomSource.dir + '/' + phantomSource.base;\n        var unpacker = undefined;\n\n        switch (fileType) {\n          case 'bz2':\n            unpacker = (0, _extract.bunzip2)(filepath, phantomPackage.dir);\n            break;\n          case 'zip':\n            unpacker = (0, _extract.unzip)(filepath, phantomPackage.dir);\n            break;\n          default:\n            throw new Error('Unable to unpack filetype: ' + fileType);\n        }\n\n        unpacker.then(function () {\n          try {\n            _fs2['default'].chmodSync(phantomPackage.binary, '755');\n            resolve(phantomPackage);\n          } catch (chmodErr) {\n            reject(chmodErr);\n          }\n        })['catch'](function (err) {\n          reject(err);\n        });\n      }\n    });\n  },\n\n  create: function create(options) {\n    return new Phantom(options);\n  }\n};\n\nexports.phantom = phantom;\nfunction Phantom(options) {\n  var _this = this;\n\n  var logger = options.logger || noop;\n\n  var phantomOptions = _getPhantomOptions(options);\n  var ready = (0, _bluebird.fromCallback)(function (cb) {\n    return _elasticNodePhantomSimple2['default'].create(phantomOptions, cb);\n  }).then(function (browser) {\n    if (!browser) throw new Error('Phantom driver failed to initialize');\n    _this.browser = browser;\n    return (0, _bluebird.fromCallback)(function (cb) {\n      return _this.browser.createPage(cb);\n    });\n  }).then(function (page) {\n    if (!page) throw new Error('Phantom driver failed to create the page instance');\n    _this.page = page;\n    _this.page.onConsoleMessage = function (msg) {\n      return logger(msg, ['phantomConsole']);\n    };\n  })['catch'](function (err) {\n    var message = err.toString();\n\n    if (message.includes('Phantom immediately exited with: 126')) {\n      throw new Error('Cannot execute phantom binary, incorrect format');\n    }\n\n    if (message.includes('Phantom immediately exited with: 127')) {\n      throw new Error('You must install fontconfig and freetype for Reporting to work');\n    }\n\n    throw err;\n  });\n\n  return _createPhantomInstance(ready, this, {\n    timeout: options.timeout\n  });\n}\n\nfunction _createPhantomInstance(ready, ph, phantomOptions) {\n  var validateInstance = function validateInstance() {\n    if (ph.page === false || ph.browser === false) throw new Error('Phantom instance is closed');\n  };\n\n  var configurePage = function configurePage(pageOptions) {\n    var RESOURCE_TIMEOUT = 5000;\n\n    return ready.then(function () {\n      return (0, _bluebird.fromCallback)(function (cb) {\n        return ph.page.set('resourceTimeout', RESOURCE_TIMEOUT, cb);\n      }).then(function () {\n        if (pageOptions.viewport) return (0, _bluebird.fromCallback)(function (cb) {\n          return ph.page.set('viewportSize', pageOptions.viewport, cb);\n        });\n      }).then(function () {\n        if (pageOptions.zoom) return (0, _bluebird.fromCallback)(function (cb) {\n          return ph.page.set('zoomFactor', pageOptions.zoom, cb);\n        });\n      }).then(function () {\n        if (pageOptions.headers) return (0, _bluebird.fromCallback)(function (cb) {\n          return ph.page.set('customHeaders', pageOptions.headers, cb);\n        });\n      });\n    });\n  };\n\n  return {\n    open: function open(url, pageOptions) {\n      var _this2 = this;\n\n      return ready.then(function () {\n        validateInstance();\n\n        return configurePage(pageOptions).then(function () {\n          return (0, _bluebird.fromCallback)(function (cb) {\n            return ph.page.open(url, cb);\n          });\n        }).then(function (status) {\n          if (status !== 'success') throw new Error('URL open failed. Is the server running?');\n          if (pageOptions.waitForSelector) {\n            return _this2.waitForSelector(pageOptions.waitForSelector, _constants.constants.PHANTOM_MAX_LOAD_TIMEOUT)['catch'](function (err) {\n              var message = err.message ? err.message : err.toString();\n\n              if (message.includes('Timeout exceeded')) {\n                throw new Error('Kibana took too long to load - ' + message);\n              }\n\n              throw err;\n            });\n          }\n        });\n      });\n    },\n\n    evaluate: function evaluate(fn) {\n      var _this3 = this;\n\n      for (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        args[_key - 1] = arguments[_key];\n      }\n\n      return ready.then(function () {\n        validateInstance();\n\n        var uniqId = [(0, _crypto.randomBytes)(6).toString('base64'), (0, _crypto.randomBytes)(9).toString('base64'), (0, _crypto.randomBytes)(6).toString('base64')].join('-');\n\n        return _injectPromise(ph.page).then(function () {\n          return (0, _bluebird.fromCallback)(function (cb) {\n            ph.page.evaluate(evaluateWrapper, fn.toString(), uniqId, args, cb);\n\n            // The original function is passed here as a string, and eval'd in phantom's context.\n            // It's then executed in phantom's context and the result is attached to a __reporting\n            // property on window. Promises can be used, and the result will be handled in the next\n            // block. If the original function does not return a promise, its result is passed on.\n            function evaluateWrapper(userFnStr, cbIndex, origArgs) {\n              // you can't pass a function to phantom, so we pass the string and eval back into a function\n              var userFn = undefined;\n              eval('userFn = ' + userFnStr); // eslint-disable-line no-eval\n\n              // keep a record of the resulting execution for future calls (used when async)\n              window.__reporting = window.__reporting || {};\n              window.__reporting[cbIndex] = undefined;\n\n              // used to format the response consistently\n              function done(err, res) {\n                if (window.__reporting[cbIndex]) {\n                  return;\n                }\n\n                var isErr = err instanceof Error;\n                if (isErr) {\n                  var keys = Object.getOwnPropertyNames(err);\n                  err = keys.reduce(function copyErr(obj, key) {\n                    obj[key] = err[key];\n                    return obj;\n                  }, {});\n                }\n\n                return window.__reporting[cbIndex] = {\n                  err: err,\n                  res: res\n                };\n              }\n\n              try {\n                // execute the original function\n                var res = userFn.apply(this, origArgs);\n\n                if (res && typeof res.then === 'function') {\n                  // handle async resolution via Promises\n                  res.then(function (val) {\n                    done(null, val);\n                  }, function (err) {\n                    if (!(err instanceof Error)) {\n                      err = new Error(err || 'Unspecified error');\n                    }\n                    done(err);\n                  });\n                  return '__promise__';\n                } else {\n                  // if not given a promise, execute as sync\n                  return done(null, res);\n                }\n              } catch (err) {\n                // any error during execution should be dealt with\n                return done(err);\n              }\n            }\n          }).then(function (res) {\n            // if the response is not a promise, pass it along\n            if (res !== '__promise__') {\n              return res;\n            }\n\n            // promise response means async, so wait for its resolution\n            return _this3.waitFor(function (cbIndex) {\n              // resolves when the result object is no longer undefined\n              return !!window.__reporting[cbIndex];\n            }, true, uniqId).then(function () {\n              // once the original promise is resolved, pass along its value\n              return (0, _bluebird.fromCallback)(function (cb) {\n                ph.page.evaluate(function (cbIndex) {\n                  return window.__reporting[cbIndex];\n                }, uniqId, cb);\n              });\n            });\n          }).then(function (res) {\n            if (res.err) {\n              // Make long/normal stack traces work\n              res.err.name = res.err.name || 'Error';\n\n              if (!res.err.stack) {\n                res.err.stack = res.err.toString();\n              }\n\n              res.err.stack.replace(/\\n*$/g, '\\n');\n\n              if (res.err.stack) {\n                res.err.toString = function () {\n                  return this.name + ': ' + this.message;\n                };\n              }\n\n              return Promise.reject(res.err);\n            }\n\n            return res.res;\n          });\n        });\n      });\n    },\n\n    wait: function wait(timeout) {\n      return ready.then(function () {\n        validateInstance();\n\n        return new Promise(function (resolve) {\n          return setTimeout(resolve, timeout);\n        });\n      });\n    },\n\n    waitFor: function waitFor(fn, value) {\n      for (var _len2 = arguments.length, args = Array(_len2 > 2 ? _len2 - 2 : 0), _key2 = 2; _key2 < _len2; _key2++) {\n        args[_key2 - 2] = arguments[_key2];\n      }\n\n      var _this4 = this;\n\n      return ready.then(function () {\n        validateInstance();\n\n        var timeout = phantomOptions.timeout || 10000;\n        return _this4.waitForTime.apply(_this4, [fn, value, timeout].concat(args));\n      });\n    },\n\n    waitForSelector: function waitForSelector(selector) {\n      var _this5 = this;\n\n      var timeout = arguments.length <= 1 || arguments[1] === undefined ? phantomOptions.timeout : arguments[1];\n\n      return ready.then(function () {\n        validateInstance();\n\n        return _this5.waitForTime(function (cssSelector) {\n          return !!document.querySelector(cssSelector);\n        }, true, timeout, selector);\n      });\n    },\n\n    waitForTime: function waitForTime(fn, value, timeout) {\n      for (var _len3 = arguments.length, args = Array(_len3 > 3 ? _len3 - 3 : 0), _key3 = 3; _key3 < _len3; _key3++) {\n        args[_key3 - 3] = arguments[_key3];\n      }\n\n      var _this6 = this;\n\n      var INTERVAL_TIME = 250;\n\n      if (typeof value === 'undefined') return ready.then(function () {\n        return Promise.resolve();\n      });\n      if (timeout < INTERVAL_TIME) timeout = INTERVAL_TIME;\n\n      return ready.then(function () {\n        validateInstance();\n\n        return new Promise(function (resolve, reject) {\n          var self = _this6;\n          var start = Date.now();\n\n          (function waitForCheck() {\n            if (Date.now() - start > timeout) {\n              return reject(new Error('Timeout exceeded (' + timeout + ')'));\n            }\n\n            return self.evaluate.apply(self, [fn].concat(args)).then(function (res) {\n              if (res === value) {\n                return resolve();\n              }\n\n              setTimeout(waitForCheck, INTERVAL_TIME);\n            })['catch'](function (err) {\n              reject(err);\n            });\n          })();\n        });\n      });\n    },\n\n    screenshot: function screenshot(screenshotPath, screenshotOptions) {\n\n      return ready.then(function () {\n        validateInstance();\n        function saveScreenshot() {\n          return (0, _bluebird.fromCallback)(function (cb) {\n            return ph.page.render(screenshotPath, cb);\n          });\n        }\n\n        if (!screenshotOptions.bounding) {\n          return saveScreenshot();\n        }\n\n        return (0, _bluebird.fromCallback)(function (cb) {\n          return ph.page.get('viewportSize', cb);\n        }).then(function (viewportSize) {\n          var contentOffset = Object.assign({\n            top: 90, // top chrome\n            left: 0,\n            right: 0,\n            bottom: 0\n          }, screenshotOptions.bounding);\n\n          var boundingArea = {\n            top: contentOffset.top,\n            left: contentOffset.left,\n            width: viewportSize.width - contentOffset.left - contentOffset.right,\n            height: viewportSize.height - contentOffset.top - contentOffset.bottom\n          };\n\n          return (0, _bluebird.fromCallback)(function (cb) {\n            return ph.page.get('clipRect', cb);\n          }).then(function (prevClipRect) {\n            return (0, _bluebird.fromCallback)(function (cb) {\n              return ph.page.set('clipRect', boundingArea, cb);\n            }).then(saveScreenshot).then(function () {\n              return (0, _bluebird.fromCallback)(function (cb) {\n                return ph.page.set('clipRect', prevClipRect, cb);\n              });\n            });\n          });\n        });\n      });\n    },\n\n    destroy: function destroy() {\n      return ready.then(function () {\n        validateInstance();\n\n        return (0, _bluebird.fromCallback)(function (cb) {\n          return ph.browser.exit(cb);\n        }).then(function () {\n          ph.browser = false;\n          ph.page = false;\n        });\n      });\n    }\n  };\n}\n\nfunction _getPhantomOptions() {\n  var options = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];\n\n  return {\n    parameters: {\n      'load-images': true,\n      'ssl-protocol': 'any',\n      'ignore-ssl-errors': options.ignoreSSLErrors != null ? options.ignoreSSLErrors : true\n    },\n    path: options.phantomPath || 'phantomjs',\n    bridge: { port: options.bridgePort || 0 }\n  };\n}\n\nfunction _injectPromise(page) {\n  function checkForPromise() {\n    return (0, _bluebird.fromCallback)(function (cb) {\n      page.evaluate(function hasPromise() {\n        return typeof window.Promise !== 'undefined';\n      }, cb);\n    });\n  }\n\n  return checkForPromise().then(function (hasPromise) {\n    if (hasPromise) return;\n\n    var nodeModules = _path2['default'].resolve(__dirname, '..', '..', '..', '..', 'node_modules');\n    var promisePath = _path2['default'].join(nodeModules, 'bluebird', 'js', 'browser', 'bluebird.js');\n    return (0, _bluebird.fromCallback)(function (cb) {\n      return page.injectJs(promisePath, cb);\n    }).then(function (status) {\n      if (status !== true) {\n        return Promise.reject('Failed to load Promise library');\n      }\n    }).then(checkForPromise).then(function (hasPromiseLoaded) {\n      if (hasPromiseLoaded !== true) {\n        return Promise.reject('Failed to inject Promise');\n      }\n    });\n  });\n}\n\nfunction _getPackage(installPath) {\n  // Code borrowed heavily from phantomjs's install script\n  // https://github.com/Medium/phantomjs/blob/v1.9.19/install.js\n\n  var platform = process.env.PHANTOMJS_PLATFORM || process.platform;\n  var arch = process.env.PHANTOMJS_ARCH || process.arch;\n  var suffix = undefined;\n  var binary = undefined;\n\n  if (platform === 'linux' && arch === 'x64') {\n    binary = _path2['default'].join(basename + '-linux-x86_64', 'bin', 'phantomjs');\n    suffix = 'linux-x86_64.tar.bz2';\n  } else if (platform === 'linux' && arch === 'ia32') {\n    binary = _path2['default'].join(basename + '-linux-i686', 'bin', 'phantomjs');\n    suffix = 'linux-i686.tar.bz2';\n  } else if (platform === 'darwin' || platform === 'openbsd' || platform === 'freebsd') {\n    binary = _path2['default'].join(basename + '-macosx', 'bin', 'phantomjs');\n    suffix = 'macosx.zip';\n  } else if (platform === 'win32') {\n    binary = _path2['default'].join(basename + '-windows', 'bin', 'phantomjs.exe');\n    suffix = 'windows.zip';\n  } else {\n    var msg = 'Unsupported platform: ' + platform + ' ' + arch;\n    throw new Error(msg);\n  }\n\n  var filename = basename + '-' + suffix;\n  var parsed = _path2['default'].parse(_path2['default'].join(installPath, filename));\n  parsed.binary = _path2['default'].join(installPath, binary);\n  return parsed;\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvcmVwb3J0aW5nL3NlcnZlci9saWIvcGhhbnRvbS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7OztvQkFBaUIsTUFBTTs7OztrQkFDUixJQUFJOzs7O3NCQUNTLFFBQVE7O3dCQUNQLFVBQVU7O3dDQUNwQiw4QkFBOEI7Ozs7dUJBQ2xCLFdBQVc7O3lCQUNoQixhQUFhOztBQUV2QyxJQUFNLE9BQU8sR0FBRyxPQUFPLENBQUM7QUFDeEIsSUFBTSxRQUFRLEdBQUcsWUFBWSxHQUFHLE9BQU8sQ0FBQztBQUN4QyxJQUFNLFVBQVUsR0FBRyxrQkFBSyxPQUFPLENBQUMsU0FBUyxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxVQUFVLENBQUMsQ0FBQzs7QUFFL0UsSUFBTSxJQUFJLEdBQUcsU0FBUCxJQUFJLEdBQWUsRUFBRSxDQUFDOztBQUVyQixJQUFNLE9BQU8sR0FBRztBQUNyQixTQUFPLEVBQUEsbUJBQTJCO1FBQTFCLFdBQVcseURBQUcsVUFBVTs7QUFDOUIsV0FBTyxJQUFJLE9BQU8sQ0FBQyxVQUFDLE9BQU8sRUFBRSxNQUFNLEVBQUs7QUFDdEMsVUFBTSxjQUFjLEdBQUcsV0FBVyxDQUFDLFdBQVcsQ0FBQyxDQUFDOztBQUVoRCxVQUFJO0FBQ0Ysd0JBQUcsVUFBVSxDQUFDLGNBQWMsQ0FBQyxNQUFNLEVBQUUsZ0JBQUcsSUFBSSxDQUFDLENBQUM7QUFDOUMsZUFBTyxDQUFDLGNBQWMsQ0FBQyxDQUFDO09BQ3pCLENBQUMsT0FBTyxTQUFTLEVBQUU7O0FBRWxCLFlBQU0sYUFBYSxHQUFHLFdBQVcsQ0FBQyxVQUFVLENBQUMsQ0FBQztBQUM5QyxZQUFNLFFBQVEsR0FBRyxhQUFhLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUNoRCxZQUFNLFFBQVEsR0FBRyxhQUFhLENBQUMsR0FBRyxHQUFHLEdB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SyxJQUFJLENBQUMsUUFBUSxHQUFHLFVBQVUsRUFBRSxLQUFLLEVBQUUsZUFBZSxDQUFDLENBQUM7QUFDbEUsVUFBTSxHQUFHLGFBQWEsQ0FBQztHQUN4QixNQUFNO0FBQ0wsUUFBTSxHQUFHLEdBQUcsd0JBQXdCLEdBQUcsUUFBUSxHQUFHLEdBQUcsR0FBRyxJQUFJLENBQUM7QUFDN0QsVUFBTSxJQUFJLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQztHQUN0Qjs7QUFFRCxNQUFNLFFBQVEsR0FBRyxRQUFRLEdBQUcsR0FBRyxHQUFHLE1BQU0sQ0FBQztBQUN6QyxNQUFNLE1BQU0sR0FBRyxrQkFBSyxLQUFLLENBQUMsa0JBQUssSUFBSSxDQUFDLFdBQVcsRUFBRSxRQUFRLENBQUMsQ0FBQyxDQUFDO0FBQzVELFFBQU0sQ0FBQyxNQUFNLEdBQUcsa0JBQUssSUFBSSxDQUFDLFdBQVcsRUFBRSxNQUFNLENBQUMsQ0FBQztBQUMvQyxTQUFPLE1BQU0sQ0FBQztDQUNmIiwiZmlsZSI6Ii91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvcmVwb3J0aW5nL3NlcnZlci9saWIvcGhhbnRvbS5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBwYXRoIGZyb20gJ3BhdGgnO1xuaW1wb3J0IGZzIGZyb20gJ2ZzJztcbmltcG9ydCB7IHJhbmRvbUJ5dGVzIH0gZnJvbSAnY3J5cHRvJztcbmltcG9ydCB7IGZyb21DYWxsYmFjayB9IGZyb20gJ2JsdWViaXJkJztcbmltcG9ydCBkcml2ZXIgZnJvbSAnQGVsYXN0aWMvbm9kZS1waGFudG9tLXNpbXBsZSc7XG5pbXBvcnQgeyB1bnppcCwgYnVuemlwMiB9IGZyb20gJy4vZXh0cmFjdCc7XG5pbXBvcnQgeyBjb25zdGFudHMgfSBmcm9tICcuL2NvbnN0YW50cyc7XG5cbmNvbnN0IHZlcnNpb24gPSAnMi4xLjEnO1xuY29uc3QgYmFzZW5hbWUgPSAncGhhbnRvbWpzLScgKyB2ZXJzaW9uO1xuY29uc3Qgc291cmNlUGF0aCA9IHBhdGgucmVzb2x2ZShfX2Rpcm5hbWUsICcuLicsICcuLicsICcuLicsICcuLicsICcucGhhbnRvbScpO1xuXG5jb25zdCBub29wID0gZnVuY3Rpb24gKCkge307XG5cbmV4cG9ydCBjb25zdCBwaGFudG9tID0ge1xuICBpbnN0YWxsKGluc3RhbGxQYXRoID0gc291cmNlUGF0aCkge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICBjb25zdCBwaGFudG9tUGFja2FnZSA9IF9nZXRQYWNrYWdlKGluc3RhbGxQYXRoKTtcblxuICAgICAgdHJ5IHtcbiAgICAgICAgZnMuYWNjZXNzU3luYyhwaGFudG9tUGFja2FnZS5iaW5hcnksIGZzLlhfT0spO1xuICAgICAgICByZXNvbHZlKHBoYW50b21QYWNrYWdlKTtcbiAgICAgIH0gY2F0Y2ggKGFjY2Vzc0Vycikge1xuICAgICAgICAvLyBlcnJvciBoZXJlIG1lYW5zIHRoZSBiaW5hcnkgZG9lcyBub3QgZXhpc3QsIHNvIGluc3RhbGwgaXRcbiAgICAgICAgY29uc3QgcGhhbnRvbVNvdXJjZSA9IF9nZXRQYWNrYWdlKHNvdXJjZVBhdGgpO1xuICAgICAgICBjb25zdCBmaWxlVHlwZSA9IHBoYW50b21Tb3VyY2UuZXh0LnN1YnN0cmluZygxKTtcbiAgICAgICAgY29uc3QgZmlsZXBhdGggPSBwaGFudG9tU291cmNlLmRpciArICcvJyArIHBoYW50b21Tb3VyY2UuYmFzZTtcbiAgICAgICAgbGV0IHVucGFja2VyO1xuXG4gICAgICAgIHN3aXRjaCAoZmlsZVR5cGUpIHtcbiAgICAgICAgICBjYXNlICdiejInOlxuICAgICAgICAgICAgdW5wYWNrZXIgPSBidW56aXAyKGZpbGVwYXRoLCBwaGFudG9tUGFja2FnZS5kaXIpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSAnemlwJzpcbiAgICAgICAgICAgIHVucGFja2VyID0gdW56aXAoZmlsZXBhdGgsIHBoYW50b21QYWNrYWdlLmRpcik7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbmFibGUgdG8gdW5wYWNrIGZpbGV0eXBlOiAke2ZpbGVUeXBlfWApO1xuICAgICAgICB9XG5cbiAgICAgICAgdW5wYWNrZXIudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGZzLmNobW9kU3luYyhwaGFudG9tUGFja2FnZS5iaW5hcnksICc3NTUnKTtcbiAgICAgICAgICAgIHJlc29sdmUocGhhbnRvbVBhY2thZ2UpO1xuICAgICAgICAgIH0gY2F0Y2ggKGNobW9kRXJyKSB7XG4gICAgICAgICAgICByZWplY3QoY2htb2RFcnIpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0sXG5cbiAgY3JlYXRlKG9wdGlvbnMpIHtcbiAgICByZXR1cm4gbmV3IFBoYW50b20ob3B0aW9ucyk7XG4gIH1cbn07XG5cbmZ1bmN0aW9uIFBoYW50b20ob3B0aW9ucykge1xuICBjb25zdCBsb2dnZXIgPSBvcHRpb25zLmxvZ2dlciB8fCBub29wO1xuXG4gIGNvbnN0IHBoYW50b21PcHRpb25zID0gX2dldFBoYW50b21PcHRpb25zKG9wdGlvbnMpO1xuICBjb25zdCByZWFkeSA9IGZyb21DYWxsYmFjayhjYiA9PiBkcml2ZXIuY3JlYXRlKHBoYW50b21PcHRpb25zLCBjYikpXG4gIC50aGVuKGJyb3dzZXIgPT4ge1xuICAgIGlmICghYnJvd3NlcikgdGhyb3cgbmV3IEVycm9yKCdQaGFudG9tIGRyaXZlciBmYWlsZWQgdG8gaW5pdGlhbGl6ZScpO1xuICAgIHRoaXMuYnJvd3NlciA9IGJyb3dzZXI7XG4gICAgcmV0dXJuIGZyb21DYWxsYmFjayhjYiA9PiB0aGlzLmJyb3dzZXIuY3JlYXRlUGFnZShjYikpO1xuICB9KVxuICAudGhlbihwYWdlID0+IHtcbiAgICBpZiAoIXBhZ2UpIHRocm93IG5ldyBFcnJvcignUGhhbnRvbSBkcml2ZXIgZmFpbGVkIHRvIGNyZWF0ZSB0aGUgcGFnZSBpbnN0YW5jZScpO1xuICAgIHRoaXMucGFnZSA9IHBhZ2U7XG4gICAgdGhpcy5wYWdlLm9uQ29uc29sZU1lc3NhZ2UgPSAobXNnKSA9PiBsb2dnZXIobXNnLCBbJ3BoYW50b21Db25zb2xlJ10pO1xuICB9KVxuICAuY2F0Y2goZXJyID0+IHtcbiAgICBjb25zdCBtZXNzYWdlID0gZXJyLnRvU3RyaW5nKCk7XG5cbiAgICBpZiAobWVzc2FnZS5pbmNsdWRlcygnUGhhbnRvbSBpbW1lZGlhdGVseSBleGl0ZWQgd2l0aDogMTI2JykpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignQ2Fubm90IGV4ZWN1dGUgcGhhbnRvbSBiaW5hcnksIGluY29ycmVjdCBmb3JtYXQnKTtcbiAgICB9XG5cbiAgICBpZiAobWVzc2FnZS5pbmNsdWRlcygnUGhhbnRvbSBpbW1lZGlhdGVseSBleGl0ZWQgd2l0aDogMTI3JykpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignWW91IG11c3QgaW5zdGFsbCBmb250Y29uZmlnIGFuZCBmcmVldHlwZSBmb3IgUmVwb3J0aW5nIHRvIHdvcmsnKTtcbiAgICB9XG5cbiAgICB0aHJvdyBlcnI7XG4gIH0pO1xuXG4gIHJldHVybiBfY3JlYXRlUGhhbnRvbUluc3RhbmNlKHJlYWR5LCB0aGlzLCB7XG4gICAgdGltZW91dDogb3B0aW9ucy50aW1lb3V0XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBfY3JlYXRlUGhhbnRvbUluc3RhbmNlKHJlYWR5LCBwaCwgcGhhbnRvbU9wdGlvbnMpIHtcbiAgY29uc3QgdmFsaWRhdGVJbnN0YW5jZSA9ICgpID0+IHtcbiAgICBpZiAocGgucGFnZSA9PT0gZmFsc2UgfHwgcGguYnJvd3NlciA9PT0gZmFsc2UpIHRocm93IG5ldyBFcnJvcignUGhhbnRvbSBpbnN0YW5jZSBpcyBjbG9zZWQnKTtcbiAgfTtcblxuICBjb25zdCBjb25maWd1cmVQYWdlID0gKHBhZ2VPcHRpb25zKSA9PiB7XG4gICAgY29uc3QgUkVTT1VSQ0VfVElNRU9VVCA9IDUwMDA7XG5cbiAgICByZXR1cm4gcmVhZHkudGhlbigoKSA9PiB7XG4gICAgICByZXR1cm4gZnJvbUNhbGxiYWNrKGNiID0+IHBoLnBhZ2Uuc2V0KCdyZXNvdXJjZVRpbWVvdXQnLCBSRVNPVVJDRV9USU1FT1VULCBjYikpXG4gICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgIGlmIChwYWdlT3B0aW9ucy52aWV3cG9ydCkgcmV0dXJuIGZyb21DYWxsYmFjayhjYiA9PiBwaC5wYWdlLnNldCgndmlld3BvcnRTaXplJywgcGFnZU9wdGlvbnMudmlld3BvcnQsIGNiKSk7XG4gICAgICB9KVxuICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICBpZiAocGFnZU9wdGlvbnMuem9vbSkgcmV0dXJuIGZyb21DYWxsYmFjayhjYiA9PiBwaC5wYWdlLnNldCgnem9vbUZhY3RvcicsIHBhZ2VPcHRpb25zLnpvb20sIGNiKSk7XG4gICAgICB9KVxuICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICBpZiAocGFnZU9wdGlvbnMuaGVhZGVycykgcmV0dXJuIGZyb21DYWxsYmFjayhjYiA9PiBwaC5wYWdlLnNldCgnY3VzdG9tSGVhZGVycycsIHBhZ2VPcHRpb25zLmhlYWRlcnMsIGNiKSk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfTtcblxuICByZXR1cm4ge1xuICAgIG9wZW4odXJsLCBwYWdlT3B0aW9ucykge1xuICAgICAgcmV0dXJuIHJlYWR5LnRoZW4oKCkgPT4ge1xuICAgICAgICB2YWxpZGF0ZUluc3RhbmNlKCk7XG5cbiAgICAgICAgcmV0dXJuIGNvbmZpZ3VyZVBhZ2UocGFnZU9wdGlvbnMpXG4gICAgICAgIC50aGVuKCgpID0+IGZyb21DYWxsYmFjayhjYiA9PiBwaC5wYWdlLm9wZW4odXJsLCBjYikpKVxuICAgICAgICAudGhlbihzdGF0dXMgPT4ge1xuICAgICAgICAgIGlmIChzdGF0dXMgIT09ICdzdWNjZXNzJykgdGhyb3cgbmV3IEVycm9yKCdVUkwgb3BlbiBmYWlsZWQuIElzIHRoZSBzZXJ2ZXIgcnVubmluZz8nKTtcbiAgICAgICAgICBpZiAocGFnZU9wdGlvbnMud2FpdEZvclNlbGVjdG9yKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy53YWl0Rm9yU2VsZWN0b3IocGFnZU9wdGlvbnMud2FpdEZvclNlbGVjdG9yLCBjb25zdGFudHMuUEhBTlRPTV9NQVhfTE9BRF9USU1FT1VUKVxuICAgICAgICAgICAgLmNhdGNoKGVyciA9PiB7XG4gICAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2UgPSAoZXJyLm1lc3NhZ2UpID8gZXJyLm1lc3NhZ2UgOiBlcnIudG9TdHJpbmcoKTtcblxuICAgICAgICAgICAgICBpZiAobWVzc2FnZS5pbmNsdWRlcygnVGltZW91dCBleGNlZWRlZCcpKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBLaWJhbmEgdG9vayB0b28gbG9uZyB0byBsb2FkIC0gJHttZXNzYWdlfWApO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgdGhyb3cgZXJyO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH0sXG5cbiAgICBldmFsdWF0ZShmbiwgLi4uYXJncykge1xuICAgICAgcmV0dXJuIHJlYWR5LnRoZW4oKCkgPT4ge1xuICAgICAgICB2YWxpZGF0ZUluc3RhbmNlKCk7XG5cbiAgICAgICAgY29uc3QgdW5pcUlkID0gW1xuICAgICAgICAgIHJhbmRvbUJ5dGVzKDYpLnRvU3RyaW5nKCdiYXNlNjQnKSxcbiAgICAgICAgICByYW5kb21CeXRlcyg5KS50b1N0cmluZygnYmFzZTY0JyksXG4gICAgICAgICAgcmFuZG9tQnl0ZXMoNikudG9TdHJpbmcoJ2Jhc2U2NCcpLFxuICAgICAgICBdLmpvaW4oJy0nKTtcblxuICAgICAgICByZXR1cm4gX2luamVjdFByb21pc2UocGgucGFnZSlcbiAgICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAgIHJldHVybiBmcm9tQ2FsbGJhY2soY2IgPT4ge1xuICAgICAgICAgICAgcGgucGFnZS5ldmFsdWF0ZShldmFsdWF0ZVdyYXBwZXIsIGZuLnRvU3RyaW5nKCksIHVuaXFJZCwgYXJncywgY2IpO1xuXG4gICAgICAgICAgICAvLyBUaGUgb3JpZ2luYWwgZnVuY3Rpb24gaXMgcGFzc2VkIGhlcmUgYXMgYSBzdHJpbmcsIGFuZCBldmFsJ2QgaW4gcGhhbnRvbSdzIGNvbnRleHQuXG4gICAgICAgICAgICAvLyBJdCdzIHRoZW4gZXhlY3V0ZWQgaW4gcGhhbnRvbSdzIGNvbnRleHQgYW5kIHRoZSByZXN1bHQgaXMgYXR0YWNoZWQgdG8gYSBfX3JlcG9ydGluZ1xuICAgICAgICAgICAgLy8gcHJvcGVydHkgb24gd2luZG93LiBQcm9taXNlcyBjYW4gYmUgdXNlZCwgYW5kIHRoZSByZXN1bHQgd2lsbCBiZSBoYW5kbGVkIGluIHRoZSBuZXh0XG4gICAgICAgICAgICAvLyBibG9jay4gSWYgdGhlIG9yaWdpbmFsIGZ1bmN0aW9uIGRvZXMgbm90IHJldHVybiBhIHByb21pc2UsIGl0cyByZXN1bHQgaXMgcGFzc2VkIG9uLlxuICAgICAgICAgICAgZnVuY3Rpb24gZXZhbHVhdGVXcmFwcGVyKHVzZXJGblN0ciwgY2JJbmRleCwgb3JpZ0FyZ3MpIHtcbiAgICAgICAgICAgICAgLy8geW91IGNhbid0IHBhc3MgYSBmdW5jdGlvbiB0byBwaGFudG9tLCBzbyB3ZSBwYXNzIHRoZSBzdHJpbmcgYW5kIGV2YWwgYmFjayBpbnRvIGEgZnVuY3Rpb25cbiAgICAgICAgICAgICAgbGV0IHVzZXJGbjtcbiAgICAgICAgICAgICAgZXZhbCgndXNlckZuID0gJyArIHVzZXJGblN0cik7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tZXZhbFxuXG4gICAgICAgICAgICAgIC8vIGtlZXAgYSByZWNvcmQgb2YgdGhlIHJlc3VsdGluZyBleGVjdXRpb24gZm9yIGZ1dHVyZSBjYWxscyAodXNlZCB3aGVuIGFzeW5jKVxuICAgICAgICAgICAgICB3aW5kb3cuX19yZXBvcnRpbmcgPSB3aW5kb3cuX19yZXBvcnRpbmcgfHwge307XG4gICAgICAgICAgICAgIHdpbmRvdy5fX3JlcG9ydGluZ1tjYkluZGV4XSA9IHVuZGVmaW5lZDtcblxuICAgICAgICAgICAgICAvLyB1c2VkIHRvIGZvcm1hdCB0aGUgcmVzcG9uc2UgY29uc2lzdGVudGx5XG4gICAgICAgICAgICAgIGZ1bmN0aW9uIGRvbmUoZXJyLCByZXMpIHtcbiAgICAgICAgICAgICAgICBpZiAod2luZG93Ll9fcmVwb3J0aW5nW2NiSW5kZXhdKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgY29uc3QgaXNFcnIgPSBlcnIgaW5zdGFuY2VvZiBFcnJvcjtcbiAgICAgICAgICAgICAgICBpZiAoaXNFcnIpIHtcbiAgICAgICAgICAgICAgICAgIGNvbnN0IGtleXMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhlcnIpO1xuICAgICAgICAgICAgICAgICAgZXJyID0ga2V5cy5yZWR1Y2UoZnVuY3Rpb24gY29weUVycihvYmosIGtleSkge1xuICAgICAgICAgICAgICAgICAgICBvYmpba2V5XSA9IGVycltrZXldO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gb2JqO1xuICAgICAgICAgICAgICAgICAgfSwge30pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiB3aW5kb3cuX19yZXBvcnRpbmdbY2JJbmRleF0gPSB7XG4gICAgICAgICAgICAgICAgICBlcnI6IGVycixcbiAgICAgICAgICAgICAgICAgIHJlczogcmVzLFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIC8vIGV4ZWN1dGUgdGhlIG9yaWdpbmFsIGZ1bmN0aW9uXG4gICAgICAgICAgICAgICAgY29uc3QgcmVzID0gdXNlckZuLmFwcGx5KHRoaXMsIG9yaWdBcmdzKTtcblxuICAgICAgICAgICAgICAgIGlmIChyZXMgJiYgdHlwZW9mIHJlcy50aGVuID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgICAvLyBoYW5kbGUgYXN5bmMgcmVzb2x1dGlvbiB2aWEgUHJvbWlzZXNcbiAgICAgICAgICAgICAgICAgIHJlcy50aGVuKCh2YWwpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgZG9uZShudWxsLCB2YWwpO1xuICAgICAgICAgICAgICAgICAgfSwgKGVycikgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIShlcnIgaW5zdGFuY2VvZiBFcnJvcikpIHtcbiAgICAgICAgICAgICAgICAgICAgICBlcnIgPSBuZXcgRXJyb3IoZXJyIHx8ICdVbnNwZWNpZmllZCBlcnJvcicpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGRvbmUoZXJyKTtcbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgcmV0dXJuICdfX3Byb21pc2VfXyc7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIC8vIGlmIG5vdCBnaXZlbiBhIHByb21pc2UsIGV4ZWN1dGUgYXMgc3luY1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGRvbmUobnVsbCwgcmVzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgICAgIC8vIGFueSBlcnJvciBkdXJpbmcgZXhlY3V0aW9uIHNob3VsZCBiZSBkZWFsdCB3aXRoXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRvbmUoZXJyKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pXG4gICAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICAgICAgLy8gaWYgdGhlIHJlc3BvbnNlIGlzIG5vdCBhIHByb21pc2UsIHBhc3MgaXQgYWxvbmdcbiAgICAgICAgICAgIGlmIChyZXMgIT09ICdfX3Byb21pc2VfXycpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gcHJvbWlzZSByZXNwb25zZSBtZWFucyBhc3luYywgc28gd2FpdCBmb3IgaXRzIHJlc29sdXRpb25cbiAgICAgICAgICAgIHJldHVybiB0aGlzLndhaXRGb3IoZnVuY3Rpb24gKGNiSW5kZXgpIHtcbiAgICAgICAgICAgICAgLy8gcmVzb2x2ZXMgd2hlbiB0aGUgcmVzdWx0IG9iamVjdCBpcyBubyBsb25nZXIgdW5kZWZpbmVkXG4gICAgICAgICAgICAgIHJldHVybiAhIXdpbmRvdy5fX3JlcG9ydGluZ1tjYkluZGV4XTtcbiAgICAgICAgICAgIH0sIHRydWUsIHVuaXFJZClcbiAgICAgICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgLy8gb25jZSB0aGUgb3JpZ2luYWwgcHJvbWlzZSBpcyByZXNvbHZlZCwgcGFzcyBhbG9uZyBpdHMgdmFsdWVcbiAgICAgICAgICAgICAgcmV0dXJuIGZyb21DYWxsYmFjayhjYiA9PiB7XG4gICAgICAgICAgICAgICAgcGgucGFnZS5ldmFsdWF0ZShmdW5jdGlvbiAoY2JJbmRleCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIHdpbmRvdy5fX3JlcG9ydGluZ1tjYkluZGV4XTtcbiAgICAgICAgICAgICAgICB9LCB1bmlxSWQsIGNiKTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9KVxuICAgICAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICAgIGlmIChyZXMuZXJyKSB7XG4gICAgICAgICAgICAgIC8vIE1ha2UgbG9uZy9ub3JtYWwgc3RhY2sgdHJhY2VzIHdvcmtcbiAgICAgICAgICAgICAgcmVzLmVyci5uYW1lID0gcmVzLmVyci5uYW1lIHx8ICdFcnJvcic7XG5cbiAgICAgICAgICAgICAgaWYgKCFyZXMuZXJyLnN0YWNrKSB7XG4gICAgICAgICAgICAgICAgcmVzLmVyci5zdGFjayA9IHJlcy5lcnIudG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIHJlcy5lcnIuc3RhY2sucmVwbGFjZSgvXFxuKiQvZywgJ1xcbicpO1xuXG4gICAgICAgICAgICAgIGlmIChyZXMuZXJyLnN0YWNrKSB7XG4gICAgICAgICAgICAgICAgcmVzLmVyci50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLm5hbWUgKyAnOiAnICsgdGhpcy5tZXNzYWdlO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QocmVzLmVycik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiByZXMucmVzO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH0sXG5cbiAgICB3YWl0KHRpbWVvdXQpIHtcbiAgICAgIHJldHVybiByZWFkeS50aGVuKCgpID0+IHtcbiAgICAgICAgdmFsaWRhdGVJbnN0YW5jZSgpO1xuXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgdGltZW91dCkpO1xuICAgICAgfSk7XG4gICAgfSxcblxuICAgIHdhaXRGb3IoZm4sIHZhbHVlLCAuLi5hcmdzKSB7XG4gICAgICByZXR1cm4gcmVhZHkudGhlbigoKSA9PiB7XG4gICAgICAgIHZhbGlkYXRlSW5zdGFuY2UoKTtcblxuICAgICAgICBjb25zdCB0aW1lb3V0ID0gcGhhbnRvbU9wdGlvbnMudGltZW91dCB8fCAxMDAwMDtcbiAgICAgICAgcmV0dXJuIHRoaXMud2FpdEZvclRpbWUoZm4sIHZhbHVlLCB0aW1lb3V0LCAuLi5hcmdzKTtcbiAgICAgIH0pO1xuICAgIH0sXG5cbiAgICB3YWl0Rm9yU2VsZWN0b3Ioc2VsZWN0b3IsIHRpbWVvdXQgPSBwaGFudG9tT3B0aW9ucy50aW1lb3V0KSB7XG4gICAgICByZXR1cm4gcmVhZHkudGhlbigoKSA9PiB7XG4gICAgICAgIHZhbGlkYXRlSW5zdGFuY2UoKTtcblxuICAgICAgICByZXR1cm4gdGhpcy53YWl0Rm9yVGltZShmdW5jdGlvbiAoY3NzU2VsZWN0b3IpIHtcbiAgICAgICAgICByZXR1cm4gISFkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNzc1NlbGVjdG9yKTtcbiAgICAgICAgfSwgdHJ1ZSwgdGltZW91dCwgc2VsZWN0b3IpO1xuICAgICAgfSk7XG4gICAgfSxcblxuICAgIHdhaXRGb3JUaW1lKGZuLCB2YWx1ZSwgdGltZW91dCwgLi4uYXJncykge1xuICAgICAgY29uc3QgSU5URVJWQUxfVElNRSA9IDI1MDtcblxuICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3VuZGVmaW5lZCcpIHJldHVybiByZWFkeS50aGVuKCgpID0+IFByb21pc2UucmVzb2x2ZSgpKTtcbiAgICAgIGlmICh0aW1lb3V0IDwgSU5URVJWQUxfVElNRSkgdGltZW91dCA9IElOVEVSVkFMX1RJTUU7XG5cbiAgICAgIHJldHVybiByZWFkeS50aGVuKCgpID0+IHtcbiAgICAgICAgdmFsaWRhdGVJbnN0YW5jZSgpO1xuXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG4gICAgICAgICAgY29uc3Qgc3RhcnQgPSBEYXRlLm5vdygpO1xuXG4gICAgICAgICAgKGZ1bmN0aW9uIHdhaXRGb3JDaGVjaygpIHtcbiAgICAgICAgICAgIGlmICgoRGF0ZS5ub3coKSAtIHN0YXJ0KSA+IHRpbWVvdXQpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHJlamVjdChuZXcgRXJyb3IoYFRpbWVvdXQgZXhjZWVkZWQgKCR7dGltZW91dH0pYCkpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gc2VsZi5ldmFsdWF0ZShmbiwgLi4uYXJncylcbiAgICAgICAgICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgICAgICAgIGlmIChyZXMgPT09IHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc29sdmUoKTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIHNldFRpbWVvdXQod2FpdEZvckNoZWNrLCBJTlRFUlZBTF9USU1FKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuY2F0Y2goZXJyID0+IHtcbiAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9KCkpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH0sXG5cbiAgICBzY3JlZW5zaG90KHNjcmVlbnNob3RQYXRoLCBzY3JlZW5zaG90T3B0aW9ucykge1xuXG4gICAgICByZXR1cm4gcmVhZHkudGhlbigoKSA9PiB7XG4gICAgICAgIHZhbGlkYXRlSW5zdGFuY2UoKTtcbiAgICAgICAgZnVuY3Rpb24gc2F2ZVNjcmVlbnNob3QoKSB7XG4gICAgICAgICAgcmV0dXJuIGZyb21DYWxsYmFjayhjYiA9PiBwaC5wYWdlLnJlbmRlcihzY3JlZW5zaG90UGF0aCwgY2IpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghc2NyZWVuc2hvdE9wdGlvbnMuYm91bmRpbmcpIHtcbiAgICAgICAgICByZXR1cm4gc2F2ZVNjcmVlbnNob3QoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBmcm9tQ2FsbGJhY2soY2IgPT4gcGgucGFnZS5nZXQoJ3ZpZXdwb3J0U2l6ZScsIGNiKSlcbiAgICAgICAgLnRoZW4odmlld3BvcnRTaXplID0+IHtcbiAgICAgICAgICBjb25zdCBjb250ZW50T2Zmc2V0ID0gT2JqZWN0LmFzc2lnbih7XG4gICAgICAgICAgICB0b3A6IDkwLCAvLyB0b3AgY2hyb21lXG4gICAgICAgICAgICBsZWZ0OiAwLFxuICAgICAgICAgICAgcmlnaHQ6IDAsXG4gICAgICAgICAgICBib3R0b206IDAsXG4gICAgICAgICAgfSwgc2NyZWVuc2hvdE9wdGlvbnMuYm91bmRpbmcpO1xuXG4gICAgICAgICAgY29uc3QgYm91bmRpbmdBcmVhID0ge1xuICAgICAgICAgICAgdG9wOiBjb250ZW50T2Zmc2V0LnRvcCxcbiAgICAgICAgICAgIGxlZnQ6IGNvbnRlbnRPZmZzZXQubGVmdCxcbiAgICAgICAgICAgIHdpZHRoOiB2aWV3cG9ydFNpemUud2lkdGggLSBjb250ZW50T2Zmc2V0LmxlZnQgLSBjb250ZW50T2Zmc2V0LnJpZ2h0LFxuICAgICAgICAgICAgaGVpZ2h0OiB2aWV3cG9ydFNpemUuaGVpZ2h0IC0gY29udGVudE9mZnNldC50b3AgLSBjb250ZW50T2Zmc2V0LmJvdHRvbSxcbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgcmV0dXJuIGZyb21DYWxsYmFjayhjYiA9PiBwaC5wYWdlLmdldCgnY2xpcFJlY3QnLCBjYikpXG4gICAgICAgICAgLnRoZW4ocHJldkNsaXBSZWN0ID0+IHtcbiAgICAgICAgICAgIHJldHVybiBmcm9tQ2FsbGJhY2soY2IgPT4gcGgucGFnZS5zZXQoJ2NsaXBSZWN0JywgYm91bmRpbmdBcmVhLCBjYikpXG4gICAgICAgICAgICAudGhlbihzYXZlU2NyZWVuc2hvdClcbiAgICAgICAgICAgIC50aGVuKCgpID0+IGZyb21DYWxsYmFjayhjYiA9PiBwaC5wYWdlLnNldCgnY2xpcFJlY3QnLCBwcmV2Q2xpcFJlY3QsIGNiKSkpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH0sXG5cbiAgICBkZXN0cm95KCkge1xuICAgICAgcmV0dXJuIHJlYWR5LnRoZW4oKCkgPT4ge1xuICAgICAgICB2YWxpZGF0ZUluc3RhbmNlKCk7XG5cbiAgICAgICAgcmV0dXJuIGZyb21DYWxsYmFjayhjYiA9PiBwaC5icm93c2VyLmV4aXQoY2IpKVxuICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgcGguYnJvd3NlciA9IGZhbHNlO1xuICAgICAgICAgIHBoLnBhZ2UgPSBmYWxzZTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9XG4gIH07XG59XG5cbmZ1bmN0aW9uIF9nZXRQaGFudG9tT3B0aW9ucyhvcHRpb25zID0ge30pIHtcbiAgcmV0dXJuIHtcbiAgICBwYXJhbWV0ZXJzOiB7XG4gICAgICAnbG9hZC1pbWFnZXMnOiB0cnVlLFxuICAgICAgJ3NzbC1wcm90b2NvbCc6ICdhbnknLFxuICAgICAgJ2lnbm9yZS1zc2wtZXJyb3JzJzogKG9wdGlvbnMuaWdub3JlU1NMRXJyb3JzICE9IG51bGwpID8gb3B0aW9ucy5pZ25vcmVTU0xFcnJvcnMgOiB0cnVlLFxuICAgIH0sXG4gICAgcGF0aDogb3B0aW9ucy5waGFudG9tUGF0aCB8fCAncGhhbnRvbWpzJyxcbiAgICBicmlkZ2U6IHsgcG9ydDogb3B0aW9ucy5icmlkZ2VQb3J0IHx8IDAgfSxcbiAgfTtcbn1cblxuZnVuY3Rpb24gX2luamVjdFByb21pc2UocGFnZSkge1xuICBmdW5jdGlvbiBjaGVja0ZvclByb21pc2UoKSB7XG4gICAgcmV0dXJuIGZyb21DYWxsYmFjayhjYiA9PiB7XG4gICAgICBwYWdlLmV2YWx1YXRlKGZ1bmN0aW9uIGhhc1Byb21pc2UoKSB7XG4gICAgICAgIHJldHVybiAodHlwZW9mIHdpbmRvdy5Qcm9taXNlICE9PSAndW5kZWZpbmVkJyk7XG4gICAgICB9LCBjYik7XG4gICAgfSk7XG4gIH1cblxuICByZXR1cm4gY2hlY2tGb3JQcm9taXNlKClcbiAgLnRoZW4oaGFzUHJvbWlzZSA9PiB7XG4gICAgaWYgKGhhc1Byb21pc2UpIHJldHVybjtcblxuICAgIGNvbnN0IG5vZGVNb2R1bGVzID0gcGF0aC5yZXNvbHZlKF9fZGlybmFtZSwgJy4uJywgJy4uJywgJy4uJywgJy4uJywgJ25vZGVfbW9kdWxlcycpO1xuICAgIGNvbnN0IHByb21pc2VQYXRoID0gcGF0aC5qb2luKG5vZGVNb2R1bGVzLCAnYmx1ZWJpcmQnLCAnanMnLCAnYnJvd3NlcicsICdibHVlYmlyZC5qcycpO1xuICAgIHJldHVybiBmcm9tQ2FsbGJhY2soY2IgPT4gcGFnZS5pbmplY3RKcyhwcm9taXNlUGF0aCwgY2IpKVxuICAgIC50aGVuKHN0YXR1cyA9PiB7XG4gICAgICBpZiAoc3RhdHVzICE9PSB0cnVlKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdCgnRmFpbGVkIHRvIGxvYWQgUHJvbWlzZSBsaWJyYXJ5Jyk7XG4gICAgICB9XG4gICAgfSlcbiAgICAudGhlbihjaGVja0ZvclByb21pc2UpXG4gICAgLnRoZW4oaGFzUHJvbWlzZUxvYWRlZCA9PiB7XG4gICAgICBpZiAoaGFzUHJvbWlzZUxvYWRlZCAhPT0gdHJ1ZSkge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoJ0ZhaWxlZCB0byBpbmplY3QgUHJvbWlzZScpO1xuICAgICAgfVxuICAgIH0pO1xuICB9KTtcbn1cblxuZnVuY3Rpb24gX2dldFBhY2thZ2UoaW5zdGFsbFBhdGgpIHtcbiAgLy8gQ29kZSBib3Jyb3dlZCBoZWF2aWx5IGZyb20gcGhhbnRvbWpzJ3MgaW5zdGFsbCBzY3JpcHRcbiAgLy8gaHR0cHM6Ly9naXRodWIuY29tL01lZGl1bS9waGFudG9tanMvYmxvYi92MS45LjE5L2luc3RhbGwuanNcblxuICBjb25zdCBwbGF0Zm9ybSA9IHByb2Nlc3MuZW52LlBIQU5UT01KU19QTEFURk9STSB8fCBwcm9jZXNzLnBsYXRmb3JtO1xuICBjb25zdCBhcmNoID0gcHJvY2Vzcy5lbnYuUEhBTlRPTUpTX0FSQ0ggfHwgcHJvY2Vzcy5hcmNoO1xuICBsZXQgc3VmZml4O1xuICBsZXQgYmluYXJ5O1xuXG4gIGlmIChwbGF0Zm9ybSA9PT0gJ2xpbnV4JyAmJiBhcmNoID09PSAneDY0Jykge1xuICAgIGJpbmFyeSA9IHBhdGguam9pbihiYXNlbmFtZSArICctbGludXgteDg2XzY0JywgJ2JpbicsICdwaGFudG9tanMnKTtcbiAgICBzdWZmaXggPSAnbGludXgteDg2XzY0LnRhci5iejInO1xuICB9IGVsc2UgaWYgKHBsYXRmb3JtID09PSAnbGludXgnICYmIGFyY2ggPT09ICdpYTMyJykge1xuICAgIGJpbmFyeSA9IHBhdGguam9pbihiYXNlbmFtZSArICctbGludXgtaTY4NicsICdiaW4nLCAncGhhbnRvbWpzJyk7XG4gICAgc3VmZml4ID0gJ2xpbnV4LWk2ODYudGFyLmJ6Mic7XG4gIH0gZWxzZSBpZiAocGxhdGZvcm0gPT09ICdkYXJ3aW4nIHx8IHBsYXRmb3JtID09PSAnb3BlbmJzZCcgfHwgcGxhdGZvcm0gPT09ICdmcmVlYnNkJykge1xuICAgIGJpbmFyeSA9IHBhdGguam9pbihiYXNlbmFtZSArICctbWFjb3N4JywgJ2JpbicsICdwaGFudG9tanMnKTtcbiAgICBzdWZmaXggPSAnbWFjb3N4LnppcCc7XG4gIH0gZWxzZSBpZiAocGxhdGZvcm0gPT09ICd3aW4zMicpIHtcbiAgICBiaW5hcnkgPSBwYXRoLmpvaW4oYmFzZW5hbWUgKyAnLXdpbmRvd3MnLCAnYmluJywgJ3BoYW50b21qcy5leGUnKTtcbiAgICBzdWZmaXggPSAnd2luZG93cy56aXAnO1xuICB9IGVsc2Uge1xuICAgIGNvbnN0IG1zZyA9ICdVbnN1cHBvcnRlZCBwbGF0Zm9ybTogJyArIHBsYXRmb3JtICsgJyAnICsgYXJjaDtcbiAgICB0aHJvdyBuZXcgRXJyb3IobXNnKTtcbiAgfVxuXG4gIGNvbnN0IGZpbGVuYW1lID0gYmFzZW5hbWUgKyAnLScgKyBzdWZmaXg7XG4gIGNvbnN0IHBhcnNlZCA9IHBhdGgucGFyc2UocGF0aC5qb2luKGluc3RhbGxQYXRoLCBmaWxlbmFtZSkpO1xuICBwYXJzZWQuYmluYXJ5ID0gcGF0aC5qb2luKGluc3RhbGxQYXRoLCBiaW5hcnkpO1xuICByZXR1cm4gcGFyc2VkO1xufVxuIl19",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/phantom.js"
      ],
      "names": [],
      "mappings": "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",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/phantom.js",
      "sourcesContent": [
        "import path from 'path';\nimport fs from 'fs';\nimport { randomBytes } from 'crypto';\nimport { fromCallback } from 'bluebird';\nimport driver from '@elastic/node-phantom-simple';\nimport { unzip, bunzip2 } from './extract';\nimport { constants } from './constants';\n\nconst version = '2.1.1';\nconst basename = 'phantomjs-' + version;\nconst sourcePath = path.resolve(__dirname, '..', '..', '..', '..', '.phantom');\n\nconst noop = function () {};\n\nexport const phantom = {\n  install(installPath = sourcePath) {\n    return new Promise((resolve, reject) => {\n      const phantomPackage = _getPackage(installPath);\n\n      try {\n        fs.accessSync(phantomPackage.binary, fs.X_OK);\n        resolve(phantomPackage);\n      } catch (accessErr) {\n        // error here means the binary does not exist, so install it\n        const phantomSource = _getPackage(sourcePath);\n        const fileType = phantomSource.ext.substring(1);\n        const filepath = phantomSource.dir + '/' + phantomSource.base;\n        let unpacker;\n\n        switch (fileType) {\n          case 'bz2':\n            unpacker = bunzip2(filepath, phantomPackage.dir);\n            break;\n          case 'zip':\n            unpacker = unzip(filepath, phantomPackage.dir);\n            break;\n          default:\n            throw new Error(`Unable to unpack filetype: ${fileType}`);\n        }\n\n        unpacker.then(function () {\n          try {\n            fs.chmodSync(phantomPackage.binary, '755');\n            resolve(phantomPackage);\n          } catch (chmodErr) {\n            reject(chmodErr);\n          }\n        })\n        .catch(function (err) {\n          reject(err);\n        });\n      }\n    });\n  },\n\n  create(options) {\n    return new Phantom(options);\n  }\n};\n\nfunction Phantom(options) {\n  const logger = options.logger || noop;\n\n  const phantomOptions = _getPhantomOptions(options);\n  const ready = fromCallback(cb => driver.create(phantomOptions, cb))\n  .then(browser => {\n    if (!browser) throw new Error('Phantom driver failed to initialize');\n    this.browser = browser;\n    return fromCallback(cb => this.browser.createPage(cb));\n  })\n  .then(page => {\n    if (!page) throw new Error('Phantom driver failed to create the page instance');\n    this.page = page;\n    this.page.onConsoleMessage = (msg) => logger(msg, ['phantomConsole']);\n  })\n  .catch(err => {\n    const message = err.toString();\n\n    if (message.includes('Phantom immediately exited with: 126')) {\n      throw new Error('Cannot execute phantom binary, incorrect format');\n    }\n\n    if (message.includes('Phantom immediately exited with: 127')) {\n      throw new Error('You must install fontconfig and freetype for Reporting to work');\n    }\n\n    throw err;\n  });\n\n  return _createPhantomInstance(ready, this, {\n    timeout: options.timeout\n  });\n}\n\nfunction _createPhantomInstance(ready, ph, phantomOptions) {\n  const validateInstance = () => {\n    if (ph.page === false || ph.browser === false) throw new Error('Phantom instance is closed');\n  };\n\n  const configurePage = (pageOptions) => {\n    const RESOURCE_TIMEOUT = 5000;\n\n    return ready.then(() => {\n      return fromCallback(cb => ph.page.set('resourceTimeout', RESOURCE_TIMEOUT, cb))\n      .then(() => {\n        if (pageOptions.viewport) return fromCallback(cb => ph.page.set('viewportSize', pageOptions.viewport, cb));\n      })\n      .then(() => {\n        if (pageOptions.zoom) return fromCallback(cb => ph.page.set('zoomFactor', pageOptions.zoom, cb));\n      })\n      .then(() => {\n        if (pageOptions.headers) return fromCallback(cb => ph.page.set('customHeaders', pageOptions.headers, cb));\n      });\n    });\n  };\n\n  return {\n    open(url, pageOptions) {\n      return ready.then(() => {\n        validateInstance();\n\n        return configurePage(pageOptions)\n        .then(() => fromCallback(cb => ph.page.open(url, cb)))\n        .then(status => {\n          if (status !== 'success') throw new Error('URL open failed. Is the server running?');\n          if (pageOptions.waitForSelector) {\n            return this.waitForSelector(pageOptions.waitForSelector, constants.PHANTOM_MAX_LOAD_TIMEOUT)\n            .catch(err => {\n              const message = (err.message) ? err.message : err.toString();\n\n              if (message.includes('Timeout exceeded')) {\n                throw new Error(`Kibana took too long to load - ${message}`);\n              }\n\n              throw err;\n            });\n          }\n        });\n      });\n    },\n\n    evaluate(fn, ...args) {\n      return ready.then(() => {\n        validateInstance();\n\n        const uniqId = [\n          randomBytes(6).toString('base64'),\n          randomBytes(9).toString('base64'),\n          randomBytes(6).toString('base64'),\n        ].join('-');\n\n        return _injectPromise(ph.page)\n        .then(() => {\n          return fromCallback(cb => {\n            ph.page.evaluate(evaluateWrapper, fn.toString(), uniqId, args, cb);\n\n            // The original function is passed here as a string, and eval'd in phantom's context.\n            // It's then executed in phantom's context and the result is attached to a __reporting\n            // property on window. Promises can be used, and the result will be handled in the next\n            // block. If the original function does not return a promise, its result is passed on.\n            function evaluateWrapper(userFnStr, cbIndex, origArgs) {\n              // you can't pass a function to phantom, so we pass the string and eval back into a function\n              let userFn;\n              eval('userFn = ' + userFnStr); // eslint-disable-line no-eval\n\n              // keep a record of the resulting execution for future calls (used when async)\n              window.__reporting = window.__reporting || {};\n              window.__reporting[cbIndex] = undefined;\n\n              // used to format the response consistently\n              function done(err, res) {\n                if (window.__reporting[cbIndex]) {\n                  return;\n                }\n\n                const isErr = err instanceof Error;\n                if (isErr) {\n                  const keys = Object.getOwnPropertyNames(err);\n                  err = keys.reduce(function copyErr(obj, key) {\n                    obj[key] = err[key];\n                    return obj;\n                  }, {});\n                }\n\n                return window.__reporting[cbIndex] = {\n                  err: err,\n                  res: res,\n                };\n              }\n\n              try {\n                // execute the original function\n                const res = userFn.apply(this, origArgs);\n\n                if (res && typeof res.then === 'function') {\n                  // handle async resolution via Promises\n                  res.then((val) => {\n                    done(null, val);\n                  }, (err) => {\n                    if (!(err instanceof Error)) {\n                      err = new Error(err || 'Unspecified error');\n                    }\n                    done(err);\n                  });\n                  return '__promise__';\n                } else {\n                  // if not given a promise, execute as sync\n                  return done(null, res);\n                }\n              } catch (err) {\n                // any error during execution should be dealt with\n                return done(err);\n              }\n            }\n          })\n          .then((res) => {\n            // if the response is not a promise, pass it along\n            if (res !== '__promise__') {\n              return res;\n            }\n\n            // promise response means async, so wait for its resolution\n            return this.waitFor(function (cbIndex) {\n              // resolves when the result object is no longer undefined\n              return !!window.__reporting[cbIndex];\n            }, true, uniqId)\n            .then(() => {\n              // once the original promise is resolved, pass along its value\n              return fromCallback(cb => {\n                ph.page.evaluate(function (cbIndex) {\n                  return window.__reporting[cbIndex];\n                }, uniqId, cb);\n              });\n            });\n          })\n          .then((res) => {\n            if (res.err) {\n              // Make long/normal stack traces work\n              res.err.name = res.err.name || 'Error';\n\n              if (!res.err.stack) {\n                res.err.stack = res.err.toString();\n              }\n\n              res.err.stack.replace(/\\n*$/g, '\\n');\n\n              if (res.err.stack) {\n                res.err.toString = function () {\n                  return this.name + ': ' + this.message;\n                };\n              }\n\n              return Promise.reject(res.err);\n            }\n\n            return res.res;\n          });\n        });\n      });\n    },\n\n    wait(timeout) {\n      return ready.then(() => {\n        validateInstance();\n\n        return new Promise(resolve => setTimeout(resolve, timeout));\n      });\n    },\n\n    waitFor(fn, value, ...args) {\n      return ready.then(() => {\n        validateInstance();\n\n        const timeout = phantomOptions.timeout || 10000;\n        return this.waitForTime(fn, value, timeout, ...args);\n      });\n    },\n\n    waitForSelector(selector, timeout = phantomOptions.timeout) {\n      return ready.then(() => {\n        validateInstance();\n\n        return this.waitForTime(function (cssSelector) {\n          return !!document.querySelector(cssSelector);\n        }, true, timeout, selector);\n      });\n    },\n\n    waitForTime(fn, value, timeout, ...args) {\n      const INTERVAL_TIME = 250;\n\n      if (typeof value === 'undefined') return ready.then(() => Promise.resolve());\n      if (timeout < INTERVAL_TIME) timeout = INTERVAL_TIME;\n\n      return ready.then(() => {\n        validateInstance();\n\n        return new Promise((resolve, reject) => {\n          const self = this;\n          const start = Date.now();\n\n          (function waitForCheck() {\n            if ((Date.now() - start) > timeout) {\n              return reject(new Error(`Timeout exceeded (${timeout})`));\n            }\n\n            return self.evaluate(fn, ...args)\n            .then(res => {\n              if (res === value) {\n                return resolve();\n              }\n\n              setTimeout(waitForCheck, INTERVAL_TIME);\n            })\n            .catch(err => {\n              reject(err);\n            });\n          }());\n        });\n      });\n    },\n\n    screenshot(screenshotPath, screenshotOptions) {\n\n      return ready.then(() => {\n        validateInstance();\n        function saveScreenshot() {\n          return fromCallback(cb => ph.page.render(screenshotPath, cb));\n        }\n\n        if (!screenshotOptions.bounding) {\n          return saveScreenshot();\n        }\n\n        return fromCallback(cb => ph.page.get('viewportSize', cb))\n        .then(viewportSize => {\n          const contentOffset = Object.assign({\n            top: 90, // top chrome\n            left: 0,\n            right: 0,\n            bottom: 0,\n          }, screenshotOptions.bounding);\n\n          const boundingArea = {\n            top: contentOffset.top,\n            left: contentOffset.left,\n            width: viewportSize.width - contentOffset.left - contentOffset.right,\n            height: viewportSize.height - contentOffset.top - contentOffset.bottom,\n          };\n\n          return fromCallback(cb => ph.page.get('clipRect', cb))\n          .then(prevClipRect => {\n            return fromCallback(cb => ph.page.set('clipRect', boundingArea, cb))\n            .then(saveScreenshot)\n            .then(() => fromCallback(cb => ph.page.set('clipRect', prevClipRect, cb)));\n          });\n        });\n      });\n    },\n\n    destroy() {\n      return ready.then(() => {\n        validateInstance();\n\n        return fromCallback(cb => ph.browser.exit(cb))\n        .then(() => {\n          ph.browser = false;\n          ph.page = false;\n        });\n      });\n    }\n  };\n}\n\nfunction _getPhantomOptions(options = {}) {\n  return {\n    parameters: {\n      'load-images': true,\n      'ssl-protocol': 'any',\n      'ignore-ssl-errors': (options.ignoreSSLErrors != null) ? options.ignoreSSLErrors : true,\n    },\n    path: options.phantomPath || 'phantomjs',\n    bridge: { port: options.bridgePort || 0 },\n  };\n}\n\nfunction _injectPromise(page) {\n  function checkForPromise() {\n    return fromCallback(cb => {\n      page.evaluate(function hasPromise() {\n        return (typeof window.Promise !== 'undefined');\n      }, cb);\n    });\n  }\n\n  return checkForPromise()\n  .then(hasPromise => {\n    if (hasPromise) return;\n\n    const nodeModules = path.resolve(__dirname, '..', '..', '..', '..', 'node_modules');\n    const promisePath = path.join(nodeModules, 'bluebird', 'js', 'browser', 'bluebird.js');\n    return fromCallback(cb => page.injectJs(promisePath, cb))\n    .then(status => {\n      if (status !== true) {\n        return Promise.reject('Failed to load Promise library');\n      }\n    })\n    .then(checkForPromise)\n    .then(hasPromiseLoaded => {\n      if (hasPromiseLoaded !== true) {\n        return Promise.reject('Failed to inject Promise');\n      }\n    });\n  });\n}\n\nfunction _getPackage(installPath) {\n  // Code borrowed heavily from phantomjs's install script\n  // https://github.com/Medium/phantomjs/blob/v1.9.19/install.js\n\n  const platform = process.env.PHANTOMJS_PLATFORM || process.platform;\n  const arch = process.env.PHANTOMJS_ARCH || process.arch;\n  let suffix;\n  let binary;\n\n  if (platform === 'linux' && arch === 'x64') {\n    binary = path.join(basename + '-linux-x86_64', 'bin', 'phantomjs');\n    suffix = 'linux-x86_64.tar.bz2';\n  } else if (platform === 'linux' && arch === 'ia32') {\n    binary = path.join(basename + '-linux-i686', 'bin', 'phantomjs');\n    suffix = 'linux-i686.tar.bz2';\n  } else if (platform === 'darwin' || platform === 'openbsd' || platform === 'freebsd') {\n    binary = path.join(basename + '-macosx', 'bin', 'phantomjs');\n    suffix = 'macosx.zip';\n  } else if (platform === 'win32') {\n    binary = path.join(basename + '-windows', 'bin', 'phantomjs.exe');\n    suffix = 'windows.zip';\n  } else {\n    const msg = 'Unsupported platform: ' + platform + ' ' + arch;\n    throw new Error(msg);\n  }\n\n  const filename = basename + '-' + suffix;\n  const parsed = path.parse(path.join(installPath, filename));\n  parsed.binary = path.join(installPath, binary);\n  return parsed;\n}\n"
      ]
    },
    "mtime": 1491771510540
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/extract/index.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [],
        "exports": {
          "exported": [
            "unzip",
            "bunzip2",
            "ExtractError"
          ],
          "specifiers": [
            {
              "kind": "external",
              "local": "unzip",
              "exported": "unzip",
              "source": "./unzip"
            },
            {
              "kind": "external",
              "local": "bunzip2",
              "exported": "bunzip2",
              "source": "./bunzip2"
            },
            {
              "kind": "external",
              "local": "ExtractError",
              "exported": "ExtractError",
              "source": "./extract_error"
            }
          ]
        }
      },
      "usedHelpers": []
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nvar _unzip = require('./unzip');\n\nObject.defineProperty(exports, 'unzip', {\n  enumerable: true,\n  get: function get() {\n    return _unzip.unzip;\n  }\n});\n\nvar _bunzip2 = require('./bunzip2');\n\nObject.defineProperty(exports, 'bunzip2', {\n  enumerable: true,\n  get: function get() {\n    return _bunzip2.bunzip2;\n  }\n});\n\nvar _extract_error = require('./extract_error');\n\nObject.defineProperty(exports, 'ExtractError', {\n  enumerable: true,\n  get: function get() {\n    return _extract_error.ExtractError;\n  }\n});\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvcmVwb3J0aW5nL3NlcnZlci9saWIvZXh0cmFjdC9pbmRleC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7cUJBQXNCLFNBQVM7Ozs7O2tCQUF0QixLQUFLOzs7O3VCQUNVLFdBQVc7Ozs7O29CQUExQixPQUFPOzs7OzZCQUNhLGlCQUFpQjs7Ozs7MEJBQXJDLFlBQVkiLCJmaWxlIjoiL3Vzci9zaGFyZS9raWJhbmEvcGx1Z2lucy94LXBhY2svcGx1Z2lucy9yZXBvcnRpbmcvc2VydmVyL2xpYi9leHRyYWN0L2luZGV4LmpzIiwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IHsgdW56aXAgfSBmcm9tICcuL3VuemlwJztcbmV4cG9ydCB7IGJ1bnppcDIgfSBmcm9tICcuL2J1bnppcDInO1xuZXhwb3J0IHsgRXh0cmFjdEVycm9yIH0gZnJvbSAnLi9leHRyYWN0X2Vycm9yJztcbiJdfQ==",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/extract/index.js"
      ],
      "names": [],
      "mappings": ";;;;;;qBAAsB,SAAS;;;;;kBAAtB,KAAK;;;;uBACU,WAAW;;;;;oBAA1B,OAAO;;;;6BACa,iBAAiB;;;;;0BAArC,YAAY",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/extract/index.js",
      "sourcesContent": [
        "export { unzip } from './unzip';\nexport { bunzip2 } from './bunzip2';\nexport { ExtractError } from './extract_error';\n"
      ]
    },
    "mtime": 1491771513565
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/extract/unzip.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "extract-zip",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "extractZip"
              }
            ]
          },
          {
            "source": "./extract_error",
            "imported": [
              "ExtractError"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "ExtractError",
                "local": "ExtractError"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "unzip",
            "filepath",
            "target"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "unzip",
              "exported": "unzip"
            },
            {
              "kind": "local",
              "local": "filepath",
              "exported": "filepath"
            },
            {
              "kind": "local",
              "local": "target",
              "exported": "target"
            }
          ]
        }
      },
      "usedHelpers": [
        "interop-require-default"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nexports.unzip = unzip;\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _extractZip = require('extract-zip');\n\nvar _extractZip2 = _interopRequireDefault(_extractZip);\n\nvar _extract_error = require('./extract_error');\n\nfunction unzip(filepath, target) {\n  return new Promise(function (resolve, reject) {\n    (0, _extractZip2['default'])(filepath, { dir: target }, function (err) {\n      if (err) {\n        return reject(new _extract_error.ExtractError(err));\n      }\n\n      resolve();\n    });\n  });\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvcmVwb3J0aW5nL3NlcnZlci9saWIvZXh0cmFjdC91bnppcC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7MEJBQXVCLGFBQWE7Ozs7NkJBQ1AsaUJBQWlCOztBQUV2QyxTQUFTLEtBQUssQ0FBQyxRQUFRLEVBQUUsTUFBTSxFQUFFO0FBQ3RDLFNBQU8sSUFBSSxPQUFPLENBQUMsVUFBVSxPQUFPLEVBQUUsTUFBTSxFQUFFO0FBQzVDLGlDQUFXLFFBQVEsRUFBRSxFQUFDLEdBQUcsRUFBRSxNQUFNLEVBQUMsRUFBRSxVQUFDLEdBQUcsRUFBSztBQUMzQyxVQUFJLEdBQUcsRUFBRTtBQUNQLGVBQU8sTUFBTSxDQUFDLGdDQUFpQixHQUFHLENBQUMsQ0FBQyxDQUFDO09BQ3RDOztBQUVELGFBQU8sRUFBRSxDQUFDO0tBQ1gsQ0FBQyxDQUFDO0dBQ0osQ0FBQyxDQUFDO0NBQ0oiLCJmaWxlIjoiL3Vzci9zaGFyZS9raWJhbmEvcGx1Z2lucy94LXBhY2svcGx1Z2lucy9yZXBvcnRpbmcvc2VydmVyL2xpYi9leHRyYWN0L3VuemlwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGV4dHJhY3RaaXAgZnJvbSAnZXh0cmFjdC16aXAnO1xuaW1wb3J0IHsgRXh0cmFjdEVycm9yIH0gZnJvbSAnLi9leHRyYWN0X2Vycm9yJztcblxuZXhwb3J0IGZ1bmN0aW9uIHVuemlwKGZpbGVwYXRoLCB0YXJnZXQpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICBleHRyYWN0WmlwKGZpbGVwYXRoLCB7ZGlyOiB0YXJnZXR9LCAoZXJyKSA9PiB7XG4gICAgICBpZiAoZXJyKSB7XG4gICAgICAgIHJldHVybiByZWplY3QobmV3IEV4dHJhY3RFcnJvcihlcnIpKTtcbiAgICAgIH1cblxuICAgICAgcmVzb2x2ZSgpO1xuICAgIH0pO1xuICB9KTtcbn1cbiJdfQ==",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/extract/unzip.js"
      ],
      "names": [],
      "mappings": ";;;;;;;;;0BAAuB,aAAa;;;;6BACP,iBAAiB;;AAEvC,SAAS,KAAK,CAAC,QAAQ,EAAE,MAAM,EAAE;AACtC,SAAO,IAAI,OAAO,CAAC,UAAU,OAAO,EAAE,MAAM,EAAE;AAC5C,iCAAW,QAAQ,EAAE,EAAC,GAAG,EAAE,MAAM,EAAC,EAAE,UAAC,GAAG,EAAK;AAC3C,UAAI,GAAG,EAAE;AACP,eAAO,MAAM,CAAC,gCAAiB,GAAG,CAAC,CAAC,CAAC;OACtC;;AAED,aAAO,EAAE,CAAC;KACX,CAAC,CAAC;GACJ,CAAC,CAAC;CACJ",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/extract/unzip.js",
      "sourcesContent": [
        "import extractZip from 'extract-zip';\nimport { ExtractError } from './extract_error';\n\nexport function unzip(filepath, target) {\n  return new Promise(function (resolve, reject) {\n    extractZip(filepath, {dir: target}, (err) => {\n      if (err) {\n        return reject(new ExtractError(err));\n      }\n\n      resolve();\n    });\n  });\n}\n"
      ]
    },
    "mtime": 1491771513565
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/extract/extract_error.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [],
        "exports": {
          "exported": [
            "ExtractError"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "ExtractError",
              "exported": "ExtractError"
            }
          ]
        }
      },
      "usedHelpers": [
        "get",
        "inherits",
        "class-call-check"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nvar _get = function get(_x2, _x3, _x4) { var _again = true; _function: while (_again) { var object = _x2, property = _x3, receiver = _x4; _again = false; if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { _x2 = parent; _x3 = property; _x4 = receiver; _again = true; desc = parent = undefined; continue _function; } } else if ('value' in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } } };\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar ExtractError = (function (_Error) {\n  _inherits(ExtractError, _Error);\n\n  function ExtractError(cause) {\n    var message = arguments.length <= 1 || arguments[1] === undefined ? 'Failed to extract the phantom.js archive' : arguments[1];\n\n    _classCallCheck(this, ExtractError);\n\n    _get(Object.getPrototypeOf(ExtractError.prototype), 'constructor', this).call(this, message);\n    this.message = message;\n    this.name = this.constructor.name;\n    Error.captureStackTrace(this, this.constructor);\n    this.cause = cause;\n  }\n\n  return ExtractError;\n})(Error);\n\nexports.ExtractError = ExtractError;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvcmVwb3J0aW5nL3NlcnZlci9saWIvZXh0cmFjdC9leHRyYWN0X2Vycm9yLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztJQUFhLFlBQVk7WUFBWixZQUFZOztBQUNaLFdBREEsWUFBWSxDQUNYLEtBQUssRUFBd0Q7UUFBdEQsT0FBTyx5REFBRywwQ0FBMEM7OzBCQUQ1RCxZQUFZOztBQUVyQiwrQkFGUyxZQUFZLDZDQUVmLE9BQU8sRUFBRTtBQUNmLFFBQUksQ0FBQyxPQUFPLEdBQUcsT0FBTyxDQUFDO0FBQ3ZCLFFBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUM7QUFDbEMsU0FBSyxDQUFDLGlCQUFpQixDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsV0FBVyxDQUFDLENBQUM7QUFDaEQsUUFBSSxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUM7R0FDcEI7O1NBUFUsWUFBWTtHQUFTLEtBQUsiLCJmaWxlIjoiL3Vzci9zaGFyZS9raWJhbmEvcGx1Z2lucy94LXBhY2svcGx1Z2lucy9yZXBvcnRpbmcvc2VydmVyL2xpYi9leHRyYWN0L2V4dHJhY3RfZXJyb3IuanMiLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY2xhc3MgRXh0cmFjdEVycm9yIGV4dGVuZHMgRXJyb3Ige1xuICBjb25zdHJ1Y3RvcihjYXVzZSwgbWVzc2FnZSA9ICdGYWlsZWQgdG8gZXh0cmFjdCB0aGUgcGhhbnRvbS5qcyBhcmNoaXZlJykge1xuICAgIHN1cGVyKG1lc3NhZ2UpO1xuICAgIHRoaXMubWVzc2FnZSA9IG1lc3NhZ2U7XG4gICAgdGhpcy5uYW1lID0gdGhpcy5jb25zdHJ1Y3Rvci5uYW1lO1xuICAgIEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKHRoaXMsIHRoaXMuY29uc3RydWN0b3IpO1xuICAgIHRoaXMuY2F1c2UgPSBjYXVzZTtcbiAgfVxufVxuIl19",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/extract/extract_error.js"
      ],
      "names": [],
      "mappings": ";;;;;;;;;;;;IAAa,YAAY;YAAZ,YAAY;;AACZ,WADA,YAAY,CACX,KAAK,EAAwD;QAAtD,OAAO,yDAAG,0CAA0C;;0BAD5D,YAAY;;AAErB,+BAFS,YAAY,6CAEf,OAAO,EAAE;AACf,QAAI,CAAC,OAAO,GAAG,OAAO,CAAC;AACvB,QAAI,CAAC,IAAI,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC;AAClC,SAAK,CAAC,iBAAiB,CAAC,IAAI,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;AAChD,QAAI,CAAC,KAAK,GAAG,KAAK,CAAC;GACpB;;SAPU,YAAY;GAAS,KAAK",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/extract/extract_error.js",
      "sourcesContent": [
        "export class ExtractError extends Error {\n  constructor(cause, message = 'Failed to extract the phantom.js archive') {\n    super(message);\n    this.message = message;\n    this.name = this.constructor.name;\n    Error.captureStackTrace(this, this.constructor);\n    this.cause = cause;\n  }\n}\n"
      ]
    },
    "mtime": 1491771513565
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/extract/bunzip2.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "./extract_error",
            "imported": [
              "ExtractError"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "ExtractError",
                "local": "ExtractError"
              }
            ]
          },
          {
            "source": "fs",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "fs"
              }
            ]
          },
          {
            "source": "tar-fs",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "tar"
              }
            ]
          },
          {
            "source": "unbzip2-stream",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "unbzip2"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "bunzip2",
            "filepath",
            "target"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "bunzip2",
              "exported": "bunzip2"
            },
            {
              "kind": "local",
              "local": "filepath",
              "exported": "filepath"
            },
            {
              "kind": "local",
              "local": "target",
              "exported": "target"
            }
          ]
        }
      },
      "usedHelpers": [
        "interop-require-default"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nexports.bunzip2 = bunzip2;\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _extract_error = require('./extract_error');\n\nvar _fs = require('fs');\n\nvar _fs2 = _interopRequireDefault(_fs);\n\nvar _tarFs = require('tar-fs');\n\nvar _tarFs2 = _interopRequireDefault(_tarFs);\n\nvar _unbzip2Stream = require('unbzip2-stream');\n\nvar _unbzip2Stream2 = _interopRequireDefault(_unbzip2Stream);\n\nfunction bunzip2(filepath, target) {\n  return new Promise(function (resolve, reject) {\n    _fs2['default'].createReadStream(filepath).on('error', function (err) {\n      reject(new _extract_error.ExtractError(err));\n    }).pipe((0, _unbzip2Stream2['default'])()).on('error', function (err) {\n      reject(new _extract_error.ExtractError(err));\n    }).pipe(_tarFs2['default'].extract(target)).on('error', function (err) {\n      reject(new _extract_error.ExtractError(err));\n    }).on('finish', resolve);\n  });\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvcmVwb3J0aW5nL3NlcnZlci9saWIvZXh0cmFjdC9idW56aXAyLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs2QkFBNkIsaUJBQWlCOztrQkFDL0IsSUFBSTs7OztxQkFDSCxRQUFROzs7OzZCQUNKLGdCQUFnQjs7OztBQUU3QixTQUFTLE9BQU8sQ0FBQyxRQUFRLEVBQUUsTUFBTSxFQUFFO0FBQ3hDLFNBQU8sSUFBSSxPQUFPLENBQUMsVUFBVSxPQUFPLEVBQUUsTUFBTSxFQUFFO0FBQzVDLG9CQUFHLGdCQUFnQixDQUFDLFFBQVEsQ0FBQyxDQUMxQixFQUFFLENBQUMsT0FBTyxFQUFFLFVBQVUsR0FBRyxFQUFFO0FBQzFCLFlBQU0sQ0FBQyxnQ0FBaUIsR0FBRyxDQUFDLENBQUMsQ0FBQztLQUMvQixDQUFDLENBQ0QsSUFBSSxDQUFDLGlDQUFTLENBQUMsQ0FDZixFQUFFLENBQUMsT0FBTyxFQUFFLFVBQVUsR0FBRyxFQUFFO0FBQzFCLFlBQU0sQ0FBQyxnQ0FBaUIsR0FBRyxDQUFDLENBQUMsQ0FBQztLQUMvQixDQUFDLENBQ0QsSUFBSSxDQUFDLG1CQUFJLE9BQU8sQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUN6QixFQUFFLENBQUMsT0FBTyxFQUFFLFVBQVUsR0FBRyxFQUFFO0FBQzFCLFlBQU0sQ0FBQyxnQ0FBaUIsR0FBRyxDQUFDLENBQUMsQ0FBQztLQUMvQixDQUFDLENBQ0QsRUFBRSxDQUFDLFFBQVEsRUFBRSxPQUFPLENBQUMsQ0FBQztHQUMxQixDQUFDLENBQUM7Q0FDSiIsImZpbGUiOiIvdXNyL3NoYXJlL2tpYmFuYS9wbHVnaW5zL3gtcGFjay9wbHVnaW5zL3JlcG9ydGluZy9zZXJ2ZXIvbGliL2V4dHJhY3QvYnVuemlwMi5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEV4dHJhY3RFcnJvciB9IGZyb20gJy4vZXh0cmFjdF9lcnJvcic7XG5pbXBvcnQgZnMgZnJvbSAnZnMnO1xuaW1wb3J0IHRhciBmcm9tICd0YXItZnMnO1xuaW1wb3J0IHVuYnppcDIgZnJvbSAndW5iemlwMi1zdHJlYW0nO1xuXG5leHBvcnQgZnVuY3Rpb24gYnVuemlwMihmaWxlcGF0aCwgdGFyZ2V0KSB7XG4gIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgZnMuY3JlYXRlUmVhZFN0cmVhbShmaWxlcGF0aClcbiAgICAgIC5vbignZXJyb3InLCBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgIHJlamVjdChuZXcgRXh0cmFjdEVycm9yKGVycikpO1xuICAgICAgfSlcbiAgICAgIC5waXBlKHVuYnppcDIoKSlcbiAgICAgIC5vbignZXJyb3InLCBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgIHJlamVjdChuZXcgRXh0cmFjdEVycm9yKGVycikpO1xuICAgICAgfSlcbiAgICAgIC5waXBlKHRhci5leHRyYWN0KHRhcmdldCkpXG4gICAgICAub24oJ2Vycm9yJywgZnVuY3Rpb24gKGVycikge1xuICAgICAgICByZWplY3QobmV3IEV4dHJhY3RFcnJvcihlcnIpKTtcbiAgICAgIH0pXG4gICAgICAub24oJ2ZpbmlzaCcsIHJlc29sdmUpO1xuICB9KTtcbn1cbiJdfQ==",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/extract/bunzip2.js"
      ],
      "names": [],
      "mappings": ";;;;;;;;;6BAA6B,iBAAiB;;kBAC/B,IAAI;;;;qBACH,QAAQ;;;;6BACJ,gBAAgB;;;;AAE7B,SAAS,OAAO,CAAC,QAAQ,EAAE,MAAM,EAAE;AACxC,SAAO,IAAI,OAAO,CAAC,UAAU,OAAO,EAAE,MAAM,EAAE;AAC5C,oBAAG,gBAAgB,CAAC,QAAQ,CAAC,CAC1B,EAAE,CAAC,OAAO,EAAE,UAAU,GAAG,EAAE;AAC1B,YAAM,CAAC,gCAAiB,GAAG,CAAC,CAAC,CAAC;KAC/B,CAAC,CACD,IAAI,CAAC,iCAAS,CAAC,CACf,EAAE,CAAC,OAAO,EAAE,UAAU,GAAG,EAAE;AAC1B,YAAM,CAAC,gCAAiB,GAAG,CAAC,CAAC,CAAC;KAC/B,CAAC,CACD,IAAI,CAAC,mBAAI,OAAO,CAAC,MAAM,CAAC,CAAC,CACzB,EAAE,CAAC,OAAO,EAAE,UAAU,GAAG,EAAE;AAC1B,YAAM,CAAC,gCAAiB,GAAG,CAAC,CAAC,CAAC;KAC/B,CAAC,CACD,EAAE,CAAC,QAAQ,EAAE,OAAO,CAAC,CAAC;GAC1B,CAAC,CAAC;CACJ",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/extract/bunzip2.js",
      "sourcesContent": [
        "import { ExtractError } from './extract_error';\nimport fs from 'fs';\nimport tar from 'tar-fs';\nimport unbzip2 from 'unbzip2-stream';\n\nexport function bunzip2(filepath, target) {\n  return new Promise(function (resolve, reject) {\n    fs.createReadStream(filepath)\n      .on('error', function (err) {\n        reject(new ExtractError(err));\n      })\n      .pipe(unbzip2())\n      .on('error', function (err) {\n        reject(new ExtractError(err));\n      })\n      .pipe(tar.extract(target))\n      .on('error', function (err) {\n        reject(new ExtractError(err));\n      })\n      .on('finish', resolve);\n  });\n}\n"
      ]
    },
    "mtime": 1491771513565
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/create_tagged_logger.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [],
        "exports": {
          "exported": [
            "createTaggedLogger",
            "server",
            "tags"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "createTaggedLogger",
              "exported": "createTaggedLogger"
            },
            {
              "kind": "local",
              "local": "server",
              "exported": "server"
            },
            {
              "kind": "local",
              "local": "tags",
              "exported": "tags"
            }
          ]
        }
      },
      "usedHelpers": [
        "to-consumable-array"
      ]
    },
    "ignored": false,
    "code": "/**\n * @function taggedLogger\n * @param {string} message\n * @param {string[]} [additionalTags]\n */\n\n/**\n * Creates a taggedLogger function with tags, allows the consumer to optionally provide additional tags\n *\n * @param {Server} server\n * @param {string[]} tags - tags to always be passed into the `logger` function\n * @returns taggedLogger\n */\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.createTaggedLogger = createTaggedLogger;\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) arr2[i] = arr[i]; return arr2; } else { return Array.from(arr); } }\n\nfunction createTaggedLogger(server, tags) {\n  return function (msg) {\n    var additionalTags = arguments.length <= 1 || arguments[1] === undefined ? [] : arguments[1];\n\n    server.log([].concat(_toConsumableArray(tags), _toConsumableArray(additionalTags)), msg);\n  };\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvcmVwb3J0aW5nL3NlcnZlci9saWIvY3JlYXRlX3RhZ2dlZF9sb2dnZXIuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQWNPLFNBQVMsa0JBQWtCLENBQUMsTUFBTSxFQUFFLElBQUksRUFBRTtBQUMvQyxTQUFPLFVBQUMsR0FBRyxFQUEwQjtRQUF4QixjQUFjLHlEQUFHLEVBQUU7O0FBQzlCLFVBQU0sQ0FBQyxHQUFHLDhCQUFLLElBQUksc0JBQUssY0FBYyxJQUFHLEdBQUcsQ0FBQyxDQUFDO0dBQy9DLENBQUM7Q0FDSCIsImZpbGUiOiIvdXNyL3NoYXJlL2tpYmFuYS9wbHVnaW5zL3gtcGFjay9wbHVnaW5zL3JlcG9ydGluZy9zZXJ2ZXIvbGliL2NyZWF0ZV90YWdnZWRfbG9nZ2VyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBAZnVuY3Rpb24gdGFnZ2VkTG9nZ2VyXG4gKiBAcGFyYW0ge3N0cmluZ30gbWVzc2FnZVxuICogQHBhcmFtIHtzdHJpbmdbXX0gW2FkZGl0aW9uYWxUYWdzXVxuICovXG5cblxuLyoqXG4gKiBDcmVhdGVzIGEgdGFnZ2VkTG9nZ2VyIGZ1bmN0aW9uIHdpdGggdGFncywgYWxsb3dzIHRoZSBjb25zdW1lciB0byBvcHRpb25hbGx5IHByb3ZpZGUgYWRkaXRpb25hbCB0YWdzXG4gKlxuICogQHBhcmFtIHtTZXJ2ZXJ9IHNlcnZlclxuICogQHBhcmFtIHtzdHJpbmdbXX0gdGFncyAtIHRhZ3MgdG8gYWx3YXlzIGJlIHBhc3NlZCBpbnRvIHRoZSBgbG9nZ2VyYCBmdW5jdGlvblxuICogQHJldHVybnMgdGFnZ2VkTG9nZ2VyXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVUYWdnZWRMb2dnZXIoc2VydmVyLCB0YWdzKSB7XG4gIHJldHVybiAobXNnLCBhZGRpdGlvbmFsVGFncyA9IFtdKSA9PiB7XG4gICAgc2VydmVyLmxvZyhbLi4udGFncywgLi4uYWRkaXRpb25hbFRhZ3NdLCBtc2cpO1xuICB9O1xufVxuIl19",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/create_tagged_logger.js"
      ],
      "names": [],
      "mappings": ";;;;;;;;;;;;;;;;;;;;;;AAcO,SAAS,kBAAkB,CAAC,MAAM,EAAE,IAAI,EAAE;AAC/C,SAAO,UAAC,GAAG,EAA0B;QAAxB,cAAc,yDAAG,EAAE;;AAC9B,UAAM,CAAC,GAAG,8BAAK,IAAI,sBAAK,cAAc,IAAG,GAAG,CAAC,CAAC;GAC/C,CAAC;CACH",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/create_tagged_logger.js",
      "sourcesContent": [
        "/**\n * @function taggedLogger\n * @param {string} message\n * @param {string[]} [additionalTags]\n */\n\n\n/**\n * Creates a taggedLogger function with tags, allows the consumer to optionally provide additional tags\n *\n * @param {Server} server\n * @param {string[]} tags - tags to always be passed into the `logger` function\n * @returns taggedLogger\n */\nexport function createTaggedLogger(server, tags) {\n  return (msg, additionalTags = []) => {\n    server.log([...tags, ...additionalTags], msg);\n  };\n}\n"
      ]
    },
    "mtime": 1491771510540
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/reporting/server/routes/jobs.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "boom",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "boom"
              }
            ]
          },
          {
            "source": "lodash",
            "imported": [
              "has"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "has",
                "local": "has"
              }
            ]
          },
          {
            "source": "../lib/constants",
            "imported": [
              "constants"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "constants",
                "local": "constants"
              }
            ]
          },
          {
            "source": "../lib/jobs_query",
            "imported": [
              "jobsQueryFactory"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "jobsQueryFactory",
                "local": "jobsQueryFactory"
              }
            ]
          },
          {
            "source": "../lib/license_pre_routing",
            "imported": [
              "licensePreRoutingFactory"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "licensePreRoutingFactory",
                "local": "licensePreRoutingFactory"
              }
            ]
          },
          {
            "source": "../lib/user_pre_routing",
            "imported": [
              "userPreRoutingFactory"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "userPreRoutingFactory",
                "local": "userPreRoutingFactory"
              }
            ]
          },
          {
            "source": "../lib/job_response_handler",
            "imported": [
              "jobResponseHandlerFactory"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "jobResponseHandlerFactory",
                "local": "jobResponseHandlerFactory"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "jobs",
            "server"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "jobs",
              "exported": "jobs"
            },
            {
              "kind": "local",
              "local": "server",
              "exported": "server"
            }
          ]
        }
      },
      "usedHelpers": [
        "interop-require-default"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nexports.jobs = jobs;\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _boom = require('boom');\n\nvar _boom2 = _interopRequireDefault(_boom);\n\nvar _lodash = require('lodash');\n\nvar _libConstants = require('../lib/constants');\n\nvar _libJobs_query = require('../lib/jobs_query');\n\nvar _libLicense_pre_routing = require('../lib/license_pre_routing');\n\nvar _libUser_pre_routing = require('../lib/user_pre_routing');\n\nvar _libJob_response_handler = require('../lib/job_response_handler');\n\nvar mainEntry = _libConstants.constants.API_BASE_URL + '/jobs';\nvar API_TAG = 'api';\n\nfunction jobs(server) {\n  var config = server.config();\n  var socketTimeout = config.get('xpack.reporting.generate.socketTimeout');\n  var jobsQuery = (0, _libJobs_query.jobsQueryFactory)(server);\n  var licensePreRouting = (0, _libLicense_pre_routing.licensePreRoutingFactory)(server);\n  var userPreRouting = (0, _libUser_pre_routing.userPreRoutingFactory)(server);\n  var jobResponseHandler = (0, _libJob_response_handler.jobResponseHandlerFactory)(server);\n\n  // list jobs in the queue, paginated\n  server.route({\n    path: mainEntry + '/list',\n    method: 'GET',\n    handler: function handler(request, reply) {\n      var page = parseInt(request.query.page) || 0;\n      var size = Math.min(100, parseInt(request.query.size) || 10);\n\n      var results = jobsQuery.list(request, page, size);\n      reply(results);\n    },\n    config: {\n      pre: [licensePreRouting]\n    }\n  });\n\n  // list all completed jobs since a specified time\n  server.route({\n    path: mainEntry + '/list_completed_since',\n    method: 'GET',\n    handler: function handler(request, reply) {\n      var size = Math.min(100, parseInt(request.query.size) || 10);\n      var sinceInMs = Date.parse(request.query.since) || null;\n\n      var results = jobsQuery.listCompletedSince(request, size, sinceInMs);\n      reply(results);\n    },\n    config: {\n      pre: [licensePreRouting]\n    }\n  });\n\n  // return the count of all jobs in the queue\n  server.route({\n    path: mainEntry + '/count',\n    method: 'GET',\n    handler: function handler(request, reply) {\n      var results = jobsQuery.count(request);\n      reply(results);\n    },\n    config: {\n      pre: [licensePreRouting]\n    }\n  });\n\n  // return the raw output from a job\n  server.route({\n    path: mainEntry + '/output/{docId}',\n    method: 'GET',\n    handler: function handler(request, reply) {\n      var docId = request.params.docId;\n\n      jobsQuery.get(request, docId, { includeContent: true }).then(function (doc) {\n        if (!doc) return reply(_boom2['default'].notFound());\n        reply(doc._source.output);\n      });\n    },\n    config: {\n      pre: [licensePreRouting],\n      timeout: { socket: socketTimeout }\n    }\n  });\n\n  // trigger a download of the output from a job\n  server.route({\n    path: mainEntry + '/download/{docId}',\n    method: 'GET',\n    handler: function handler(request, reply) {\n      var docId = request.params.docId;\n\n      var jobType = _libConstants.constants.JOBTYPES.PRINTABLE_PDF;\n      var syncResponse = (0, _lodash.has)(request.query, 'sync');\n\n      jobResponseHandler(request, reply, { docId: docId, jobType: jobType }, { sync: syncResponse });\n    },\n    config: {\n      pre: [licensePreRouting, userPreRouting],\n      timeout: { socket: socketTimeout },\n      tags: [API_TAG]\n    }\n  });\n}\n\n;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvcmVwb3J0aW5nL3NlcnZlci9yb3V0ZXMvam9icy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7b0JBQWlCLE1BQU07Ozs7c0JBQ0gsUUFBUTs7NEJBQ0Ysa0JBQWtCOzs2QkFDWCxtQkFBbUI7O3NDQUNaLDRCQUE0Qjs7bUNBQzlCLHlCQUF5Qjs7dUNBQ3JCLDZCQUE2Qjs7QUFFdkUsSUFBTSxTQUFTLEdBQU0sd0JBQVUsWUFBWSxVQUFPLENBQUM7QUFDbkQsSUFBTSxPQUFPLEdBQUcsS0FBSyxDQUFDOztBQUVmLFNBQVMsSUFBSSxDQUFDLE1BQU0sRUFBRTtBQUMzQixNQUFNLE1BQU0sR0FBRyxNQUFNLENBQUMsTUFBTSxFQUFFLENBQUM7QUFDL0IsTUFBTSxhQUFhLEdBQUcsTUFBTSxDQUFDLEdBQUcsQ0FBQyx3Q0FBd0MsQ0FBQyxDQUFDO0FBQzNFLE1BQU0sU0FBUyxHQUFHLHFDQUFpQixNQUFNLENBQUMsQ0FBQztBQUMzQyxNQUFNLGlCQUFpQixHQUFHLHNEQUF5QixNQUFNLENBQUMsQ0FBQztBQUMzRCxNQUFNLGNBQWMsR0FBRyxnREFBc0IsTUFBTSxDQUFDLENBQUM7QUFDckQsTUFBTSxrQkFBa0IsR0FBRyx3REFBMEIsTUFBTSxDQUFDLENBQUM7OztBQUc3RCxRQUFNLENBQUMsS0FBSyxDQUFDO0FBQ1gsUUFBSSxFQUFLLFNBQVMsVUFBTztBQUN6QixVQUFNLEVBQUUsS0FBSztBQUNiLFdBQU8sRUFBRSxpQkFBQyxPQUFPLEVBQUUsS0FBSyxFQUFLO0FBQzNCLFVBQU0sSUFBSSxHQUFHLFFBQVEsQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUMvQyxVQUFNLElBQUksR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBRSxRQUFRLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFB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QUFMLEtBQUssRUFBRSxPQUFPLEVBQVAsT0FBTyxFQUFFLEVBQUUsRUFBRSxJQUFJLEVBQUUsWUFBWSxFQUFFLENBQUMsQ0FBQztLQUNoRjtBQUNELFVBQU0sRUFBRTtBQUNOLFNBQUcsRUFBRSxDQUFFLGlCQUFpQixFQUFFLGNBQWMsQ0FBRTtBQUMxQyxhQUFPLEVBQUUsRUFBRSxNQUFNLEVBQUUsYUFBYSxFQUFFO0FBQ2xDLFVBQUksRUFBRSxDQUFDLE9BQU8sQ0FBQztLQUNoQjtHQUNGLENBQUMsQ0FBQztDQUNKOztBQUFBLENBQUMiLCJmaWxlIjoiL3Vzci9zaGFyZS9raWJhbmEvcGx1Z2lucy94LXBhY2svcGx1Z2lucy9yZXBvcnRpbmcvc2VydmVyL3JvdXRlcy9qb2JzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGJvb20gZnJvbSAnYm9vbSc7XG5pbXBvcnQgeyBoYXMgfSBmcm9tICdsb2Rhc2gnO1xuaW1wb3J0IHsgY29uc3RhbnRzIH0gZnJvbSAnLi4vbGliL2NvbnN0YW50cyc7XG5pbXBvcnQgeyBqb2JzUXVlcnlGYWN0b3J5IH0gZnJvbSAnLi4vbGliL2pvYnNfcXVlcnknO1xuaW1wb3J0IHsgbGljZW5zZVByZVJvdXRpbmdGYWN0b3J5IH0gZnJvbScuLi9saWIvbGljZW5zZV9wcmVfcm91dGluZyc7XG5pbXBvcnQgeyB1c2VyUHJlUm91dGluZ0ZhY3RvcnkgfSBmcm9tICcuLi9saWIvdXNlcl9wcmVfcm91dGluZyc7XG5pbXBvcnQgeyBqb2JSZXNwb25zZUhhbmRsZXJGYWN0b3J5IH0gZnJvbSAnLi4vbGliL2pvYl9yZXNwb25zZV9oYW5kbGVyJztcblxuY29uc3QgbWFpbkVudHJ5ID0gYCR7Y29uc3RhbnRzLkFQSV9CQVNFX1VSTH0vam9ic2A7XG5jb25zdCBBUElfVEFHID0gJ2FwaSc7XG5cbmV4cG9ydCBmdW5jdGlvbiBqb2JzKHNlcnZlcikge1xuICBjb25zdCBjb25maWcgPSBzZXJ2ZXIuY29uZmlnKCk7XG4gIGNvbnN0IHNvY2tldFRpbWVvdXQgPSBjb25maWcuZ2V0KCd4cGFjay5yZXBvcnRpbmcuZ2VuZXJhdGUuc29ja2V0VGltZW91dCcpO1xuICBjb25zdCBqb2JzUXVlcnkgPSBqb2JzUXVlcnlGYWN0b3J5KHNlcnZlcik7XG4gIGNvbnN0IGxpY2Vuc2VQcmVSb3V0aW5nID0gbGljZW5zZVByZVJvdXRpbmdGYWN0b3J5KHNlcnZlcik7XG4gIGNvbnN0IHVzZXJQcmVSb3V0aW5nID0gdXNlclByZVJvdXRpbmdGYWN0b3J5KHNlcnZlcik7XG4gIGNvbnN0IGpvYlJlc3BvbnNlSGFuZGxlciA9IGpvYlJlc3BvbnNlSGFuZGxlckZhY3Rvcnkoc2VydmVyKTtcblxuICAvLyBsaXN0IGpvYnMgaW4gdGhlIHF1ZXVlLCBwYWdpbmF0ZWRcbiAgc2VydmVyLnJvdXRlKHtcbiAgICBwYXRoOiBgJHttYWluRW50cnl9L2xpc3RgLFxuICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgaGFuZGxlcjogKHJlcXVlc3QsIHJlcGx5KSA9PiB7XG4gICAgICBjb25zdCBwYWdlID0gcGFyc2VJbnQocmVxdWVzdC5xdWVyeS5wYWdlKSB8fCAwO1xuICAgICAgY29uc3Qgc2l6ZSA9IE1hdGgubWluKDEwMCwgcGFyc2VJbnQocmVxdWVzdC5xdWVyeS5zaXplKSB8fCAxMCk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdHMgPSBqb2JzUXVlcnkubGlzdChyZXF1ZXN0LCBwYWdlLCBzaXplKTtcbiAgICAgIHJlcGx5KHJlc3VsdHMpO1xuICAgIH0sXG4gICAgY29uZmlnOiB7XG4gICAgICBwcmU6IFsgbGljZW5zZVByZVJvdXRpbmcgXSxcbiAgICB9XG4gIH0pO1xuXG4gIC8vIGxpc3QgYWxsIGNvbXBsZXRlZCBqb2JzIHNpbmNlIGEgc3BlY2lmaWVkIHRpbWVcbiAgc2VydmVyLnJvdXRlKHtcbiAgICBwYXRoOiBgJHttYWluRW50cnl9L2xpc3RfY29tcGxldGVkX3NpbmNlYCxcbiAgICBtZXRob2Q6ICdHRVQnLFxuICAgIGhhbmRsZXI6IChyZXF1ZXN0LCByZXBseSkgPT4ge1xuICAgICAgY29uc3Qgc2l6ZSA9IE1hdGgubWluKDEwMCwgcGFyc2VJbnQocmVxdWVzdC5xdWVyeS5zaXplKSB8fCAxMCk7XG4gICAgICBjb25zdCBzaW5jZUluTXMgPSBEYXRlLnBhcnNlKHJlcXVlc3QucXVlcnkuc2luY2UpIHx8IG51bGw7XG5cbiAgICAgIGNvbnN0IHJlc3VsdHMgPSBqb2JzUXVlcnkubGlzdENvbXBsZXRlZFNpbmNlKHJlcXVlc3QsIHNpemUsIHNpbmNlSW5Ncyk7XG4gICAgICByZXBseShyZXN1bHRzKTtcbiAgICB9LFxuICAgIGNvbmZpZzoge1xuICAgICAgcHJlOiBbIGxpY2Vuc2VQcmVSb3V0aW5nIF0sXG4gICAgfVxuICB9KTtcblxuICAvLyByZXR1cm4gdGhlIGNvdW50IG9mIGFsbCBqb2JzIGluIHRoZSBxdWV1ZVxuICBzZXJ2ZXIucm91dGUoe1xuICAgIHBhdGg6IGAke21haW5FbnRyeX0vY291bnRgLFxuICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgaGFuZGxlcjogKHJlcXVlc3QsIHJlcGx5KSA9PiB7XG4gICAgICBjb25zdCByZXN1bHRzID0gam9ic1F1ZXJ5LmNvdW50KHJlcXVlc3QpO1xuICAgICAgcmVwbHkocmVzdWx0cyk7XG4gICAgfSxcbiAgICBjb25maWc6IHtcbiAgICAgIHByZTogWyBsaWNlbnNlUHJlUm91dGluZyBdLFxuICAgIH1cbiAgfSk7XG5cbiAgLy8gcmV0dXJuIHRoZSByYXcgb3V0cHV0IGZyb20gYSBqb2JcbiAgc2VydmVyLnJvdXRlKHtcbiAgICBwYXRoOiBgJHttYWluRW50cnl9L291dHB1dC97ZG9jSWR9YCxcbiAgICBtZXRob2Q6ICdHRVQnLFxuICAgIGhhbmRsZXI6IChyZXF1ZXN0LCByZXBseSkgPT4ge1xuICAgICAgY29uc3QgeyBkb2NJZCB9ID0gcmVxdWVzdC5wYXJhbXM7XG5cbiAgICAgIGpvYnNRdWVyeS5nZXQocmVxdWVzdCwgZG9jSWQsIHsgaW5jbHVkZUNvbnRlbnQ6IHRydWUgfSlcbiAgICAgIC50aGVuKChkb2MpID0+IHtcbiAgICAgICAgaWYgKCFkb2MpIHJldHVybiByZXBseShib29tLm5vdEZvdW5kKCkpO1xuICAgICAgICByZXBseShkb2MuX3NvdXJjZS5vdXRwdXQpO1xuICAgICAgfSk7XG4gICAgfSxcbiAgICBjb25maWc6IHtcbiAgICAgIHByZTogWyBsaWNlbnNlUHJlUm91dGluZyBdLFxuICAgICAgdGltZW91dDogeyBzb2NrZXQ6IHNvY2tldFRpbWVvdXQgfSxcbiAgICB9XG4gIH0pO1xuXG4gIC8vIHRyaWdnZXIgYSBkb3dubG9hZCBvZiB0aGUgb3V0cHV0IGZyb20gYSBqb2JcbiAgc2VydmVyLnJvdXRlKHtcbiAgICBwYXRoOiBgJHttYWluRW50cnl9L2Rvd25sb2FkL3tkb2NJZH1gLFxuICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgaGFuZGxlcjogKHJlcXVlc3QsIHJlcGx5KSA9PiB7XG4gICAgICBjb25zdCB7IGRvY0lkIH0gPSByZXF1ZXN0LnBhcmFtcztcbiAgICAgIGNvbnN0IGpvYlR5cGUgPSBjb25zdGFudHMuSk9CVFlQRVMuUFJJTlRBQkxFX1BERjtcbiAgICAgIGNvbnN0IHN5bmNSZXNwb25zZSA9IGhhcyhyZXF1ZXN0LnF1ZXJ5LCAnc3luYycpO1xuXG4gICAgICBqb2JSZXNwb25zZUhhbmRsZXIocmVxdWVzdCwgcmVwbHksIHsgZG9jSWQsIGpvYlR5cGUgfSwgeyBzeW5jOiBzeW5jUmVzcG9uc2UgfSk7XG4gICAgfSxcbiAgICBjb25maWc6IHtcbiAgICAgIHByZTogWyBsaWNlbnNlUHJlUm91dGluZywgdXNlclByZVJvdXRpbmcgXSxcbiAgICAgIHRpbWVvdXQ6IHsgc29ja2V0OiBzb2NrZXRUaW1lb3V0IH0sXG4gICAgICB0YWdzOiBbQVBJX1RBR10sXG4gICAgfSxcbiAgfSk7XG59O1xuIl19",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/routes/jobs.js"
      ],
      "names": [],
      "mappings": "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",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/routes/jobs.js",
      "sourcesContent": [
        "import boom from 'boom';\nimport { has } from 'lodash';\nimport { constants } from '../lib/constants';\nimport { jobsQueryFactory } from '../lib/jobs_query';\nimport { licensePreRoutingFactory } from'../lib/license_pre_routing';\nimport { userPreRoutingFactory } from '../lib/user_pre_routing';\nimport { jobResponseHandlerFactory } from '../lib/job_response_handler';\n\nconst mainEntry = `${constants.API_BASE_URL}/jobs`;\nconst API_TAG = 'api';\n\nexport function jobs(server) {\n  const config = server.config();\n  const socketTimeout = config.get('xpack.reporting.generate.socketTimeout');\n  const jobsQuery = jobsQueryFactory(server);\n  const licensePreRouting = licensePreRoutingFactory(server);\n  const userPreRouting = userPreRoutingFactory(server);\n  const jobResponseHandler = jobResponseHandlerFactory(server);\n\n  // list jobs in the queue, paginated\n  server.route({\n    path: `${mainEntry}/list`,\n    method: 'GET',\n    handler: (request, reply) => {\n      const page = parseInt(request.query.page) || 0;\n      const size = Math.min(100, parseInt(request.query.size) || 10);\n\n      const results = jobsQuery.list(request, page, size);\n      reply(results);\n    },\n    config: {\n      pre: [ licensePreRouting ],\n    }\n  });\n\n  // list all completed jobs since a specified time\n  server.route({\n    path: `${mainEntry}/list_completed_since`,\n    method: 'GET',\n    handler: (request, reply) => {\n      const size = Math.min(100, parseInt(request.query.size) || 10);\n      const sinceInMs = Date.parse(request.query.since) || null;\n\n      const results = jobsQuery.listCompletedSince(request, size, sinceInMs);\n      reply(results);\n    },\n    config: {\n      pre: [ licensePreRouting ],\n    }\n  });\n\n  // return the count of all jobs in the queue\n  server.route({\n    path: `${mainEntry}/count`,\n    method: 'GET',\n    handler: (request, reply) => {\n      const results = jobsQuery.count(request);\n      reply(results);\n    },\n    config: {\n      pre: [ licensePreRouting ],\n    }\n  });\n\n  // return the raw output from a job\n  server.route({\n    path: `${mainEntry}/output/{docId}`,\n    method: 'GET',\n    handler: (request, reply) => {\n      const { docId } = request.params;\n\n      jobsQuery.get(request, docId, { includeContent: true })\n      .then((doc) => {\n        if (!doc) return reply(boom.notFound());\n        reply(doc._source.output);\n      });\n    },\n    config: {\n      pre: [ licensePreRouting ],\n      timeout: { socket: socketTimeout },\n    }\n  });\n\n  // trigger a download of the output from a job\n  server.route({\n    path: `${mainEntry}/download/{docId}`,\n    method: 'GET',\n    handler: (request, reply) => {\n      const { docId } = request.params;\n      const jobType = constants.JOBTYPES.PRINTABLE_PDF;\n      const syncResponse = has(request.query, 'sync');\n\n      jobResponseHandler(request, reply, { docId, jobType }, { sync: syncResponse });\n    },\n    config: {\n      pre: [ licensePreRouting, userPreRouting ],\n      timeout: { socket: socketTimeout },\n      tags: [API_TAG],\n    },\n  });\n};\n"
      ]
    },
    "mtime": 1491771510542
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/create_queue.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "esqueue",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "Esqueue"
              }
            ]
          },
          {
            "source": "./create_workers",
            "imported": [
              "createWorkersFactory"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "createWorkersFactory",
                "local": "createWorkersFactory"
              }
            ]
          },
          {
            "source": "./constants",
            "imported": [
              "constants"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "constants",
                "local": "constants"
              }
            ]
          },
          {
            "source": "./once_per_server",
            "imported": [
              "oncePerServer"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "oncePerServer",
                "local": "oncePerServer"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "createQueueFactory"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "createQueueFactory",
              "exported": "createQueueFactory"
            }
          ]
        }
      },
      "usedHelpers": [
        "interop-require-default"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _esqueue = require('esqueue');\n\nvar _esqueue2 = _interopRequireDefault(_esqueue);\n\nvar _create_workers = require('./create_workers');\n\nvar _constants = require('./constants');\n\nvar _once_per_server = require('./once_per_server');\n\nvar dateSeparator = '.';\n\nfunction createQueueFn(server) {\n  var queueConfig = server.config().get('xpack.reporting.queue');\n  var createWorkers = (0, _create_workers.createWorkersFactory)(server);\n\n  var _server$plugins$elasticsearch$getCluster = server.plugins.elasticsearch.getCluster('admin');\n\n  var getClient = _server$plugins$elasticsearch$getCluster.getClient;\n\n  var queueOptions = {\n    doctype: _constants.constants.QUEUE_DOCTYPE,\n    interval: queueConfig.indexInterval,\n    timeout: queueConfig.timeout,\n    dateSeparator: dateSeparator,\n    client: getClient()\n  };\n\n  var queue = new _esqueue2['default'](_constants.constants.QUEUE_INDEX, queueOptions);\n\n  createWorkers(queue);\n\n  return queue;\n}\n\nvar createQueueFactory = (0, _once_per_server.oncePerServer)(createQueueFn);\nexports.createQueueFactory = createQueueFactory;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvcmVwb3J0aW5nL3NlcnZlci9saWIvY3JlYXRlX3F1ZXVlLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7O3VCQUFvQixTQUFTOzs7OzhCQUNRLGtCQUFrQjs7eUJBQzdCLGFBQWE7OytCQUNULG1CQUFtQjs7QUFFakQsSUFBTSxhQUFhLEdBQUcsR0FBRyxDQUFDOztBQUUxQixTQUFTLGFBQWEsQ0FBQyxNQUFNLEVBQUU7QUFDN0IsTUFBTSxXQUFXLEdBQUcsTUFBTSxDQUFDLE1BQU0sRUFBRSxDQUFDLEdBQUcsQ0FBQyx1QkFBdUIsQ0FBQyxDQUFDO0FBQ2pFLE1BQU0sYUFBYSxHQUFHLDBDQUFxQixNQUFNLENBQUMsQ0FBQzs7aURBQzdCLE1BQU0sQ0FBQyxPQUFPLENBQUMsYUFBYSxDQUFDLFVBQVUsQ0FBQyxPQUFPLENBQUM7O01BQTlELFNBQVMsNENBQVQsU0FBUzs7QUFFakIsTUFBTSxZQUFZLEdBQUc7QUFDbkIsV0FBTyxFQUFFLHFCQUFVLGFBQWE7QUFDaEMsWUFBUSxFQUFFLFdBQVcsQ0FBQyxhQUFhO0FBQ25DLFdBQU8sRUFBRSxXQUFXLENBQUMsT0FBTztBQUM1QixpQkFBYSxFQUFFLGFBQWE7QUFDNUIsVUFBTSxFQUFFLFNBQVMsRUFBRTtHQUNwQixDQUFDOztBQUVGLE1BQU0sS0FBSyxHQUFHLHlCQUFZLHFCQUFVLFdBQVcsRUFBRSxZQUFZLENBQUMsQ0FBQzs7QUFFL0QsZUFBYSxDQUFDLEtBQUssQ0FBQyxDQUFDOztBQUVyQixTQUFPLEtBQUssQ0FBQztDQUNkOztBQUVNLElBQU0sa0JBQWtCLEdBQUcsb0NBQWMsYUFBYSxDQUFDLENBQUMiLCJmaWxlIjoiL3Vzci9zaGFyZS9raWJhbmEvcGx1Z2lucy94LXBhY2svcGx1Z2lucy9yZXBvcnRpbmcvc2VydmVyL2xpYi9jcmVhdGVfcXVldWUuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgRXNxdWV1ZSBmcm9tICdlc3F1ZXVlJztcbmltcG9ydCB7IGNyZWF0ZVdvcmtlcnNGYWN0b3J5IH0gZnJvbSAnLi9jcmVhdGVfd29ya2Vycyc7XG5pbXBvcnQgeyBjb25zdGFudHMgfSBmcm9tICcuL2NvbnN0YW50cyc7XG5pbXBvcnQgeyBvbmNlUGVyU2VydmVyIH0gZnJvbSAnLi9vbmNlX3Blcl9zZXJ2ZXInO1xuXG5jb25zdCBkYXRlU2VwYXJhdG9yID0gJy4nO1xuXG5mdW5jdGlvbiBjcmVhdGVRdWV1ZUZuKHNlcnZlcikge1xuICBjb25zdCBxdWV1ZUNvbmZpZyA9IHNlcnZlci5jb25maWcoKS5nZXQoJ3hwYWNrLnJlcG9ydGluZy5xdWV1ZScpO1xuICBjb25zdCBjcmVhdGVXb3JrZXJzID0gY3JlYXRlV29ya2Vyc0ZhY3Rvcnkoc2VydmVyKTtcbiAgY29uc3QgeyBnZXRDbGllbnQgfSA9IHNlcnZlci5wbHVnaW5zLmVsYXN0aWNzZWFyY2guZ2V0Q2x1c3RlcignYWRtaW4nKTtcblxuICBjb25zdCBxdWV1ZU9wdGlvbnMgPSB7XG4gICAgZG9jdHlwZTogY29uc3RhbnRzLlFVRVVFX0RPQ1RZUEUsXG4gICAgaW50ZXJ2YWw6IHF1ZXVlQ29uZmlnLmluZGV4SW50ZXJ2YWwsXG4gICAgdGltZW91dDogcXVldWVDb25maWcudGltZW91dCxcbiAgICBkYXRlU2VwYXJhdG9yOiBkYXRlU2VwYXJhdG9yLFxuICAgIGNsaWVudDogZ2V0Q2xpZW50KClcbiAgfTtcblxuICBjb25zdCBxdWV1ZSA9IG5ldyBFc3F1ZXVlKGNvbnN0YW50cy5RVUVVRV9JTkRFWCwgcXVldWVPcHRpb25zKTtcblxuICBjcmVhdGVXb3JrZXJzKHF1ZXVlKTtcblxuICByZXR1cm4gcXVldWU7XG59XG5cbmV4cG9ydCBjb25zdCBjcmVhdGVRdWV1ZUZhY3RvcnkgPSBvbmNlUGVyU2VydmVyKGNyZWF0ZVF1ZXVlRm4pO1xuIl19",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/create_queue.js"
      ],
      "names": [],
      "mappings": ";;;;;;;;uBAAoB,SAAS;;;;8BACQ,kBAAkB;;yBAC7B,aAAa;;+BACT,mBAAmB;;AAEjD,IAAM,aAAa,GAAG,GAAG,CAAC;;AAE1B,SAAS,aAAa,CAAC,MAAM,EAAE;AAC7B,MAAM,WAAW,GAAG,MAAM,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,uBAAuB,CAAC,CAAC;AACjE,MAAM,aAAa,GAAG,0CAAqB,MAAM,CAAC,CAAC;;iDAC7B,MAAM,CAAC,OAAO,CAAC,aAAa,CAAC,UAAU,CAAC,OAAO,CAAC;;MAA9D,SAAS,4CAAT,SAAS;;AAEjB,MAAM,YAAY,GAAG;AACnB,WAAO,EAAE,qBAAU,aAAa;AAChC,YAAQ,EAAE,WAAW,CAAC,aAAa;AACnC,WAAO,EAAE,WAAW,CAAC,OAAO;AAC5B,iBAAa,EAAE,aAAa;AAC5B,UAAM,EAAE,SAAS,EAAE;GACpB,CAAC;;AAEF,MAAM,KAAK,GAAG,yBAAY,qBAAU,WAAW,EAAE,YAAY,CAAC,CAAC;;AAE/D,eAAa,CAAC,KAAK,CAAC,CAAC;;AAErB,SAAO,KAAK,CAAC;CACd;;AAEM,IAAM,kBAAkB,GAAG,oCAAc,aAAa,CAAC,CAAC",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/create_queue.js",
      "sourcesContent": [
        "import Esqueue from 'esqueue';\nimport { createWorkersFactory } from './create_workers';\nimport { constants } from './constants';\nimport { oncePerServer } from './once_per_server';\n\nconst dateSeparator = '.';\n\nfunction createQueueFn(server) {\n  const queueConfig = server.config().get('xpack.reporting.queue');\n  const createWorkers = createWorkersFactory(server);\n  const { getClient } = server.plugins.elasticsearch.getCluster('admin');\n\n  const queueOptions = {\n    doctype: constants.QUEUE_DOCTYPE,\n    interval: queueConfig.indexInterval,\n    timeout: queueConfig.timeout,\n    dateSeparator: dateSeparator,\n    client: getClient()\n  };\n\n  const queue = new Esqueue(constants.QUEUE_INDEX, queueOptions);\n\n  createWorkers(queue);\n\n  return queue;\n}\n\nexport const createQueueFactory = oncePerServer(createQueueFn);\n"
      ]
    },
    "mtime": 1491771510540
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/create_workers.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "esqueue/lib/constants/events",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "esqueueEvents"
              }
            ]
          },
          {
            "source": "./constants",
            "imported": [
              "constants"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "constants",
                "local": "constants"
              }
            ]
          },
          {
            "source": "./workers",
            "imported": [
              "workersFactory"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "workersFactory",
                "local": "workersFactory"
              }
            ]
          },
          {
            "source": "./once_per_server",
            "imported": [
              "oncePerServer"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "oncePerServer",
                "local": "oncePerServer"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "createWorkersFactory"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "createWorkersFactory",
              "exported": "createWorkersFactory"
            }
          ]
        }
      },
      "usedHelpers": [
        "interop-require-default"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _esqueueLibConstantsEvents = require('esqueue/lib/constants/events');\n\nvar _esqueueLibConstantsEvents2 = _interopRequireDefault(_esqueueLibConstantsEvents);\n\nvar _constants = require('./constants');\n\nvar _workers = require('./workers');\n\nvar _once_per_server = require('./once_per_server');\n\nfunction createWorkersFn(server) {\n  var queueConfig = server.config().get('xpack.reporting.queue');\n  var workers = (0, _workers.workersFactory)(server);\n\n  // Once more document types are added, this will need to be passed in\n  return function createWorkers(queue) {\n    var workerTypes = [_constants.constants.JOBTYPES.PRINTABLE_PDF];\n\n    workerTypes.forEach(function (workerType) {\n      var log = function log(msg) {\n        server.log(['reporting', 'worker', 'debug'], workerType + ': ' + msg);\n      };\n\n      log('Registering ' + workerType + ' worker');\n      var workerFn = workers[workerType];\n      var workerOptions = {\n        interval: queueConfig.pollInterval\n      };\n      var worker = queue.registerWorker(workerType, workerFn, workerOptions);\n\n      worker.on(_esqueueLibConstantsEvents2['default'].EVENT_WORKER_COMPLETE, function (res) {\n        return log('Worker completed: (' + res.job.id + ')');\n      });\n      worker.on(_esqueueLibConstantsEvents2['default'].EVENT_WORKER_JOB_EXECUTION_ERROR, function (res) {\n        return log('Worker error: (' + res.job.id + ')');\n      });\n      worker.on(_esqueueLibConstantsEvents2['default'].EVENT_WORKER_JOB_TIMEOUT, function (res) {\n        return log('Job timeout exceeded: (' + res.job.id + ')');\n      });\n    });\n  };\n};\n\nvar createWorkersFactory = (0, _once_per_server.oncePerServer)(createWorkersFn);\nexports.createWorkersFactory = createWorkersFactory;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvcmVwb3J0aW5nL3NlcnZlci9saWIvY3JlYXRlX3dvcmtlcnMuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7eUNBQTBCLDhCQUE4Qjs7Ozt5QkFDOUIsYUFBYTs7dUJBQ1IsV0FBVzs7K0JBQ1osbUJBQW1COztBQUVqRCxTQUFTLGVBQWUsQ0FBQyxNQUFNLEVBQUU7QUFDL0IsTUFBTSxXQUFXLEdBQUcsTUFBTSxDQUFDLE1BQU0sRUFBRSxDQUFDLEdBQUcsQ0FBQyx1QkFBdUIsQ0FBQyxDQUFDO0FBQ2pFLE1BQU0sT0FBTyxHQUFHLDZCQUFlLE1BQU0sQ0FBQyxDQUFDOzs7QUFHdkMsU0FBTyxTQUFTLGFBQWEsQ0FBQyxLQUFLLEVBQUU7QUFDbkMsUUFBTSxXQUFXLEdBQUcsQ0FDbEIscUJBQVUsUUFBUSxDQUFDLGFBQWEsQ0FDakMsQ0FBQzs7QUFFRixlQUFXLENBQUMsT0FBTyxDQUFDLFVBQUMsVUFBVSxFQUFLO0FBQ2xDLFVBQU0sR0FBRyxHQUFHLFNBQU4sR0FBRyxDQUFJLEdBQUcsRUFBSztBQUNuQixjQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsV0FBVyxFQUFFLFFBQVEsRUFBRSxPQUFPLENBQUMsRUFBSyxVQUFVLFVBQUssR0FBRyxDQUFHLENBQUM7T0FDdkUsQ0FBQzs7QUFFRixTQUFHLGtCQUFnQixVQUFVLGFBQVUsQ0FBQztBQUN4QyxVQUFNLFFBQVEsR0FBRyxPQUFPLENBQUMsVUFBVSxDQUFDLENBQUM7QUFDckMsVUFBTSxhQUFhLEdBQUc7QUFDcEIsZ0JBQVEsRUFBRSxXQUFXLENBQUMsWUFBWTtPQUNuQyxDQUFDO0FBQ0YsVUFBTSxNQUFNLEdBQUcsS0FBSyxDQUFDLGNBQWMsQ0FBQyxVQUFVLEVBQUUsUUFBUSxFQUFFLGFBQWEsQ0FBQyxDQUFDOztBQUV6RSxZQUFNLENBQUMsRUFBRSxDQUFDLHVDQUFjLHFCQUFxQixFQUFFLFVBQUMsR0FBRztlQUFLLEdBQUcseUJBQXVCLEdBQUcsQ0FBQyxHQUFHLENBQUMsRUFBRSxPQUFJO09BQUEsQ0FBQyxDQUFDO0FBQ2xHLFlBQU0sQ0FBQyxFQUFFLENBQUMsdUNBQWMsZ0NBQWdDLEVBQUUsVUFBQyxHQUFHO2VBQUssR0FBRyxxQkFBbUIsR0FBRyxDQUFDLEdBQUcsQ0FBQyxFQUFFLE9BQUk7T0FBQSxDQUFDLENBQUM7QUFDekcsWUFBTSxDQUFDLEVBQUUsQ0FBQyx1Q0FBYyx3QkFBd0IsRUFBRSxVQUFDLEdBQUc7ZUFBSyxHQUFHLDZCQUEyQixHQUFHLENBQUMsR0FBRyxDQUFDLEVBQUUsT0FBSTtPQUFBLENBQUMsQ0FBQztLQUMxRyxDQUFDLENBQUM7R0FDSixDQUFDO0NBQ0gsQ0FBQzs7QUFFSyxJQUFNLG9CQUFvQixHQUFHLG9DQUFjLGVBQWUsQ0FBQyxDQUFDIiwiZmlsZSI6Ii91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvcmVwb3J0aW5nL3NlcnZlci9saWIvY3JlYXRlX3dvcmtlcnMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZXNxdWV1ZUV2ZW50cyBmcm9tICdlc3F1ZXVlL2xpYi9jb25zdGFudHMvZXZlbnRzJztcbmltcG9ydCB7IGNvbnN0YW50cyB9IGZyb20gJy4vY29uc3RhbnRzJztcbmltcG9ydCB7IHdvcmtlcnNGYWN0b3J5IH0gZnJvbSAnLi93b3JrZXJzJztcbmltcG9ydCB7IG9uY2VQZXJTZXJ2ZXIgfSBmcm9tICcuL29uY2VfcGVyX3NlcnZlcic7XG5cbmZ1bmN0aW9uIGNyZWF0ZVdvcmtlcnNGbihzZXJ2ZXIpIHtcbiAgY29uc3QgcXVldWVDb25maWcgPSBzZXJ2ZXIuY29uZmlnKCkuZ2V0KCd4cGFjay5yZXBvcnRpbmcucXVldWUnKTtcbiAgY29uc3Qgd29ya2VycyA9IHdvcmtlcnNGYWN0b3J5KHNlcnZlcik7XG5cbiAgLy8gT25jZSBtb3JlIGRvY3VtZW50IHR5cGVzIGFyZSBhZGRlZCwgdGhpcyB3aWxsIG5lZWQgdG8gYmUgcGFzc2VkIGluXG4gIHJldHVybiBmdW5jdGlvbiBjcmVhdGVXb3JrZXJzKHF1ZXVlKSB7XG4gICAgY29uc3Qgd29ya2VyVHlwZXMgPSBbXG4gICAgICBjb25zdGFudHMuSk9CVFlQRVMuUFJJTlRBQkxFX1BERlxuICAgIF07XG5cbiAgICB3b3JrZXJUeXBlcy5mb3JFYWNoKCh3b3JrZXJUeXBlKSA9PiB7XG4gICAgICBjb25zdCBsb2cgPSAobXNnKSA9PiB7XG4gICAgICAgIHNlcnZlci5sb2coWydyZXBvcnRpbmcnLCAnd29ya2VyJywgJ2RlYnVnJ10sIGAke3dvcmtlclR5cGV9OiAke21zZ31gKTtcbiAgICAgIH07XG5cbiAgICAgIGxvZyhgUmVnaXN0ZXJpbmcgJHt3b3JrZXJUeXBlfSB3b3JrZXJgKTtcbiAgICAgIGNvbnN0IHdvcmtlckZuID0gd29ya2Vyc1t3b3JrZXJUeXBlXTtcbiAgICAgIGNvbnN0IHdvcmtlck9wdGlvbnMgPSB7XG4gICAgICAgIGludGVydmFsOiBxdWV1ZUNvbmZpZy5wb2xsSW50ZXJ2YWxcbiAgICAgIH07XG4gICAgICBjb25zdCB3b3JrZXIgPSBxdWV1ZS5yZWdpc3Rlcldvcmtlcih3b3JrZXJUeXBlLCB3b3JrZXJGbiwgd29ya2VyT3B0aW9ucyk7XG5cbiAgICAgIHdvcmtlci5vbihlc3F1ZXVlRXZlbnRzLkVWRU5UX1dPUktFUl9DT01QTEVURSwgKHJlcykgPT4gbG9nKGBXb3JrZXIgY29tcGxldGVkOiAoJHtyZXMuam9iLmlkfSlgKSk7XG4gICAgICB3b3JrZXIub24oZXNxdWV1ZUV2ZW50cy5FVkVOVF9XT1JLRVJfSk9CX0VYRUNVVElPTl9FUlJPUiwgKHJlcykgPT4gbG9nKGBXb3JrZXIgZXJyb3I6ICgke3Jlcy5qb2IuaWR9KWApKTtcbiAgICAgIHdvcmtlci5vbihlc3F1ZXVlRXZlbnRzLkVWRU5UX1dPUktFUl9KT0JfVElNRU9VVCwgKHJlcykgPT4gbG9nKGBKb2IgdGltZW91dCBleGNlZWRlZDogKCR7cmVzLmpvYi5pZH0pYCkpO1xuICAgIH0pO1xuICB9O1xufTtcblxuZXhwb3J0IGNvbnN0IGNyZWF0ZVdvcmtlcnNGYWN0b3J5ID0gb25jZVBlclNlcnZlcihjcmVhdGVXb3JrZXJzRm4pO1xuIl19",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/create_workers.js"
      ],
      "names": [],
      "mappings": ";;;;;;;;yCAA0B,8BAA8B;;;;yBAC9B,aAAa;;uBACR,WAAW;;+BACZ,mBAAmB;;AAEjD,SAAS,eAAe,CAAC,MAAM,EAAE;AAC/B,MAAM,WAAW,GAAG,MAAM,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,uBAAuB,CAAC,CAAC;AACjE,MAAM,OAAO,GAAG,6BAAe,MAAM,CAAC,CAAC;;;AAGvC,SAAO,SAAS,aAAa,CAAC,KAAK,EAAE;AACnC,QAAM,WAAW,GAAG,CAClB,qBAAU,QAAQ,CAAC,aAAa,CACjC,CAAC;;AAEF,eAAW,CAAC,OAAO,CAAC,UAAC,UAAU,EAAK;AAClC,UAAM,GAAG,GAAG,SAAN,GAAG,CAAI,GAAG,EAAK;AACnB,cAAM,CAAC,GAAG,CAAC,CAAC,WAAW,EAAE,QAAQ,EAAE,OAAO,CAAC,EAAK,UAAU,UAAK,GAAG,CAAG,CAAC;OACvE,CAAC;;AAEF,SAAG,kBAAgB,UAAU,aAAU,CAAC;AACxC,UAAM,QAAQ,GAAG,OAAO,CAAC,UAAU,CAAC,CAAC;AACrC,UAAM,aAAa,GAAG;AACpB,gBAAQ,EAAE,WAAW,CAAC,YAAY;OACnC,CAAC;AACF,UAAM,MAAM,GAAG,KAAK,CAAC,cAAc,CAAC,UAAU,EAAE,QAAQ,EAAE,aAAa,CAAC,CAAC;;AAEzE,YAAM,CAAC,EAAE,CAAC,uCAAc,qBAAqB,EAAE,UAAC,GAAG;eAAK,GAAG,yBAAuB,GAAG,CAAC,GAAG,CAAC,EAAE,OAAI;OAAA,CAAC,CAAC;AAClG,YAAM,CAAC,EAAE,CAAC,uCAAc,gCAAgC,EAAE,UAAC,GAAG;eAAK,GAAG,qBAAmB,GAAG,CAAC,GAAG,CAAC,EAAE,OAAI;OAAA,CAAC,CAAC;AACzG,YAAM,CAAC,EAAE,CAAC,uCAAc,wBAAwB,EAAE,UAAC,GAAG;eAAK,GAAG,6BAA2B,GAAG,CAAC,GAAG,CAAC,EAAE,OAAI;OAAA,CAAC,CAAC;KAC1G,CAAC,CAAC;GACJ,CAAC;CACH,CAAC;;AAEK,IAAM,oBAAoB,GAAG,oCAAc,eAAe,CAAC,CAAC",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/create_workers.js",
      "sourcesContent": [
        "import esqueueEvents from 'esqueue/lib/constants/events';\nimport { constants } from './constants';\nimport { workersFactory } from './workers';\nimport { oncePerServer } from './once_per_server';\n\nfunction createWorkersFn(server) {\n  const queueConfig = server.config().get('xpack.reporting.queue');\n  const workers = workersFactory(server);\n\n  // Once more document types are added, this will need to be passed in\n  return function createWorkers(queue) {\n    const workerTypes = [\n      constants.JOBTYPES.PRINTABLE_PDF\n    ];\n\n    workerTypes.forEach((workerType) => {\n      const log = (msg) => {\n        server.log(['reporting', 'worker', 'debug'], `${workerType}: ${msg}`);\n      };\n\n      log(`Registering ${workerType} worker`);\n      const workerFn = workers[workerType];\n      const workerOptions = {\n        interval: queueConfig.pollInterval\n      };\n      const worker = queue.registerWorker(workerType, workerFn, workerOptions);\n\n      worker.on(esqueueEvents.EVENT_WORKER_COMPLETE, (res) => log(`Worker completed: (${res.job.id})`));\n      worker.on(esqueueEvents.EVENT_WORKER_JOB_EXECUTION_ERROR, (res) => log(`Worker error: (${res.job.id})`));\n      worker.on(esqueueEvents.EVENT_WORKER_JOB_TIMEOUT, (res) => log(`Job timeout exceeded: (${res.job.id})`));\n    });\n  };\n};\n\nexport const createWorkersFactory = oncePerServer(createWorkersFn);\n"
      ]
    },
    "mtime": 1491771510540
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/reporting/server/config/config.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "os",
            "imported": [
              "cpus"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "cpus",
                "local": "cpus"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "config"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "config",
              "exported": "config"
            }
          ]
        }
      },
      "usedHelpers": []
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nvar _os = require('os');\n\nvar defaultCPUCount = 2;\n\nfunction cpuCount() {\n  try {\n    return (0, _os.cpus)().length;\n  } catch (e) {\n    return defaultCPUCount;\n  }\n};\n\nvar config = {\n  concurrency: cpuCount()\n};\nexports.config = config;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvcmVwb3J0aW5nL3NlcnZlci9jb25maWcvY29uZmlnLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7OztrQkFBcUIsSUFBSTs7QUFFekIsSUFBTSxlQUFlLEdBQUcsQ0FBQyxDQUFDOztBQUUxQixTQUFTLFFBQVEsR0FBRztBQUNsQixNQUFJO0FBQ0YsV0FBTyxlQUFNLENBQUMsTUFBTSxDQUFDO0dBQ3RCLENBQUMsT0FBTyxDQUFDLEVBQUU7QUFDVixXQUFPLGVBQWUsQ0FBQztHQUN4QjtDQUNGLENBQUM7O0FBRUssSUFBTSxNQUFNLEdBQUc7QUFDcEIsYUFBVyxFQUFFLFFBQVEsRUFBRTtDQUN4QixDQUFDIiwiZmlsZSI6Ii91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvcmVwb3J0aW5nL3NlcnZlci9jb25maWcvY29uZmlnLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3B1cyB9IGZyb20gJ29zJztcblxuY29uc3QgZGVmYXVsdENQVUNvdW50ID0gMjtcblxuZnVuY3Rpb24gY3B1Q291bnQoKSB7XG4gIHRyeSB7XG4gICAgcmV0dXJuIGNwdXMoKS5sZW5ndGg7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICByZXR1cm4gZGVmYXVsdENQVUNvdW50O1xuICB9XG59O1xuXG5leHBvcnQgY29uc3QgY29uZmlnID0ge1xuICBjb25jdXJyZW5jeTogY3B1Q291bnQoKVxufTtcbiJdfQ==",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/config/config.js"
      ],
      "names": [],
      "mappings": ";;;;;;kBAAqB,IAAI;;AAEzB,IAAM,eAAe,GAAG,CAAC,CAAC;;AAE1B,SAAS,QAAQ,GAAG;AAClB,MAAI;AACF,WAAO,eAAM,CAAC,MAAM,CAAC;GACtB,CAAC,OAAO,CAAC,EAAE;AACV,WAAO,eAAe,CAAC;GACxB;CACF,CAAC;;AAEK,IAAM,MAAM,GAAG;AACpB,aAAW,EAAE,QAAQ,EAAE;CACxB,CAAC",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/config/config.js",
      "sourcesContent": [
        "import { cpus } from 'os';\n\nconst defaultCPUCount = 2;\n\nfunction cpuCount() {\n  try {\n    return cpus().length;\n  } catch (e) {\n    return defaultCPUCount;\n  }\n};\n\nexport const config = {\n  concurrency: cpuCount()\n};\n"
      ]
    },
    "mtime": 1491771510540
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/check_license.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [],
        "exports": {
          "exported": [
            "checkLicense",
            "xpackLicenseInfo"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "checkLicense",
              "exported": "checkLicense"
            },
            {
              "kind": "local",
              "local": "xpackLicenseInfo",
              "exported": "xpackLicenseInfo"
            }
          ]
        }
      },
      "usedHelpers": []
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nexports.checkLicense = checkLicense;\n\nfunction checkLicense(xpackLicenseInfo) {\n  // If, for some reason, we cannot get the license information\n  // from Elasticsearch, assume worst case and disable reporting\n  if (!xpackLicenseInfo || !xpackLicenseInfo.isAvailable()) {\n    return {\n      showLinks: true,\n      enableLinks: false,\n      message: 'You cannot use Reporting because license information is not available at this time.'\n    };\n  }\n\n  var VALID_LICENSE_MODES_TO_ENABLE_REPORTING = ['trial', 'standard', 'gold', 'platinum'];\n\n  var isLicenseModeValid = xpackLicenseInfo.license.isOneOf(VALID_LICENSE_MODES_TO_ENABLE_REPORTING);\n  var isLicenseActive = xpackLicenseInfo.license.isActive();\n\n  // License is not valid\n  if (!isLicenseModeValid) {\n    return {\n      showLinks: false,\n      message: 'Your ' + xpackLicenseInfo.license.getType() + ' license does not support Reporting. Please upgrade your license.'\n    };\n  }\n\n  // License is valid but not active\n  if (!isLicenseActive) {\n    return {\n      showLinks: true,\n      enableLinks: false,\n      message: 'You cannot use Reporting because your ' + xpackLicenseInfo.license.getType() + ' license has expired.'\n    };\n  }\n\n  // License is valid and active\n  return {\n    showLinks: true,\n    enableLinks: true\n  };\n}\n\n;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvcmVwb3J0aW5nL3NlcnZlci9saWIvY2hlY2tfbGljZW5zZS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQU8sU0FBUyxZQUFZLENBQUMsZ0JBQWdCLEVBQUU7OztBQUc3QyxNQUFJLENBQUMsZ0JBQWdCLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxXQUFXLEVBQUUsRUFBRTtBQUN4RCxXQUFPO0FBQ0wsZUFBUyxFQUFFLElBQUk7QUFDZixpQkFBVyxFQUFFLEtBQUs7QUFDbEIsYUFBTyxFQUFFLHFGQUFxRjtLQUMvRixDQUFDO0dBQ0g7O0FBRUQsTUFBTSx1Q0FBdUMsR0FBRyxDQUM5QyxPQUFPLEVBQ1AsVUFBVSxFQUNWLE1BQU0sRUFDTixVQUFVLENBQ1gsQ0FBQzs7QUFFRixNQUFNLGtCQUFrQixHQUFHLGdCQUFnQixDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsdUNBQXVDLENBQUMsQ0FBQztBQUNyRyxNQUFNLGVBQWUsR0FBRyxnQkFBZ0IsQ0FBQyxPQUFPLENBQUMsUUFBUSxFQUFFLENBQUM7OztBQUc1RCxNQUFJLENBQUMsa0JBQWtCLEVBQUU7QUFDdkIsV0FBTztBQUNMLGVBQVMsRUFBRSxLQUFLO0FBQ2hCLGFBQU8sWUFBVSxnQkFBZ0IsQ0FBQyxPQUFPLENBQUMsT0FBTyxFQUFFLHNFQUFtRTtLQUN2SCxDQUFDO0dBQ0g7OztBQUdELE1BQUksQ0FBQyxlQUFlLEVBQUU7QUFDcEIsV0FBTztBQUNMLGVBQVMsRUFBRSxJQUFJO0FBQ2YsaUJBQVcsRUFBRSxLQUFLO0FBQ2xCLGFBQU8sNkNBQTJDLGdCQUFnQixDQUFDLE9BQU8sQ0FBQyxPQUFPLEVBQUUsMEJBQXVCO0tBQzVHLENBQUM7R0FDSDs7O0FBR0QsU0FBTztBQUNMLGFBQVMsRUFBRSxJQUFJO0FBQ2YsZUFBVyxFQUFFLElBQUk7R0FDbEIsQ0FBQztDQUNIOztBQUFBLENBQUMiLCJmaWxlIjoiL3Vzci9zaGFyZS9raWJhbmEvcGx1Z2lucy94LXBhY2svcGx1Z2lucy9yZXBvcnRpbmcvc2VydmVyL2xpYi9jaGVja19saWNlbnNlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGZ1bmN0aW9uIGNoZWNrTGljZW5zZSh4cGFja0xpY2Vuc2VJbmZvKSB7XG4gIC8vIElmLCBmb3Igc29tZSByZWFzb24sIHdlIGNhbm5vdCBnZXQgdGhlIGxpY2Vuc2UgaW5mb3JtYXRpb25cbiAgLy8gZnJvbSBFbGFzdGljc2VhcmNoLCBhc3N1bWUgd29yc3QgY2FzZSBhbmQgZGlzYWJsZSByZXBvcnRpbmdcbiAgaWYgKCF4cGFja0xpY2Vuc2VJbmZvIHx8ICF4cGFja0xpY2Vuc2VJbmZvLmlzQXZhaWxhYmxlKCkpIHtcbiAgICByZXR1cm4ge1xuICAgICAgc2hvd0xpbmtzOiB0cnVlLFxuICAgICAgZW5hYmxlTGlua3M6IGZhbHNlLFxuICAgICAgbWVzc2FnZTogJ1lvdSBjYW5ub3QgdXNlIFJlcG9ydGluZyBiZWNhdXNlIGxpY2Vuc2UgaW5mb3JtYXRpb24gaXMgbm90IGF2YWlsYWJsZSBhdCB0aGlzIHRpbWUuJ1xuICAgIH07XG4gIH1cblxuICBjb25zdCBWQUxJRF9MSUNFTlNFX01PREVTX1RPX0VOQUJMRV9SRVBPUlRJTkcgPSBbXG4gICAgJ3RyaWFsJyxcbiAgICAnc3RhbmRhcmQnLFxuICAgICdnb2xkJyxcbiAgICAncGxhdGludW0nXG4gIF07XG5cbiAgY29uc3QgaXNMaWNlbnNlTW9kZVZhbGlkID0geHBhY2tMaWNlbnNlSW5mby5saWNlbnNlLmlzT25lT2YoVkFMSURfTElDRU5TRV9NT0RFU19UT19FTkFCTEVfUkVQT1JUSU5HKTtcbiAgY29uc3QgaXNMaWNlbnNlQWN0aXZlID0geHBhY2tMaWNlbnNlSW5mby5saWNlbnNlLmlzQWN0aXZlKCk7XG5cbiAgLy8gTGljZW5zZSBpcyBub3QgdmFsaWRcbiAgaWYgKCFpc0xpY2Vuc2VNb2RlVmFsaWQpIHtcbiAgICByZXR1cm4ge1xuICAgICAgc2hvd0xpbmtzOiBmYWxzZSxcbiAgICAgIG1lc3NhZ2U6IGBZb3VyICR7eHBhY2tMaWNlbnNlSW5mby5saWNlbnNlLmdldFR5cGUoKX0gbGljZW5zZSBkb2VzIG5vdCBzdXBwb3J0IFJlcG9ydGluZy4gUGxlYXNlIHVwZ3JhZGUgeW91ciBsaWNlbnNlLmBcbiAgICB9O1xuICB9XG5cbiAgLy8gTGljZW5zZSBpcyB2YWxpZCBidXQgbm90IGFjdGl2ZVxuICBpZiAoIWlzTGljZW5zZUFjdGl2ZSkge1xuICAgIHJldHVybiB7XG4gICAgICBzaG93TGlua3M6IHRydWUsXG4gICAgICBlbmFibGVMaW5rczogZmFsc2UsXG4gICAgICBtZXNzYWdlOiBgWW91IGNhbm5vdCB1c2UgUmVwb3J0aW5nIGJlY2F1c2UgeW91ciAke3hwYWNrTGljZW5zZUluZm8ubGljZW5zZS5nZXRUeXBlKCl9IGxpY2Vuc2UgaGFzIGV4cGlyZWQuYFxuICAgIH07XG4gIH1cblxuICAvLyBMaWNlbnNlIGlzIHZhbGlkIGFuZCBhY3RpdmVcbiAgcmV0dXJuIHtcbiAgICBzaG93TGlua3M6IHRydWUsXG4gICAgZW5hYmxlTGlua3M6IHRydWVcbiAgfTtcbn07Il19",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/check_license.js"
      ],
      "names": [],
      "mappings": ";;;;;;;AAAO,SAAS,YAAY,CAAC,gBAAgB,EAAE;;;AAG7C,MAAI,CAAC,gBAAgB,IAAI,CAAC,gBAAgB,CAAC,WAAW,EAAE,EAAE;AACxD,WAAO;AACL,eAAS,EAAE,IAAI;AACf,iBAAW,EAAE,KAAK;AAClB,aAAO,EAAE,qFAAqF;KAC/F,CAAC;GACH;;AAED,MAAM,uCAAuC,GAAG,CAC9C,OAAO,EACP,UAAU,EACV,MAAM,EACN,UAAU,CACX,CAAC;;AAEF,MAAM,kBAAkB,GAAG,gBAAgB,CAAC,OAAO,CAAC,OAAO,CAAC,uCAAuC,CAAC,CAAC;AACrG,MAAM,eAAe,GAAG,gBAAgB,CAAC,OAAO,CAAC,QAAQ,EAAE,CAAC;;;AAG5D,MAAI,CAAC,kBAAkB,EAAE;AACvB,WAAO;AACL,eAAS,EAAE,KAAK;AAChB,aAAO,YAAU,gBAAgB,CAAC,OAAO,CAAC,OAAO,EAAE,sEAAmE;KACvH,CAAC;GACH;;;AAGD,MAAI,CAAC,eAAe,EAAE;AACpB,WAAO;AACL,eAAS,EAAE,IAAI;AACf,iBAAW,EAAE,KAAK;AAClB,aAAO,6CAA2C,gBAAgB,CAAC,OAAO,CAAC,OAAO,EAAE,0BAAuB;KAC5G,CAAC;GACH;;;AAGD,SAAO;AACL,aAAS,EAAE,IAAI;AACf,eAAW,EAAE,IAAI;GAClB,CAAC;CACH;;AAAA,CAAC",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/check_license.js",
      "sourcesContent": [
        "export function checkLicense(xpackLicenseInfo) {\n  // If, for some reason, we cannot get the license information\n  // from Elasticsearch, assume worst case and disable reporting\n  if (!xpackLicenseInfo || !xpackLicenseInfo.isAvailable()) {\n    return {\n      showLinks: true,\n      enableLinks: false,\n      message: 'You cannot use Reporting because license information is not available at this time.'\n    };\n  }\n\n  const VALID_LICENSE_MODES_TO_ENABLE_REPORTING = [\n    'trial',\n    'standard',\n    'gold',\n    'platinum'\n  ];\n\n  const isLicenseModeValid = xpackLicenseInfo.license.isOneOf(VALID_LICENSE_MODES_TO_ENABLE_REPORTING);\n  const isLicenseActive = xpackLicenseInfo.license.isActive();\n\n  // License is not valid\n  if (!isLicenseModeValid) {\n    return {\n      showLinks: false,\n      message: `Your ${xpackLicenseInfo.license.getType()} license does not support Reporting. Please upgrade your license.`\n    };\n  }\n\n  // License is valid but not active\n  if (!isLicenseActive) {\n    return {\n      showLinks: true,\n      enableLinks: false,\n      message: `You cannot use Reporting because your ${xpackLicenseInfo.license.getType()} license has expired.`\n    };\n  }\n\n  // License is valid and active\n  return {\n    showLinks: true,\n    enableLinks: true\n  };\n};"
      ]
    },
    "mtime": 1491771510540
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/validate_config.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "crypto",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "crypto"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "validateConfig",
            "config",
            "log"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "validateConfig",
              "exported": "validateConfig"
            },
            {
              "kind": "local",
              "local": "config",
              "exported": "config"
            },
            {
              "kind": "local",
              "local": "log",
              "exported": "log"
            }
          ]
        }
      },
      "usedHelpers": [
        "interop-require-default"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nexports.validateConfig = validateConfig;\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _crypto = require('crypto');\n\nvar _crypto2 = _interopRequireDefault(_crypto);\n\nfunction validateConfig(config, log) {\n  if (config.get('xpack.reporting.encryptionKey') == null) {\n    log('Generating a random key for xpack.reporting.encryptionKey. To prevent pending reports from failing on ' + 'restart, please set xpack.reporting.encryptionKey in kibana.yml');\n    config.set('xpack.reporting.encryptionKey', _crypto2['default'].randomBytes(16).toString('hex'));\n  }\n\n  // queue.syncSocketTimeout was replaced by generate.socketTimeout\n  var syncSocketTimeout = config.get('xpack.reporting.queue.syncSocketTimeout');\n  if (syncSocketTimeout != null) {\n    log('xpack.reporting.queue.syncSocketTimeout has been deprecated.');\n  }\n\n  // generate.socketTimeout is depricated and going away in 6.0\n  var socketTimeout = config.get('xpack.reporting.generate.socketTimeout');\n  if (socketTimeout) {\n    log('The \"&sync\" parameter and xpack.reporting.generate.socketTimeout setting have been deprecated ' + 'and will be removed in 6.0.');\n  }\n}\n\n;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvcmVwb3J0aW5nL3NlcnZlci9saWIvdmFsaWRhdGVfY29uZmlnLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7OztzQkFBbUIsUUFBUTs7OztBQUVwQixTQUFTLGNBQWMsQ0FBQyxNQUFNLEVBQUUsR0FBRyxFQUFFO0FBQzFDLE1BQUksTUFBTSxDQUFDLEdBQUcsQ0FBQywrQkFBK0IsQ0FBQyxJQUFJLElBQUksRUFBRTtBQUN2RCxPQUFHLENBQUMsd0dBQXdHLEdBQzFHLGlFQUFpRSxDQUFDLENBQUM7QUFDckUsVUFBTSxDQUFDLEdBQUcsQ0FBQywrQkFBK0IsRUFBRSxvQkFBTyxXQUFXLENBQUMsRUFBRSxDQUFDLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUM7R0FDckY7OztBQUdELE1BQU0saUJBQWlCLEdBQUcsTUFBTSxDQUFDLEdBQUcsQ0FBQyx5Q0FBeUMsQ0FBQyxDQUFDO0FBQ2hGLE1BQUksaUJBQWlCLElBQUksSUFBSSxFQUFFO0FBQzdCLE9BQUcsQ0FBQyw4REFBOEQsQ0FBQyxDQUFDO0dBQ3JFOzs7QUFHRCxNQUFNLGFBQWEsR0FBRyxNQUFNLENBQUMsR0FBRyxDQUFDLHdDQUF3QyxDQUFDLENBQUM7QUFDM0UsTUFBSSxhQUFhLEVBQUU7QUFDakIsT0FBRyxDQUFDLGdHQUFnRyxHQUNsRyw2QkFBNkIsQ0FBQyxDQUFDO0dBQ2xDO0NBQ0Y7O0FBQUEsQ0FBQyIsImZpbGUiOiIvdXNyL3NoYXJlL2tpYmFuYS9wbHVnaW5zL3gtcGFjay9wbHVnaW5zL3JlcG9ydGluZy9zZXJ2ZXIvbGliL3ZhbGlkYXRlX2NvbmZpZy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBjcnlwdG8gZnJvbSAnY3J5cHRvJztcblxuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlQ29uZmlnKGNvbmZpZywgbG9nKSB7XG4gIGlmIChjb25maWcuZ2V0KCd4cGFjay5yZXBvcnRpbmcuZW5jcnlwdGlvbktleScpID09IG51bGwpIHtcbiAgICBsb2coJ0dlbmVyYXRpbmcgYSByYW5kb20ga2V5IGZvciB4cGFjay5yZXBvcnRpbmcuZW5jcnlwdGlvbktleS4gVG8gcHJldmVudCBwZW5kaW5nIHJlcG9ydHMgZnJvbSBmYWlsaW5nIG9uICcgK1xuICAgICAgJ3Jlc3RhcnQsIHBsZWFzZSBzZXQgeHBhY2sucmVwb3J0aW5nLmVuY3J5cHRpb25LZXkgaW4ga2liYW5hLnltbCcpO1xuICAgIGNvbmZpZy5zZXQoJ3hwYWNrLnJlcG9ydGluZy5lbmNyeXB0aW9uS2V5JywgY3J5cHRvLnJhbmRvbUJ5dGVzKDE2KS50b1N0cmluZygnaGV4JykpO1xuICB9XG5cbiAgLy8gcXVldWUuc3luY1NvY2tldFRpbWVvdXQgd2FzIHJlcGxhY2VkIGJ5IGdlbmVyYXRlLnNvY2tldFRpbWVvdXRcbiAgY29uc3Qgc3luY1NvY2tldFRpbWVvdXQgPSBjb25maWcuZ2V0KCd4cGFjay5yZXBvcnRpbmcucXVldWUuc3luY1NvY2tldFRpbWVvdXQnKTtcbiAgaWYgKHN5bmNTb2NrZXRUaW1lb3V0ICE9IG51bGwpIHtcbiAgICBsb2coJ3hwYWNrLnJlcG9ydGluZy5xdWV1ZS5zeW5jU29ja2V0VGltZW91dCBoYXMgYmVlbiBkZXByZWNhdGVkLicpO1xuICB9XG5cbiAgLy8gZ2VuZXJhdGUuc29ja2V0VGltZW91dCBpcyBkZXByaWNhdGVkIGFuZCBnb2luZyBhd2F5IGluIDYuMFxuICBjb25zdCBzb2NrZXRUaW1lb3V0ID0gY29uZmlnLmdldCgneHBhY2sucmVwb3J0aW5nLmdlbmVyYXRlLnNvY2tldFRpbWVvdXQnKTtcbiAgaWYgKHNvY2tldFRpbWVvdXQpIHtcbiAgICBsb2coJ1RoZSBcIiZzeW5jXCIgcGFyYW1ldGVyIGFuZCB4cGFjay5yZXBvcnRpbmcuZ2VuZXJhdGUuc29ja2V0VGltZW91dCBzZXR0aW5nIGhhdmUgYmVlbiBkZXByZWNhdGVkICcgK1xuICAgICAgJ2FuZCB3aWxsIGJlIHJlbW92ZWQgaW4gNi4wLicpO1xuICB9XG59O1xuIl19",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/validate_config.js"
      ],
      "names": [],
      "mappings": ";;;;;;;;;sBAAmB,QAAQ;;;;AAEpB,SAAS,cAAc,CAAC,MAAM,EAAE,GAAG,EAAE;AAC1C,MAAI,MAAM,CAAC,GAAG,CAAC,+BAA+B,CAAC,IAAI,IAAI,EAAE;AACvD,OAAG,CAAC,wGAAwG,GAC1G,iEAAiE,CAAC,CAAC;AACrE,UAAM,CAAC,GAAG,CAAC,+BAA+B,EAAE,oBAAO,WAAW,CAAC,EAAE,CAAC,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,CAAC;GACrF;;;AAGD,MAAM,iBAAiB,GAAG,MAAM,CAAC,GAAG,CAAC,yCAAyC,CAAC,CAAC;AAChF,MAAI,iBAAiB,IAAI,IAAI,EAAE;AAC7B,OAAG,CAAC,8DAA8D,CAAC,CAAC;GACrE;;;AAGD,MAAM,aAAa,GAAG,MAAM,CAAC,GAAG,CAAC,wCAAwC,CAAC,CAAC;AAC3E,MAAI,aAAa,EAAE;AACjB,OAAG,CAAC,gGAAgG,GAClG,6BAA6B,CAAC,CAAC;GAClC;CACF;;AAAA,CAAC",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/reporting/server/lib/validate_config.js",
      "sourcesContent": [
        "import crypto from 'crypto';\n\nexport function validateConfig(config, log) {\n  if (config.get('xpack.reporting.encryptionKey') == null) {\n    log('Generating a random key for xpack.reporting.encryptionKey. To prevent pending reports from failing on ' +\n      'restart, please set xpack.reporting.encryptionKey in kibana.yml');\n    config.set('xpack.reporting.encryptionKey', crypto.randomBytes(16).toString('hex'));\n  }\n\n  // queue.syncSocketTimeout was replaced by generate.socketTimeout\n  const syncSocketTimeout = config.get('xpack.reporting.queue.syncSocketTimeout');\n  if (syncSocketTimeout != null) {\n    log('xpack.reporting.queue.syncSocketTimeout has been deprecated.');\n  }\n\n  // generate.socketTimeout is depricated and going away in 6.0\n  const socketTimeout = config.get('xpack.reporting.generate.socketTimeout');\n  if (socketTimeout) {\n    log('The \"&sync\" parameter and xpack.reporting.generate.socketTimeout setting have been deprecated ' +\n      'and will be removed in 6.0.');\n  }\n};\n"
      ]
    },
    "mtime": 1491771510541
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/security/index.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "hapi-auth-basic",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "hapiAuthBasic"
              }
            ]
          },
          {
            "source": "hapi-auth-cookie",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "hapiAuthCookie"
              }
            ]
          },
          {
            "source": "path",
            "imported": [
              "resolve"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "resolve",
                "local": "resolve"
              }
            ]
          },
          {
            "source": "bluebird",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "Promise"
              }
            ]
          },
          {
            "source": "./server/lib/get_basic_validate",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "getBasicValidate"
              }
            ]
          },
          {
            "source": "./server/lib/get_cookie_validate",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "getCookieValidate"
              }
            ]
          },
          {
            "source": "./server/lib/get_user",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "getUserProvider"
              }
            ]
          },
          {
            "source": "./server/lib/is_authenticated",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "isAuthenticatedProvider"
              }
            ]
          },
          {
            "source": "./server/routes/api/v1/authenticate",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "initAuthenticateApi"
              }
            ]
          },
          {
            "source": "./server/routes/api/v1/users",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "initUsersApi"
              }
            ]
          },
          {
            "source": "./server/routes/api/v1/roles",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "initRolesApi"
              }
            ]
          },
          {
            "source": "./server/routes/api/v1/indices",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "initIndicesApi"
              }
            ]
          },
          {
            "source": "./server/routes/views/login",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "initLoginView"
              }
            ]
          },
          {
            "source": "./server/routes/views/logout",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "initLogoutView"
              }
            ]
          },
          {
            "source": "./server/lib/validate_config",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "validateConfig"
              }
            ]
          },
          {
            "source": "./server/lib/set_elasticsearch_auth",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "setElasticsearchAuth"
              }
            ]
          },
          {
            "source": "./server/lib/login_scheme",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "createScheme"
              }
            ]
          },
          {
            "source": "./server/lib/check_license",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "checkLicense"
              }
            ]
          },
          {
            "source": "../../server/lib/mirror_plugin_status",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "mirrorPluginStatus"
              }
            ]
          }
        ],
        "exports": {
          "exported": [],
          "specifiers": []
        }
      },
      "usedHelpers": [
        "interop-require-default"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _hapiAuthBasic = require('hapi-auth-basic');\n\nvar _hapiAuthBasic2 = _interopRequireDefault(_hapiAuthBasic);\n\nvar _hapiAuthCookie = require('hapi-auth-cookie');\n\nvar _hapiAuthCookie2 = _interopRequireDefault(_hapiAuthCookie);\n\nvar _path = require('path');\n\nvar _bluebird = require('bluebird');\n\nvar _bluebird2 = _interopRequireDefault(_bluebird);\n\nvar _serverLibGet_basic_validate = require('./server/lib/get_basic_validate');\n\nvar _serverLibGet_basic_validate2 = _interopRequireDefault(_serverLibGet_basic_validate);\n\nvar _serverLibGet_cookie_validate = require('./server/lib/get_cookie_validate');\n\nvar _serverLibGet_cookie_validate2 = _interopRequireDefault(_serverLibGet_cookie_validate);\n\nvar _serverLibGet_user = require('./server/lib/get_user');\n\nvar _serverLibGet_user2 = _interopRequireDefault(_serverLibGet_user);\n\nvar _serverLibIs_authenticated = require('./server/lib/is_authenticated');\n\nvar _serverLibIs_authenticated2 = _interopRequireDefault(_serverLibIs_authenticated);\n\nvar _serverRoutesApiV1Authenticate = require('./server/routes/api/v1/authenticate');\n\nvar _serverRoutesApiV1Authenticate2 = _interopRequireDefault(_serverRoutesApiV1Authenticate);\n\nvar _serverRoutesApiV1Users = require('./server/routes/api/v1/users');\n\nvar _serverRoutesApiV1Users2 = _interopRequireDefault(_serverRoutesApiV1Users);\n\nvar _serverRoutesApiV1Roles = require('./server/routes/api/v1/roles');\n\nvar _serverRoutesApiV1Roles2 = _interopRequireDefault(_serverRoutesApiV1Roles);\n\nvar _serverRoutesApiV1Indices = require('./server/routes/api/v1/indices');\n\nvar _serverRoutesApiV1Indices2 = _interopRequireDefault(_serverRoutesApiV1Indices);\n\nvar _serverRoutesViewsLogin = require('./server/routes/views/login');\n\nvar _serverRoutesViewsLogin2 = _interopRequireDefault(_serverRoutesViewsLogin);\n\nvar _serverRoutesViewsLogout = require('./server/routes/views/logout');\n\nvar _serverRoutesViewsLogout2 = _interopRequireDefault(_serverRoutesViewsLogout);\n\nvar _serverLibValidate_config = require('./server/lib/validate_config');\n\nvar _serverLibValidate_config2 = _interopRequireDefault(_serverLibValidate_config);\n\nvar _serverLibSet_elasticsearch_auth = require('./server/lib/set_elasticsearch_auth');\n\nvar _serverLibSet_elasticsearch_auth2 = _interopRequireDefault(_serverLibSet_elasticsearch_auth);\n\nvar _serverLibLogin_scheme = require('./server/lib/login_scheme');\n\nvar _serverLibLogin_scheme2 = _interopRequireDefault(_serverLibLogin_scheme);\n\nvar _serverLibCheck_license = require('./server/lib/check_license');\n\nvar _serverLibCheck_license2 = _interopRequireDefault(_serverLibCheck_license);\n\nvar _serverLibMirror_plugin_status = require('../../server/lib/mirror_plugin_status');\n\nvar _serverLibMirror_plugin_status2 = _interopRequireDefault(_serverLibMirror_plugin_status);\n\nexports['default'] = function (kibana) {\n  return new kibana.Plugin({\n    id: 'security',\n    configPrefix: 'xpack.security',\n    publicDir: (0, _path.resolve)(__dirname, 'public'),\n    require: ['kibana', 'elasticsearch', 'xpack_main'],\n\n    config: function config(Joi) {\n      return Joi.object({\n        enabled: Joi.boolean()['default'](true),\n        cookieName: Joi.string()['default']('sid'),\n        encryptionKey: Joi.string(),\n        sessionTimeout: Joi.number().allow(null)['default'](null),\n        secureCookies: Joi.boolean()['default'](false)\n      })['default']();\n    },\n\n    uiExports: {\n      chromeNavControls: ['plugins/security/views/nav_control'],\n      managementSections: ['plugins/security/views/management'],\n      apps: [{\n        id: 'login',\n        title: 'Login',\n        main: 'plugins/security/views/login',\n        hidden: true,\n        injectVars: function injectVars(server) {\n          var pluginId = 'security';\n          var xpackInfo = server.plugins.xpack_main.info;\n\n          var _ref = xpackInfo.feature(pluginId).getLicenseCheckResults() || {};\n\n          var showLogin = _ref.showLogin;\n          var loginMessage = _ref.loginMessage;\n          var allowLogin = _ref.allowLogin;\n\n          return {\n            loginState: {\n              showLogin: showLogin,\n              allowLogin: allowLogin,\n              loginMessage: loginMessage\n            }\n          };\n        }\n      }, {\n        id: 'logout',\n        title: 'Logout',\n        main: 'plugins/security/views/logout',\n        hidden: true\n      }],\n      hacks: ['plugins/security/hacks/on_session_timeout', 'plugins/security/hacks/on_unauthorized_response'],\n      injectDefaultVars: function injectDefaultVars(server) {\n        var config = server.config();\n\n        return {\n          secureCookies: config.get('xpack.security.secureCookies'),\n          sessionTimeout: config.get('xpack.security.sessionTimeout')\n        };\n      }\n    },\n\n    preInit: function preInit(server) {\n      (0, _serverLibSet_elasticsearch_auth2['default'])(server.config());\n    },\n\n    init: function init(server) {\n      var thisPlugin = this;\n      var xpackMainPlugin = server.plugins.xpack_main;\n      (0, _serverLibMirror_plugin_status2['default'])(xpackMainPlugin, thisPlugin);\n      xpackMainPlugin.status.once('green', function () {\n        // Register a function that is called whenever the xpack info changes,\n        // to re-compute the license check results for this plugin\n        xpackMainPlugin.info.feature(thisPlugin.id).registerLicenseCheckResultsGenerator(_serverLibCheck_license2['default']);\n      });\n\n      var config = server.config();\n      (0, _serverLibValidate_config2['default'])(config, function (message) {\n        return server.log(['security', 'warning'], message);\n      });\n\n      var cookieName = config.get('xpack.security.cookieName');\n\n      var register = _bluebird2['default'].promisify(server.register, { context: server });\n      _bluebird2['default'].all([register(_hapiAuthBasic2['default']), register(_hapiAuthCookie2['default'])]).then(function () {\n        server.auth.scheme('login', (0, _serverLibLogin_scheme2['default'])({\n          redirectUrl: function redirectUrl(path) {\n            return loginUrl(config.get('server.basePath'), path);\n          },\n          strategies: ['security-cookie', 'security-basic']\n        }));\n\n        server.auth.strategy('session', 'login', 'required');\n\n        server.auth.strategy('security-basic', 'basic', false, {\n          validateFunc: (0, _serverLibGet_basic_validate2['default'])(server)\n        });\n\n        server.auth.strategy('security-cookie', 'cookie', false, {\n          cookie: cookieName,\n          password: config.get('xpack.security.encryptionKey'),\n          clearInvalid: true,\n          validateFunc: (0, _serverLibGet_cookie_validate2['default'])(server),\n          isSecure: config.get('xpack.security.secureCookies'),\n          path: config.get('server.basePath') + '/'\n        });\n      });\n\n      (0, _serverLibGet_user2['default'])(server);\n      (0, _serverLibIs_authenticated2['default'])(server);\n\n      (0, _serverRoutesApiV1Authenticate2['default'])(server);\n      (0, _serverRoutesApiV1Users2['default'])(server);\n      (0, _serverRoutesApiV1Roles2['default'])(server);\n      (0, _serverRoutesApiV1Indices2['default'])(server);\n      (0, _serverRoutesViewsLogin2['default'])(server, thisPlugin, xpackMainPlugin);\n      (0, _serverRoutesViewsLogout2['default'])(server, thisPlugin);\n    }\n  });\n};\n\nfunction loginUrl(baseUrl, requestedPath) {\n  var next = encodeURIComponent(requestedPath);\n  return baseUrl + '/login?next=' + next;\n}\nmodule.exports = exports['default'];\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvc2VjdXJpdHkvaW5kZXguanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7NkJBQTBCLGlCQUFpQjs7Ozs4QkFDaEIsa0JBQWtCOzs7O29CQUNyQixNQUFNOzt3QkFDVixVQUFVOzs7OzJDQUNELGlDQUFpQzs7Ozs0Q0FDaEMsa0NBQWtDOzs7O2lDQUNwQyx1QkFBdUI7Ozs7eUNBQ2YsK0JBQStCOzs7OzZDQUNuQyxxQ0FBcUM7Ozs7c0NBQzVDLDhCQUE4Qjs7OztzQ0FDOUIsOEJBQThCOzs7O3dDQUM1QixnQ0FBZ0M7Ozs7c0NBQ2pDLDZCQUE2Qjs7Ozt1Q0FDNUIsOEJBQThCOzs7O3dDQUM5Qiw4QkFBOEI7Ozs7K0NBQ3hCLHFDQUFxQzs7OztxQ0FDN0MsMkJBQTJCOzs7O3NDQUMzQiw0QkFBNEI7Ozs7NkNBQ3RCLHVDQUF1Qzs7OztxQkFFdkQsVUFBQyxNQUFNO1NBQUssSUFBSSxNQUFNLENBQUMsTUFBTSxDQUFDO0FBQzNDLE1BQUUsRUFBRSxVQUFVO0FBQ2QsZ0JBQVksRUFBRSxnQkFBZ0I7QUFDOUIsYUFBUyxFQUFFLG1CQUFRLFNBQVMsRUFBRSxRQUFRLENBQUM7QUFDdkMsV0FBTyxFQUFFLENBQUMsUUFBUSxFQUFFLGVBQWUsRUFBRSxZQUFZLENBQUM7O0FBRWxELFVBQU0sRUFBQSxnQkFBQyxHQUFHLEVBQUU7QUFDVixhQUFPLEdBQUcsQ0FBQyxNQUFNLENBQUM7QUFDaEIsZUFBTyxFQUFFLEdBQUcsQ0FBQyxPQUFPLEVBQUUsV0FBUSxDQUFDLElBQUksQ0FBQztBQUNwQyxrQkFBVSxFQUFFLEdBQUcsQ0FBQyxNQUFNLEVBQUUsV0FBUSxDQUFDLEtBQUssQ0FBQztBQUN2QyxxQkFBYSxFQUFFLEdBQUcsQ0FBQyxNQUFNLEVBQUU7QUFDM0Isc0JBQWMsRUFBRSxHQUFHLENBQUMsTUFBTSxFQUFFLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxXQUFRLENBQUMs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QUFNLEVBQUUsVUFBVSxFQUFFLGVBQWUsQ0FBQyxDQUFDO0FBQ25ELGdEQUFlLE1BQU0sRUFBRSxVQUFVLENBQUMsQ0FBQztLQUVwQztHQUNGLENBQUM7Q0FBQTs7QUFFRixTQUFTLFFBQVEsQ0FBQyxPQUFPLEVBQUUsYUFBYSxFQUFFO0FBQ3hDLE1BQU0sSUFBSSxHQUFHLGtCQUFrQixDQUFDLGFBQWEsQ0FBQyxDQUFDO0FBQy9DLFNBQVUsT0FBTyxvQkFBZSxJQUFJLENBQUc7Q0FDeEMiLCJmaWxlIjoiL3Vzci9zaGFyZS9raWJhbmEvcGx1Z2lucy94LXBhY2svcGx1Z2lucy9zZWN1cml0eS9pbmRleC5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBoYXBpQXV0aEJhc2ljIGZyb20gJ2hhcGktYXV0aC1iYXNpYyc7XG5pbXBvcnQgaGFwaUF1dGhDb29raWUgZnJvbSAnaGFwaS1hdXRoLWNvb2tpZSc7XG5pbXBvcnQgeyByZXNvbHZlIH0gZnJvbSAncGF0aCc7XG5pbXBvcnQgUHJvbWlzZSBmcm9tICdibHVlYmlyZCc7XG5pbXBvcnQgZ2V0QmFzaWNWYWxpZGF0ZSBmcm9tICcuL3NlcnZlci9saWIvZ2V0X2Jhc2ljX3ZhbGlkYXRlJztcbmltcG9ydCBnZXRDb29raWVWYWxpZGF0ZSBmcm9tICcuL3NlcnZlci9saWIvZ2V0X2Nvb2tpZV92YWxpZGF0ZSc7XG5pbXBvcnQgZ2V0VXNlclByb3ZpZGVyIGZyb20gJy4vc2VydmVyL2xpYi9nZXRfdXNlcic7XG5pbXBvcnQgaXNBdXRoZW50aWNhdGVkUHJvdmlkZXIgZnJvbSAnLi9zZXJ2ZXIvbGliL2lzX2F1dGhlbnRpY2F0ZWQnO1xuaW1wb3J0IGluaXRBdXRoZW50aWNhdGVBcGkgZnJvbSAnLi9zZXJ2ZXIvcm91dGVzL2FwaS92MS9hdXRoZW50aWNhdGUnO1xuaW1wb3J0IGluaXRVc2Vyc0FwaSBmcm9tICcuL3NlcnZlci9yb3V0ZXMvYXBpL3YxL3VzZXJzJztcbmltcG9ydCBpbml0Um9sZXNBcGkgZnJvbSAnLi9zZXJ2ZXIvcm91dGVzL2FwaS92MS9yb2xlcyc7XG5pbXBvcnQgaW5pdEluZGljZXNBcGkgZnJvbSAnLi9zZXJ2ZXIvcm91dGVzL2FwaS92MS9pbmRpY2VzJztcbmltcG9ydCBpbml0TG9naW5WaWV3IGZyb20gJy4vc2VydmVyL3JvdXRlcy92aWV3cy9sb2dpbic7XG5pbXBvcnQgaW5pdExvZ291dFZpZXcgZnJvbSAnLi9zZXJ2ZXIvcm91dGVzL3ZpZXdzL2xvZ291dCc7XG5pbXBvcnQgdmFsaWRhdGVDb25maWcgZnJvbSAnLi9zZXJ2ZXIvbGliL3ZhbGlkYXRlX2NvbmZpZyc7XG5pbXBvcnQgc2V0RWxhc3RpY3NlYXJjaEF1dGggZnJvbSAnLi9zZXJ2ZXIvbGliL3NldF9lbGFzdGljc2VhcmNoX2F1dGgnO1xuaW1wb3J0IGNyZWF0ZVNjaGVtZSBmcm9tICcuL3NlcnZlci9saWIvbG9naW5fc2NoZW1lJztcbmltcG9ydCBjaGVja0xpY2Vuc2UgZnJvbSAnLi9zZXJ2ZXIvbGliL2NoZWNrX2xpY2Vuc2UnO1xuaW1wb3J0IG1pcnJvclBsdWdpblN0YXR1cyBmcm9tICcuLi8uLi9zZXJ2ZXIvbGliL21pcnJvcl9wbHVnaW5fc3RhdHVzJztcblxuZXhwb3J0IGRlZmF1bHQgKGtpYmFuYSkgPT4gbmV3IGtpYmFuYS5QbHVnaW4oe1xuICBpZDogJ3NlY3VyaXR5JyxcbiAgY29uZmlnUHJlZml4OiAneHBhY2suc2VjdXJpdHknLFxuICBwdWJsaWNEaXI6IHJlc29sdmUoX19kaXJuYW1lLCAncHVibGljJyksXG4gIHJlcXVpcmU6IFsna2liYW5hJywgJ2VsYXN0aWNzZWFyY2gnLCAneHBhY2tfbWFpbiddLFxuXG4gIGNvbmZpZyhKb2kpIHtcbiAgICByZXR1cm4gSm9pLm9iamVjdCh7XG4gICAgICBlbmFibGVkOiBKb2kuYm9vbGVhbigpLmRlZmF1bHQodHJ1ZSksXG4gICAgICBjb29raWVOYW1lOiBKb2kuc3RyaW5nKCkuZGVmYXVsdCgnc2lkJyksXG4gICAgICBlbmNyeXB0aW9uS2V5OiBKb2kuc3RyaW5nKCksXG4gICAgICBzZXNzaW9uVGltZW91dDogSm9pLm51bWJlcigpLmFsbG93KG51bGwpLmRlZmF1bHQobnVsbCksXG4gICAgICBzZWN1cmVDb29raWVzOiBKb2kuYm9vbGVhbigpLmRlZmF1bHQoZmFsc2UpXG4gICAgfSkuZGVmYXVsdCgpO1xuICB9LFxuXG4gIHVpRXhwb3J0czoge1xuICAgIGNocm9tZU5hdkNvbnRyb2xzOiBbJ3BsdWdpbnMvc2VjdXJpdHkvdmlld3MvbmF2X2NvbnRyb2wnXSxcbiAgICBtYW5hZ2VtZW50U2VjdGlvbnM6IFsncGx1Z2lucy9zZWN1cml0eS92aWV3cy9tYW5hZ2VtZW50J10sXG4gICAgYXBwczogW3tcbiAgICAgIGlkOiAnbG9naW4nLFxuICAgICAgdGl0bGU6ICdMb2dpbicsXG4gICAgICBtYWluOiAncGx1Z2lucy9zZWN1cml0eS92aWV3cy9sb2dpbicsXG4gICAgICBoaWRkZW46IHRydWUsXG4gICAgICBpbmplY3RWYXJzKHNlcnZlcikge1xuICAgICAgICBjb25zdCBwbHVnaW5JZCA9ICdzZWN1cml0eSc7XG4gICAgICAgIGNvbnN0IHhwYWNrSW5mbyA9IHNlcnZlci5wbHVnaW5zLnhwYWNrX21haW4uaW5mbztcbiAgICAgICAgY29uc3QgeyBzaG93TG9naW4sIGxvZ2luTWVzc2FnZSwgYWxsb3dMb2dpbiB9ID0geHBhY2tJbmZvLmZlYXR1cmUocGx1Z2luSWQpLmdldExpY2Vuc2VDaGVja1Jlc3VsdHMoKSB8fCB7fTtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGxvZ2luU3RhdGU6IHtcbiAgICAgICAgICAgIHNob3dMb2dpbixcbiAgICAgICAgICAgIGFsbG93TG9naW4sXG4gICAgICAgICAgICBsb2dpbk1lc3NhZ2VcbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICB9XG4gICAgfSwge1xuICAgICAgaWQ6ICdsb2dvdXQnLFxuICAgICAgdGl0bGU6ICdMb2dvdXQnLFxuICAgICAgbWFpbjogJ3BsdWdpbnMvc2VjdXJpdHkvdmlld3MvbG9nb3V0JyxcbiAgICAgIGhpZGRlbjogdHJ1ZVxuICAgIH1dLFxuICAgIGhhY2tzOiBbXG4gICAgICAncGx1Z2lucy9zZWN1cml0eS9oYWNrcy9vbl9zZXNzaW9uX3RpbWVvdXQnLFxuICAgICAgJ3BsdWdpbnMvc2VjdXJpdHkvaGFja3Mvb25fdW5hdXRob3JpemVkX3Jlc3BvbnNlJ1xuICAgIF0sXG4gICAgaW5qZWN0RGVmYXVsdFZhcnM6IGZ1bmN0aW9uIChzZXJ2ZXIpIHtcbiAgICAgIGNvbnN0IGNvbmZpZyA9IHNlcnZlci5jb25maWcoKTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc2VjdXJlQ29va2llczogY29uZmlnLmdldCgneHBhY2suc2VjdXJpdHkuc2VjdXJlQ29va2llcycpLFxuICAgICAgICBzZXNzaW9uVGltZW91dDogY29uZmlnLmdldCgneHBhY2suc2VjdXJpdHkuc2Vzc2lvblRpbWVvdXQnKVxuICAgICAgfTtcbiAgICB9XG4gIH0sXG5cbiAgcHJlSW5pdChzZXJ2ZXIpIHtcbiAgICBzZXRFbGFzdGljc2VhcmNoQXV0aChzZXJ2ZXIuY29uZmlnKCkpO1xuICB9LFxuXG4gIGluaXQoc2VydmVyKSB7XG4gICAgY29uc3QgdGhpc1BsdWdpbiA9IHRoaXM7XG4gICAgY29uc3QgeHBhY2tNYWluUGx1Z2luID0gc2VydmVyLnBsdWdpbnMueHBhY2tfbWFpbjtcbiAgICBtaXJyb3JQbHVnaW5TdGF0dXMoeHBhY2tNYWluUGx1Z2luLCB0aGlzUGx1Z2luKTtcbiAgICB4cGFja01haW5QbHVnaW4uc3RhdHVzLm9uY2UoJ2dyZWVuJywgKCkgPT4ge1xuICAgICAgLy8gUmVnaXN0ZXIgYSBmdW5jdGlvbiB0aGF0IGlzIGNhbGxlZCB3aGVuZXZlciB0aGUgeHBhY2sgaW5mbyBjaGFuZ2VzLFxuICAgICAgLy8gdG8gcmUtY29tcHV0ZSB0aGUgbGljZW5zZSBjaGVjayByZXN1bHRzIGZvciB0aGlzIHBsdWdpblxuICAgICAgeHBhY2tNYWluUGx1Z2luLmluZm8uZmVhdHVyZSh0aGlzUGx1Z2luLmlkKS5yZWdpc3RlckxpY2Vuc2VDaGVja1Jlc3VsdHNHZW5lcmF0b3IoY2hlY2tMaWNlbnNlKTtcbiAgICB9KTtcblxuICAgIGNvbnN0IGNvbmZpZyA9IHNlcnZlci5jb25maWcoKTtcbiAgICB2YWxpZGF0ZUNvbmZpZyhjb25maWcsIG1lc3NhZ2UgPT4gc2VydmVyLmxvZyhbJ3NlY3VyaXR5JywgJ3dhcm5pbmcnXSwgbWVzc2FnZSkpO1xuXG4gICAgY29uc3QgY29va2llTmFtZSA9IGNvbmZpZy5nZXQoJ3hwYWNrLnNlY3VyaXR5LmNvb2tpZU5hbWUnKTtcblxuICAgIGNvbnN0IHJlZ2lzdGVyID0gUHJvbWlzZS5wcm9taXNpZnkoc2VydmVyLnJlZ2lzdGVyLCB7Y29udGV4dDogc2VydmVyfSk7XG4gICAgUHJvbWlzZS5hbGwoW1xuICAgICAgcmVnaXN0ZXIoaGFwaUF1dGhCYXNpYyksXG4gICAgICByZWdpc3RlcihoYXBpQXV0aENvb2tpZSlcbiAgICBdKVxuICAgIC50aGVuKCgpID0+IHtcbiAgICAgIHNlcnZlci5hdXRoLnNjaGVtZSgnbG9naW4nLCBjcmVhdGVTY2hlbWUoe1xuICAgICAgICByZWRpcmVjdFVybDogKHBhdGgpID0+IGxvZ2luVXJsKGNvbmZpZy5nZXQoJ3NlcnZlci5iYXNlUGF0aCcpLCBwYXRoKSxcbiAgICAgICAgc3RyYXRlZ2llczogWydzZWN1cml0eS1jb29raWUnLCAnc2VjdXJpdHktYmFzaWMnXVxuICAgICAgfSkpO1xuXG4gICAgICBzZXJ2ZXIuYXV0aC5zdHJhdGVneSgnc2Vzc2lvbicsICdsb2dpbicsICdyZXF1aXJlZCcpO1xuXG4gICAgICBzZXJ2ZXIuYXV0aC5zdHJhdGVneSgnc2VjdXJpdHktYmFzaWMnLCAnYmFzaWMnLCBmYWxzZSwge1xuICAgICAgICB2YWxpZGF0ZUZ1bmM6IGdldEJhc2ljVmFsaWRhdGUoc2VydmVyKVxuICAgICAgfSk7XG5cbiAgICAgIHNlcnZlci5hdXRoLnN0cmF0ZWd5KCdzZWN1cml0eS1jb29raWUnLCAnY29va2llJywgZmFsc2UsIHtcbiAgICAgICAgY29va2llOiBjb29raWVOYW1lLFxuICAgICAgICBwYXNzd29yZDogY29uZmlnLmdldCgneHBhY2suc2VjdXJpdHkuZW5jcnlwdGlvbktleScpLFxuICAgICAgICBjbGVhckludmFsaWQ6IHRydWUsXG4gICAgICAgIHZhbGlkYXRlRnVuYzogZ2V0Q29va2llVmFsaWRhdGUoc2VydmVyKSxcbiAgICAgICAgaXNTZWN1cmU6IGNvbmZpZy5nZXQoJ3hwYWNrLnNlY3VyaXR5LnNlY3VyZUNvb2tpZXMnKSxcbiAgICAgICAgcGF0aDogY29uZmlnLmdldCgnc2VydmVyLmJhc2VQYXRoJykgKyAnLydcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgZ2V0VXNlclByb3ZpZGVyKHNlcnZlcik7XG4gICAgaXNBdXRoZW50aWNhdGVkUHJvdmlkZXIoc2VydmVyKTtcblxuICAgIGluaXRBdXRoZW50aWNhdGVBcGkoc2VydmVyKTtcbiAgICBpbml0VXNlcnNBcGkoc2VydmVyKTtcbiAgICBpbml0Um9sZXNBcGkoc2VydmVyKTtcbiAgICBpbml0SW5kaWNlc0FwaShzZXJ2ZXIpO1xuICAgIGluaXRMb2dpblZpZXcoc2VydmVyLCB0aGlzUGx1Z2luLCB4cGFja01haW5QbHVnaW4pO1xuICAgIGluaXRMb2dvdXRWaWV3KHNlcnZlciwgdGhpc1BsdWdpbik7XG5cbiAgfVxufSk7XG5cbmZ1bmN0aW9uIGxvZ2luVXJsKGJhc2VVcmwsIHJlcXVlc3RlZFBhdGgpIHtcbiAgY29uc3QgbmV4dCA9IGVuY29kZVVSSUNvbXBvbmVudChyZXF1ZXN0ZWRQYXRoKTtcbiAgcmV0dXJuIGAke2Jhc2VVcmx9L2xvZ2luP25leHQ9JHtuZXh0fWA7XG59XG4iXX0=",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/security/index.js"
      ],
      "names": [],
      "mappings": "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",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/security/index.js",
      "sourcesContent": [
        "import hapiAuthBasic from 'hapi-auth-basic';\nimport hapiAuthCookie from 'hapi-auth-cookie';\nimport { resolve } from 'path';\nimport Promise from 'bluebird';\nimport getBasicValidate from './server/lib/get_basic_validate';\nimport getCookieValidate from './server/lib/get_cookie_validate';\nimport getUserProvider from './server/lib/get_user';\nimport isAuthenticatedProvider from './server/lib/is_authenticated';\nimport initAuthenticateApi from './server/routes/api/v1/authenticate';\nimport initUsersApi from './server/routes/api/v1/users';\nimport initRolesApi from './server/routes/api/v1/roles';\nimport initIndicesApi from './server/routes/api/v1/indices';\nimport initLoginView from './server/routes/views/login';\nimport initLogoutView from './server/routes/views/logout';\nimport validateConfig from './server/lib/validate_config';\nimport setElasticsearchAuth from './server/lib/set_elasticsearch_auth';\nimport createScheme from './server/lib/login_scheme';\nimport checkLicense from './server/lib/check_license';\nimport mirrorPluginStatus from '../../server/lib/mirror_plugin_status';\n\nexport default (kibana) => new kibana.Plugin({\n  id: 'security',\n  configPrefix: 'xpack.security',\n  publicDir: resolve(__dirname, 'public'),\n  require: ['kibana', 'elasticsearch', 'xpack_main'],\n\n  config(Joi) {\n    return Joi.object({\n      enabled: Joi.boolean().default(true),\n      cookieName: Joi.string().default('sid'),\n      encryptionKey: Joi.string(),\n      sessionTimeout: Joi.number().allow(null).default(null),\n      secureCookies: Joi.boolean().default(false)\n    }).default();\n  },\n\n  uiExports: {\n    chromeNavControls: ['plugins/security/views/nav_control'],\n    managementSections: ['plugins/security/views/management'],\n    apps: [{\n      id: 'login',\n      title: 'Login',\n      main: 'plugins/security/views/login',\n      hidden: true,\n      injectVars(server) {\n        const pluginId = 'security';\n        const xpackInfo = server.plugins.xpack_main.info;\n        const { showLogin, loginMessage, allowLogin } = xpackInfo.feature(pluginId).getLicenseCheckResults() || {};\n\n        return {\n          loginState: {\n            showLogin,\n            allowLogin,\n            loginMessage\n          }\n        };\n      }\n    }, {\n      id: 'logout',\n      title: 'Logout',\n      main: 'plugins/security/views/logout',\n      hidden: true\n    }],\n    hacks: [\n      'plugins/security/hacks/on_session_timeout',\n      'plugins/security/hacks/on_unauthorized_response'\n    ],\n    injectDefaultVars: function (server) {\n      const config = server.config();\n\n      return {\n        secureCookies: config.get('xpack.security.secureCookies'),\n        sessionTimeout: config.get('xpack.security.sessionTimeout')\n      };\n    }\n  },\n\n  preInit(server) {\n    setElasticsearchAuth(server.config());\n  },\n\n  init(server) {\n    const thisPlugin = this;\n    const xpackMainPlugin = server.plugins.xpack_main;\n    mirrorPluginStatus(xpackMainPlugin, thisPlugin);\n    xpackMainPlugin.status.once('green', () => {\n      // Register a function that is called whenever the xpack info changes,\n      // to re-compute the license check results for this plugin\n      xpackMainPlugin.info.feature(thisPlugin.id).registerLicenseCheckResultsGenerator(checkLicense);\n    });\n\n    const config = server.config();\n    validateConfig(config, message => server.log(['security', 'warning'], message));\n\n    const cookieName = config.get('xpack.security.cookieName');\n\n    const register = Promise.promisify(server.register, {context: server});\n    Promise.all([\n      register(hapiAuthBasic),\n      register(hapiAuthCookie)\n    ])\n    .then(() => {\n      server.auth.scheme('login', createScheme({\n        redirectUrl: (path) => loginUrl(config.get('server.basePath'), path),\n        strategies: ['security-cookie', 'security-basic']\n      }));\n\n      server.auth.strategy('session', 'login', 'required');\n\n      server.auth.strategy('security-basic', 'basic', false, {\n        validateFunc: getBasicValidate(server)\n      });\n\n      server.auth.strategy('security-cookie', 'cookie', false, {\n        cookie: cookieName,\n        password: config.get('xpack.security.encryptionKey'),\n        clearInvalid: true,\n        validateFunc: getCookieValidate(server),\n        isSecure: config.get('xpack.security.secureCookies'),\n        path: config.get('server.basePath') + '/'\n      });\n    });\n\n    getUserProvider(server);\n    isAuthenticatedProvider(server);\n\n    initAuthenticateApi(server);\n    initUsersApi(server);\n    initRolesApi(server);\n    initIndicesApi(server);\n    initLoginView(server, thisPlugin, xpackMainPlugin);\n    initLogoutView(server, thisPlugin);\n\n  }\n});\n\nfunction loginUrl(baseUrl, requestedPath) {\n  const next = encodeURIComponent(requestedPath);\n  return `${baseUrl}/login?next=${next}`;\n}\n"
      ]
    },
    "mtime": 1491771506060
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/get_basic_validate.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "./get_is_valid_user",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "getIsValidUser"
              }
            ]
          }
        ],
        "exports": {
          "exported": [],
          "specifiers": []
        }
      },
      "usedHelpers": [
        "interop-require-default"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _get_is_valid_user = require('./get_is_valid_user');\n\nvar _get_is_valid_user2 = _interopRequireDefault(_get_is_valid_user);\n\nexports['default'] = function (server) {\n  var isValidUser = (0, _get_is_valid_user2['default'])(server);\n\n  return function validate(request, username, password, callback) {\n    return isValidUser(request, username, password).then(function () {\n      return callback(null, true, { username: username, password: password });\n    }, function (error) {\n      return callback(error, false);\n    });\n  };\n};\n\nmodule.exports = exports['default'];\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvc2VjdXJpdHkvc2VydmVyL2xpYi9nZXRfYmFzaWNfdmFsaWRhdGUuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7aUNBQTJCLHFCQUFxQjs7OztxQkFFakMsVUFBQyxNQUFNLEVBQUs7QUFDekIsTUFBTSxXQUFXLEdBQUcsb0NBQWUsTUFBTSxDQUFDLENBQUM7O0FBRTNDLFNBQU8sU0FBUyxRQUFRLENBQUMsT0FBTyxFQUFFLFFBQVEsRUFBRSxRQUFRLEVBQUUsUUFBUSxFQUFFO0FBQzlELFdBQU8sV0FBVyxDQUFDLE9BQU8sRUFBRSxRQUFRLEVBQUUsUUFBUSxDQUFDLENBQUMsSUFBSSxDQUNsRDthQUFNLFFBQVEsQ0FBQyxJQUFJLEVBQUUsSUFBSSxFQUFFLEVBQUMsUUFBUSxFQUFSLFFBQVEsRUFBRSxRQUFRLEVBQVIsUUFBUSxFQUFDLENBQUM7S0FBQSxFQUNoRCxVQUFDLEtBQUs7YUFBSyxRQUFRLENBQUMsS0FBSyxFQUFFLEtBQUssQ0FBQztLQUFBLENBQ2xDLENBQUM7R0FDSCxDQUFDO0NBQ0giLCJmaWxlIjoiL3Vzci9zaGFyZS9raWJhbmEvcGx1Z2lucy94LXBhY2svcGx1Z2lucy9zZWN1cml0eS9zZXJ2ZXIvbGliL2dldF9iYXNpY192YWxpZGF0ZS5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBnZXRJc1ZhbGlkVXNlciBmcm9tICcuL2dldF9pc192YWxpZF91c2VyJztcblxuZXhwb3J0IGRlZmF1bHQgKHNlcnZlcikgPT4ge1xuICBjb25zdCBpc1ZhbGlkVXNlciA9IGdldElzVmFsaWRVc2VyKHNlcnZlcik7XG5cbiAgcmV0dXJuIGZ1bmN0aW9uIHZhbGlkYXRlKHJlcXVlc3QsIHVzZXJuYW1lLCBwYXNzd29yZCwgY2FsbGJhY2spIHtcbiAgICByZXR1cm4gaXNWYWxpZFVzZXIocmVxdWVzdCwgdXNlcm5hbWUsIHBhc3N3b3JkKS50aGVuKFxuICAgICAgKCkgPT4gY2FsbGJhY2sobnVsbCwgdHJ1ZSwge3VzZXJuYW1lLCBwYXNzd29yZH0pLFxuICAgICAgKGVycm9yKSA9PiBjYWxsYmFjayhlcnJvciwgZmFsc2UpXG4gICAgKTtcbiAgfTtcbn07XG4iXX0=",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/get_basic_validate.js"
      ],
      "names": [],
      "mappings": ";;;;;;;;iCAA2B,qBAAqB;;;;qBAEjC,UAAC,MAAM,EAAK;AACzB,MAAM,WAAW,GAAG,oCAAe,MAAM,CAAC,CAAC;;AAE3C,SAAO,SAAS,QAAQ,CAAC,OAAO,EAAE,QAAQ,EAAE,QAAQ,EAAE,QAAQ,EAAE;AAC9D,WAAO,WAAW,CAAC,OAAO,EAAE,QAAQ,EAAE,QAAQ,CAAC,CAAC,IAAI,CAClD;aAAM,QAAQ,CAAC,IAAI,EAAE,IAAI,EAAE,EAAC,QAAQ,EAAR,QAAQ,EAAE,QAAQ,EAAR,QAAQ,EAAC,CAAC;KAAA,EAChD,UAAC,KAAK;aAAK,QAAQ,CAAC,KAAK,EAAE,KAAK,CAAC;KAAA,CAClC,CAAC;GACH,CAAC;CACH",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/get_basic_validate.js",
      "sourcesContent": [
        "import getIsValidUser from './get_is_valid_user';\n\nexport default (server) => {\n  const isValidUser = getIsValidUser(server);\n\n  return function validate(request, username, password, callback) {\n    return isValidUser(request, username, password).then(\n      () => callback(null, true, {username, password}),\n      (error) => callback(error, false)\n    );\n  };\n};\n"
      ]
    },
    "mtime": 1491771510468
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/get_is_valid_user.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "lodash",
            "imported": [
              "assign"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "assign",
                "local": "assign"
              }
            ]
          },
          {
            "source": "./basic_auth",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "basicAuth"
              }
            ]
          }
        ],
        "exports": {
          "exported": [],
          "specifiers": []
        }
      },
      "usedHelpers": [
        "interop-require-default"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _lodash = require('lodash');\n\nvar _basic_auth = require('./basic_auth');\n\nvar _basic_auth2 = _interopRequireDefault(_basic_auth);\n\nexports['default'] = function (server) {\n  return function isValidUser(request, username, password) {\n    (0, _lodash.assign)(request.headers, _basic_auth2['default'].getHeader(username, password));\n    return server.plugins.security.getUser(request);\n  };\n};\n\nmodule.exports = exports['default'];\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvc2VjdXJpdHkvc2VydmVyL2xpYi9nZXRfaXNfdmFsaWRfdXNlci5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7OztzQkFBcUIsUUFBUTs7MEJBQ1AsY0FBYzs7OztxQkFFckIsVUFBQyxNQUFNLEVBQUs7QUFDekIsU0FBTyxTQUFTLFdBQVcsQ0FBQyxPQUFPLEVBQUUsUUFBUSxFQUFFLFFBQVEsRUFBRTtBQUN2RCx3QkFBTyxPQUFPLENBQUMsT0FBTyxFQUFFLHdCQUFVLFNBQVMsQ0FBQyxRQUFRLEVBQUUsUUFBUSxDQUFDLENBQUMsQ0FBQztBQUNqRSxXQUFPLE1BQU0sQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsQ0FBQztHQUNqRCxDQUFDO0NBQ0giLCJmaWxlIjoiL3Vzci9zaGFyZS9raWJhbmEvcGx1Z2lucy94LXBhY2svcGx1Z2lucy9zZWN1cml0eS9zZXJ2ZXIvbGliL2dldF9pc192YWxpZF91c2VyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHthc3NpZ259IGZyb20gJ2xvZGFzaCc7XG5pbXBvcnQgYmFzaWNBdXRoIGZyb20gJy4vYmFzaWNfYXV0aCc7XG5cbmV4cG9ydCBkZWZhdWx0IChzZXJ2ZXIpID0+IHtcbiAgcmV0dXJuIGZ1bmN0aW9uIGlzVmFsaWRVc2VyKHJlcXVlc3QsIHVzZXJuYW1lLCBwYXNzd29yZCkge1xuICAgIGFzc2lnbihyZXF1ZXN0LmhlYWRlcnMsIGJhc2ljQXV0aC5nZXRIZWFkZXIodXNlcm5hbWUsIHBhc3N3b3JkKSk7XG4gICAgcmV0dXJuIHNlcnZlci5wbHVnaW5zLnNlY3VyaXR5LmdldFVzZXIocmVxdWVzdCk7XG4gIH07XG59O1xuIl19",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/get_is_valid_user.js"
      ],
      "names": [],
      "mappings": ";;;;;;;;sBAAqB,QAAQ;;0BACP,cAAc;;;;qBAErB,UAAC,MAAM,EAAK;AACzB,SAAO,SAAS,WAAW,CAAC,OAAO,EAAE,QAAQ,EAAE,QAAQ,EAAE;AACvD,wBAAO,OAAO,CAAC,OAAO,EAAE,wBAAU,SAAS,CAAC,QAAQ,EAAE,QAAQ,CAAC,CAAC,CAAC;AACjE,WAAO,MAAM,CAAC,OAAO,CAAC,QAAQ,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;GACjD,CAAC;CACH",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/get_is_valid_user.js",
      "sourcesContent": [
        "import {assign} from 'lodash';\nimport basicAuth from './basic_auth';\n\nexport default (server) => {\n  return function isValidUser(request, username, password) {\n    assign(request.headers, basicAuth.getHeader(username, password));\n    return server.plugins.security.getUser(request);\n  };\n};\n"
      ]
    },
    "mtime": 1491771510468
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/basic_auth.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [],
        "exports": {
          "exported": [],
          "specifiers": []
        }
      },
      "usedHelpers": [
        "sliced-to-array",
        "to-array"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nvar _slicedToArray = (function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i['return']) _i['return'](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError('Invalid attempt to destructure non-iterable instance'); } }; })();\n\nfunction _toArray(arr) { return Array.isArray(arr) ? arr : Array.from(arr); }\n\nexports['default'] = {\n  getHeader: getAuthHeader,\n  parseHeader: parseAuthHeader\n};\n\nfunction getAuthHeader(username, password) {\n  var auth = new Buffer(username + ':' + password).toString('base64');\n  return {\n    authorization: 'Basic ' + auth\n  };\n}\n\nfunction parseAuthHeader(authorization) {\n  if (typeof authorization !== 'string') {\n    throw new Error('Authorization should be a string');\n  }\n\n  var _authorization$split = authorization.split(' ');\n\n  var _authorization$split2 = _slicedToArray(_authorization$split, 2);\n\n  var authType = _authorization$split2[0];\n  var token = _authorization$split2[1];\n\n  if (authType.toLowerCase() !== 'basic') {\n    throw new Error('Authorization is not Basic');\n  }\n\n  // base64 decode auth header\n  var tokenBuffer = new Buffer(token, 'base64');\n  var tokenString = tokenBuffer.toString();\n\n  // everything after the first : is the password\n\n  var _tokenString$split = tokenString.split(/:/);\n\n  var _tokenString$split2 = _toArray(_tokenString$split);\n\n  var username = _tokenString$split2[0];\n\n  var passwordParts = _tokenString$split2.slice(1);\n\n  var password = passwordParts.join(':');\n\n  return { username: username, password: password };\n}\nmodule.exports = exports['default'];\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvc2VjdXJpdHkvc2VydmVyL2xpYi9iYXNpY19hdXRoLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7cUJBQWU7QUFDYixXQUFTLEVBQUUsYUFBYTtBQUN4QixhQUFXLEVBQUUsZUFBZTtDQUM3Qjs7QUFFRCxTQUFTLGFBQWEsQ0FBQyxRQUFRLEVBQUUsUUFBUSxFQUFFO0FBQ3pDLE1BQU0sSUFBSSxHQUFHLElBQUksTUFBTSxDQUFJLFFBQVEsU0FBSSxRQUFRLENBQUcsQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDLENBQUM7QUFDdEUsU0FBTztBQUNMLGlCQUFhLGFBQVcsSUFBSSxBQUFFO0dBQy9CLENBQUM7Q0FDSDs7QUFFRCxTQUFTLGVBQWUsQ0FBQyxhQUFhLEVBQUU7QUFDdEMsTUFBSSxPQUFPLGFBQWEsS0FBSyxRQUFRLEVBQUU7QUFDckMsVUFBTSxJQUFJLEtBQUssQ0FBQyxrQ0FBa0MsQ0FBQyxDQUFDO0dBQ3JEOzs2QkFFMkIsYUFBYSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUM7Ozs7TUFBNUMsUUFBUTtNQUFFLEtBQUs7O0FBQ3ZCLE1BQUksUUFBUSxDQUFDLFdBQVcsRUFBRSxLQUFLLE9BQU8sRUFBRTtBQUN0QyxVQUFNLElBQUksS0FBSyxDQUFDLDRCQUE0QixDQUFDLENBQUM7R0FDL0M7OztBQUdELE1BQU0sV0FBVyxHQUFHLElBQUksTUFBTSxDQUFDLEtBQUssRUFBRSxRQUFRLENBQUMsQ0FBQztBQUNoRCxNQUFNLFdBQVcsR0FBRyxXQUFXLENBQUMsUUFBUSxFQUFFLENBQUM7Ozs7MkJBR0osV0FBVyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUM7Ozs7TUFBckQsUUFBUTs7TUFBSyxhQUFhOztBQUNsQyxNQUFNLFFBQVEsR0FBRyxhQUFhLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDOztBQUV6QyxTQUFPLEVBQUUsUUFBUSxFQUFSLFFBQVEsRUFBRSxRQUFRLEVBQVIsUUFBUSxFQUFFLENBQUM7Q0FDL0IiLCJmaWxlIjoiL3Vzci9zaGFyZS9raWJhbmEvcGx1Z2lucy94LXBhY2svcGx1Z2lucy9zZWN1cml0eS9zZXJ2ZXIvbGliL2Jhc2ljX2F1dGguanMiLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCB7XG4gIGdldEhlYWRlcjogZ2V0QXV0aEhlYWRlcixcbiAgcGFyc2VIZWFkZXI6IHBhcnNlQXV0aEhlYWRlclxufTtcblxuZnVuY3Rpb24gZ2V0QXV0aEhlYWRlcih1c2VybmFtZSwgcGFzc3dvcmQpIHtcbiAgY29uc3QgYXV0aCA9IG5ldyBCdWZmZXIoYCR7dXNlcm5hbWV9OiR7cGFzc3dvcmR9YCkudG9TdHJpbmcoJ2Jhc2U2NCcpO1xuICByZXR1cm4ge1xuICAgIGF1dGhvcml6YXRpb246IGBCYXNpYyAke2F1dGh9YFxuICB9O1xufVxuXG5mdW5jdGlvbiBwYXJzZUF1dGhIZWFkZXIoYXV0aG9yaXphdGlvbikge1xuICBpZiAodHlwZW9mIGF1dGhvcml6YXRpb24gIT09ICdzdHJpbmcnKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdBdXRob3JpemF0aW9uIHNob3VsZCBiZSBhIHN0cmluZycpO1xuICB9XG5cbiAgY29uc3QgWyBhdXRoVHlwZSwgdG9rZW4gXSA9IGF1dGhvcml6YXRpb24uc3BsaXQoJyAnKTtcbiAgaWYgKGF1dGhUeXBlLnRvTG93ZXJDYXNlKCkgIT09ICdiYXNpYycpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0F1dGhvcml6YXRpb24gaXMgbm90IEJhc2ljJyk7XG4gIH1cblxuICAvLyBiYXNlNjQgZGVjb2RlIGF1dGggaGVhZGVyXG4gIGNvbnN0IHRva2VuQnVmZmVyID0gbmV3IEJ1ZmZlcih0b2tlbiwgJ2Jhc2U2NCcpO1xuICBjb25zdCB0b2tlblN0cmluZyA9IHRva2VuQnVmZmVyLnRvU3RyaW5nKCk7XG5cbiAgLy8gZXZlcnl0aGluZyBhZnRlciB0aGUgZmlyc3QgOiBpcyB0aGUgcGFzc3dvcmRcbiAgY29uc3QgWyB1c2VybmFtZSwgLi4ucGFzc3dvcmRQYXJ0cyBdID0gdG9rZW5TdHJpbmcuc3BsaXQoLzovKTtcbiAgY29uc3QgcGFzc3dvcmQgPSBwYXNzd29yZFBhcnRzLmpvaW4oJzonKTtcblxuICByZXR1cm4geyB1c2VybmFtZSwgcGFzc3dvcmQgfTtcbn1cbiJdfQ==",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/basic_auth.js"
      ],
      "names": [],
      "mappings": ";;;;;;;;;;qBAAe;AACb,WAAS,EAAE,aAAa;AACxB,aAAW,EAAE,eAAe;CAC7B;;AAED,SAAS,aAAa,CAAC,QAAQ,EAAE,QAAQ,EAAE;AACzC,MAAM,IAAI,GAAG,IAAI,MAAM,CAAI,QAAQ,SAAI,QAAQ,CAAG,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;AACtE,SAAO;AACL,iBAAa,aAAW,IAAI,AAAE;GAC/B,CAAC;CACH;;AAED,SAAS,eAAe,CAAC,aAAa,EAAE;AACtC,MAAI,OAAO,aAAa,KAAK,QAAQ,EAAE;AACrC,UAAM,IAAI,KAAK,CAAC,kCAAkC,CAAC,CAAC;GACrD;;6BAE2B,aAAa,CAAC,KAAK,CAAC,GAAG,CAAC;;;;MAA5C,QAAQ;MAAE,KAAK;;AACvB,MAAI,QAAQ,CAAC,WAAW,EAAE,KAAK,OAAO,EAAE;AACtC,UAAM,IAAI,KAAK,CAAC,4BAA4B,CAAC,CAAC;GAC/C;;;AAGD,MAAM,WAAW,GAAG,IAAI,MAAM,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAC;AAChD,MAAM,WAAW,GAAG,WAAW,CAAC,QAAQ,EAAE,CAAC;;;;2BAGJ,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC;;;;MAArD,QAAQ;;MAAK,aAAa;;AAClC,MAAM,QAAQ,GAAG,aAAa,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;;AAEzC,SAAO,EAAE,QAAQ,EAAR,QAAQ,EAAE,QAAQ,EAAR,QAAQ,EAAE,CAAC;CAC/B",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/basic_auth.js",
      "sourcesContent": [
        "export default {\n  getHeader: getAuthHeader,\n  parseHeader: parseAuthHeader\n};\n\nfunction getAuthHeader(username, password) {\n  const auth = new Buffer(`${username}:${password}`).toString('base64');\n  return {\n    authorization: `Basic ${auth}`\n  };\n}\n\nfunction parseAuthHeader(authorization) {\n  if (typeof authorization !== 'string') {\n    throw new Error('Authorization should be a string');\n  }\n\n  const [ authType, token ] = authorization.split(' ');\n  if (authType.toLowerCase() !== 'basic') {\n    throw new Error('Authorization is not Basic');\n  }\n\n  // base64 decode auth header\n  const tokenBuffer = new Buffer(token, 'base64');\n  const tokenString = tokenBuffer.toString();\n\n  // everything after the first : is the password\n  const [ username, ...passwordParts ] = tokenString.split(/:/);\n  const password = passwordParts.join(':');\n\n  return { username, password };\n}\n"
      ]
    },
    "mtime": 1491771510468
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/get_cookie_validate.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "./get_is_valid_user",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "getIsValidUser"
              }
            ]
          },
          {
            "source": "./get_calculate_expires",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "getCalculateExpires"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "hasSessionExpired",
            "session"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "hasSessionExpired",
              "exported": "hasSessionExpired"
            },
            {
              "kind": "local",
              "local": "session",
              "exported": "session"
            }
          ]
        }
      },
      "usedHelpers": [
        "interop-require-default"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nexports.hasSessionExpired = hasSessionExpired;\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _get_is_valid_user = require('./get_is_valid_user');\n\nvar _get_is_valid_user2 = _interopRequireDefault(_get_is_valid_user);\n\nvar _get_calculate_expires = require('./get_calculate_expires');\n\nvar _get_calculate_expires2 = _interopRequireDefault(_get_calculate_expires);\n\nexports['default'] = function (server) {\n  var isValidUser = (0, _get_is_valid_user2['default'])(server);\n  var calculateExpires = (0, _get_calculate_expires2['default'])(server);\n  var isSystemApiRequest = server.plugins.kibana.systemApi.isSystemApiRequest;\n\n  return function validate(request, session, callback) {\n    if (hasSessionExpired(session)) return callback(new Error('Session has expired'), false);\n\n    var username = session.username;\n    var password = session.password;\n\n    return isValidUser(request, username, password).then(function () {\n      // Extend the session timeout provided this is NOT a system API call\n      if (!isSystemApiRequest(request)) {\n        // Keep the session alive\n        request.cookieAuth.set({\n          username: username,\n          password: password,\n          expires: calculateExpires()\n        });\n      }\n      return callback(null, true);\n    }, function (error) {\n      return callback(error, false);\n    });\n  };\n};\n\nfunction hasSessionExpired(session) {\n  var expires = session.expires;\n\n  return !!(expires && expires < Date.now());\n}\n\n;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvc2VjdXJpdHkvc2VydmVyL2xpYi9nZXRfY29va2llX3ZhbGlkYXRlLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7OztpQ0FBMkIscUJBQXFCOzs7O3FDQUNoQix5QkFBeUI7Ozs7cUJBRTFDLFVBQUMsTUFBTSxFQUFLO0FBQ3pCLE1BQU0sV0FBVyxHQUFHLG9DQUFlLE1BQU0sQ0FBQyxDQUFDO0FBQzNDLE1BQU0sZ0JBQWdCLEdBQUcsd0NBQW9CLE1BQU0sQ0FBQyxDQUFDO01BQzdDLGtCQUFrQixHQUFLLE1BQU0sQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBdEQsa0JBQWtCOztBQUUxQixTQUFPLFNBQVMsUUFBUSxDQUFDLE9BQU8sRUFBRSxPQUFPLEVBQUUsUUFBUSxFQUFFO0FBQ25ELFFBQUksaUJBQWlCLENBQUMsT0FBTyxDQUFDLEVBQUUsT0FBTyxRQUFRLENBQUMsSUFBSSxLQUFLLENBQUMscUJBQXFCLENBQUMsRUFBRSxLQUFLLENBQUMsQ0FBQzs7UUFFbEYsUUFBUSxHQUFjLE9BQU8sQ0FBN0IsUUFBUTtRQUFFLFFBQVEsR0FBSSxPQUFPLENBQW5CLFFBQVE7O0FBQ3pCLFdBQU8sV0FBVyxDQUFDLE9BQU8sRUFBRSxRQUFRLEVBQUUsUUFBUSxDQUFDLENBQUMsSUFBSSxDQUNsRCxZQUFNOztBQUVKLFVBQUksQ0FBQyxrQkFBa0IsQ0FBQyxPQUFPLENBQUMsRUFBRTs7QUFFaEMsZUFBTyxDQUFDLFVBQVUsQ0FBQyxHQUFHLENBQUM7QUFDckIsa0JBQVEsRUFBUixRQUFRO0FBQ1Isa0JBQVEsRUFBUixRQUFRO0FBQ1IsaUJBQU8sRUFBRSxnQkFBZ0IsRUFBRTtTQUM1QixDQUFDLENBQUM7T0FDSjtBQUNELGFBQU8sUUFBUSxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQztLQUM3QixFQUNELFVBQUMsS0FBSzthQUFLLFFBQVEsQ0FBQyxLQUFLLEVBQUUsS0FBSyxDQUFDO0tBQUEsQ0FDbEMsQ0FBQztHQUNILENBQUM7Q0FDSDs7QUFFTSxTQUFTLGlCQUFpQixDQUFDLE9BQU8sRUFBRTtNQUNsQyxPQUFPLEdBQUksT0FBTyxDQUFsQixPQUFPOztBQUNkLFNBQU8sQ0FBQyxFQUFFLE9BQU8sSUFBSSxPQUFPLEdBQUcsSUFBSSxDQUFDLEdBQUcsRUFBRSxDQUFBLEFBQUMsQ0FBQztDQUM1Qzs7QUFBQSxDQUFDIiwiZmlsZSI6Ii91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvc2VjdXJpdHkvc2VydmVyL2xpYi9nZXRfY29va2llX3ZhbGlkYXRlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGdldElzVmFsaWRVc2VyIGZyb20gJy4vZ2V0X2lzX3ZhbGlkX3VzZXInO1xuaW1wb3J0IGdldENhbGN1bGF0ZUV4cGlyZXMgZnJvbSAnLi9nZXRfY2FsY3VsYXRlX2V4cGlyZXMnO1xuXG5leHBvcnQgZGVmYXVsdCAoc2VydmVyKSA9PiB7XG4gIGNvbnN0IGlzVmFsaWRVc2VyID0gZ2V0SXNWYWxpZFVzZXIoc2VydmVyKTtcbiAgY29uc3QgY2FsY3VsYXRlRXhwaXJlcyA9IGdldENhbGN1bGF0ZUV4cGlyZXMoc2VydmVyKTtcbiAgY29uc3QgeyBpc1N5c3RlbUFwaVJlcXVlc3QgfSA9IHNlcnZlci5wbHVnaW5zLmtpYmFuYS5zeXN0ZW1BcGk7XG5cbiAgcmV0dXJuIGZ1bmN0aW9uIHZhbGlkYXRlKHJlcXVlc3QsIHNlc3Npb24sIGNhbGxiYWNrKSB7XG4gICAgaWYgKGhhc1Nlc3Npb25FeHBpcmVkKHNlc3Npb24pKSByZXR1cm4gY2FsbGJhY2sobmV3IEVycm9yKCdTZXNzaW9uIGhhcyBleHBpcmVkJyksIGZhbHNlKTtcblxuICAgIGNvbnN0IHt1c2VybmFtZSwgcGFzc3dvcmR9ID0gc2Vzc2lvbjtcbiAgICByZXR1cm4gaXNWYWxpZFVzZXIocmVxdWVzdCwgdXNlcm5hbWUsIHBhc3N3b3JkKS50aGVuKFxuICAgICAgKCkgPT4ge1xuICAgICAgICAvLyBFeHRlbmQgdGhlIHNlc3Npb24gdGltZW91dCBwcm92aWRlZCB0aGlzIGlzIE5PVCBhIHN5c3RlbSBBUEkgY2FsbFxuICAgICAgICBpZiAoIWlzU3lzdGVtQXBpUmVxdWVzdChyZXF1ZXN0KSkge1xuICAgICAgICAgIC8vIEtlZXAgdGhlIHNlc3Npb24gYWxpdmVcbiAgICAgICAgICByZXF1ZXN0LmNvb2tpZUF1dGguc2V0KHtcbiAgICAgICAgICAgIHVzZXJuYW1lLFxuICAgICAgICAgICAgcGFzc3dvcmQsXG4gICAgICAgICAgICBleHBpcmVzOiBjYWxjdWxhdGVFeHBpcmVzKClcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY2FsbGJhY2sobnVsbCwgdHJ1ZSk7XG4gICAgICB9LFxuICAgICAgKGVycm9yKSA9PiBjYWxsYmFjayhlcnJvciwgZmFsc2UpXG4gICAgKTtcbiAgfTtcbn07XG5cbmV4cG9ydCBmdW5jdGlvbiBoYXNTZXNzaW9uRXhwaXJlZChzZXNzaW9uKSB7XG4gIGNvbnN0IHtleHBpcmVzfSA9IHNlc3Npb247XG4gIHJldHVybiAhIShleHBpcmVzICYmIGV4cGlyZXMgPCBEYXRlLm5vdygpKTtcbn07XG4iXX0=",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/get_cookie_validate.js"
      ],
      "names": [],
      "mappings": ";;;;;;;;;iCAA2B,qBAAqB;;;;qCAChB,yBAAyB;;;;qBAE1C,UAAC,MAAM,EAAK;AACzB,MAAM,WAAW,GAAG,oCAAe,MAAM,CAAC,CAAC;AAC3C,MAAM,gBAAgB,GAAG,wCAAoB,MAAM,CAAC,CAAC;MAC7C,kBAAkB,GAAK,MAAM,CAAC,OAAO,CAAC,MAAM,CAAC,SAAS,CAAtD,kBAAkB;;AAE1B,SAAO,SAAS,QAAQ,CAAC,OAAO,EAAE,OAAO,EAAE,QAAQ,EAAE;AACnD,QAAI,iBAAiB,CAAC,OAAO,CAAC,EAAE,OAAO,QAAQ,CAAC,IAAI,KAAK,CAAC,qBAAqB,CAAC,EAAE,KAAK,CAAC,CAAC;;QAElF,QAAQ,GAAc,OAAO,CAA7B,QAAQ;QAAE,QAAQ,GAAI,OAAO,CAAnB,QAAQ;;AACzB,WAAO,WAAW,CAAC,OAAO,EAAE,QAAQ,EAAE,QAAQ,CAAC,CAAC,IAAI,CAClD,YAAM;;AAEJ,UAAI,CAAC,kBAAkB,CAAC,OAAO,CAAC,EAAE;;AAEhC,eAAO,CAAC,UAAU,CAAC,GAAG,CAAC;AACrB,kBAAQ,EAAR,QAAQ;AACR,kBAAQ,EAAR,QAAQ;AACR,iBAAO,EAAE,gBAAgB,EAAE;SAC5B,CAAC,CAAC;OACJ;AACD,aAAO,QAAQ,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;KAC7B,EACD,UAAC,KAAK;aAAK,QAAQ,CAAC,KAAK,EAAE,KAAK,CAAC;KAAA,CAClC,CAAC;GACH,CAAC;CACH;;AAEM,SAAS,iBAAiB,CAAC,OAAO,EAAE;MAClC,OAAO,GAAI,OAAO,CAAlB,OAAO;;AACd,SAAO,CAAC,EAAE,OAAO,IAAI,OAAO,GAAG,IAAI,CAAC,GAAG,EAAE,CAAA,AAAC,CAAC;CAC5C;;AAAA,CAAC",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/get_cookie_validate.js",
      "sourcesContent": [
        "import getIsValidUser from './get_is_valid_user';\nimport getCalculateExpires from './get_calculate_expires';\n\nexport default (server) => {\n  const isValidUser = getIsValidUser(server);\n  const calculateExpires = getCalculateExpires(server);\n  const { isSystemApiRequest } = server.plugins.kibana.systemApi;\n\n  return function validate(request, session, callback) {\n    if (hasSessionExpired(session)) return callback(new Error('Session has expired'), false);\n\n    const {username, password} = session;\n    return isValidUser(request, username, password).then(\n      () => {\n        // Extend the session timeout provided this is NOT a system API call\n        if (!isSystemApiRequest(request)) {\n          // Keep the session alive\n          request.cookieAuth.set({\n            username,\n            password,\n            expires: calculateExpires()\n          });\n        }\n        return callback(null, true);\n      },\n      (error) => callback(error, false)\n    );\n  };\n};\n\nexport function hasSessionExpired(session) {\n  const {expires} = session;\n  return !!(expires && expires < Date.now());\n};\n"
      ]
    },
    "mtime": 1491771510468
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/get_calculate_expires.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [],
        "exports": {
          "exported": [],
          "specifiers": []
        }
      },
      "usedHelpers": []
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nexports['default'] = function (server) {\n  var ttl = server.config().get('xpack.security.sessionTimeout');\n  return function () {\n    return ttl && Date.now() + ttl;\n  };\n};\n\nmodule.exports = exports['default'];\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvc2VjdXJpdHkvc2VydmVyL2xpYi9nZXRfY2FsY3VsYXRlX2V4cGlyZXMuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7O3FCQUFlLFVBQUMsTUFBTSxFQUFLO0FBQ3pCLE1BQU0sR0FBRyxHQUFHLE1BQU0sQ0FBQyxNQUFNLEVBQUUsQ0FBQyxHQUFHLENBQUMsK0JBQStCLENBQUMsQ0FBQztBQUNqRSxTQUFPO1dBQU0sR0FBRyxJQUFJLElBQUksQ0FBQyxHQUFHLEVBQUUsR0FBRyxHQUFHO0dBQUEsQ0FBQztDQUN0QyIsImZpbGUiOiIvdXNyL3NoYXJlL2tpYmFuYS9wbHVnaW5zL3gtcGFjay9wbHVnaW5zL3NlY3VyaXR5L3NlcnZlci9saWIvZ2V0X2NhbGN1bGF0ZV9leHBpcmVzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgKHNlcnZlcikgPT4ge1xuICBjb25zdCB0dGwgPSBzZXJ2ZXIuY29uZmlnKCkuZ2V0KCd4cGFjay5zZWN1cml0eS5zZXNzaW9uVGltZW91dCcpO1xuICByZXR1cm4gKCkgPT4gdHRsICYmIERhdGUubm93KCkgKyB0dGw7XG59O1xuIl19",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/get_calculate_expires.js"
      ],
      "names": [],
      "mappings": ";;;;;;qBAAe,UAAC,MAAM,EAAK;AACzB,MAAM,GAAG,GAAG,MAAM,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,+BAA+B,CAAC,CAAC;AACjE,SAAO;WAAM,GAAG,IAAI,IAAI,CAAC,GAAG,EAAE,GAAG,GAAG;GAAA,CAAC;CACtC",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/get_calculate_expires.js",
      "sourcesContent": [
        "export default (server) => {\n  const ttl = server.config().get('xpack.security.sessionTimeout');\n  return () => ttl && Date.now() + ttl;\n};\n"
      ]
    },
    "mtime": 1491771510468
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/get_user.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "./get_client_shield",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "getClient"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "getUserProvider",
            "server"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "getUserProvider",
              "exported": "default"
            },
            {
              "kind": "local",
              "local": "server",
              "exported": "default"
            }
          ]
        }
      },
      "usedHelpers": [
        "interop-require-default"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nexports['default'] = getUserProvider;\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _get_client_shield = require('./get_client_shield');\n\nvar _get_client_shield2 = _interopRequireDefault(_get_client_shield);\n\nfunction getUserProvider(server) {\n  var callWithRequest = (0, _get_client_shield2['default'])(server).callWithRequest;\n\n  server.expose('getUser', function (request) {\n    var xpackInfo = server.plugins.xpack_main.info;\n    if (xpackInfo && xpackInfo.isAvailable() && !xpackInfo.feature('security').isEnabled()) {\n      return Promise.resolve(null);\n    }\n    return callWithRequest(request, 'shield.authenticate');\n  });\n}\n\n;\nmodule.exports = exports['default'];\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvc2VjdXJpdHkvc2VydmVyL2xpYi9nZXRfdXNlci5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztxQkFFd0IsZUFBZTs7OztpQ0FGakIscUJBQXFCOzs7O0FBRTVCLFNBQVMsZUFBZSxDQUFDLE1BQU0sRUFBRTtBQUM5QyxNQUFNLGVBQWUsR0FBRyxvQ0FBVSxNQUFNLENBQUMsQ0FBQyxlQUFlLENBQUM7O0FBRTFELFFBQU0sQ0FBQyxNQUFNLENBQUMsU0FBUyxFQUFFLFVBQUMsT0FBTyxFQUFLO0FBQ3BDLFFBQU0sU0FBUyxHQUFHLE1BQU0sQ0FBQyxPQUFPLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQztBQUNqRCxRQUFJLFNBQVMsSUFBSSxTQUFTLENBQUMsV0FBVyxFQUFFLElBQUksQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQyxDQUFDLFNBQVMsRUFBRSxFQUFFO0FBQ3RGLGFBQU8sT0FBTyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztLQUM5QjtBQUNELFdBQU8sZUFBZSxDQUFDLE9BQU8sRUFBRSxxQkFBcUIsQ0FBQyxDQUFDO0dBQ3hELENBQUMsQ0FBQztDQUNKOztBQUFBLENBQUMiLCJmaWxlIjoiL3Vzci9zaGFyZS9raWJhbmEvcGx1Z2lucy94LXBhY2svcGx1Z2lucy9zZWN1cml0eS9zZXJ2ZXIvbGliL2dldF91c2VyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGdldENsaWVudCBmcm9tICcuL2dldF9jbGllbnRfc2hpZWxkJztcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0VXNlclByb3ZpZGVyKHNlcnZlcikge1xuICBjb25zdCBjYWxsV2l0aFJlcXVlc3QgPSBnZXRDbGllbnQoc2VydmVyKS5jYWxsV2l0aFJlcXVlc3Q7XG5cbiAgc2VydmVyLmV4cG9zZSgnZ2V0VXNlcicsIChyZXF1ZXN0KSA9PiB7XG4gICAgY29uc3QgeHBhY2tJbmZvID0gc2VydmVyLnBsdWdpbnMueHBhY2tfbWFpbi5pbmZvO1xuICAgIGlmICh4cGFja0luZm8gJiYgeHBhY2tJbmZvLmlzQXZhaWxhYmxlKCkgJiYgIXhwYWNrSW5mby5mZWF0dXJlKCdzZWN1cml0eScpLmlzRW5hYmxlZCgpKSB7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG51bGwpO1xuICAgIH1cbiAgICByZXR1cm4gY2FsbFdpdGhSZXF1ZXN0KHJlcXVlc3QsICdzaGllbGQuYXV0aGVudGljYXRlJyk7XG4gIH0pO1xufTtcbiJdfQ==",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/get_user.js"
      ],
      "names": [],
      "mappings": ";;;;;qBAEwB,eAAe;;;;iCAFjB,qBAAqB;;;;AAE5B,SAAS,eAAe,CAAC,MAAM,EAAE;AAC9C,MAAM,eAAe,GAAG,oCAAU,MAAM,CAAC,CAAC,eAAe,CAAC;;AAE1D,QAAM,CAAC,MAAM,CAAC,SAAS,EAAE,UAAC,OAAO,EAAK;AACpC,QAAM,SAAS,GAAG,MAAM,CAAC,OAAO,CAAC,UAAU,CAAC,IAAI,CAAC;AACjD,QAAI,SAAS,IAAI,SAAS,CAAC,WAAW,EAAE,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,UAAU,CAAC,CAAC,SAAS,EAAE,EAAE;AACtF,aAAO,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;KAC9B;AACD,WAAO,eAAe,CAAC,OAAO,EAAE,qBAAqB,CAAC,CAAC;GACxD,CAAC,CAAC;CACJ;;AAAA,CAAC",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/get_user.js",
      "sourcesContent": [
        "import getClient from './get_client_shield';\n\nexport default function getUserProvider(server) {\n  const callWithRequest = getClient(server).callWithRequest;\n\n  server.expose('getUser', (request) => {\n    const xpackInfo = server.plugins.xpack_main.info;\n    if (xpackInfo && xpackInfo.isAvailable() && !xpackInfo.feature('security').isEnabled()) {\n      return Promise.resolve(null);\n    }\n    return callWithRequest(request, 'shield.authenticate');\n  });\n};\n"
      ]
    },
    "mtime": 1491771510468
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/get_client_shield.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "lodash",
            "imported": [
              "once"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "once",
                "local": "once"
              }
            ]
          },
          {
            "source": "./elasticsearch-shield-js/elasticsearch-shield",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "esShield"
              }
            ]
          }
        ],
        "exports": {
          "exported": [],
          "specifiers": []
        }
      },
      "usedHelpers": [
        "interop-require-default"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _lodash = require('lodash');\n\nvar _elasticsearchShieldJsElasticsearchShield = require('./elasticsearch-shield-js/elasticsearch-shield');\n\nvar _elasticsearchShieldJsElasticsearchShield2 = _interopRequireDefault(_elasticsearchShieldJsElasticsearchShield);\n\nexports['default'] = (0, _lodash.once)(function (server) {\n  var config = Object.assign({ plugins: [_elasticsearchShieldJsElasticsearchShield2['default']] }, server.config().get('elasticsearch'));\n  var cluster = server.plugins.elasticsearch.createCluster('security', config);\n\n  return cluster;\n});\nmodule.exports = exports['default'];\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvc2VjdXJpdHkvc2VydmVyL2xpYi9nZXRfY2xpZW50X3NoaWVsZC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7OztzQkFBcUIsUUFBUTs7d0RBQ1IsZ0RBQWdEOzs7O3FCQUV0RCxrQkFBSyxVQUFDLE1BQU0sRUFBSztBQUM5QixNQUFNLE1BQU0sR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLEVBQUUsT0FBTyxFQUFFLHVEQUFVLEVBQUUsRUFBRSxNQUFNLENBQUMsTUFBTSxFQUFFLENBQUMsR0FBRyxDQUFDLGVBQWUsQ0FBQyxDQUFDLENBQUM7QUFDNUYsTUFBTSxPQUFPLEdBQUcsTUFBTSxDQUFDLE9BQU8sQ0FBQyxhQUFhLENBQUMsYUFBYSxDQUFDLFVBQVUsRUFBRSxNQUFNLENBQUMsQ0FBQzs7QUFFL0UsU0FBTyxPQUFPLENBQUM7Q0FDaEIsQ0FBQyIsImZpbGUiOiIvdXNyL3NoYXJlL2tpYmFuYS9wbHVnaW5zL3gtcGFjay9wbHVnaW5zL3NlY3VyaXR5L3NlcnZlci9saWIvZ2V0X2NsaWVudF9zaGllbGQuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBvbmNlIH0gZnJvbSAnbG9kYXNoJztcbmltcG9ydCBlc1NoaWVsZCBmcm9tICcuL2VsYXN0aWNzZWFyY2gtc2hpZWxkLWpzL2VsYXN0aWNzZWFyY2gtc2hpZWxkJztcblxuZXhwb3J0IGRlZmF1bHQgb25jZSgoc2VydmVyKSA9PiB7XG4gIGNvbnN0IGNvbmZpZyA9IE9iamVjdC5hc3NpZ24oeyBwbHVnaW5zOiBbZXNTaGllbGRdIH0sIHNlcnZlci5jb25maWcoKS5nZXQoJ2VsYXN0aWNzZWFyY2gnKSk7XG4gIGNvbnN0IGNsdXN0ZXIgPSBzZXJ2ZXIucGx1Z2lucy5lbGFzdGljc2VhcmNoLmNyZWF0ZUNsdXN0ZXIoJ3NlY3VyaXR5JywgY29uZmlnKTtcblxuICByZXR1cm4gY2x1c3Rlcjtcbn0pO1xuIl19",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/get_client_shield.js"
      ],
      "names": [],
      "mappings": ";;;;;;;;sBAAqB,QAAQ;;wDACR,gDAAgD;;;;qBAEtD,kBAAK,UAAC,MAAM,EAAK;AAC9B,MAAM,MAAM,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,OAAO,EAAE,uDAAU,EAAE,EAAE,MAAM,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,eAAe,CAAC,CAAC,CAAC;AAC5F,MAAM,OAAO,GAAG,MAAM,CAAC,OAAO,CAAC,aAAa,CAAC,aAAa,CAAC,UAAU,EAAE,MAAM,CAAC,CAAC;;AAE/E,SAAO,OAAO,CAAC;CAChB,CAAC",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/get_client_shield.js",
      "sourcesContent": [
        "import { once } from 'lodash';\nimport esShield from './elasticsearch-shield-js/elasticsearch-shield';\n\nexport default once((server) => {\n  const config = Object.assign({ plugins: [esShield] }, server.config().get('elasticsearch'));\n  const cluster = server.plugins.elasticsearch.createCluster('security', config);\n\n  return cluster;\n});\n"
      ]
    },
    "mtime": 1491771510468
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/elasticsearch-shield-js/elasticsearch-shield.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [],
        "exports": {
          "exported": [],
          "specifiers": []
        }
      },
      "usedHelpers": []
    },
    "ignored": false,
    "code": "'use strict';\n\n(function (root, factory) {\n  if (typeof define === 'function' && define.amd) {\n    define([], factory);\n  } else if (typeof exports === 'object') {\n    module.exports = factory();\n  } else {\n    root.ElasticsearchShield = factory();\n  }\n})(undefined, function () {\n  return function addShieldApi(Client, config, components) {\n    var ca = components.clientAction.factory;\n\n    Client.prototype.shield = components.clientAction.namespaceFactory();\n    var shield = Client.prototype.shield.prototype;\n\n    /**\n     * Perform a [shield.authenticate](Retrieve details about the currently authenticated user) request\n     *\n     * @param {Object} params - An object with parameters used to carry out this action\n     */\n    shield.authenticate = ca({\n      params: {},\n      url: {\n        fmt: '/_xpack/security/_authenticate'\n      }\n    });\n\n    /**\n     * Perform a [shield.changePassword](Change the password of a user) request\n     *\n     * @param {Object} params - An object with parameters used to carry out this action\n     * @param {Boolean} params.refresh - Refresh the index after performing the operation\n     * @param {String} params.username - The username of the user to change the password for\n     */\n    shield.changePassword = ca({\n      params: {\n        refresh: {\n          type: 'boolean'\n        }\n      },\n      urls: [{\n        fmt: '/_xpack/security/user/<%=username%>/_password',\n        req: {\n          username: {\n            type: 'string',\n            required: false\n          }\n        }\n      }, {\n        fmt: '/_xpack/security/user/_password'\n      }],\n      needBody: true,\n      method: 'POST'\n    });\n\n    /**\n     * Perform a [shield.clearCachedRealms](Clears the internal user caches for specified realms) request\n     *\n     * @param {Object} params - An object with parameters used to carry out this action\n     * @param {String} params.usernames - Comma-separated list of usernames to clear from the cache\n     * @param {String} params.realms - Comma-separated list of realms to clear\n     */\n    shield.clearCachedRealms = ca({\n      params: {\n        usernames: {\n          type: 'string',\n          required: false\n        }\n      },\n      url: {\n        fmt: '/_xpack/security/realm/<%=realms%>/_clear_cache',\n        req: {\n          realms: {\n            type: 'string',\n            required: true\n          }\n        }\n      },\n      method: 'POST'\n    });\n\n    /**\n     * Perform a [shield.clearCachedRoles](Clears the internal caches for specified roles) request\n     *\n     * @param {Object} params - An object with parameters used to carry out this action\n     * @param {String} params.name - Role name\n     */\n    shield.clearCachedRoles = ca({\n      params: {},\n      url: {\n        fmt: '/_xpack/security/role/<%=name%>/_clear_cache',\n        req: {\n          name: {\n            type: 'string',\n            required: true\n          }\n        }\n      },\n      method: 'POST'\n    });\n\n    /**\n     * Perform a [shield.deleteRole](Remove a role from the native shield realm) request\n     *\n     * @param {Object} params - An object with parameters used to carry out this action\n     * @param {Boolean} params.refresh - Refresh the index after performing the operation\n     * @param {String} params.name - Role name\n     */\n    shield.deleteRole = ca({\n      params: {\n        refresh: {\n          type: 'boolean'\n        }\n      },\n      url: {\n        fmt: '/_xpack/security/role/<%=name%>',\n        req: {\n          name: {\n            type: 'string',\n            required: true\n          }\n        }\n      },\n      method: 'DELETE'\n    });\n\n    /**\n     * Perform a [shield.deleteUser](Remove a user from the native shield realm) request\n     *\n     * @param {Object} params - An object with parameters used to carry out this action\n     * @param {Boolean} params.refresh - Refresh the index after performing the operation\n     * @param {String} params.username - username\n     */\n    shield.deleteUser = ca({\n      params: {\n        refresh: {\n          type: 'boolean'\n        }\n      },\n      url: {\n        fmt: '/_xpack/security/user/<%=username%>',\n        req: {\n          username: {\n            type: 'string',\n            required: true\n          }\n        }\n      },\n      method: 'DELETE'\n    });\n\n    /**\n     * Perform a [shield.getRole](Retrieve one or more roles from the native shield realm) request\n     *\n     * @param {Object} params - An object with parameters used to carry out this action\n     * @param {String} params.name - Role name\n     */\n    shield.getRole = ca({\n      params: {},\n      urls: [{\n        fmt: '/_xpack/security/role/<%=name%>',\n        req: {\n          name: {\n            type: 'string',\n            required: false\n          }\n        }\n      }, {\n        fmt: '/_xpack/security/role'\n      }]\n    });\n\n    /**\n     * Perform a [shield.getUser](Retrieve one or more users from the native shield realm) request\n     *\n     * @param {Object} params - An object with parameters used to carry out this action\n     * @param {String, String[], Boolean} params.username - A comma-separated list of usernames\n     */\n    shield.getUser = ca({\n      params: {},\n      urls: [{\n        fmt: '/_xpack/security/user/<%=username%>',\n        req: {\n          username: {\n            type: 'list',\n            required: false\n          }\n        }\n      }, {\n        fmt: '/_xpack/security/user'\n      }]\n    });\n\n    /**\n     * Perform a [shield.putRole](Update or create a role for the native shield realm) request\n     *\n     * @param {Object} params - An object with parameters used to carry out this action\n     * @param {Boolean} params.refresh - Refresh the index after performing the operation\n     * @param {String} params.name - Role name\n     */\n    shield.putRole = ca({\n      params: {\n        refresh: {\n          type: 'boolean'\n        }\n      },\n      url: {\n        fmt: '/_xpack/security/role/<%=name%>',\n        req: {\n          name: {\n            type: 'string',\n            required: true\n          }\n        }\n      },\n      needBody: true,\n      method: 'PUT'\n    });\n\n    /**\n     * Perform a [shield.putUser](Update or create a user for the native shield realm) request\n     *\n     * @param {Object} params - An object with parameters used to carry out this action\n     * @param {Boolean} params.refresh - Refresh the index after performing the operation\n     * @param {String} params.username - The username of the User\n     */\n    shield.putUser = ca({\n      params: {\n        refresh: {\n          type: 'boolean'\n        }\n      },\n      url: {\n        fmt: '/_xpack/security/user/<%=username%>',\n        req: {\n          username: {\n            type: 'string',\n            required: true\n          }\n        }\n      },\n      needBody: true,\n      method: 'PUT'\n    });\n  };\n});\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvc2VjdXJpdHkvc2VydmVyL2xpYi9lbGFzdGljc2VhcmNoLXNoaWVsZC1qcy9lbGFzdGljc2VhcmNoLXNoaWVsZC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLEFBQUMsQ0FBQSxVQUFVLElBQUksRUFBRSxPQUFPLEVBQUU7QUFDeEIsTUFBSSxPQUFPLE1BQU0sS0FBSyxVQUFVLElBQUksTUFBTSxDQUFDLEdBQUcsRUFBRTtBQUM5QyxVQUFNLENBQUMsRUFBRSxFQUFFLE9BQU8sQ0FBQyxDQUFDO0dBQ3JCLE1BQU0sSUFBSSxPQUFPLE9BQU8sS0FBSyxRQUFRLEVBQUU7QUFDdEMsVUFBTSxDQUFDLE9BQU8sR0FBRyxPQUFPLEVBQUUsQ0FBQztHQUM1QixNQUFNO0FBQ0wsUUFBSSxDQUFDLG1CQUFtQixHQUFHLE9BQU8sRUFBRSxDQUFDO0dBQ3RDO0NBQ0YsQ0FBQSxZQUFPLFlBQVk7QUFDbEIsU0FBTyxTQUFTLFlBQVksQ0FBQyxNQUFNLEVBQUUsTUFBTSxFQUFFLFVBQVUsRUFBRTtBQUN2RCxRQUFNLEVBQUUsR0FBRyxVQUFVLENBQUMsWUFBWSxDQUFDLE9BQU8sQ0FBQzs7QUFFM0MsVUFBTSxDQUFDLFNBQVMsQ0FBQyxNQUFNLEdBQUcsVUFBVSxDQUFDLFlBQVksQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO0FBQ3JFLFFBQU0sTUFBTSxHQUFHLE1BQU0sQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQzs7Ozs7OztBQU9qRCxVQUFNLENBQUMsWUFBWSxHQUFHLEVBQUUsQ0FBQztBQUN2QixZQUFNLEVBQUUsRUFBRTtBQUNWLFNBQUcsRUFBRTtBQUNILFdBQUcsRUFBRSxnQ0FBZ0M7T0FDdEM7S0FDRixDQUFDLENBQUM7Ozs7Ozs7OztBQVNILFVBQU0sQ0FBQyxjQUFjLEdBQUcsRUFBRSxDQUFDO0FBQ3pCLFlBQU0sRUFBRTtBQUNOLGVBQU8sRUFBRTtBQUNQ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Ozs7QUFTSCxVQUFNLENBQUMsT0FBTyxHQUFHLEVBQUUsQ0FBQztBQUNsQixZQUFNLEVBQUU7QUFDTixlQUFPLEVBQUU7QUFDUCxjQUFJLEVBQUUsU0FBUztTQUNoQjtPQUNGO0FBQ0QsU0FBRyxFQUFFO0FBQ0gsV0FBRyxFQUFFLGlDQUFpQztBQUN0QyxXQUFHLEVBQUU7QUFDSCxjQUFJLEVBQUU7QUFDSixnQkFBSSxFQUFFLFFBQVE7QUFDZCxvQkFBUSxFQUFFLElBQUk7V0FDZjtTQUNGO09BQ0Y7QUFDRCxjQUFRLEVBQUUsSUFBSTtBQUNkLFlBQU0sRUFBRSxLQUFLO0tBQ2QsQ0FBQyxDQUFDOzs7Ozs7Ozs7QUFTSCxVQUFNLENBQUMsT0FBTyxHQUFHLEVBQUUsQ0FBQztBQUNsQixZQUFNLEVBQUU7QUFDTixlQUFPLEVBQUU7QUFDUCxjQUFJLEVBQUUsU0FBUztTQUNoQjtPQUNGO0FBQ0QsU0FBRyxFQUFFO0FBQ0gsV0FBRyxFQUFFLHFDQUFxQztBQUMxQyxXQUFHLEVBQUU7QUFDSCxrQkFBUSxFQUFFO0FBQ1IsZ0JBQUksRUFBRSxRQUFRO0FBQ2Qsb0JBQVEsRUFBRSxJQUFJO1dBQ2Y7U0FDRjtPQUNGO0FBQ0QsY0FBUSxFQUFFLElBQUk7QUFDZCxZQUFNLEVBQUUsS0FBSztLQUNkLENBQUMsQ0FBQztHQUVKLENBQUM7Q0FDSCxDQUFDLENBQUUiLCJmaWxlIjoiL3Vzci9zaGFyZS9raWJhbmEvcGx1Z2lucy94LXBhY2svcGx1Z2lucy9zZWN1cml0eS9zZXJ2ZXIvbGliL2VsYXN0aWNzZWFyY2gtc2hpZWxkLWpzL2VsYXN0aWNzZWFyY2gtc2hpZWxkLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIChyb290LCBmYWN0b3J5KSB7XG4gIGlmICh0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpIHtcbiAgICBkZWZpbmUoW10sIGZhY3RvcnkpO1xuICB9IGVsc2UgaWYgKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0Jykge1xuICAgIG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpO1xuICB9IGVsc2Uge1xuICAgIHJvb3QuRWxhc3RpY3NlYXJjaFNoaWVsZCA9IGZhY3RvcnkoKTtcbiAgfVxufSh0aGlzLCBmdW5jdGlvbiAoKSB7XG4gIHJldHVybiBmdW5jdGlvbiBhZGRTaGllbGRBcGkoQ2xpZW50LCBjb25maWcsIGNvbXBvbmVudHMpIHtcbiAgICBjb25zdCBjYSA9IGNvbXBvbmVudHMuY2xpZW50QWN0aW9uLmZhY3Rvcnk7XG5cbiAgICBDbGllbnQucHJvdG90eXBlLnNoaWVsZCA9IGNvbXBvbmVudHMuY2xpZW50QWN0aW9uLm5hbWVzcGFjZUZhY3RvcnkoKTtcbiAgICBjb25zdCBzaGllbGQgPSBDbGllbnQucHJvdG90eXBlLnNoaWVsZC5wcm90b3R5cGU7XG5cbiAgICAvKipcbiAgICAgKiBQZXJmb3JtIGEgW3NoaWVsZC5hdXRoZW50aWNhdGVdKFJldHJpZXZlIGRldGFpbHMgYWJvdXQgdGhlIGN1cnJlbnRseSBhdXRoZW50aWNhdGVkIHVzZXIpIHJlcXVlc3RcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBwYXJhbXMgLSBBbiBvYmplY3Qgd2l0aCBwYXJhbWV0ZXJzIHVzZWQgdG8gY2Fycnkgb3V0IHRoaXMgYWN0aW9uXG4gICAgICovXG4gICAgc2hpZWxkLmF1dGhlbnRpY2F0ZSA9IGNhKHtcbiAgICAgIHBhcmFtczoge30sXG4gICAgICB1cmw6IHtcbiAgICAgICAgZm10OiAnL194cGFjay9zZWN1cml0eS9fYXV0aGVudGljYXRlJ1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUGVyZm9ybSBhIFtzaGllbGQuY2hhbmdlUGFzc3dvcmRdKENoYW5nZSB0aGUgcGFzc3dvcmQgb2YgYSB1c2VyKSByZXF1ZXN0XG4gICAgICpcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gcGFyYW1zIC0gQW4gb2JqZWN0IHdpdGggcGFyYW1ldGVycyB1c2VkIHRvIGNhcnJ5IG91dCB0aGlzIGFjdGlvblxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gcGFyYW1zLnJlZnJlc2ggLSBSZWZyZXNoIHRoZSBpbmRleCBhZnRlciBwZXJmb3JtaW5nIHRoZSBvcGVyYXRpb25cbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gcGFyYW1zLnVzZXJuYW1lIC0gVGhlIHVzZXJuYW1lIG9mIHRoZSB1c2VyIHRvIGNoYW5nZSB0aGUgcGFzc3dvcmQgZm9yXG4gICAgICovXG4gICAgc2hpZWxkLmNoYW5nZVBhc3N3b3JkID0gY2Eoe1xuICAgICAgcGFyYW1zOiB7XG4gICAgICAgIHJlZnJlc2g6IHtcbiAgICAgICAgICB0eXBlOiAnYm9vbGVhbidcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHVybHM6IFtcbiAgICAgICAge1xuICAgICAgICAgIGZtdDogJy9feHBhY2svc2VjdXJpdHkvdXNlci88JT11c2VybmFtZSU+L19wYXNzd29yZCcsXG4gICAgICAgICAgcmVxOiB7XG4gICAgICAgICAgICB1c2VybmFtZToge1xuICAgICAgICAgICAgICB0eXBlOiAnc3RyaW5nJyxcbiAgICAgICAgICAgICAgcmVxdWlyZWQ6IGZhbHNlXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgZm10OiAnL194cGFjay9zZWN1cml0eS91c2VyL19wYXNzd29yZCdcbiAgICAgICAgfVxuICAgICAgXSxcbiAgICAgIG5lZWRCb2R5OiB0cnVlLFxuICAgICAgbWV0aG9kOiAnUE9TVCdcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFBlcmZvcm0gYSBbc2hpZWxkLmNsZWFyQ2FjaGVkUmVhbG1zXShDbGVhcnMgdGhlIGludGVybmFsIHVzZXIgY2FjaGVzIGZvciBzcGVjaWZpZWQgcmVhbG1zKSByZXF1ZXN0XG4gICAgICpcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gcGFyYW1zIC0gQW4gb2JqZWN0IHdpdGggcGFyYW1ldGVycyB1c2VkIHRvIGNhcnJ5IG91dCB0aGlzIGFjdGlvblxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBwYXJhbXMudXNlcm5hbWVzIC0gQ29tbWEtc2VwYXJhdGVkIGxpc3Qgb2YgdXNlcm5hbWVzIHRvIGNsZWFyIGZyb20gdGhlIGNhY2hlXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHBhcmFtcy5yZWFsbXMgLSBDb21tYS1zZXBhcmF0ZWQgbGlzdCBvZiByZWFsbXMgdG8gY2xlYXJcbiAgICAgKi9cbiAgICBzaGllbGQuY2xlYXJDYWNoZWRSZWFsbXMgPSBjYSh7XG4gICAgICBwYXJhbXM6IHtcbiAgICAgICAgdXNlcm5hbWVzOiB7XG4gICAgICAgICAgdHlwZTogJ3N0cmluZycsXG4gICAgICAgICAgcmVxdWlyZWQ6IGZhbHNlXG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICB1cmw6IHtcbiAgICAgICAgZm10OiAnL194cGFjay9zZWN1cml0eS9yZWFsbS88JT1yZWFsbXMlPi9fY2xlYXJfY2FjaGUnLFxuICAgICAgICByZXE6IHtcbiAgICAgICAgICByZWFsbXM6IHtcbiAgICAgICAgICAgIHR5cGU6ICdzdHJpbmcnLFxuICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWVcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBtZXRob2Q6ICdQT1NUJ1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUGVyZm9ybSBhIFtzaGllbGQuY2xlYXJDYWNoZWRSb2xlc10oQ2xlYXJzIHRoZSBpbnRlcm5hbCBjYWNoZXMgZm9yIHNwZWNpZmllZCByb2xlcykgcmVxdWVzdFxuICAgICAqXG4gICAgICogQHBhcmFtIHtPYmplY3R9IHBhcmFtcyAtIEFuIG9iamVjdCB3aXRoIHBhcmFtZXRlcnMgdXNlZCB0byBjYXJyeSBvdXQgdGhpcyBhY3Rpb25cbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gcGFyYW1zLm5hbWUgLSBSb2xlIG5hbWVcbiAgICAgKi9cbiAgICBzaGllbGQuY2xlYXJDYWNoZWRSb2xlcyA9IGNhKHtcbiAgICAgIHBhcmFtczoge30sXG4gICAgICB1cmw6IHtcbiAgICAgICAgZm10OiAnL194cGFjay9zZWN1cml0eS9yb2xlLzwlPW5hbWUlPi9fY2xlYXJfY2FjaGUnLFxuICAgICAgICByZXE6IHtcbiAgICAgICAgICBuYW1lOiB7XG4gICAgICAgICAgICB0eXBlOiAnc3RyaW5nJyxcbiAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgbWV0aG9kOiAnUE9TVCdcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFBlcmZvcm0gYSBbc2hpZWxkLmRlbGV0ZVJvbGVdKFJlbW92ZSBhIHJvbGUgZnJvbSB0aGUgbmF0aXZlIHNoaWVsZCByZWFsbSkgcmVxdWVzdFxuICAgICAqXG4gICAgICogQHBhcmFtIHtPYmplY3R9IHBhcmFtcyAtIEFuIG9iamVjdCB3aXRoIHBhcmFtZXRlcnMgdXNlZCB0byBjYXJyeSBvdXQgdGhpcyBhY3Rpb25cbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IHBhcmFtcy5yZWZyZXNoIC0gUmVmcmVzaCB0aGUgaW5kZXggYWZ0ZXIgcGVyZm9ybWluZyB0aGUgb3BlcmF0aW9uXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHBhcmFtcy5uYW1lIC0gUm9sZSBuYW1lXG4gICAgICovXG4gICAgc2hpZWxkLmRlbGV0ZVJvbGUgPSBjYSh7XG4gICAgICBwYXJhbXM6IHtcbiAgICAgICAgcmVmcmVzaDoge1xuICAgICAgICAgIHR5cGU6ICdib29sZWFuJ1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgdXJsOiB7XG4gICAgICAgIGZtdDogJy9feHBhY2svc2VjdXJpdHkvcm9sZS88JT1uYW1lJT4nLFxuICAgICAgICByZXE6IHtcbiAgICAgICAgICBuYW1lOiB7XG4gICAgICAgICAgICB0eXBlOiAnc3RyaW5nJyxcbiAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgbWV0aG9kOiAnREVMRVRFJ1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUGVyZm9ybSBhIFtzaGllbGQuZGVsZXRlVXNlcl0oUmVtb3ZlIGEgdXNlciBmcm9tIHRoZSBuYXRpdmUgc2hpZWxkIHJlYWxtKSByZXF1ZXN0XG4gICAgICpcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gcGFyYW1zIC0gQW4gb2JqZWN0IHdpdGggcGFyYW1ldGVycyB1c2VkIHRvIGNhcnJ5IG91dCB0aGlzIGFjdGlvblxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gcGFyYW1zLnJlZnJlc2ggLSBSZWZyZXNoIHRoZSBpbmRleCBhZnRlciBwZXJmb3JtaW5nIHRoZSBvcGVyYXRpb25cbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gcGFyYW1zLnVzZXJuYW1lIC0gdXNlcm5hbWVcbiAgICAgKi9cbiAgICBzaGllbGQuZGVsZXRlVXNlciA9IGNhKHtcbiAgICAgIHBhcmFtczoge1xuICAgICAgICByZWZyZXNoOiB7XG4gICAgICAgICAgdHlwZTogJ2Jvb2xlYW4nXG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICB1cmw6IHtcbiAgICAgICAgZm10OiAnL194cGFjay9zZWN1cml0eS91c2VyLzwlPXVzZXJuYW1lJT4nLFxuICAgICAgICByZXE6IHtcbiAgICAgICAgICB1c2VybmFtZToge1xuICAgICAgICAgICAgdHlwZTogJ3N0cmluZycsXG4gICAgICAgICAgICByZXF1aXJlZDogdHJ1ZVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIG1ldGhvZDogJ0RFTEVURSdcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFBlcmZvcm0gYSBbc2hpZWxkLmdldFJvbGVdKFJldHJpZXZlIG9uZSBvciBtb3JlIHJvbGVzIGZyb20gdGhlIG5hdGl2ZSBzaGllbGQgcmVhbG0pIHJlcXVlc3RcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBwYXJhbXMgLSBBbiBvYmplY3Qgd2l0aCBwYXJhbWV0ZXJzIHVzZWQgdG8gY2Fycnkgb3V0IHRoaXMgYWN0aW9uXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHBhcmFtcy5uYW1lIC0gUm9sZSBuYW1lXG4gICAgICovXG4gICAgc2hpZWxkLmdldFJvbGUgPSBjYSh7XG4gICAgICBwYXJhbXM6IHt9LFxuICAgICAgdXJsczogW1xuICAgICAgICB7XG4gICAgICAgICAgZm10OiAnL194cGFjay9zZWN1cml0eS9yb2xlLzwlPW5hbWUlPicsXG4gICAgICAgICAgcmVxOiB7XG4gICAgICAgICAgICBuYW1lOiB7XG4gICAgICAgICAgICAgIHR5cGU6ICdzdHJpbmcnLFxuICAgICAgICAgICAgICByZXF1aXJlZDogZmFsc2VcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBmbXQ6ICcvX3hwYWNrL3NlY3VyaXR5L3JvbGUnXG4gICAgICAgIH1cbiAgICAgIF1cbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFBlcmZvcm0gYSBbc2hpZWxkLmdldFVzZXJdKFJldHJpZXZlIG9uZSBvciBtb3JlIHVzZXJzIGZyb20gdGhlIG5hdGl2ZSBzaGllbGQgcmVhbG0pIHJlcXVlc3RcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBwYXJhbXMgLSBBbiBvYmplY3Qgd2l0aCBwYXJhbWV0ZXJzIHVzZWQgdG8gY2Fycnkgb3V0IHRoaXMgYWN0aW9uXG4gICAgICogQHBhcmFtIHtTdHJpbmcsIFN0cmluZ1tdLCBCb29sZWFufSBwYXJhbXMudXNlcm5hbWUgLSBBIGNvbW1hLXNlcGFyYXRlZCBsaXN0IG9mIHVzZXJuYW1lc1xuICAgICAqL1xuICAgIHNoaWVsZC5nZXRVc2VyID0gY2Eoe1xuICAgICAgcGFyYW1zOiB7fSxcbiAgICAgIHVybHM6IFtcbiAgICAgICAge1xuICAgICAgICAgIGZtdDogJy9feHBhY2svc2VjdXJpdHkvdXNlci88JT11c2VybmFtZSU+JyxcbiAgICAgICAgICByZXE6IHtcbiAgICAgICAgICAgIHVzZXJuYW1lOiB7XG4gICAgICAgICAgICAgIHR5cGU6ICdsaXN0JyxcbiAgICAgICAgICAgICAgcmVxdWlyZWQ6IGZhbHNlXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgZm10OiAnL194cGFjay9zZWN1cml0eS91c2VyJ1xuICAgICAgICB9XG4gICAgICBdXG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBQZXJmb3JtIGEgW3NoaWVsZC5wdXRSb2xlXShVcGRhdGUgb3IgY3JlYXRlIGEgcm9sZSBmb3IgdGhlIG5hdGl2ZSBzaGllbGQgcmVhbG0pIHJlcXVlc3RcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBwYXJhbXMgLSBBbiBvYmplY3Qgd2l0aCBwYXJhbWV0ZXJzIHVzZWQgdG8gY2Fycnkgb3V0IHRoaXMgYWN0aW9uXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBwYXJhbXMucmVmcmVzaCAtIFJlZnJlc2ggdGhlIGluZGV4IGFmdGVyIHBlcmZvcm1pbmcgdGhlIG9wZXJhdGlvblxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBwYXJhbXMubmFtZSAtIFJvbGUgbmFtZVxuICAgICAqL1xuICAgIHNoaWVsZC5wdXRSb2xlID0gY2Eoe1xuICAgICAgcGFyYW1zOiB7XG4gICAgICAgIHJlZnJlc2g6IHtcbiAgICAgICAgICB0eXBlOiAnYm9vbGVhbidcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHVybDoge1xuICAgICAgICBmbXQ6ICcvX3hwYWNrL3NlY3VyaXR5L3JvbGUvPCU9bmFtZSU+JyxcbiAgICAgICAgcmVxOiB7XG4gICAgICAgICAgbmFtZToge1xuICAgICAgICAgICAgdHlwZTogJ3N0cmluZycsXG4gICAgICAgICAgICByZXF1aXJlZDogdHJ1ZVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIG5lZWRCb2R5OiB0cnVlLFxuICAgICAgbWV0aG9kOiAnUFVUJ1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUGVyZm9ybSBhIFtzaGllbGQucHV0VXNlcl0oVXBkYXRlIG9yIGNyZWF0ZSBhIHVzZXIgZm9yIHRoZSBuYXRpdmUgc2hpZWxkIHJlYWxtKSByZXF1ZXN0XG4gICAgICpcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gcGFyYW1zIC0gQW4gb2JqZWN0IHdpdGggcGFyYW1ldGVycyB1c2VkIHRvIGNhcnJ5IG91dCB0aGlzIGFjdGlvblxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gcGFyYW1zLnJlZnJlc2ggLSBSZWZyZXNoIHRoZSBpbmRleCBhZnRlciBwZXJmb3JtaW5nIHRoZSBvcGVyYXRpb25cbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gcGFyYW1zLnVzZXJuYW1lIC0gVGhlIHVzZXJuYW1lIG9mIHRoZSBVc2VyXG4gICAgICovXG4gICAgc2hpZWxkLnB1dFVzZXIgPSBjYSh7XG4gICAgICBwYXJhbXM6IHtcbiAgICAgICAgcmVmcmVzaDoge1xuICAgICAgICAgIHR5cGU6ICdib29sZWFuJ1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgdXJsOiB7XG4gICAgICAgIGZtdDogJy9feHBhY2svc2VjdXJpdHkvdXNlci88JT11c2VybmFtZSU+JyxcbiAgICAgICAgcmVxOiB7XG4gICAgICAgICAgdXNlcm5hbWU6IHtcbiAgICAgICAgICAgIHR5cGU6ICdzdHJpbmcnLFxuICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWVcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBuZWVkQm9keTogdHJ1ZSxcbiAgICAgIG1ldGhvZDogJ1BVVCdcbiAgICB9KTtcblxuICB9O1xufSkpO1xuIl19",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/elasticsearch-shield-js/elasticsearch-shield.js"
      ],
      "names": [],
      "mappings": ";;AAAA,AAAC,CAAA,UAAU,IAAI,EAAE,OAAO,EAAE;AACxB,MAAI,OAAO,MAAM,KAAK,UAAU,IAAI,MAAM,CAAC,GAAG,EAAE;AAC9C,UAAM,CAAC,EAAE,EAAE,OAAO,CAAC,CAAC;GACrB,MAAM,IAAI,OAAO,OAAO,KAAK,QAAQ,EAAE;AACtC,UAAM,CAAC,OAAO,GAAG,OAAO,EAAE,CAAC;GAC5B,MAAM;AACL,QAAI,CAAC,mBAAmB,GAAG,OAAO,EAAE,CAAC;GACtC;CACF,CAAA,YAAO,YAAY;AAClB,SAAO,SAAS,YAAY,CAAC,MAAM,EAAE,MAAM,EAAE,UAAU,EAAE;AACvD,QAAM,EAAE,GAAG,UAAU,CAAC,YAAY,CAAC,OAAO,CAAC;;AAE3C,UAAM,CAAC,SAAS,CAAC,MAAM,GAAG,UAAU,CAAC,YAAY,CAAC,gBAAgB,EAAE,CAAC;AACrE,QAAM,MAAM,GAAG,MAAM,CAAC,SAAS,CAAC,MAAM,CAAC,SAAS,CAAC;;;;;;;AAOjD,UAAM,CAAC,YAAY,GAAG,EAAE,CAAC;AACvB,YAAM,EAAE,EAAE;AACV,SAAG,EAAE;AACH,WAAG,EAAE,gCAAgC;OACtC;KACF,CAAC,CAAC;;;;;;;;;AASH,UAAM,CAAC,cAAc,GAAG,EAAE,CAAC;AACzB,YAAM,EAAE;AACN,eAAO,EAAE;AACP,cAAI,EAAE,SAAS;SAChB;OACF;AACD,UAAI,EAAE,CACJ;AACE,WAAG,EAAE,+CAA+C;AACpD,WAAG,EAAE;AACH,kBAAQ,EAAE;AACR,gBAAI,EAAE,QAAQ;AACd,oBAAQ,EAAE,KAAK;WAChB;SACF;OACF,EACD;AACE,WAAG,EAAE,iCAAiC;OACvC,CACF;AACD,cAAQ,EAAE,IAAI;AACd,YAAM,EAAE,MAAM;KACf,CAAC,CAAC;;;;;;;;;AASH,UAAM,CAAC,iBAAiB,GAAG,EAAE,CAAC;AAC5B,YAAM,EAAE;AACN,iBAAS,EAAE;AACT,cAAI,EAAE,QAAQ;AACd,kBAAQ,EAAE,KAAK;SAChB;OACF;AACD,SAAG,EAAE;AACH,WAAG,EAAE,iDAAiD;AACtD,WAAG,EAAE;AACH,gBAAM,EAAE;AACN,gBAAI,EAAE,QAAQ;AACd,oBAAQ,EAAE,IAAI;WACf;SACF;OACF;AACD,YAAM,EAAE,MAAM;KACf,CAAC,CAAC;;;;;;;;AAQH,UAAM,CAAC,gBAAgB,GAAG,EAAE,CAAC;AAC3B,YAAM,EAAE,EAAE;AACV,SAAG,EAAE;AACH,WAAG,EAAE,8CAA8C;AACnD,WAAG,EAAE;AACH,cAAI,EAAE;AACJ,gBAAI,EAAE,QAAQ;AACd,oBAAQ,EAAE,IAAI;WACf;SACF;OACF;AACD,YAAM,EAAE,MAAM;KACf,CAAC,CAAC;;;;;;;;;AASH,UAAM,CAAC,UAAU,GAAG,EAAE,CAAC;AACrB,YAAM,EAAE;AACN,eAAO,EAAE;AACP,cAAI,EAAE,SAAS;SAChB;OACF;AACD,SAAG,EAAE;AACH,WAAG,EAAE,iCAAiC;AACtC,WAAG,EAAE;AACH,cAAI,EAAE;AACJ,gBAAI,EAAE,QAAQ;AACd,oBAAQ,EAAE,IAAI;WACf;SACF;OACF;AACD,YAAM,EAAE,QAAQ;KACjB,CAAC,CAAC;;;;;;;;;AASH,UAAM,CAAC,UAAU,GAAG,EAAE,CAAC;AACrB,YAAM,EAAE;AACN,eAAO,EAAE;AACP,cAAI,EAAE,SAAS;SAChB;OACF;AACD,SAAG,EAAE;AACH,WAAG,EAAE,qCAAqC;AAC1C,WAAG,EAAE;AACH,kBAAQ,EAAE;AACR,gBAAI,EAAE,QAAQ;AACd,oBAAQ,EAAE,IAAI;WACf;SACF;OACF;AACD,YAAM,EAAE,QAAQ;KACjB,CAAC,CAAC;;;;;;;;AAQH,UAAM,CAAC,OAAO,GAAG,EAAE,CAAC;AAClB,YAAM,EAAE,EAAE;AACV,UAAI,EAAE,CACJ;AACE,WAAG,EAAE,iCAAiC;AACtC,WAAG,EAAE;AACH,cAAI,EAAE;AACJ,gBAAI,EAAE,QAAQ;AACd,oBAAQ,EAAE,KAAK;WAChB;SACF;OACF,EACD;AACE,WAAG,EAAE,uBAAuB;OAC7B,CACF;KACF,CAAC,CAAC;;;;;;;;AAQH,UAAM,CAAC,OAAO,GAAG,EAAE,CAAC;AAClB,YAAM,EAAE,EAAE;AACV,UAAI,EAAE,CACJ;AACE,WAAG,EAAE,qCAAqC;AAC1C,WAAG,EAAE;AACH,kBAAQ,EAAE;AACR,gBAAI,EAAE,MAAM;AACZ,oBAAQ,EAAE,KAAK;WAChB;SACF;OACF,EACD;AACE,WAAG,EAAE,uBAAuB;OAC7B,CACF;KACF,CAAC,CAAC;;;;;;;;;AASH,UAAM,CAAC,OAAO,GAAG,EAAE,CAAC;AAClB,YAAM,EAAE;AACN,eAAO,EAAE;AACP,cAAI,EAAE,SAAS;SAChB;OACF;AACD,SAAG,EAAE;AACH,WAAG,EAAE,iCAAiC;AACtC,WAAG,EAAE;AACH,cAAI,EAAE;AACJ,gBAAI,EAAE,QAAQ;AACd,oBAAQ,EAAE,IAAI;WACf;SACF;OACF;AACD,cAAQ,EAAE,IAAI;AACd,YAAM,EAAE,KAAK;KACd,CAAC,CAAC;;;;;;;;;AASH,UAAM,CAAC,OAAO,GAAG,EAAE,CAAC;AAClB,YAAM,EAAE;AACN,eAAO,EAAE;AACP,cAAI,EAAE,SAAS;SAChB;OACF;AACD,SAAG,EAAE;AACH,WAAG,EAAE,qCAAqC;AAC1C,WAAG,EAAE;AACH,kBAAQ,EAAE;AACR,gBAAI,EAAE,QAAQ;AACd,oBAAQ,EAAE,IAAI;WACf;SACF;OACF;AACD,cAAQ,EAAE,IAAI;AACd,YAAM,EAAE,KAAK;KACd,CAAC,CAAC;GAEJ,CAAC;CACH,CAAC,CAAE",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/elasticsearch-shield-js/elasticsearch-shield.js",
      "sourcesContent": [
        "(function (root, factory) {\n  if (typeof define === 'function' && define.amd) {\n    define([], factory);\n  } else if (typeof exports === 'object') {\n    module.exports = factory();\n  } else {\n    root.ElasticsearchShield = factory();\n  }\n}(this, function () {\n  return function addShieldApi(Client, config, components) {\n    const ca = components.clientAction.factory;\n\n    Client.prototype.shield = components.clientAction.namespaceFactory();\n    const shield = Client.prototype.shield.prototype;\n\n    /**\n     * Perform a [shield.authenticate](Retrieve details about the currently authenticated user) request\n     *\n     * @param {Object} params - An object with parameters used to carry out this action\n     */\n    shield.authenticate = ca({\n      params: {},\n      url: {\n        fmt: '/_xpack/security/_authenticate'\n      }\n    });\n\n    /**\n     * Perform a [shield.changePassword](Change the password of a user) request\n     *\n     * @param {Object} params - An object with parameters used to carry out this action\n     * @param {Boolean} params.refresh - Refresh the index after performing the operation\n     * @param {String} params.username - The username of the user to change the password for\n     */\n    shield.changePassword = ca({\n      params: {\n        refresh: {\n          type: 'boolean'\n        }\n      },\n      urls: [\n        {\n          fmt: '/_xpack/security/user/<%=username%>/_password',\n          req: {\n            username: {\n              type: 'string',\n              required: false\n            }\n          }\n        },\n        {\n          fmt: '/_xpack/security/user/_password'\n        }\n      ],\n      needBody: true,\n      method: 'POST'\n    });\n\n    /**\n     * Perform a [shield.clearCachedRealms](Clears the internal user caches for specified realms) request\n     *\n     * @param {Object} params - An object with parameters used to carry out this action\n     * @param {String} params.usernames - Comma-separated list of usernames to clear from the cache\n     * @param {String} params.realms - Comma-separated list of realms to clear\n     */\n    shield.clearCachedRealms = ca({\n      params: {\n        usernames: {\n          type: 'string',\n          required: false\n        }\n      },\n      url: {\n        fmt: '/_xpack/security/realm/<%=realms%>/_clear_cache',\n        req: {\n          realms: {\n            type: 'string',\n            required: true\n          }\n        }\n      },\n      method: 'POST'\n    });\n\n    /**\n     * Perform a [shield.clearCachedRoles](Clears the internal caches for specified roles) request\n     *\n     * @param {Object} params - An object with parameters used to carry out this action\n     * @param {String} params.name - Role name\n     */\n    shield.clearCachedRoles = ca({\n      params: {},\n      url: {\n        fmt: '/_xpack/security/role/<%=name%>/_clear_cache',\n        req: {\n          name: {\n            type: 'string',\n            required: true\n          }\n        }\n      },\n      method: 'POST'\n    });\n\n    /**\n     * Perform a [shield.deleteRole](Remove a role from the native shield realm) request\n     *\n     * @param {Object} params - An object with parameters used to carry out this action\n     * @param {Boolean} params.refresh - Refresh the index after performing the operation\n     * @param {String} params.name - Role name\n     */\n    shield.deleteRole = ca({\n      params: {\n        refresh: {\n          type: 'boolean'\n        }\n      },\n      url: {\n        fmt: '/_xpack/security/role/<%=name%>',\n        req: {\n          name: {\n            type: 'string',\n            required: true\n          }\n        }\n      },\n      method: 'DELETE'\n    });\n\n    /**\n     * Perform a [shield.deleteUser](Remove a user from the native shield realm) request\n     *\n     * @param {Object} params - An object with parameters used to carry out this action\n     * @param {Boolean} params.refresh - Refresh the index after performing the operation\n     * @param {String} params.username - username\n     */\n    shield.deleteUser = ca({\n      params: {\n        refresh: {\n          type: 'boolean'\n        }\n      },\n      url: {\n        fmt: '/_xpack/security/user/<%=username%>',\n        req: {\n          username: {\n            type: 'string',\n            required: true\n          }\n        }\n      },\n      method: 'DELETE'\n    });\n\n    /**\n     * Perform a [shield.getRole](Retrieve one or more roles from the native shield realm) request\n     *\n     * @param {Object} params - An object with parameters used to carry out this action\n     * @param {String} params.name - Role name\n     */\n    shield.getRole = ca({\n      params: {},\n      urls: [\n        {\n          fmt: '/_xpack/security/role/<%=name%>',\n          req: {\n            name: {\n              type: 'string',\n              required: false\n            }\n          }\n        },\n        {\n          fmt: '/_xpack/security/role'\n        }\n      ]\n    });\n\n    /**\n     * Perform a [shield.getUser](Retrieve one or more users from the native shield realm) request\n     *\n     * @param {Object} params - An object with parameters used to carry out this action\n     * @param {String, String[], Boolean} params.username - A comma-separated list of usernames\n     */\n    shield.getUser = ca({\n      params: {},\n      urls: [\n        {\n          fmt: '/_xpack/security/user/<%=username%>',\n          req: {\n            username: {\n              type: 'list',\n              required: false\n            }\n          }\n        },\n        {\n          fmt: '/_xpack/security/user'\n        }\n      ]\n    });\n\n    /**\n     * Perform a [shield.putRole](Update or create a role for the native shield realm) request\n     *\n     * @param {Object} params - An object with parameters used to carry out this action\n     * @param {Boolean} params.refresh - Refresh the index after performing the operation\n     * @param {String} params.name - Role name\n     */\n    shield.putRole = ca({\n      params: {\n        refresh: {\n          type: 'boolean'\n        }\n      },\n      url: {\n        fmt: '/_xpack/security/role/<%=name%>',\n        req: {\n          name: {\n            type: 'string',\n            required: true\n          }\n        }\n      },\n      needBody: true,\n      method: 'PUT'\n    });\n\n    /**\n     * Perform a [shield.putUser](Update or create a user for the native shield realm) request\n     *\n     * @param {Object} params - An object with parameters used to carry out this action\n     * @param {Boolean} params.refresh - Refresh the index after performing the operation\n     * @param {String} params.username - The username of the User\n     */\n    shield.putUser = ca({\n      params: {\n        refresh: {\n          type: 'boolean'\n        }\n      },\n      url: {\n        fmt: '/_xpack/security/user/<%=username%>',\n        req: {\n          username: {\n            type: 'string',\n            required: true\n          }\n        }\n      },\n      needBody: true,\n      method: 'PUT'\n    });\n\n  };\n}));\n"
      ]
    },
    "mtime": 1491771513550
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/is_authenticated.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [],
        "exports": {
          "exported": [
            "isAuthenticatedProvider",
            "server"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "isAuthenticatedProvider",
              "exported": "default"
            },
            {
              "kind": "local",
              "local": "server",
              "exported": "default"
            }
          ]
        }
      },
      "usedHelpers": []
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nexports['default'] = isAuthenticatedProvider;\n\nfunction isAuthenticatedProvider(server) {\n  var _this = this;\n\n  server.expose('isAuthenticated', function callee$1$0(request) {\n    return regeneratorRuntime.async(function callee$1$0$(context$2$0) {\n      while (1) switch (context$2$0.prev = context$2$0.next) {\n        case 0:\n          context$2$0.prev = 0;\n          context$2$0.next = 3;\n          return regeneratorRuntime.awrap(server.plugins.security.getUser(request));\n\n        case 3:\n          return context$2$0.abrupt('return', true);\n\n        case 6:\n          context$2$0.prev = 6;\n          context$2$0.t0 = context$2$0['catch'](0);\n\n          if (!(!context$2$0.t0.isBoom || context$2$0.t0.output.statusCode !== 401)) {\n            context$2$0.next = 10;\n            break;\n          }\n\n          throw context$2$0.t0;\n\n        case 10:\n          return context$2$0.abrupt('return', false);\n\n        case 11:\n        case 'end':\n          return context$2$0.stop();\n      }\n    }, null, _this, [[0, 6]]);\n  });\n}\n\nmodule.exports = exports['default'];\n\n// ensure that the user is authenticated\n\n// don't swallow server errors\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvc2VjdXJpdHkvc2VydmVyL2xpYi9pc19hdXRoZW50aWNhdGVkLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O3FCQUF3Qix1QkFBdUI7O0FBQWhDLFNBQVMsdUJBQXVCLENBQUMsTUFBTSxFQUFFOzs7QUFDdEQsUUFBTSxDQUFDLE1BQU0sQ0FBQyxpQkFBaUIsRUFBRSxvQkFBTyxPQUFPOzs7Ozs7MENBR3JDLE1BQU0sQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUM7Ozs4Q0FDdkMsSUFBSTs7Ozs7O2dCQUVQLENBQUMsZUFBSSxNQUFNLElBQUksZUFBSSxNQUFNLENBQUMsVUFBVSxLQUFLLEdBQUcsQ0FBQTs7Ozs7Ozs7OENBTTNDLEtBQUs7Ozs7Ozs7R0FDYixDQUFDLENBQUM7Q0FDSiIsImZpbGUiOiIvdXNyL3NoYXJlL2tpYmFuYS9wbHVnaW5zL3gtcGFjay9wbHVnaW5zL3NlY3VyaXR5L3NlcnZlci9saWIvaXNfYXV0aGVudGljYXRlZC5qcyIsInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGlzQXV0aGVudGljYXRlZFByb3ZpZGVyKHNlcnZlcikge1xuICBzZXJ2ZXIuZXhwb3NlKCdpc0F1dGhlbnRpY2F0ZWQnLCBhc3luYyAocmVxdWVzdCkgPT4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBlbnN1cmUgdGhhdCB0aGUgdXNlciBpcyBhdXRoZW50aWNhdGVkXG4gICAgICBhd2FpdCBzZXJ2ZXIucGx1Z2lucy5zZWN1cml0eS5nZXRVc2VyKHJlcXVlc3QpO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBpZiAoIWVyci5pc0Jvb20gfHwgZXJyLm91dHB1dC5zdGF0dXNDb2RlICE9PSA0MDEpIHtcbiAgICAgICAgLy8gZG9uJ3Qgc3dhbGxvdyBzZXJ2ZXIgZXJyb3JzXG4gICAgICAgIHRocm93IGVycjtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gZmFsc2U7XG4gIH0pO1xufVxuIl19",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/is_authenticated.js"
      ],
      "names": [],
      "mappings": ";;;;;qBAAwB,uBAAuB;;AAAhC,SAAS,uBAAuB,CAAC,MAAM,EAAE;;;AACtD,QAAM,CAAC,MAAM,CAAC,iBAAiB,EAAE,oBAAO,OAAO;;;;;;0CAGrC,MAAM,CAAC,OAAO,CAAC,QAAQ,CAAC,OAAO,CAAC,OAAO,CAAC;;;8CACvC,IAAI;;;;;;gBAEP,CAAC,eAAI,MAAM,IAAI,eAAI,MAAM,CAAC,UAAU,KAAK,GAAG,CAAA;;;;;;;;8CAM3C,KAAK;;;;;;;GACb,CAAC,CAAC;CACJ",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/is_authenticated.js",
      "sourcesContent": [
        "export default function isAuthenticatedProvider(server) {\n  server.expose('isAuthenticated', async (request) => {\n    try {\n      // ensure that the user is authenticated\n      await server.plugins.security.getUser(request);\n      return true;\n    } catch (err) {\n      if (!err.isBoom || err.output.statusCode !== 401) {\n        // don't swallow server errors\n        throw err;\n      }\n    }\n\n    return false;\n  });\n}\n"
      ]
    },
    "mtime": 1491771510468
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/security/server/routes/api/v1/authenticate.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "lodash",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "_"
              }
            ]
          },
          {
            "source": "boom",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "Boom"
              }
            ]
          },
          {
            "source": "joi",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "Joi"
              }
            ]
          },
          {
            "source": "../../../lib/get_is_valid_user",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "getIsValidUser"
              }
            ]
          },
          {
            "source": "../../../lib/get_calculate_expires",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "getCalculateExpires"
              }
            ]
          },
          {
            "source": "../../../lib/errors",
            "imported": [
              "wrapError"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "wrapError",
                "local": "wrapError"
              }
            ]
          }
        ],
        "exports": {
          "exported": [],
          "specifiers": []
        }
      },
      "usedHelpers": [
        "interop-require-default"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _lodash = require('lodash');\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _boom = require('boom');\n\nvar _boom2 = _interopRequireDefault(_boom);\n\nvar _joi = require('joi');\n\nvar _joi2 = _interopRequireDefault(_joi);\n\nvar _libGet_is_valid_user = require('../../../lib/get_is_valid_user');\n\nvar _libGet_is_valid_user2 = _interopRequireDefault(_libGet_is_valid_user);\n\nvar _libGet_calculate_expires = require('../../../lib/get_calculate_expires');\n\nvar _libGet_calculate_expires2 = _interopRequireDefault(_libGet_calculate_expires);\n\nvar _libErrors = require('../../../lib/errors');\n\nexports['default'] = function (server) {\n  var isValidUser = (0, _libGet_is_valid_user2['default'])(server);\n  var calculateExpires = (0, _libGet_calculate_expires2['default'])(server);\n\n  server.route({\n    method: 'POST',\n    path: '/api/security/v1/login',\n    handler: function handler(request, reply) {\n      var _request$payload = request.payload;\n      var username = _request$payload.username;\n      var password = _request$payload.password;\n\n      return isValidUser(request, username, password).then(function (response) {\n        // Initialize the session\n        request.cookieAuth.set({\n          username: username,\n          password: password,\n          expires: calculateExpires()\n        });\n\n        return reply(response);\n      }, function (error) {\n        request.cookieAuth.clear();\n        return reply(_boom2['default'].unauthorized(error));\n      });\n    },\n    config: {\n      auth: false,\n      validate: {\n        payload: {\n          username: _joi2['default'].string().required(),\n          password: _joi2['default'].string().required()\n        }\n      }\n    }\n  });\n\n  server.route({\n    method: 'POST',\n    path: '/api/security/v1/logout',\n    handler: function handler(request, reply) {\n      request.cookieAuth.clear();\n      return reply().code(204);\n    },\n    config: {\n      auth: false\n    }\n  });\n\n  server.route({\n    method: 'GET',\n    path: '/api/security/v1/me',\n    handler: function handler(request, reply) {\n      server.plugins.security.getUser(request).then(reply, _lodash2['default'].flow(_libErrors.wrapError, reply));\n    }\n  });\n};\n\nmodule.exports = exports['default'];\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvc2VjdXJpdHkvc2VydmVyL3JvdXRlcy9hcGkvdjEvYXV0aGVudGljYXRlLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7O3NCQUFjLFFBQVE7Ozs7b0JBQ0wsTUFBTTs7OzttQkFDUCxLQUFLOzs7O29DQUNNLGdDQUFnQzs7Ozt3Q0FDM0Isb0NBQW9DOzs7O3lCQUMxQyxxQkFBcUI7O3FCQUVoQyxVQUFDLE1BQU0sRUFBSztBQUN6QixNQUFNLFdBQVcsR0FBRyx1Q0FBZSxNQUFNLENBQUMsQ0FBQztBQUMzQyxNQUFNLGdCQUFnQixHQUFHLDJDQUFvQixNQUFNLENBQUMsQ0FBQzs7QUFFckQsUUFBTSxDQUFDLEtBQUssQ0FBQztBQUNYLFVBQU0sRUFBRSxNQUFNO0FBQ2QsUUFBSSxFQUFFLHdCQUF3QjtBQUM5QixXQUFPLEVBQUEsaUJBQUMsT0FBTyxFQUFFLEtBQUssRUFBRTs2QkFDTyxPQUFPLENBQUMsT0FBTztVQUFyQyxRQUFRLG9CQUFSLFFBQVE7VUFBRSxRQUFRLG9CQUFSLFFBQVE7O0FBQ3pCLGFBQU8sV0FBVyxDQUFDLE9BQU8sRUFBRSxRQUFRLEVBQUUsUUFBUSxDQUFDLENBQUMsSUFBSSxDQUFDLFVBQUMsUUFBUSxFQUFLOztBQUVqRSxlQUFPLENBQUMsVUFBVSxDQUFDLEdBQUcsQ0FBQztBQUNyQixrQkFBUSxFQUFSLFFBQVE7QUFDUixrQkFBUSxFQUFSLFFBQVE7QUFDUixpQkFBTyxFQUFFLGdCQUFnQixFQUFFO1NBQzVCLENBQUMsQ0FBQzs7QUFFSCxlQUFPLEtBQUssQ0FBQyxRQUFRLENBQUMsQ0FBQztPQUN4QixFQUFFLFVBQUMsS0FBSyxFQUFLO0FBQ1osZUFBTyxDQUFDLFVBQVUsQ0FBQyxLQUFLLEVBQUUsQ0FBQztBQUMzQixlQUFPLEtBQUssQ0FBQyxrQkFBSyxZQUFZLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQztPQUN4QyxDQUFDLENBQUM7S0FDSjtBQUNELFVBQU0sRUFBRTtBQUNOLFVBQUksRUFBRSxLQUFLO0FBQ1gsY0FBUSxFQUFFO0FBQ1IsZUFBTyxFQUFFO0FBQ1Asa0JBQVEsRUFBRSxpQkFBSSxNQUFNLEVBQUUsQ0FBQyxRQUFRLEVBQUU7QUFDakMsa0JBQVEsRUFBRSxpQkFBSSxNQUFNLEVBQUUsQ0FBQyxRQUFRLEVBQUU7U0FDbEM7T0FDRjtLQUNGO0dBQ0YsQ0FBQyxDQUFDOztBQUVILFFBQU0sQ0FBQyxLQUFLLENBQUM7QUFDWCxVQUFNLEVBQUUsTUFBTTtBQUNkLFFBQUksRUFBRSx5QkFBeUI7QUFDL0IsV0FBTyxFQUFBLGlCQUFDLE9BQU8sRUFBRSxLQUFLLEVBQUU7QUFDdEIsYUFBTyxDQUFDLFVBQVUsQ0FBQyxLQUFLLEVBQUUsQ0FBQztBQUMzQixhQUFPLEtBQUssRUFBRSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQztLQUMxQjtBQUNELFVBQU0sRUFBRTtBQUNOLFVBQUksRUFBRSxLQUFLO0tBQ1o7R0FDRixDQUFDLENBQUM7O0FBRUgsUUFBTSxDQUFDLEtBQUssQ0FBQztBQUNYLFVBQU0sRUFBRSxLQUFLO0FBQ2IsUUFBSSxFQUFFLHFCQUFxQjtBQUMzQixXQUFPLEVBQUEsaUJBQUMsT0FBTyxFQUFFLEtBQUssRUFBRTtBQUN0QixZQUFNLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssRUFBRSxvQkFBRSxJQUFJLHVCQUFZLEtBQUssQ0FBQyxDQUFDLENBQUM7S0FDaEY7R0FDRixDQUFDLENBQUM7Q0FDSiIsImZpbGUiOiIvdXNyL3NoYXJlL2tpYmFuYS9wbHVnaW5zL3gtcGFjay9wbHVnaW5zL3NlY3VyaXR5L3NlcnZlci9yb3V0ZXMvYXBpL3YxL2F1dGhlbnRpY2F0ZS5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBfIGZyb20gJ2xvZGFzaCc7XG5pbXBvcnQgQm9vbSBmcm9tICdib29tJztcbmltcG9ydCBKb2kgZnJvbSAnam9pJztcbmltcG9ydCBnZXRJc1ZhbGlkVXNlciBmcm9tICcuLi8uLi8uLi9saWIvZ2V0X2lzX3ZhbGlkX3VzZXInO1xuaW1wb3J0IGdldENhbGN1bGF0ZUV4cGlyZXMgZnJvbSAnLi4vLi4vLi4vbGliL2dldF9jYWxjdWxhdGVfZXhwaXJlcyc7XG5pbXBvcnQgeyB3cmFwRXJyb3IgfSBmcm9tICcuLi8uLi8uLi9saWIvZXJyb3JzJztcblxuZXhwb3J0IGRlZmF1bHQgKHNlcnZlcikgPT4ge1xuICBjb25zdCBpc1ZhbGlkVXNlciA9IGdldElzVmFsaWRVc2VyKHNlcnZlcik7XG4gIGNvbnN0IGNhbGN1bGF0ZUV4cGlyZXMgPSBnZXRDYWxjdWxhdGVFeHBpcmVzKHNlcnZlcik7XG5cbiAgc2VydmVyLnJvdXRlKHtcbiAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICBwYXRoOiAnL2FwaS9zZWN1cml0eS92MS9sb2dpbicsXG4gICAgaGFuZGxlcihyZXF1ZXN0LCByZXBseSkge1xuICAgICAgY29uc3Qge3VzZXJuYW1lLCBwYXNzd29yZH0gPSByZXF1ZXN0LnBheWxvYWQ7XG4gICAgICByZXR1cm4gaXNWYWxpZFVzZXIocmVxdWVzdCwgdXNlcm5hbWUsIHBhc3N3b3JkKS50aGVuKChyZXNwb25zZSkgPT4ge1xuICAgICAgICAvLyBJbml0aWFsaXplIHRoZSBzZXNzaW9uXG4gICAgICAgIHJlcXVlc3QuY29va2llQXV0aC5zZXQoe1xuICAgICAgICAgIHVzZXJuYW1lLFxuICAgICAgICAgIHBhc3N3b3JkLFxuICAgICAgICAgIGV4cGlyZXM6IGNhbGN1bGF0ZUV4cGlyZXMoKVxuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gcmVwbHkocmVzcG9uc2UpO1xuICAgICAgfSwgKGVycm9yKSA9PiB7XG4gICAgICAgIHJlcXVlc3QuY29va2llQXV0aC5jbGVhcigpO1xuICAgICAgICByZXR1cm4gcmVwbHkoQm9vbS51bmF1dGhvcml6ZWQoZXJyb3IpKTtcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgY29uZmlnOiB7XG4gICAgICBhdXRoOiBmYWxzZSxcbiAgICAgIHZhbGlkYXRlOiB7XG4gICAgICAgIHBheWxvYWQ6IHtcbiAgICAgICAgICB1c2VybmFtZTogSm9pLnN0cmluZygpLnJlcXVpcmVkKCksXG4gICAgICAgICAgcGFzc3dvcmQ6IEpvaS5zdHJpbmcoKS5yZXF1aXJlZCgpXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuXG4gIHNlcnZlci5yb3V0ZSh7XG4gICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgcGF0aDogJy9hcGkvc2VjdXJpdHkvdjEvbG9nb3V0JyxcbiAgICBoYW5kbGVyKHJlcXVlc3QsIHJlcGx5KSB7XG4gICAgICByZXF1ZXN0LmNvb2tpZUF1dGguY2xlYXIoKTtcbiAgICAgIHJldHVybiByZXBseSgpLmNvZGUoMjA0KTtcbiAgICB9LFxuICAgIGNvbmZpZzoge1xuICAgICAgYXV0aDogZmFsc2UsXG4gICAgfVxuICB9KTtcblxuICBzZXJ2ZXIucm91dGUoe1xuICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgcGF0aDogJy9hcGkvc2VjdXJpdHkvdjEvbWUnLFxuICAgIGhhbmRsZXIocmVxdWVzdCwgcmVwbHkpIHtcbiAgICAgIHNlcnZlci5wbHVnaW5zLnNlY3VyaXR5LmdldFVzZXIocmVxdWVzdCkudGhlbihyZXBseSwgXy5mbG93KHdyYXBFcnJvciwgcmVwbHkpKTtcbiAgICB9XG4gIH0pO1xufTtcbiJdfQ==",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/security/server/routes/api/v1/authenticate.js"
      ],
      "names": [],
      "mappings": ";;;;;;;;sBAAc,QAAQ;;;;oBACL,MAAM;;;;mBACP,KAAK;;;;oCACM,gCAAgC;;;;wCAC3B,oCAAoC;;;;yBAC1C,qBAAqB;;qBAEhC,UAAC,MAAM,EAAK;AACzB,MAAM,WAAW,GAAG,uCAAe,MAAM,CAAC,CAAC;AAC3C,MAAM,gBAAgB,GAAG,2CAAoB,MAAM,CAAC,CAAC;;AAErD,QAAM,CAAC,KAAK,CAAC;AACX,UAAM,EAAE,MAAM;AACd,QAAI,EAAE,wBAAwB;AAC9B,WAAO,EAAA,iBAAC,OAAO,EAAE,KAAK,EAAE;6BACO,OAAO,CAAC,OAAO;UAArC,QAAQ,oBAAR,QAAQ;UAAE,QAAQ,oBAAR,QAAQ;;AACzB,aAAO,WAAW,CAAC,OAAO,EAAE,QAAQ,EAAE,QAAQ,CAAC,CAAC,IAAI,CAAC,UAAC,QAAQ,EAAK;;AAEjE,eAAO,CAAC,UAAU,CAAC,GAAG,CAAC;AACrB,kBAAQ,EAAR,QAAQ;AACR,kBAAQ,EAAR,QAAQ;AACR,iBAAO,EAAE,gBAAgB,EAAE;SAC5B,CAAC,CAAC;;AAEH,eAAO,KAAK,CAAC,QAAQ,CAAC,CAAC;OACxB,EAAE,UAAC,KAAK,EAAK;AACZ,eAAO,CAAC,UAAU,CAAC,KAAK,EAAE,CAAC;AAC3B,eAAO,KAAK,CAAC,kBAAK,YAAY,CAAC,KAAK,CAAC,CAAC,CAAC;OACxC,CAAC,CAAC;KACJ;AACD,UAAM,EAAE;AACN,UAAI,EAAE,KAAK;AACX,cAAQ,EAAE;AACR,eAAO,EAAE;AACP,kBAAQ,EAAE,iBAAI,MAAM,EAAE,CAAC,QAAQ,EAAE;AACjC,kBAAQ,EAAE,iBAAI,MAAM,EAAE,CAAC,QAAQ,EAAE;SAClC;OACF;KACF;GACF,CAAC,CAAC;;AAEH,QAAM,CAAC,KAAK,CAAC;AACX,UAAM,EAAE,MAAM;AACd,QAAI,EAAE,yBAAyB;AAC/B,WAAO,EAAA,iBAAC,OAAO,EAAE,KAAK,EAAE;AACtB,aAAO,CAAC,UAAU,CAAC,KAAK,EAAE,CAAC;AAC3B,aAAO,KAAK,EAAE,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;KAC1B;AACD,UAAM,EAAE;AACN,UAAI,EAAE,KAAK;KACZ;GACF,CAAC,CAAC;;AAEH,QAAM,CAAC,KAAK,CAAC;AACX,UAAM,EAAE,KAAK;AACb,QAAI,EAAE,qBAAqB;AAC3B,WAAO,EAAA,iBAAC,OAAO,EAAE,KAAK,EAAE;AACtB,YAAM,CAAC,OAAO,CAAC,QAAQ,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,KAAK,EAAE,oBAAE,IAAI,uBAAY,KAAK,CAAC,CAAC,CAAC;KAChF;GACF,CAAC,CAAC;CACJ",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/security/server/routes/api/v1/authenticate.js",
      "sourcesContent": [
        "import _ from 'lodash';\nimport Boom from 'boom';\nimport Joi from 'joi';\nimport getIsValidUser from '../../../lib/get_is_valid_user';\nimport getCalculateExpires from '../../../lib/get_calculate_expires';\nimport { wrapError } from '../../../lib/errors';\n\nexport default (server) => {\n  const isValidUser = getIsValidUser(server);\n  const calculateExpires = getCalculateExpires(server);\n\n  server.route({\n    method: 'POST',\n    path: '/api/security/v1/login',\n    handler(request, reply) {\n      const {username, password} = request.payload;\n      return isValidUser(request, username, password).then((response) => {\n        // Initialize the session\n        request.cookieAuth.set({\n          username,\n          password,\n          expires: calculateExpires()\n        });\n\n        return reply(response);\n      }, (error) => {\n        request.cookieAuth.clear();\n        return reply(Boom.unauthorized(error));\n      });\n    },\n    config: {\n      auth: false,\n      validate: {\n        payload: {\n          username: Joi.string().required(),\n          password: Joi.string().required()\n        }\n      }\n    }\n  });\n\n  server.route({\n    method: 'POST',\n    path: '/api/security/v1/logout',\n    handler(request, reply) {\n      request.cookieAuth.clear();\n      return reply().code(204);\n    },\n    config: {\n      auth: false,\n    }\n  });\n\n  server.route({\n    method: 'GET',\n    path: '/api/security/v1/me',\n    handler(request, reply) {\n      server.plugins.security.getUser(request).then(reply, _.flow(wrapError, reply));\n    }\n  });\n};\n"
      ]
    },
    "mtime": 1491771515103
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/errors.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "boom",
            "imported": [
              "wrap"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "wrap",
                "local": "wrapBoom"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "wrapError",
            "error"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "wrapError",
              "exported": "wrapError"
            },
            {
              "kind": "local",
              "local": "error",
              "exported": "error"
            }
          ]
        }
      },
      "usedHelpers": []
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nexports.wrapError = wrapError;\n\nvar _boom = require('boom');\n\nfunction wrapError(error) {\n  return (0, _boom.wrap)(error, error.status);\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvc2VjdXJpdHkvc2VydmVyL2xpYi9lcnJvcnMuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7OztvQkFBaUMsTUFBTTs7QUFFaEMsU0FBUyxTQUFTLENBQUMsS0FBSyxFQUFFO0FBQy9CLFNBQU8sZ0JBQVMsS0FBSyxFQUFFLEtBQUssQ0FBQyxNQUFNLENBQUMsQ0FBQztDQUN0QyIsImZpbGUiOiIvdXNyL3NoYXJlL2tpYmFuYS9wbHVnaW5zL3gtcGFjay9wbHVnaW5zL3NlY3VyaXR5L3NlcnZlci9saWIvZXJyb3JzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgd3JhcCBhcyB3cmFwQm9vbSB9IGZyb20gJ2Jvb20nO1xuXG5leHBvcnQgZnVuY3Rpb24gd3JhcEVycm9yKGVycm9yKSB7XG4gIHJldHVybiB3cmFwQm9vbShlcnJvciwgZXJyb3Iuc3RhdHVzKTtcbn1cbiJdfQ==",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/errors.js"
      ],
      "names": [],
      "mappings": ";;;;;;;oBAAiC,MAAM;;AAEhC,SAAS,SAAS,CAAC,KAAK,EAAE;AAC/B,SAAO,gBAAS,KAAK,EAAE,KAAK,CAAC,MAAM,CAAC,CAAC;CACtC",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/errors.js",
      "sourcesContent": [
        "import { wrap as wrapBoom } from 'boom';\n\nexport function wrapError(error) {\n  return wrapBoom(error, error.status);\n}\n"
      ]
    },
    "mtime": 1491771510468
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/security/server/routes/api/v1/users.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "lodash",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "_"
              }
            ]
          },
          {
            "source": "boom",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "Boom"
              }
            ]
          },
          {
            "source": "joi",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "Joi"
              }
            ]
          },
          {
            "source": "../../../lib/get_client_shield",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "getClient"
              }
            ]
          },
          {
            "source": "../../../lib/user_schema",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "userSchema"
              }
            ]
          },
          {
            "source": "../../../lib/errors",
            "imported": [
              "wrapError"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "wrapError",
                "local": "wrapError"
              }
            ]
          },
          {
            "source": "../../../lib/get_calculate_expires",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "getCalculateExpires"
              }
            ]
          },
          {
            "source": "../../../lib/on_change_password",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "onChangePassword"
              }
            ]
          },
          {
            "source": "../../../lib/get_is_valid_user",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "getIsValidUser"
              }
            ]
          },
          {
            "source": "../../../lib/route_pre_check_license",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "routePreCheckLicense"
              }
            ]
          }
        ],
        "exports": {
          "exported": [],
          "specifiers": []
        }
      },
      "usedHelpers": [
        "interop-require-default"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _lodash = require('lodash');\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _boom = require('boom');\n\nvar _boom2 = _interopRequireDefault(_boom);\n\nvar _joi = require('joi');\n\nvar _joi2 = _interopRequireDefault(_joi);\n\nvar _libGet_client_shield = require('../../../lib/get_client_shield');\n\nvar _libGet_client_shield2 = _interopRequireDefault(_libGet_client_shield);\n\nvar _libUser_schema = require('../../../lib/user_schema');\n\nvar _libUser_schema2 = _interopRequireDefault(_libUser_schema);\n\nvar _libErrors = require('../../../lib/errors');\n\nvar _libGet_calculate_expires = require('../../../lib/get_calculate_expires');\n\nvar _libGet_calculate_expires2 = _interopRequireDefault(_libGet_calculate_expires);\n\nvar _libOn_change_password = require('../../../lib/on_change_password');\n\nvar _libOn_change_password2 = _interopRequireDefault(_libOn_change_password);\n\nvar _libGet_is_valid_user = require('../../../lib/get_is_valid_user');\n\nvar _libGet_is_valid_user2 = _interopRequireDefault(_libGet_is_valid_user);\n\nvar _libRoute_pre_check_license = require('../../../lib/route_pre_check_license');\n\nvar _libRoute_pre_check_license2 = _interopRequireDefault(_libRoute_pre_check_license);\n\nexports['default'] = function (server) {\n  var callWithRequest = (0, _libGet_client_shield2['default'])(server).callWithRequest;\n  var calculateExpires = (0, _libGet_calculate_expires2['default'])(server);\n  var isValidUser = (0, _libGet_is_valid_user2['default'])(server);\n  var routePreCheckLicenseFn = (0, _libRoute_pre_check_license2['default'])(server);\n\n  server.route({\n    method: 'GET',\n    path: '/api/security/v1/users',\n    handler: function handler(request, reply) {\n      return callWithRequest(request, 'shield.getUser').then(function (response) {\n        return reply(_lodash2['default'].values(response));\n      }, _lodash2['default'].flow(_libErrors.wrapError, reply));\n    },\n    config: {\n      pre: [routePreCheckLicenseFn]\n    }\n  });\n\n  server.route({\n    method: 'GET',\n    path: '/api/security/v1/users/{username}',\n    handler: function handler(request, reply) {\n      var username = request.params.username;\n      return callWithRequest(request, 'shield.getUser', { username: username }).then(function (response) {\n        if (response[username]) return reply(response[username]);\n        return reply(_boom2['default'].notFound());\n      }, _lodash2['default'].flow(_libErrors.wrapError, reply));\n    },\n    config: {\n      pre: [routePreCheckLicenseFn]\n    }\n  });\n\n  server.route({\n    method: 'POST',\n    path: '/api/security/v1/users/{username}',\n    handler: function handler(request, reply) {\n      var username = request.params.username;\n      var body = (0, _lodash2['default'])(request.payload).omit(['username', 'enabled']).omit(_lodash2['default'].isNull);\n      return callWithRequest(request, 'shield.putUser', { username: username, body: body }).then(function () {\n        return reply(request.payload);\n      }, _lodash2['default'].flow(_libErrors.wrapError, reply));\n    },\n    config: {\n      validate: {\n        payload: _libUser_schema2['default']\n      },\n      pre: [routePreCheckLicenseFn]\n    }\n  });\n\n  server.route({\n    method: 'DELETE',\n    path: '/api/security/v1/users/{username}',\n    handler: function handler(request, reply) {\n      var username = request.params.username;\n      return callWithRequest(request, 'shield.deleteUser', { username: username }).then(function () {\n        return reply().code(204);\n      }, _lodash2['default'].flow(_libErrors.wrapError, reply));\n    },\n    config: {\n      pre: [routePreCheckLicenseFn]\n    }\n  });\n\n  server.route({\n    method: 'POST',\n    path: '/api/security/v1/users/{username}/password',\n    handler: function handler(request, reply) {\n      var username = request.params.username;\n      var _request$payload = request.payload;\n      var password = _request$payload.password;\n      var newPassword = _request$payload.newPassword;\n\n      var promise = Promise.resolve();\n      if (username === request.auth.credentials.username) promise = isValidUser(request, username, password);\n\n      return promise.then(function () {\n        var body = { password: newPassword };\n        return callWithRequest(request, 'shield.changePassword', { username: username, body: body }).then((0, _libOn_change_password2['default'])(request, username, newPassword, calculateExpires, reply))['catch'](_lodash2['default'].flow(_libErrors.wrapError, reply));\n      })['catch'](function (error) {\n        return reply(_boom2['default'].unauthorized(error));\n      });\n    },\n    config: {\n      validate: {\n        payload: {\n          password: _joi2['default'].string(),\n          newPassword: _joi2['default'].string().required()\n        }\n      },\n      pre: [routePreCheckLicenseFn]\n    }\n  });\n};\n\nmodule.exports = exports['default'];\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvc2VjdXJpdHkvc2VydmVyL3JvdXRlcy9hcGkvdjEvdXNlcnMuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7c0JBQWMsUUFBUTs7OztvQkFDTCxNQUFNOzs7O21CQUNQLEtBQUs7Ozs7b0NBQ0MsZ0NBQWdDOzs7OzhCQUMvQiwwQkFBMEI7Ozs7eUJBQ3ZCLHFCQUFxQjs7d0NBQ2Ysb0NBQW9DOzs7O3FDQUN2QyxpQ0FBaUM7Ozs7b0NBQ25DLGdDQUFnQzs7OzswQ0FDMUIsc0NBQXNDOzs7O3FCQUV4RCxVQUFDLE1BQU0sRUFBSztBQUN6QixNQUFNLGVBQWUsR0FBRyx1Q0FBVSxNQUFNLENBQUMsQ0FBQyxlQUFlLENBQUM7QUFDMUQsTUFBTSxnQkFBZ0IsR0FBRywyQ0FBb0IsTUFBTSxDQUFDLENBQUM7QUFDckQsTUFBTSxXQUFXLEdBQUcsdUNBQWUsTUFBTSxDQUFDLENBQUM7QUFDM0MsTUFBTSxzQkFBc0IsR0FBRyw2Q0FBcUIsTUFBTSxDQUFDLENBQUM7O0FBRTVELFFBQU0sQ0FBQyxLQUFLLENBQUM7QUFDWCxVQUFNLEVBQUUsS0FBSztBQUNiLFFBQUksRUFBRSx3QkFBd0I7QUFDOUIsV0FBTyxFQUFBLGlCQUFDLE9BQU8sRUFBRSxLQUFLLEVBQUU7QUFDdEIsYUFBTyxlQUFlLENBQUMsT0FBTyxFQUFFLGdCQUFnQixDQUFDLENBQUMsSUFBSSxDQUNwRCxVQUFDLFFBQVE7ZUFBSyxLQUFLLENBQUMsb0JBQUUsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDO09BQUEsRUFDdkMsb0JBQUUsSUFBSSx1QkFBWSxLQUFLLENBQUMsQ0FDekIsQ0FBQztLQUNIO0FBQ0QsVUFBTSxFQUFFO0FBQ04sU0FBRyxFQUFFLENBQUMsc0JBQXNCLENBQUM7S0FDOUI7R0FDRixDQUFDLENBQUM7O0FBRUgsUUFBTSxDQUFDLEtBQUssQ0FBQztBQUNYLFVBQU0sRUFBRSxLQUFLO0FBQ2Is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LE9BQU8sR0FBRyxXQUFXLENBQUMsT0FBTyxFQUFFLFFBQVEsRUFBRSxRQUFRLENBQUMsQ0FBQzs7QUFFdkcsYUFBTyxPQUFPLENBQUMsSUFBSSxDQUFDLFlBQU07QUFDeEIsWUFBTSxJQUFJLEdBQUcsRUFBQyxRQUFRLEVBQUUsV0FBVyxFQUFDLENBQUM7QUFDckMsZUFBTyxlQUFlLENBQUMsT0FBTyxFQUFFLHVCQUF1QixFQUFFLEVBQUMsUUFBUSxFQUFSLFFBQVEsRUFBRSxJQUFJLEVBQUosSUFBSSxFQUFDLENBQUMsQ0FDekUsSUFBSSxDQUFDLHdDQUFpQixPQUFPLEVBQUUsUUFBUSxFQUFFLFdBQVcsRUFBRSxnQkFBZ0IsRUFBRSxLQUFLLENBQUMsQ0FBQyxTQUMxRSxDQUFDLG9CQUFFLElBQUksdUJBQVksS0FBSyxDQUFDLENBQUMsQ0FBQztPQUNsQyxDQUFDLFNBQ0ksQ0FBQyxVQUFDLEtBQUs7ZUFBSyxLQUFLLENBQUMsa0JBQUssWUFBWSxDQUFDLEtBQUssQ0FBQyxDQUFDO09BQUEsQ0FBQyxDQUFDO0tBQ3BEO0FBQ0QsVUFBTSxFQUFFO0FBQ04sY0FBUSxFQUFFO0FBQ1IsZUFBTyxFQUFFO0FBQ1Asa0JBQVEsRUFBRSxpQkFBSSxNQUFNLEVBQUU7QUFDdEIscUJBQVcsRUFBRSxpQkFBSSxNQUFNLEVBQUUsQ0FBQyxRQUFRLEVBQUU7U0FDckM7T0FDRjtBQUNELFNBQUcsRUFBRSxDQUFDLHNCQUFzQixDQUFDO0tBQzlCO0dBQ0YsQ0FBQyxDQUFDO0NBQ0oiLCJmaWxlIjoiL3Vzci9zaGFyZS9raWJhbmEvcGx1Z2lucy94LXBhY2svcGx1Z2lucy9zZWN1cml0eS9zZXJ2ZXIvcm91dGVzL2FwaS92MS91c2Vycy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBfIGZyb20gJ2xvZGFzaCc7XG5pbXBvcnQgQm9vbSBmcm9tICdib29tJztcbmltcG9ydCBKb2kgZnJvbSAnam9pJztcbmltcG9ydCBnZXRDbGllbnQgZnJvbSAnLi4vLi4vLi4vbGliL2dldF9jbGllbnRfc2hpZWxkJztcbmltcG9ydCB1c2VyU2NoZW1hIGZyb20gJy4uLy4uLy4uL2xpYi91c2VyX3NjaGVtYSc7XG5pbXBvcnQgeyB3cmFwRXJyb3IgfSBmcm9tICcuLi8uLi8uLi9saWIvZXJyb3JzJztcbmltcG9ydCBnZXRDYWxjdWxhdGVFeHBpcmVzIGZyb20gJy4uLy4uLy4uL2xpYi9nZXRfY2FsY3VsYXRlX2V4cGlyZXMnO1xuaW1wb3J0IG9uQ2hhbmdlUGFzc3dvcmQgZnJvbSAnLi4vLi4vLi4vbGliL29uX2NoYW5nZV9wYXNzd29yZCc7XG5pbXBvcnQgZ2V0SXNWYWxpZFVzZXIgZnJvbSAnLi4vLi4vLi4vbGliL2dldF9pc192YWxpZF91c2VyJztcbmltcG9ydCByb3V0ZVByZUNoZWNrTGljZW5zZSBmcm9tICcuLi8uLi8uLi9saWIvcm91dGVfcHJlX2NoZWNrX2xpY2Vuc2UnO1xuXG5leHBvcnQgZGVmYXVsdCAoc2VydmVyKSA9PiB7XG4gIGNvbnN0IGNhbGxXaXRoUmVxdWVzdCA9IGdldENsaWVudChzZXJ2ZXIpLmNhbGxXaXRoUmVxdWVzdDtcbiAgY29uc3QgY2FsY3VsYXRlRXhwaXJlcyA9IGdldENhbGN1bGF0ZUV4cGlyZXMoc2VydmVyKTtcbiAgY29uc3QgaXNWYWxpZFVzZXIgPSBnZXRJc1ZhbGlkVXNlcihzZXJ2ZXIpO1xuICBjb25zdCByb3V0ZVByZUNoZWNrTGljZW5zZUZuID0gcm91dGVQcmVDaGVja0xpY2Vuc2Uoc2VydmVyKTtcblxuICBzZXJ2ZXIucm91dGUoe1xuICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgcGF0aDogJy9hcGkvc2VjdXJpdHkvdjEvdXNlcnMnLFxuICAgIGhhbmRsZXIocmVxdWVzdCwgcmVwbHkpIHtcbiAgICAgIHJldHVybiBjYWxsV2l0aFJlcXVlc3QocmVxdWVzdCwgJ3NoaWVsZC5nZXRVc2VyJykudGhlbihcbiAgICAgICAgKHJlc3BvbnNlKSA9PiByZXBseShfLnZhbHVlcyhyZXNwb25zZSkpLFxuICAgICAgICBfLmZsb3cod3JhcEVycm9yLCByZXBseSlcbiAgICAgICk7XG4gICAgfSxcbiAgICBjb25maWc6IHtcbiAgICAgIHByZTogW3JvdXRlUHJlQ2hlY2tMaWNlbnNlRm5dXG4gICAgfVxuICB9KTtcblxuICBzZXJ2ZXIucm91dGUoe1xuICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgcGF0aDogJy9hcGkvc2VjdXJpdHkvdjEvdXNlcnMve3VzZXJuYW1lfScsXG4gICAgaGFuZGxlcihyZXF1ZXN0LCByZXBseSkge1xuICAgICAgY29uc3QgdXNlcm5hbWUgPSByZXF1ZXN0LnBhcmFtcy51c2VybmFtZTtcbiAgICAgIHJldHVybiBjYWxsV2l0aFJlcXVlc3QocmVxdWVzdCwgJ3NoaWVsZC5nZXRVc2VyJywge3VzZXJuYW1lfSkudGhlbihcbiAgICAgICAgKHJlc3BvbnNlKSA9PiB7XG4gICAgICAgICAgaWYgKHJlc3BvbnNlW3VzZXJuYW1lXSkgcmV0dXJuIHJlcGx5KHJlc3BvbnNlW3VzZXJuYW1lXSk7XG4gICAgICAgICAgcmV0dXJuIHJlcGx5KEJvb20ubm90Rm91bmQoKSk7XG4gICAgICAgIH0sXG4gICAgICAgIF8uZmxvdyh3cmFwRXJyb3IsIHJlcGx5KSk7XG4gICAgfSxcbiAgICBjb25maWc6IHtcbiAgICAgIHByZTogW3JvdXRlUHJlQ2hlY2tMaWNlbnNlRm5dXG4gICAgfVxuICB9KTtcblxuICBzZXJ2ZXIucm91dGUoe1xuICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgIHBhdGg6ICcvYXBpL3NlY3VyaXR5L3YxL3VzZXJzL3t1c2VybmFtZX0nLFxuICAgIGhhbmRsZXIocmVxdWVzdCwgcmVwbHkpIHtcbiAgICAgIGNvbnN0IHVzZXJuYW1lID0gcmVxdWVzdC5wYXJhbXMudXNlcm5hbWU7XG4gICAgICBjb25zdCBib2R5ID0gXyhyZXF1ZXN0LnBheWxvYWQpLm9taXQoWyd1c2VybmFtZScsICdlbmFibGVkJ10pLm9taXQoXy5pc051bGwpO1xuICAgICAgcmV0dXJuIGNhbGxXaXRoUmVxdWVzdChyZXF1ZXN0LCAnc2hpZWxkLnB1dFVzZXInLCB7dXNlcm5hbWUsIGJvZHl9KS50aGVuKFxuICAgICAgICAoKSA9PiByZXBseShyZXF1ZXN0LnBheWxvYWQpLFxuICAgICAgICBfLmZsb3cod3JhcEVycm9yLCByZXBseSkpO1xuICAgIH0sXG4gICAgY29uZmlnOiB7XG4gICAgICB2YWxpZGF0ZToge1xuICAgICAgICBwYXlsb2FkOiB1c2VyU2NoZW1hXG4gICAgICB9LFxuICAgICAgcHJlOiBbcm91dGVQcmVDaGVja0xpY2Vuc2VGbl1cbiAgICB9XG4gIH0pO1xuXG4gIHNlcnZlci5yb3V0ZSh7XG4gICAgbWV0aG9kOiAnREVMRVRFJyxcbiAgICBwYXRoOiAnL2FwaS9zZWN1cml0eS92MS91c2Vycy97dXNlcm5hbWV9JyxcbiAgICBoYW5kbGVyKHJlcXVlc3QsIHJlcGx5KSB7XG4gICAgICBjb25zdCB1c2VybmFtZSA9IHJlcXVlc3QucGFyYW1zLnVzZXJuYW1lO1xuICAgICAgcmV0dXJuIGNhbGxXaXRoUmVxdWVzdChyZXF1ZXN0LCAnc2hpZWxkLmRlbGV0ZVVzZXInLCB7dXNlcm5hbWV9KS50aGVuKFxuICAgICAgICAoKSA9PiByZXBseSgpLmNvZGUoMjA0KSxcbiAgICAgICAgXy5mbG93KHdyYXBFcnJvciwgcmVwbHkpKTtcbiAgICB9LFxuICAgIGNvbmZpZzoge1xuICAgICAgcHJlOiBbcm91dGVQcmVDaGVja0xpY2Vuc2VGbl1cbiAgICB9XG4gIH0pO1xuXG4gIHNlcnZlci5yb3V0ZSh7XG4gICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgcGF0aDogJy9hcGkvc2VjdXJpdHkvdjEvdXNlcnMve3VzZXJuYW1lfS9wYXNzd29yZCcsXG4gICAgaGFuZGxlcihyZXF1ZXN0LCByZXBseSkge1xuICAgICAgY29uc3QgdXNlcm5hbWUgPSByZXF1ZXN0LnBhcmFtcy51c2VybmFtZTtcbiAgICAgIGNvbnN0IHtwYXNzd29yZCwgbmV3UGFzc3dvcmR9ID0gcmVxdWVzdC5wYXlsb2FkO1xuXG4gICAgICBsZXQgcHJvbWlzZSA9IFByb21pc2UucmVzb2x2ZSgpO1xuICAgICAgaWYgKHVzZXJuYW1lID09PSByZXF1ZXN0LmF1dGguY3JlZGVudGlhbHMudXNlcm5hbWUpIHByb21pc2UgPSBpc1ZhbGlkVXNlcihyZXF1ZXN0LCB1c2VybmFtZSwgcGFzc3dvcmQpO1xuXG4gICAgICByZXR1cm4gcHJvbWlzZS50aGVuKCgpID0+IHtcbiAgICAgICAgY29uc3QgYm9keSA9IHtwYXNzd29yZDogbmV3UGFzc3dvcmR9O1xuICAgICAgICByZXR1cm4gY2FsbFdpdGhSZXF1ZXN0KHJlcXVlc3QsICdzaGllbGQuY2hhbmdlUGFzc3dvcmQnLCB7dXNlcm5hbWUsIGJvZHl9KVxuICAgICAgICAudGhlbihvbkNoYW5nZVBhc3N3b3JkKHJlcXVlc3QsIHVzZXJuYW1lLCBuZXdQYXNzd29yZCwgY2FsY3VsYXRlRXhwaXJlcywgcmVwbHkpKVxuICAgICAgICAuY2F0Y2goXy5mbG93KHdyYXBFcnJvciwgcmVwbHkpKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycm9yKSA9PiByZXBseShCb29tLnVuYXV0aG9yaXplZChlcnJvcikpKTtcbiAgICB9LFxuICAgIGNvbmZpZzoge1xuICAgICAgdmFsaWRhdGU6IHtcbiAgICAgICAgcGF5bG9hZDoge1xuICAgICAgICAgIHBhc3N3b3JkOiBKb2kuc3RyaW5nKCksXG4gICAgICAgICAgbmV3UGFzc3dvcmQ6IEpvaS5zdHJpbmcoKS5yZXF1aXJlZCgpXG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBwcmU6IFtyb3V0ZVByZUNoZWNrTGljZW5zZUZuXVxuICAgIH1cbiAgfSk7XG59O1xuIl19",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/security/server/routes/api/v1/users.js"
      ],
      "names": [],
      "mappings": "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",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/security/server/routes/api/v1/users.js",
      "sourcesContent": [
        "import _ from 'lodash';\nimport Boom from 'boom';\nimport Joi from 'joi';\nimport getClient from '../../../lib/get_client_shield';\nimport userSchema from '../../../lib/user_schema';\nimport { wrapError } from '../../../lib/errors';\nimport getCalculateExpires from '../../../lib/get_calculate_expires';\nimport onChangePassword from '../../../lib/on_change_password';\nimport getIsValidUser from '../../../lib/get_is_valid_user';\nimport routePreCheckLicense from '../../../lib/route_pre_check_license';\n\nexport default (server) => {\n  const callWithRequest = getClient(server).callWithRequest;\n  const calculateExpires = getCalculateExpires(server);\n  const isValidUser = getIsValidUser(server);\n  const routePreCheckLicenseFn = routePreCheckLicense(server);\n\n  server.route({\n    method: 'GET',\n    path: '/api/security/v1/users',\n    handler(request, reply) {\n      return callWithRequest(request, 'shield.getUser').then(\n        (response) => reply(_.values(response)),\n        _.flow(wrapError, reply)\n      );\n    },\n    config: {\n      pre: [routePreCheckLicenseFn]\n    }\n  });\n\n  server.route({\n    method: 'GET',\n    path: '/api/security/v1/users/{username}',\n    handler(request, reply) {\n      const username = request.params.username;\n      return callWithRequest(request, 'shield.getUser', {username}).then(\n        (response) => {\n          if (response[username]) return reply(response[username]);\n          return reply(Boom.notFound());\n        },\n        _.flow(wrapError, reply));\n    },\n    config: {\n      pre: [routePreCheckLicenseFn]\n    }\n  });\n\n  server.route({\n    method: 'POST',\n    path: '/api/security/v1/users/{username}',\n    handler(request, reply) {\n      const username = request.params.username;\n      const body = _(request.payload).omit(['username', 'enabled']).omit(_.isNull);\n      return callWithRequest(request, 'shield.putUser', {username, body}).then(\n        () => reply(request.payload),\n        _.flow(wrapError, reply));\n    },\n    config: {\n      validate: {\n        payload: userSchema\n      },\n      pre: [routePreCheckLicenseFn]\n    }\n  });\n\n  server.route({\n    method: 'DELETE',\n    path: '/api/security/v1/users/{username}',\n    handler(request, reply) {\n      const username = request.params.username;\n      return callWithRequest(request, 'shield.deleteUser', {username}).then(\n        () => reply().code(204),\n        _.flow(wrapError, reply));\n    },\n    config: {\n      pre: [routePreCheckLicenseFn]\n    }\n  });\n\n  server.route({\n    method: 'POST',\n    path: '/api/security/v1/users/{username}/password',\n    handler(request, reply) {\n      const username = request.params.username;\n      const {password, newPassword} = request.payload;\n\n      let promise = Promise.resolve();\n      if (username === request.auth.credentials.username) promise = isValidUser(request, username, password);\n\n      return promise.then(() => {\n        const body = {password: newPassword};\n        return callWithRequest(request, 'shield.changePassword', {username, body})\n        .then(onChangePassword(request, username, newPassword, calculateExpires, reply))\n        .catch(_.flow(wrapError, reply));\n      })\n      .catch((error) => reply(Boom.unauthorized(error)));\n    },\n    config: {\n      validate: {\n        payload: {\n          password: Joi.string(),\n          newPassword: Joi.string().required()\n        }\n      },\n      pre: [routePreCheckLicenseFn]\n    }\n  });\n};\n"
      ]
    },
    "mtime": 1491771515103
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/user_schema.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "joi",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "Joi"
              }
            ]
          }
        ],
        "exports": {
          "exported": [],
          "specifiers": []
        }
      },
      "usedHelpers": [
        "interop-require-default"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _joi = require('joi');\n\nvar _joi2 = _interopRequireDefault(_joi);\n\nexports['default'] = {\n  username: _joi2['default'].string().required(),\n  password: _joi2['default'].string(),\n  roles: _joi2['default'].array().items(_joi2['default'].string()),\n  full_name: _joi2['default'].string().allow(null, ''),\n  email: _joi2['default'].string().allow(null, ''),\n  metadata: _joi2['default'].object(),\n  enabled: _joi2['default'].boolean()['default'](true)\n};\nmodule.exports = exports['default'];\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvc2VjdXJpdHkvc2VydmVyL2xpYi91c2VyX3NjaGVtYS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7OzttQkFBZ0IsS0FBSzs7OztxQkFFTjtBQUNiLFVBQVEsRUFBRSxpQkFBSSxNQUFNLEVBQUUsQ0FBQyxRQUFRLEVBQUU7QUFDakMsVUFBUSxFQUFFLGlCQUFJLE1BQU0sRUFBRTtBQUN0QixPQUFLLEVBQUUsaUJBQUksS0FBSyxFQUFFLENBQUMsS0FBSyxDQUFDLGlCQUFJLE1BQU0sRUFBRSxDQUFDO0FBQ3RDLFdBQVMsRUFBRSxpQkFBSSxNQUFNLEVBQUUsQ0FBQyxLQUFLLENBQUMsSUFBSSxFQUFFLEVBQUUsQ0FBQztBQUN2QyxPQUFLLEVBQUUsaUJBQUksTUFBTSxFQUFFLENBQUMsS0FBSyxDQUFDLElBQUksRUFBRSxFQUFFLENBQUM7QUFDbkMsVUFBUSxFQUFFLGlCQUFJLE1BQU0sRUFBRTtBQUN0QixTQUFPLEVBQUUsaUJBQUksT0FBTyxFQUFFLFdBQVEsQ0FBQyxJQUFJLENBQUM7Q0FDckMiLCJmaWxlIjoiL3Vzci9zaGFyZS9raWJhbmEvcGx1Z2lucy94LXBhY2svcGx1Z2lucy9zZWN1cml0eS9zZXJ2ZXIvbGliL3VzZXJfc2NoZW1hLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IEpvaSBmcm9tICdqb2knO1xuXG5leHBvcnQgZGVmYXVsdCB7XG4gIHVzZXJuYW1lOiBKb2kuc3RyaW5nKCkucmVxdWlyZWQoKSxcbiAgcGFzc3dvcmQ6IEpvaS5zdHJpbmcoKSxcbiAgcm9sZXM6IEpvaS5hcnJheSgpLml0ZW1zKEpvaS5zdHJpbmcoKSksXG4gIGZ1bGxfbmFtZTogSm9pLnN0cmluZygpLmFsbG93KG51bGwsICcnKSxcbiAgZW1haWw6IEpvaS5zdHJpbmcoKS5hbGxvdyhudWxsLCAnJyksXG4gIG1ldGFkYXRhOiBKb2kub2JqZWN0KCksXG4gIGVuYWJsZWQ6IEpvaS5ib29sZWFuKCkuZGVmYXVsdCh0cnVlKVxufTtcbiJdfQ==",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/user_schema.js"
      ],
      "names": [],
      "mappings": ";;;;;;;;mBAAgB,KAAK;;;;qBAEN;AACb,UAAQ,EAAE,iBAAI,MAAM,EAAE,CAAC,QAAQ,EAAE;AACjC,UAAQ,EAAE,iBAAI,MAAM,EAAE;AACtB,OAAK,EAAE,iBAAI,KAAK,EAAE,CAAC,KAAK,CAAC,iBAAI,MAAM,EAAE,CAAC;AACtC,WAAS,EAAE,iBAAI,MAAM,EAAE,CAAC,KAAK,CAAC,IAAI,EAAE,EAAE,CAAC;AACvC,OAAK,EAAE,iBAAI,MAAM,EAAE,CAAC,KAAK,CAAC,IAAI,EAAE,EAAE,CAAC;AACnC,UAAQ,EAAE,iBAAI,MAAM,EAAE;AACtB,SAAO,EAAE,iBAAI,OAAO,EAAE,WAAQ,CAAC,IAAI,CAAC;CACrC",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/user_schema.js",
      "sourcesContent": [
        "import Joi from 'joi';\n\nexport default {\n  username: Joi.string().required(),\n  password: Joi.string(),\n  roles: Joi.array().items(Joi.string()),\n  full_name: Joi.string().allow(null, ''),\n  email: Joi.string().allow(null, ''),\n  metadata: Joi.object(),\n  enabled: Joi.boolean().default(true)\n};\n"
      ]
    },
    "mtime": 1491771510468
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/on_change_password.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [],
        "exports": {
          "exported": [],
          "specifiers": []
        }
      },
      "usedHelpers": []
    },
    "ignored": false,
    "code": "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nexports[\"default\"] = function (request, username, password, calculateExpires, reply) {\n  return function () {\n    var currentUser = request.auth.credentials.username;\n    if (username === currentUser) {\n      request.cookieAuth.set({\n        username: username,\n        password: password,\n        expires: calculateExpires()\n      });\n    }\n\n    return reply().code(204);\n  };\n};\n\nmodule.exports = exports[\"default\"];\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvc2VjdXJpdHkvc2VydmVyL2xpYi9vbl9jaGFuZ2VfcGFzc3dvcmQuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7O3FCQUFlLFVBQUMsT0FBTyxFQUFFLFFBQVEsRUFBRSxRQUFRLEVBQUUsZ0JBQWdCLEVBQUUsS0FBSyxFQUFLO0FBQ3ZFLFNBQU8sWUFBTTtBQUNYLFFBQU0sV0FBVyxHQUFHLE9BQU8sQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLFFBQVEsQ0FBQztBQUN0RCxRQUFJLFFBQVEsS0FBSyxXQUFXLEVBQUU7QUFDNUIsYUFBTyxDQUFDLFVBQVUsQ0FBQyxHQUFHLENBQUM7QUFDckIsZ0JBQVEsRUFBUixRQUFRO0FBQ1IsZ0JBQVEsRUFBUixRQUFRO0FBQ1IsZUFBTyxFQUFFLGdCQUFnQixFQUFFO09BQzVCLENBQUMsQ0FBQztLQUNKOztBQUVELFdBQU8sS0FBSyxFQUFFLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO0dBQzFCLENBQUM7Q0FDSCIsImZpbGUiOiIvdXNyL3NoYXJlL2tpYmFuYS9wbHVnaW5zL3gtcGFjay9wbHVnaW5zL3NlY3VyaXR5L3NlcnZlci9saWIvb25fY2hhbmdlX3Bhc3N3b3JkLmpzIiwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgKHJlcXVlc3QsIHVzZXJuYW1lLCBwYXNzd29yZCwgY2FsY3VsYXRlRXhwaXJlcywgcmVwbHkpID0+IHtcbiAgcmV0dXJuICgpID0+IHtcbiAgICBjb25zdCBjdXJyZW50VXNlciA9IHJlcXVlc3QuYXV0aC5jcmVkZW50aWFscy51c2VybmFtZTtcbiAgICBpZiAodXNlcm5hbWUgPT09IGN1cnJlbnRVc2VyKSB7XG4gICAgICByZXF1ZXN0LmNvb2tpZUF1dGguc2V0KHtcbiAgICAgICAgdXNlcm5hbWUsXG4gICAgICAgIHBhc3N3b3JkLFxuICAgICAgICBleHBpcmVzOiBjYWxjdWxhdGVFeHBpcmVzKClcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiByZXBseSgpLmNvZGUoMjA0KTtcbiAgfTtcbn07XG4iXX0=",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/on_change_password.js"
      ],
      "names": [],
      "mappings": ";;;;;;qBAAe,UAAC,OAAO,EAAE,QAAQ,EAAE,QAAQ,EAAE,gBAAgB,EAAE,KAAK,EAAK;AACvE,SAAO,YAAM;AACX,QAAM,WAAW,GAAG,OAAO,CAAC,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC;AACtD,QAAI,QAAQ,KAAK,WAAW,EAAE;AAC5B,aAAO,CAAC,UAAU,CAAC,GAAG,CAAC;AACrB,gBAAQ,EAAR,QAAQ;AACR,gBAAQ,EAAR,QAAQ;AACR,eAAO,EAAE,gBAAgB,EAAE;OAC5B,CAAC,CAAC;KACJ;;AAED,WAAO,KAAK,EAAE,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;GAC1B,CAAC;CACH",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/on_change_password.js",
      "sourcesContent": [
        "export default (request, username, password, calculateExpires, reply) => {\n  return () => {\n    const currentUser = request.auth.credentials.username;\n    if (username === currentUser) {\n      request.cookieAuth.set({\n        username,\n        password,\n        expires: calculateExpires()\n      });\n    }\n\n    return reply().code(204);\n  };\n};\n"
      ]
    },
    "mtime": 1491771510468
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/route_pre_check_license.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [],
        "exports": {
          "exported": [
            "routePreCheckLicense",
            "server"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "routePreCheckLicense",
              "exported": "default"
            },
            {
              "kind": "local",
              "local": "server",
              "exported": "default"
            }
          ]
        }
      },
      "usedHelpers": []
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nexports['default'] = routePreCheckLicense;\nvar Boom = require('boom');\n\nfunction routePreCheckLicense(server) {\n  var xpackMainPlugin = server.plugins.xpack_main;\n  var pluginId = 'security';\n  return function forbidApiAccess(request, reply) {\n    var licenseCheckResults = xpackMainPlugin.info.feature(pluginId).getLicenseCheckResults();\n    if (!licenseCheckResults.showLinks) {\n      reply(Boom.forbidden(licenseCheckResults.linksMessage));\n    } else {\n      reply();\n    }\n  };\n}\n\n;\nmodule.exports = exports['default'];\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvc2VjdXJpdHkvc2VydmVyL2xpYi9yb3V0ZV9wcmVfY2hlY2tfbGljZW5zZS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztxQkFFd0Isb0JBQW9CO0FBRjVDLElBQU0sSUFBSSxHQUFHLE9BQU8sQ0FBQyxNQUFNLENBQUMsQ0FBQzs7QUFFZCxTQUFTLG9CQUFvQixDQUFDLE1BQU0sRUFBRTtBQUNuRCxNQUFNLGVBQWUsR0FBRyxNQUFNLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQztBQUNsRCxNQUFNLFFBQVEsR0FBRyxVQUFVLENBQUM7QUFDNUIsU0FBTyxTQUFTLGVBQWUsQ0FBQyxPQUFPLEVBQUUsS0FBSyxFQUFFO0FBQzlDLFFBQU0sbUJBQW1CLEdBQUcsZUFBZSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLENBQUMsc0JBQXNCLEVBQUUsQ0FBQztBQUM1RixRQUFJLENBQUMsbUJBQW1CLENBQUMsU0FBUyxFQUFFO0FBQ2xDLFdBQUssQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLG1CQUFtQixDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUM7S0FDekQsTUFBTTtBQUNMLFdBQUssRUFBRSxDQUFDO0tBQ1Q7R0FDRixDQUFDO0NBQ0g7O0FBQUEsQ0FBQyIsImZpbGUiOiIvdXNyL3NoYXJlL2tpYmFuYS9wbHVnaW5zL3gtcGFjay9wbHVnaW5zL3NlY3VyaXR5L3NlcnZlci9saWIvcm91dGVfcHJlX2NoZWNrX2xpY2Vuc2UuanMiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBCb29tID0gcmVxdWlyZSgnYm9vbScpO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiByb3V0ZVByZUNoZWNrTGljZW5zZShzZXJ2ZXIpIHtcbiAgY29uc3QgeHBhY2tNYWluUGx1Z2luID0gc2VydmVyLnBsdWdpbnMueHBhY2tfbWFpbjtcbiAgY29uc3QgcGx1Z2luSWQgPSAnc2VjdXJpdHknO1xuICByZXR1cm4gZnVuY3Rpb24gZm9yYmlkQXBpQWNjZXNzKHJlcXVlc3QsIHJlcGx5KSB7XG4gICAgY29uc3QgbGljZW5zZUNoZWNrUmVzdWx0cyA9IHhwYWNrTWFpblBsdWdpbi5pbmZvLmZlYXR1cmUocGx1Z2luSWQpLmdldExpY2Vuc2VDaGVja1Jlc3VsdHMoKTtcbiAgICBpZiAoIWxpY2Vuc2VDaGVja1Jlc3VsdHMuc2hvd0xpbmtzKSB7XG4gICAgICByZXBseShCb29tLmZvcmJpZGRlbihsaWNlbnNlQ2hlY2tSZXN1bHRzLmxpbmtzTWVzc2FnZSkpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXBseSgpO1xuICAgIH1cbiAgfTtcbn07XG4iXX0=",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/route_pre_check_license.js"
      ],
      "names": [],
      "mappings": ";;;;;qBAEwB,oBAAoB;AAF5C,IAAM,IAAI,GAAG,OAAO,CAAC,MAAM,CAAC,CAAC;;AAEd,SAAS,oBAAoB,CAAC,MAAM,EAAE;AACnD,MAAM,eAAe,GAAG,MAAM,CAAC,OAAO,CAAC,UAAU,CAAC;AAClD,MAAM,QAAQ,GAAG,UAAU,CAAC;AAC5B,SAAO,SAAS,eAAe,CAAC,OAAO,EAAE,KAAK,EAAE;AAC9C,QAAM,mBAAmB,GAAG,eAAe,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,sBAAsB,EAAE,CAAC;AAC5F,QAAI,CAAC,mBAAmB,CAAC,SAAS,EAAE;AAClC,WAAK,CAAC,IAAI,CAAC,SAAS,CAAC,mBAAmB,CAAC,YAAY,CAAC,CAAC,CAAC;KACzD,MAAM;AACL,WAAK,EAAE,CAAC;KACT;GACF,CAAC;CACH;;AAAA,CAAC",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/route_pre_check_license.js",
      "sourcesContent": [
        "const Boom = require('boom');\n\nexport default function routePreCheckLicense(server) {\n  const xpackMainPlugin = server.plugins.xpack_main;\n  const pluginId = 'security';\n  return function forbidApiAccess(request, reply) {\n    const licenseCheckResults = xpackMainPlugin.info.feature(pluginId).getLicenseCheckResults();\n    if (!licenseCheckResults.showLinks) {\n      reply(Boom.forbidden(licenseCheckResults.linksMessage));\n    } else {\n      reply();\n    }\n  };\n};\n"
      ]
    },
    "mtime": 1491771510468
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/security/server/routes/api/v1/roles.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "lodash",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "_"
              }
            ]
          },
          {
            "source": "boom",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "Boom"
              }
            ]
          },
          {
            "source": "../../../lib/get_client_shield",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "getClient"
              }
            ]
          },
          {
            "source": "../../../lib/role_schema",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "roleSchema"
              }
            ]
          },
          {
            "source": "../../../lib/errors",
            "imported": [
              "wrapError"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "wrapError",
                "local": "wrapError"
              }
            ]
          },
          {
            "source": "../../../lib/route_pre_check_license",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "routePreCheckLicense"
              }
            ]
          }
        ],
        "exports": {
          "exported": [],
          "specifiers": []
        }
      },
      "usedHelpers": [
        "interop-require-default"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _lodash = require('lodash');\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _boom = require('boom');\n\nvar _boom2 = _interopRequireDefault(_boom);\n\nvar _libGet_client_shield = require('../../../lib/get_client_shield');\n\nvar _libGet_client_shield2 = _interopRequireDefault(_libGet_client_shield);\n\nvar _libRole_schema = require('../../../lib/role_schema');\n\nvar _libRole_schema2 = _interopRequireDefault(_libRole_schema);\n\nvar _libErrors = require('../../../lib/errors');\n\nvar _libRoute_pre_check_license = require('../../../lib/route_pre_check_license');\n\nvar _libRoute_pre_check_license2 = _interopRequireDefault(_libRoute_pre_check_license);\n\nexports['default'] = function (server) {\n  var callWithRequest = (0, _libGet_client_shield2['default'])(server).callWithRequest;\n  var routePreCheckLicenseFn = (0, _libRoute_pre_check_license2['default'])(server);\n\n  server.route({\n    method: 'GET',\n    path: '/api/security/v1/roles',\n    handler: function handler(request, reply) {\n      return callWithRequest(request, 'shield.getRole').then(function (response) {\n        var roles = _lodash2['default'].map(response, function (role, name) {\n          return _lodash2['default'].assign(role, { name: name });\n        });\n        return reply(roles);\n      }, _lodash2['default'].flow(_libErrors.wrapError, reply));\n    },\n    config: {\n      pre: [routePreCheckLicenseFn]\n    }\n  });\n\n  server.route({\n    method: 'GET',\n    path: '/api/security/v1/roles/{name}',\n    handler: function handler(request, reply) {\n      var name = request.params.name;\n      return callWithRequest(request, 'shield.getRole', { name: name }).then(function (response) {\n        if (response[name]) return reply(_lodash2['default'].assign(response[name], { name: name }));\n        return reply(_boom2['default'].notFound());\n      }, _lodash2['default'].flow(_libErrors.wrapError, reply));\n    },\n    config: {\n      pre: [routePreCheckLicenseFn]\n    }\n  });\n\n  server.route({\n    method: 'POST',\n    path: '/api/security/v1/roles/{name}',\n    handler: function handler(request, reply) {\n      var name = request.params.name;\n      var body = _lodash2['default'].omit(request.payload, 'name');\n      return callWithRequest(request, 'shield.putRole', { name: name, body: body }).then(function () {\n        return reply(request.payload);\n      }, _lodash2['default'].flow(_libErrors.wrapError, reply));\n    },\n    config: {\n      validate: {\n        payload: _libRole_schema2['default']\n      },\n      pre: [routePreCheckLicenseFn]\n    }\n  });\n\n  server.route({\n    method: 'DELETE',\n    path: '/api/security/v1/roles/{name}',\n    handler: function handler(request, reply) {\n      var name = request.params.name;\n      return callWithRequest(request, 'shield.deleteRole', { name: name }).then(function () {\n        return reply().code(204);\n      }, _lodash2['default'].flow(_libErrors.wrapError, reply));\n    },\n    config: {\n      pre: [routePreCheckLicenseFn]\n    }\n  });\n};\n\nmodule.exports = exports['default'];\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvc2VjdXJpdHkvc2VydmVyL3JvdXRlcy9hcGkvdjEvcm9sZXMuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7c0JBQWMsUUFBUTs7OztvQkFDTCxNQUFNOzs7O29DQUNELGdDQUFnQzs7Ozs4QkFDL0IsMEJBQTBCOzs7O3lCQUN2QixxQkFBcUI7OzBDQUNkLHNDQUFzQzs7OztxQkFFeEQsVUFBQyxNQUFNLEVBQUs7QUFDekIsTUFBTSxlQUFlLEdBQUcsdUNBQVUsTUFBTSxDQUFDLENBQUMsZUFBZSxDQUFDO0FBQzFELE1BQU0sc0JBQXNCLEdBQUcsNkNBQXFCLE1BQU0sQ0FBQyxDQUFDOztBQUU1RCxRQUFNLENBQUMsS0FBSyxDQUFDO0FBQ1gsVUFBTSxFQUFFLEtBQUs7QUFDYixRQUFJLEVBQUUsd0JBQXdCO0FBQzlCLFdBQU8sRUFBQSxpQkFBQyxPQUFPLEVBQUUsS0FBSyxFQUFFO0FBQ3RCLGFBQU8sZUFBZSxDQUFDLE9BQU8sRUFBRSxnQkFBZ0IsQ0FBQyxDQUFDLElBQUksQ0FDcEQsVUFBQyxRQUFRLEVBQUs7QUFDWixZQUFNLEtBQUssR0FBRyxvQkFBRSxHQUFHLENBQUMsUUFBUSxFQUFFLFVBQUMsSUFBSSxFQUFFLElBQUk7aUJBQUssb0JBQUUsTUFBTSxDQUFDLElBQUksRUFBRSxFQUFDLElBQUksRUFBSixJQUFJLEVBQUMsQ0FBQztTQUFBLENBQUMsQ0FBQztBQUN0RSxlQUFPLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQztPQUNyQixFQUNELG9CQUFFLElBQUksdUJBQVksS0FBSyxDQUFDLENBQ3pCLENBQUM7S0FDSDtBQUNELFVBQU0sRUFBRTtBQUNOLFNBQUcsRUFBRSxDQUFDLHNCQUFzQixDQUFDO0tBQzlCO0dBQ0YsQ0FBQyxDQUFDOztBQUVILFFBQU0sQ0FBQyxLQUFLLENBQUM7QUFDWCxVQUFNLEVBQUUsS0FBSztBQUNiLFFBQUksRUFBRSwrQkFBK0I7QUFDckMsV0FBTyxFQUFBLGlCQUFDLE9BQU8sRUFBRSxLQUFLLEVBQUU7QUFDdEIsVUFBTSxJQUFJLEdBQUcsT0FBTyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUM7QUFDakMsYUFBTyxlQUFlLENBQUMsT0FBTyxFQUFFLGdCQUFnQixFQUFFLEVBQUMsSUFBSSxFQUFKLElBQUksRUFBQyxDQUFDLENBQUMsSUFBSSxDQUM1RCxVQUFDLFFBQVEsRUFBSztBQUNaLFlBQUksUUFBUSxDQUFDLElBQUksQ0FBQyxFQUFFLE9BQU8sS0FBSyxDQUFDLG9CQUFFLE1BQU0sQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLEVBQUUsRUFBQyxJQUFJLEVBQUosSUFBSSxFQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ25FLGVBQU8sS0FBSyxDQUFDLGtCQUFLLFFBQVEsRUFBRSxDQUFDLENBQUM7T0FDL0IsRUFDRCxvQkFBRSxJQUFJLHVCQUFZLEtBQUssQ0FBQyxDQUFDLENBQUM7S0FDN0I7QUFDRCxVQUFNLEVBQUU7QUFDTixTQUFHLEVBQUUsQ0FBQyxzQkFBc0IsQ0FBQztLQUM5QjtHQUNGLENBQUMsQ0FBQzs7QUFFSCxRQUFNLENBQUMsS0FBSyxDQUFDO0FBQ1gsVUFBTSxFQUFFLE1BQU07QUFDZCxRQUFJLEVBQUUsK0JBQStCO0FBQ3JDLFdBQU8sRUFBQSxpQkFBQyxPQUFPLEVBQUUsS0FBSyxFQUFFO0FBQ3RCLFVBQU0sSUFBSSxHQUFHLE9BQU8sQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDO0FBQ2pDLFVBQU0sSUFBSSxHQUFHLG9CQUFFLElBQUksQ0FBQyxPQUFPLENBQUMsT0FBTyxFQUFFLE1BQU0sQ0FBQyxDQUFDO0FBQzdDLGFBQU8sZUFBZSxDQUFDLE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxFQUFDLElBQUksRUFBSixJQUFJLEVBQUUsSUFBSSxFQUFKLElBQUksRUFBQyxDQUFDLENBQUMsSUFBSSxDQUNsRTtlQUFNLEtBQUssQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDO09BQUEsRUFDNUIsb0JBQUUsSUFBSSx1QkFBWSxLQUFLLENBQUMsQ0FBQyxDQUFDO0tBQzdCO0FBQ0QsVUFBTSxFQUFFO0FBQ04sY0FBUSxFQUFFO0FBQ1IsZUFBTyw2QkFBWTtPQUNwQjtBQUNELFNBQUcsRUFBRSxDQUFDLHNCQUFzQixDQUFDO0tBQzlCO0dBQ0YsQ0FBQyxDQUFDOztBQUVILFFBQU0sQ0FBQyxLQUFLLENBQUM7QUFDWCxVQUFNLEVBQUUsUUFBUTtBQUNoQixRQUFJLEVBQUUsK0JBQStCO0FBQ3JDLFdBQU8sRUFBQSxpQkFBQyxPQUFPLEVBQUUsS0FBSyxFQUFFO0FBQ3RCLFVBQU0sSUFBSSxHQUFHLE9BQU8sQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDO0FBQ2pDLGFBQU8sZUFBZSxDQUFDLE9BQU8sRUFBRSxtQkFBbUIsRUFBRSxFQUFDLElBQUksRUFBSixJQUFJLEVBQUMsQ0FBQyxDQUFDLElBQUksQ0FDL0Q7ZUFBTSxLQUFLLEVBQUUsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDO09BQUEsRUFDdkIsb0JBQUUsSUFBSSx1QkFBWSxLQUFLLENBQUMsQ0FBQyxDQUFDO0tBQzdCO0FBQ0QsVUFBTSxFQUFFO0FBQ04sU0FBRyxFQUFFLENBQUMsc0JBQXNCLENBQUM7S0FDOUI7R0FDRixDQUFDLENBQUM7Q0FDSiIsImZpbGUiOiIvdXNyL3NoYXJlL2tpYmFuYS9wbHVnaW5zL3gtcGFjay9wbHVnaW5zL3NlY3VyaXR5L3NlcnZlci9yb3V0ZXMvYXBpL3YxL3JvbGVzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IF8gZnJvbSAnbG9kYXNoJztcbmltcG9ydCBCb29tIGZyb20gJ2Jvb20nO1xuaW1wb3J0IGdldENsaWVudCBmcm9tICcuLi8uLi8uLi9saWIvZ2V0X2NsaWVudF9zaGllbGQnO1xuaW1wb3J0IHJvbGVTY2hlbWEgZnJvbSAnLi4vLi4vLi4vbGliL3JvbGVfc2NoZW1hJztcbmltcG9ydCB7IHdyYXBFcnJvciB9IGZyb20gJy4uLy4uLy4uL2xpYi9lcnJvcnMnO1xuaW1wb3J0IHJvdXRlUHJlQ2hlY2tMaWNlbnNlIGZyb20gJy4uLy4uLy4uL2xpYi9yb3V0ZV9wcmVfY2hlY2tfbGljZW5zZSc7XG5cbmV4cG9ydCBkZWZhdWx0IChzZXJ2ZXIpID0+IHtcbiAgY29uc3QgY2FsbFdpdGhSZXF1ZXN0ID0gZ2V0Q2xpZW50KHNlcnZlcikuY2FsbFdpdGhSZXF1ZXN0O1xuICBjb25zdCByb3V0ZVByZUNoZWNrTGljZW5zZUZuID0gcm91dGVQcmVDaGVja0xpY2Vuc2Uoc2VydmVyKTtcblxuICBzZXJ2ZXIucm91dGUoe1xuICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgcGF0aDogJy9hcGkvc2VjdXJpdHkvdjEvcm9sZXMnLFxuICAgIGhhbmRsZXIocmVxdWVzdCwgcmVwbHkpIHtcbiAgICAgIHJldHVybiBjYWxsV2l0aFJlcXVlc3QocmVxdWVzdCwgJ3NoaWVsZC5nZXRSb2xlJykudGhlbihcbiAgICAgICAgKHJlc3BvbnNlKSA9PiB7XG4gICAgICAgICAgY29uc3Qgcm9sZXMgPSBfLm1hcChyZXNwb25zZSwgKHJvbGUsIG5hbWUpID0+IF8uYXNzaWduKHJvbGUsIHtuYW1lfSkpO1xuICAgICAgICAgIHJldHVybiByZXBseShyb2xlcyk7XG4gICAgICAgIH0sXG4gICAgICAgIF8uZmxvdyh3cmFwRXJyb3IsIHJlcGx5KVxuICAgICAgKTtcbiAgICB9LFxuICAgIGNvbmZpZzoge1xuICAgICAgcHJlOiBbcm91dGVQcmVDaGVja0xpY2Vuc2VGbl1cbiAgICB9XG4gIH0pO1xuXG4gIHNlcnZlci5yb3V0ZSh7XG4gICAgbWV0aG9kOiAnR0VUJyxcbiAgICBwYXRoOiAnL2FwaS9zZWN1cml0eS92MS9yb2xlcy97bmFtZX0nLFxuICAgIGhhbmRsZXIocmVxdWVzdCwgcmVwbHkpIHtcbiAgICAgIGNvbnN0IG5hbWUgPSByZXF1ZXN0LnBhcmFtcy5uYW1lO1xuICAgICAgcmV0dXJuIGNhbGxXaXRoUmVxdWVzdChyZXF1ZXN0LCAnc2hpZWxkLmdldFJvbGUnLCB7bmFtZX0pLnRoZW4oXG4gICAgICAgIChyZXNwb25zZSkgPT4ge1xuICAgICAgICAgIGlmIChyZXNwb25zZVtuYW1lXSkgcmV0dXJuIHJlcGx5KF8uYXNzaWduKHJlc3BvbnNlW25hbWVdLCB7bmFtZX0pKTtcbiAgICAgICAgICByZXR1cm4gcmVwbHkoQm9vbS5ub3RGb3VuZCgpKTtcbiAgICAgICAgfSxcbiAgICAgICAgXy5mbG93KHdyYXBFcnJvciwgcmVwbHkpKTtcbiAgICB9LFxuICAgIGNvbmZpZzoge1xuICAgICAgcHJlOiBbcm91dGVQcmVDaGVja0xpY2Vuc2VGbl1cbiAgICB9XG4gIH0pO1xuXG4gIHNlcnZlci5yb3V0ZSh7XG4gICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgcGF0aDogJy9hcGkvc2VjdXJpdHkvdjEvcm9sZXMve25hbWV9JyxcbiAgICBoYW5kbGVyKHJlcXVlc3QsIHJlcGx5KSB7XG4gICAgICBjb25zdCBuYW1lID0gcmVxdWVzdC5wYXJhbXMubmFtZTtcbiAgICAgIGNvbnN0IGJvZHkgPSBfLm9taXQocmVxdWVzdC5wYXlsb2FkLCAnbmFtZScpO1xuICAgICAgcmV0dXJuIGNhbGxXaXRoUmVxdWVzdChyZXF1ZXN0LCAnc2hpZWxkLnB1dFJvbGUnLCB7bmFtZSwgYm9keX0pLnRoZW4oXG4gICAgICAgICgpID0+IHJlcGx5KHJlcXVlc3QucGF5bG9hZCksXG4gICAgICAgIF8uZmxvdyh3cmFwRXJyb3IsIHJlcGx5KSk7XG4gICAgfSxcbiAgICBjb25maWc6IHtcbiAgICAgIHZhbGlkYXRlOiB7XG4gICAgICAgIHBheWxvYWQ6IHJvbGVTY2hlbWFcbiAgICAgIH0sXG4gICAgICBwcmU6IFtyb3V0ZVByZUNoZWNrTGljZW5zZUZuXVxuICAgIH1cbiAgfSk7XG5cbiAgc2VydmVyLnJvdXRlKHtcbiAgICBtZXRob2Q6ICdERUxFVEUnLFxuICAgIHBhdGg6ICcvYXBpL3NlY3VyaXR5L3YxL3JvbGVzL3tuYW1lfScsXG4gICAgaGFuZGxlcihyZXF1ZXN0LCByZXBseSkge1xuICAgICAgY29uc3QgbmFtZSA9IHJlcXVlc3QucGFyYW1zLm5hbWU7XG4gICAgICByZXR1cm4gY2FsbFdpdGhSZXF1ZXN0KHJlcXVlc3QsICdzaGllbGQuZGVsZXRlUm9sZScsIHtuYW1lfSkudGhlbihcbiAgICAgICAgKCkgPT4gcmVwbHkoKS5jb2RlKDIwNCksXG4gICAgICAgIF8uZmxvdyh3cmFwRXJyb3IsIHJlcGx5KSk7XG4gICAgfSxcbiAgICBjb25maWc6IHtcbiAgICAgIHByZTogW3JvdXRlUHJlQ2hlY2tMaWNlbnNlRm5dXG4gICAgfVxuICB9KTtcbn07XG4iXX0=",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/security/server/routes/api/v1/roles.js"
      ],
      "names": [],
      "mappings": "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",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/security/server/routes/api/v1/roles.js",
      "sourcesContent": [
        "import _ from 'lodash';\nimport Boom from 'boom';\nimport getClient from '../../../lib/get_client_shield';\nimport roleSchema from '../../../lib/role_schema';\nimport { wrapError } from '../../../lib/errors';\nimport routePreCheckLicense from '../../../lib/route_pre_check_license';\n\nexport default (server) => {\n  const callWithRequest = getClient(server).callWithRequest;\n  const routePreCheckLicenseFn = routePreCheckLicense(server);\n\n  server.route({\n    method: 'GET',\n    path: '/api/security/v1/roles',\n    handler(request, reply) {\n      return callWithRequest(request, 'shield.getRole').then(\n        (response) => {\n          const roles = _.map(response, (role, name) => _.assign(role, {name}));\n          return reply(roles);\n        },\n        _.flow(wrapError, reply)\n      );\n    },\n    config: {\n      pre: [routePreCheckLicenseFn]\n    }\n  });\n\n  server.route({\n    method: 'GET',\n    path: '/api/security/v1/roles/{name}',\n    handler(request, reply) {\n      const name = request.params.name;\n      return callWithRequest(request, 'shield.getRole', {name}).then(\n        (response) => {\n          if (response[name]) return reply(_.assign(response[name], {name}));\n          return reply(Boom.notFound());\n        },\n        _.flow(wrapError, reply));\n    },\n    config: {\n      pre: [routePreCheckLicenseFn]\n    }\n  });\n\n  server.route({\n    method: 'POST',\n    path: '/api/security/v1/roles/{name}',\n    handler(request, reply) {\n      const name = request.params.name;\n      const body = _.omit(request.payload, 'name');\n      return callWithRequest(request, 'shield.putRole', {name, body}).then(\n        () => reply(request.payload),\n        _.flow(wrapError, reply));\n    },\n    config: {\n      validate: {\n        payload: roleSchema\n      },\n      pre: [routePreCheckLicenseFn]\n    }\n  });\n\n  server.route({\n    method: 'DELETE',\n    path: '/api/security/v1/roles/{name}',\n    handler(request, reply) {\n      const name = request.params.name;\n      return callWithRequest(request, 'shield.deleteRole', {name}).then(\n        () => reply().code(204),\n        _.flow(wrapError, reply));\n    },\n    config: {\n      pre: [routePreCheckLicenseFn]\n    }\n  });\n};\n"
      ]
    },
    "mtime": 1491771515103
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/role_schema.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "joi",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "Joi"
              }
            ]
          }
        ],
        "exports": {
          "exported": [],
          "specifiers": []
        }
      },
      "usedHelpers": [
        "interop-require-default"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _joi = require('joi');\n\nvar _joi2 = _interopRequireDefault(_joi);\n\nexports['default'] = {\n  name: _joi2['default'].string().required(),\n  cluster: _joi2['default'].array().items(_joi2['default'].string()),\n  indices: _joi2['default'].array().items({\n    names: _joi2['default'].array().items(_joi2['default'].string()),\n    field_security: _joi2['default'].object().keys({\n      grant: _joi2['default'].array().items(_joi2['default'].string()),\n      except: _joi2['default'].array().items(_joi2['default'].string())\n    }),\n    privileges: _joi2['default'].array().items(_joi2['default'].string()),\n    query: _joi2['default'].string().allow('')\n  }),\n  run_as: _joi2['default'].array().items(_joi2['default'].string()),\n  metadata: _joi2['default'].object(),\n  transient_metadata: _joi2['default'].object()\n};\nmodule.exports = exports['default'];\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvc2VjdXJpdHkvc2VydmVyL2xpYi9yb2xlX3NjaGVtYS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7OzttQkFBZ0IsS0FBSzs7OztxQkFFTjtBQUNiLE1BQUksRUFBRSxpQkFBSSxNQUFNLEVBQUUsQ0FBQyxRQUFRLEVBQUU7QUFDN0IsU0FBTyxFQUFFLGlCQUFJLEtBQUssRUFBRSxDQUFDLEtBQUssQ0FBQyxpQkFBSSxNQUFNLEVBQUUsQ0FBQztBQUN4QyxTQUFPLEVBQUUsaUJBQUksS0FBSyxFQUFFLENBQUMsS0FBSyxDQUFDO0FBQ3pCLFNBQUssRUFBRSxpQkFBSSxLQUFLLEVBQUUsQ0FBQyxLQUFLLENBQUMsaUJBQUksTUFBTSxFQUFFLENBQUM7QUFDdEMsa0JBQWMsRUFBRSxpQkFBSSxNQUFNLEVBQUUsQ0FBQyxJQUFJLENBQUM7QUFDaEMsV0FBSyxFQUFFLGlCQUFJLEtBQUssRUFBRSxDQUFDLEtBQUssQ0FBQyxpQkFBSSxNQUFNLEVBQUUsQ0FBQztBQUN0QyxZQUFNLEVBQUcsaUJBQUksS0FBSyxFQUFFLENBQUMsS0FBSyxDQUFDLGlCQUFJLE1BQU0sRUFBRSxDQUFDO0tBQ3pDLENBQUM7QUFDRixjQUFVLEVBQUUsaUJBQUksS0FBSyxFQUFFLENBQUMsS0FBSyxDQUFDLGlCQUFJLE1BQU0sRUFBRSxDQUFDO0FBQzNDLFNBQUssRUFBRSxpQkFBSSxNQUFNLEVBQUUsQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDO0dBQzlCLENBQUM7QUFDRixRQUFNLEVBQUUsaUJBQUksS0FBSyxFQUFFLENBQUMsS0FBSyxDQUFDLGlCQUFJLE1BQU0sRUFBRSxDQUFDO0FBQ3ZDLFVBQVEsRUFBRSxpQkFBSSxNQUFNLEVBQUU7QUFDdEIsb0JBQWtCLEVBQUUsaUJBQUksTUFBTSxFQUFFO0NBQ2pDIiwiZmlsZSI6Ii91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvc2VjdXJpdHkvc2VydmVyL2xpYi9yb2xlX3NjaGVtYS5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBKb2kgZnJvbSAnam9pJztcblxuZXhwb3J0IGRlZmF1bHQge1xuICBuYW1lOiBKb2kuc3RyaW5nKCkucmVxdWlyZWQoKSxcbiAgY2x1c3RlcjogSm9pLmFycmF5KCkuaXRlbXMoSm9pLnN0cmluZygpKSxcbiAgaW5kaWNlczogSm9pLmFycmF5KCkuaXRlbXMoe1xuICAgIG5hbWVzOiBKb2kuYXJyYXkoKS5pdGVtcyhKb2kuc3RyaW5nKCkpLFxuICAgIGZpZWxkX3NlY3VyaXR5OiBKb2kub2JqZWN0KCkua2V5cyh7XG4gICAgICBncmFudDogSm9pLmFycmF5KCkuaXRlbXMoSm9pLnN0cmluZygpKSxcbiAgICAgIGV4Y2VwdDogIEpvaS5hcnJheSgpLml0ZW1zKEpvaS5zdHJpbmcoKSlcbiAgICB9KSxcbiAgICBwcml2aWxlZ2VzOiBKb2kuYXJyYXkoKS5pdGVtcyhKb2kuc3RyaW5nKCkpLFxuICAgIHF1ZXJ5OiBKb2kuc3RyaW5nKCkuYWxsb3coJycpXG4gIH0pLFxuICBydW5fYXM6IEpvaS5hcnJheSgpLml0ZW1zKEpvaS5zdHJpbmcoKSksXG4gIG1ldGFkYXRhOiBKb2kub2JqZWN0KCksXG4gIHRyYW5zaWVudF9tZXRhZGF0YTogSm9pLm9iamVjdCgpXG59O1xuIl19",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/role_schema.js"
      ],
      "names": [],
      "mappings": ";;;;;;;;mBAAgB,KAAK;;;;qBAEN;AACb,MAAI,EAAE,iBAAI,MAAM,EAAE,CAAC,QAAQ,EAAE;AAC7B,SAAO,EAAE,iBAAI,KAAK,EAAE,CAAC,KAAK,CAAC,iBAAI,MAAM,EAAE,CAAC;AACxC,SAAO,EAAE,iBAAI,KAAK,EAAE,CAAC,KAAK,CAAC;AACzB,SAAK,EAAE,iBAAI,KAAK,EAAE,CAAC,KAAK,CAAC,iBAAI,MAAM,EAAE,CAAC;AACtC,kBAAc,EAAE,iBAAI,MAAM,EAAE,CAAC,IAAI,CAAC;AAChC,WAAK,EAAE,iBAAI,KAAK,EAAE,CAAC,KAAK,CAAC,iBAAI,MAAM,EAAE,CAAC;AACtC,YAAM,EAAG,iBAAI,KAAK,EAAE,CAAC,KAAK,CAAC,iBAAI,MAAM,EAAE,CAAC;KACzC,CAAC;AACF,cAAU,EAAE,iBAAI,KAAK,EAAE,CAAC,KAAK,CAAC,iBAAI,MAAM,EAAE,CAAC;AAC3C,SAAK,EAAE,iBAAI,MAAM,EAAE,CAAC,KAAK,CAAC,EAAE,CAAC;GAC9B,CAAC;AACF,QAAM,EAAE,iBAAI,KAAK,EAAE,CAAC,KAAK,CAAC,iBAAI,MAAM,EAAE,CAAC;AACvC,UAAQ,EAAE,iBAAI,MAAM,EAAE;AACtB,oBAAkB,EAAE,iBAAI,MAAM,EAAE;CACjC",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/role_schema.js",
      "sourcesContent": [
        "import Joi from 'joi';\n\nexport default {\n  name: Joi.string().required(),\n  cluster: Joi.array().items(Joi.string()),\n  indices: Joi.array().items({\n    names: Joi.array().items(Joi.string()),\n    field_security: Joi.object().keys({\n      grant: Joi.array().items(Joi.string()),\n      except:  Joi.array().items(Joi.string())\n    }),\n    privileges: Joi.array().items(Joi.string()),\n    query: Joi.string().allow('')\n  }),\n  run_as: Joi.array().items(Joi.string()),\n  metadata: Joi.object(),\n  transient_metadata: Joi.object()\n};\n"
      ]
    },
    "mtime": 1491771510468
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/security/server/routes/api/v1/indices.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "lodash",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "_"
              }
            ]
          },
          {
            "source": "../../../lib/get_client_shield",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "getClient"
              }
            ]
          },
          {
            "source": "../../../lib/errors",
            "imported": [
              "wrapError"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "wrapError",
                "local": "wrapError"
              }
            ]
          }
        ],
        "exports": {
          "exported": [],
          "specifiers": []
        }
      },
      "usedHelpers": [
        "interop-require-default"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _lodash = require('lodash');\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _libGet_client_shield = require('../../../lib/get_client_shield');\n\nvar _libGet_client_shield2 = _interopRequireDefault(_libGet_client_shield);\n\nvar _libErrors = require('../../../lib/errors');\n\nexports['default'] = function (server) {\n  var callWithRequest = (0, _libGet_client_shield2['default'])(server).callWithRequest;\n\n  server.route({\n    method: 'GET',\n    path: '/api/security/v1/fields/{query}',\n    handler: function handler(request, reply) {\n      return callWithRequest(request, 'indices.getFieldMapping', {\n        index: request.params.query,\n        fields: '*',\n        allowNoIndices: false,\n        includeDefaults: true\n      }).then(function (mappings) {\n        return reply((0, _lodash2['default'])(mappings).map('mappings').map(_lodash2['default'].values).flatten().map(_lodash2['default'].keys).flatten().uniq().value());\n      })['catch'](_lodash2['default'].flow(_libErrors.wrapError, reply));\n    }\n  });\n};\n\nmodule.exports = exports['default'];\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvc2VjdXJpdHkvc2VydmVyL3JvdXRlcy9hcGkvdjEvaW5kaWNlcy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7OztzQkFBYyxRQUFROzs7O29DQUNBLGdDQUFnQzs7Ozt5QkFDNUIscUJBQXFCOztxQkFFaEMsVUFBQyxNQUFNLEVBQUs7QUFDekIsTUFBTSxlQUFlLEdBQUcsdUNBQVUsTUFBTSxDQUFDLENBQUMsZUFBZSxDQUFDOztBQUUxRCxRQUFNLENBQUMsS0FBSyxDQUFDO0FBQ1gsVUFBTSxFQUFFLEtBQUs7QUFDYixRQUFJLEVBQUUsaUNBQWlDO0FBQ3ZDLFdBQU8sRUFBQSxpQkFBQyxPQUFPLEVBQUUsS0FBSyxFQUFFO0FBQ3RCLGFBQU8sZUFBZSxDQUFDLE9BQU8sRUFBRSx5QkFBeUIsRUFBRTtBQUN6RCxhQUFLLEVBQUUsT0FBTyxDQUFDLE1BQU0sQ0FBQyxLQUFLO0FBQzNCLGNBQU0sRUFBRSxHQUFHO0FBQ1gsc0JBQWMsRUFBRSxLQUFLO0FBQ3JCLHVCQUFlLEVBQUUsSUFBSTtPQUN0QixDQUFDLENBQ0QsSUFBSSxDQUFDLFVBQUMsUUFBUTtlQUFLLEtBQUssQ0FDdkIseUJBQUUsUUFBUSxDQUFDLENBQ1YsR0FBRyxDQUFDLFVBQVUsQ0FBQyxDQUNmLEdBQUcsQ0FBQyxvQkFBRSxNQUFNLENBQUMsQ0FDYixPQUFPLEVBQUUsQ0FDVCxHQUFHLENBQUMsb0JBQUUsSUFBSSxDQUFDLENBQ1gsT0FBTyxFQUFFLENBQ1QsSUFBSSxFQUFFLENBQ04sS0FBSyxFQUFFLENBQ1Q7T0FBQSxDQUFDLFNBQ0ksQ0FBQyxvQkFBRSxJQUFJLHVCQUFZLEtBQUssQ0FBQyxDQUFDLENBQUM7S0FDbEM7R0FDRixDQUFDLENBQUM7Q0FDSiIsImZpbGUiOiIvdXNyL3NoYXJlL2tpYmFuYS9wbHVnaW5zL3gtcGFjay9wbHVnaW5zL3NlY3VyaXR5L3NlcnZlci9yb3V0ZXMvYXBpL3YxL2luZGljZXMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgXyBmcm9tICdsb2Rhc2gnO1xuaW1wb3J0IGdldENsaWVudCBmcm9tICcuLi8uLi8uLi9saWIvZ2V0X2NsaWVudF9zaGllbGQnO1xuaW1wb3J0IHsgd3JhcEVycm9yIH0gZnJvbSAnLi4vLi4vLi4vbGliL2Vycm9ycyc7XG5cbmV4cG9ydCBkZWZhdWx0IChzZXJ2ZXIpID0+IHtcbiAgY29uc3QgY2FsbFdpdGhSZXF1ZXN0ID0gZ2V0Q2xpZW50KHNlcnZlcikuY2FsbFdpdGhSZXF1ZXN0O1xuXG4gIHNlcnZlci5yb3V0ZSh7XG4gICAgbWV0aG9kOiAnR0VUJyxcbiAgICBwYXRoOiAnL2FwaS9zZWN1cml0eS92MS9maWVsZHMve3F1ZXJ5fScsXG4gICAgaGFuZGxlcihyZXF1ZXN0LCByZXBseSkge1xuICAgICAgcmV0dXJuIGNhbGxXaXRoUmVxdWVzdChyZXF1ZXN0LCAnaW5kaWNlcy5nZXRGaWVsZE1hcHBpbmcnLCB7XG4gICAgICAgIGluZGV4OiByZXF1ZXN0LnBhcmFtcy5xdWVyeSxcbiAgICAgICAgZmllbGRzOiAnKicsXG4gICAgICAgIGFsbG93Tm9JbmRpY2VzOiBmYWxzZSxcbiAgICAgICAgaW5jbHVkZURlZmF1bHRzOiB0cnVlXG4gICAgICB9KVxuICAgICAgLnRoZW4oKG1hcHBpbmdzKSA9PiByZXBseShcbiAgICAgICAgXyhtYXBwaW5ncylcbiAgICAgICAgLm1hcCgnbWFwcGluZ3MnKVxuICAgICAgICAubWFwKF8udmFsdWVzKVxuICAgICAgICAuZmxhdHRlbigpXG4gICAgICAgIC5tYXAoXy5rZXlzKVxuICAgICAgICAuZmxhdHRlbigpXG4gICAgICAgIC51bmlxKClcbiAgICAgICAgLnZhbHVlKClcbiAgICAgICkpXG4gICAgICAuY2F0Y2goXy5mbG93KHdyYXBFcnJvciwgcmVwbHkpKTtcbiAgICB9XG4gIH0pO1xufTtcbiJdfQ==",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/security/server/routes/api/v1/indices.js"
      ],
      "names": [],
      "mappings": ";;;;;;;;sBAAc,QAAQ;;;;oCACA,gCAAgC;;;;yBAC5B,qBAAqB;;qBAEhC,UAAC,MAAM,EAAK;AACzB,MAAM,eAAe,GAAG,uCAAU,MAAM,CAAC,CAAC,eAAe,CAAC;;AAE1D,QAAM,CAAC,KAAK,CAAC;AACX,UAAM,EAAE,KAAK;AACb,QAAI,EAAE,iCAAiC;AACvC,WAAO,EAAA,iBAAC,OAAO,EAAE,KAAK,EAAE;AACtB,aAAO,eAAe,CAAC,OAAO,EAAE,yBAAyB,EAAE;AACzD,aAAK,EAAE,OAAO,CAAC,MAAM,CAAC,KAAK;AAC3B,cAAM,EAAE,GAAG;AACX,sBAAc,EAAE,KAAK;AACrB,uBAAe,EAAE,IAAI;OACtB,CAAC,CACD,IAAI,CAAC,UAAC,QAAQ;eAAK,KAAK,CACvB,yBAAE,QAAQ,CAAC,CACV,GAAG,CAAC,UAAU,CAAC,CACf,GAAG,CAAC,oBAAE,MAAM,CAAC,CACb,OAAO,EAAE,CACT,GAAG,CAAC,oBAAE,IAAI,CAAC,CACX,OAAO,EAAE,CACT,IAAI,EAAE,CACN,KAAK,EAAE,CACT;OAAA,CAAC,SACI,CAAC,oBAAE,IAAI,uBAAY,KAAK,CAAC,CAAC,CAAC;KAClC;GACF,CAAC,CAAC;CACJ",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/security/server/routes/api/v1/indices.js",
      "sourcesContent": [
        "import _ from 'lodash';\nimport getClient from '../../../lib/get_client_shield';\nimport { wrapError } from '../../../lib/errors';\n\nexport default (server) => {\n  const callWithRequest = getClient(server).callWithRequest;\n\n  server.route({\n    method: 'GET',\n    path: '/api/security/v1/fields/{query}',\n    handler(request, reply) {\n      return callWithRequest(request, 'indices.getFieldMapping', {\n        index: request.params.query,\n        fields: '*',\n        allowNoIndices: false,\n        includeDefaults: true\n      })\n      .then((mappings) => reply(\n        _(mappings)\n        .map('mappings')\n        .map(_.values)\n        .flatten()\n        .map(_.keys)\n        .flatten()\n        .uniq()\n        .value()\n      ))\n      .catch(_.flow(wrapError, reply));\n    }\n  });\n};\n"
      ]
    },
    "mtime": 1491771515103
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/security/server/routes/views/login.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "lodash",
            "imported": [
              "get"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "get",
                "local": "get"
              }
            ]
          }
        ],
        "exports": {
          "exported": [],
          "specifiers": []
        }
      },
      "usedHelpers": []
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nvar _lodash = require('lodash');\n\nexports['default'] = function (server, uiExports, xpackMainPlugin) {\n  var config = server.config();\n  var cookieName = config.get('xpack.security.cookieName');\n  var login = uiExports.apps.byId.login;\n\n  server.route({\n    method: 'GET',\n    path: '/login',\n    handler: function handler(request, reply) {\n\n      var xpackInfo = xpackMainPlugin && xpackMainPlugin.info;\n      var licenseCheckResults = xpackInfo && xpackInfo.isAvailable() && xpackInfo.feature('security').getLicenseCheckResults();\n      var showLogin = (0, _lodash.get)(licenseCheckResults, 'showLogin');\n\n      var isUserAlreadyLoggedIn = !!request.state[cookieName];\n      if (isUserAlreadyLoggedIn || !showLogin) {\n        var next = (0, _lodash.get)(request, 'query.next', '/');\n        return reply.redirect('' + config.get('server.basePath') + next);\n      }\n      return reply.renderAppWithDefaultConfig(login);\n    },\n    config: {\n      auth: false\n    }\n  });\n};\n\nmodule.exports = exports['default'];\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvc2VjdXJpdHkvc2VydmVyL3JvdXRlcy92aWV3cy9sb2dpbi5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7c0JBQW9CLFFBQVE7O3FCQUViLFVBQUMsTUFBTSxFQUFFLFNBQVMsRUFBRSxlQUFlLEVBQUs7QUFDckQsTUFBTSxNQUFNLEdBQUcsTUFBTSxDQUFDLE1BQU0sRUFBRSxDQUFDO0FBQy9CLE1BQU0sVUFBVSxHQUFHLE1BQU0sQ0FBQyxHQUFHLENBQUMsMkJBQTJCLENBQUMsQ0FBQztBQUMzRCxNQUFNLEtBQUssR0FBRyxTQUFTLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUM7O0FBRXhDLFFBQU0sQ0FBQyxLQUFLLENBQUM7QUFDWCxVQUFNLEVBQUUsS0FBSztBQUNiLFFBQUksRUFBRSxRQUFRO0FBQ2QsV0FBTyxFQUFBLGlCQUFDLE9BQU8sRUFBRSxLQUFLLEVBQUU7O0FBRXRCLFVBQU0sU0FBUyxHQUFHLGVBQWUsSUFBSSxlQUFlLENBQUMsSUFBSSxDQUFDO0FBQzFELFVBQU0sbUJBQW1CLEdBQUcsU0FBUyxJQUFJLFNBQVMsQ0FBQyxXQUFXLEVBQUUsSUFBSSxTQUFTLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQyxDQUFDLHNCQUFzQixFQUFFLENBQUM7QUFDM0gsVUFBTSxTQUFTLEdBQUcsaUJBQUksbUJBQW1CLEVBQUUsV0FBVyxDQUFDLENBQUM7O0FBRXhELFVBQU0scUJBQXFCLEdBQUcsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsVUFBVSxDQUFDLENBQUM7QUFDMUQsVUFBSSxxQkFBcUIsSUFBSSxDQUFDLFNBQVMsRUFBRTtBQUN2QyxZQUFNLElBQUksR0FBRyxpQkFBSSxPQUFPLEVBQUUsWUFBWSxFQUFFLEdBQUcsQ0FBQyxDQUFDO0FBQzdDLGVBQU8sS0FBSyxDQUFDLFFBQVEsTUFBSSxNQUFNLENBQUMsR0FBRyxDQUFDLGlCQUFpQixDQUFDLEdBQUcsSUFBSSxDQUFHLENBQUM7T0FDbEU7QUFDRCxhQUFPLEtBQUssQ0FBQywwQkFBMEIsQ0FBQyxLQUFLLENBQUMsQ0FBQztLQUNoRDtBQUNELFVBQU0sRUFBRTtBQUNOLFVBQUksRUFBRSxLQUFLO0tBQ1o7R0FDRixDQUFDLENBQUM7Q0FDSiIsImZpbGUiOiIvdXNyL3NoYXJlL2tpYmFuYS9wbHVnaW5zL3gtcGFjay9wbHVnaW5zL3NlY3VyaXR5L3NlcnZlci9yb3V0ZXMvdmlld3MvbG9naW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBnZXQgfSBmcm9tICdsb2Rhc2gnO1xuXG5leHBvcnQgZGVmYXVsdCAoc2VydmVyLCB1aUV4cG9ydHMsIHhwYWNrTWFpblBsdWdpbikgPT4ge1xuICBjb25zdCBjb25maWcgPSBzZXJ2ZXIuY29uZmlnKCk7XG4gIGNvbnN0IGNvb2tpZU5hbWUgPSBjb25maWcuZ2V0KCd4cGFjay5zZWN1cml0eS5jb29raWVOYW1lJyk7XG4gIGNvbnN0IGxvZ2luID0gdWlFeHBvcnRzLmFwcHMuYnlJZC5sb2dpbjtcblxuICBzZXJ2ZXIucm91dGUoe1xuICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgcGF0aDogJy9sb2dpbicsXG4gICAgaGFuZGxlcihyZXF1ZXN0LCByZXBseSkge1xuXG4gICAgICBjb25zdCB4cGFja0luZm8gPSB4cGFja01haW5QbHVnaW4gJiYgeHBhY2tNYWluUGx1Z2luLmluZm87XG4gICAgICBjb25zdCBsaWNlbnNlQ2hlY2tSZXN1bHRzID0geHBhY2tJbmZvICYmIHhwYWNrSW5mby5pc0F2YWlsYWJsZSgpICYmIHhwYWNrSW5mby5mZWF0dXJlKCdzZWN1cml0eScpLmdldExpY2Vuc2VDaGVja1Jlc3VsdHMoKTtcbiAgICAgIGNvbnN0IHNob3dMb2dpbiA9IGdldChsaWNlbnNlQ2hlY2tSZXN1bHRzLCAnc2hvd0xvZ2luJyk7XG5cbiAgICAgIGNvbnN0IGlzVXNlckFscmVhZHlMb2dnZWRJbiA9ICEhcmVxdWVzdC5zdGF0ZVtjb29raWVOYW1lXTtcbiAgICAgIGlmIChpc1VzZXJBbHJlYWR5TG9nZ2VkSW4gfHwgIXNob3dMb2dpbikge1xuICAgICAgICBjb25zdCBuZXh0ID0gZ2V0KHJlcXVlc3QsICdxdWVyeS5uZXh0JywgJy8nKTtcbiAgICAgICAgcmV0dXJuIHJlcGx5LnJlZGlyZWN0KGAke2NvbmZpZy5nZXQoJ3NlcnZlci5iYXNlUGF0aCcpfSR7bmV4dH1gKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiByZXBseS5yZW5kZXJBcHBXaXRoRGVmYXVsdENvbmZpZyhsb2dpbik7XG4gICAgfSxcbiAgICBjb25maWc6IHtcbiAgICAgIGF1dGg6IGZhbHNlXG4gICAgfVxuICB9KTtcbn07XG4iXX0=",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/security/server/routes/views/login.js"
      ],
      "names": [],
      "mappings": ";;;;;;sBAAoB,QAAQ;;qBAEb,UAAC,MAAM,EAAE,SAAS,EAAE,eAAe,EAAK;AACrD,MAAM,MAAM,GAAG,MAAM,CAAC,MAAM,EAAE,CAAC;AAC/B,MAAM,UAAU,GAAG,MAAM,CAAC,GAAG,CAAC,2BAA2B,CAAC,CAAC;AAC3D,MAAM,KAAK,GAAG,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC;;AAExC,QAAM,CAAC,KAAK,CAAC;AACX,UAAM,EAAE,KAAK;AACb,QAAI,EAAE,QAAQ;AACd,WAAO,EAAA,iBAAC,OAAO,EAAE,KAAK,EAAE;;AAEtB,UAAM,SAAS,GAAG,eAAe,IAAI,eAAe,CAAC,IAAI,CAAC;AAC1D,UAAM,mBAAmB,GAAG,SAAS,IAAI,SAAS,CAAC,WAAW,EAAE,IAAI,SAAS,CAAC,OAAO,CAAC,UAAU,CAAC,CAAC,sBAAsB,EAAE,CAAC;AAC3H,UAAM,SAAS,GAAG,iBAAI,mBAAmB,EAAE,WAAW,CAAC,CAAC;;AAExD,UAAM,qBAAqB,GAAG,CAAC,CAAC,OAAO,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC;AAC1D,UAAI,qBAAqB,IAAI,CAAC,SAAS,EAAE;AACvC,YAAM,IAAI,GAAG,iBAAI,OAAO,EAAE,YAAY,EAAE,GAAG,CAAC,CAAC;AAC7C,eAAO,KAAK,CAAC,QAAQ,MAAI,MAAM,CAAC,GAAG,CAAC,iBAAiB,CAAC,GAAG,IAAI,CAAG,CAAC;OAClE;AACD,aAAO,KAAK,CAAC,0BAA0B,CAAC,KAAK,CAAC,CAAC;KAChD;AACD,UAAM,EAAE;AACN,UAAI,EAAE,KAAK;KACZ;GACF,CAAC,CAAC;CACJ",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/security/server/routes/views/login.js",
      "sourcesContent": [
        "import { get } from 'lodash';\n\nexport default (server, uiExports, xpackMainPlugin) => {\n  const config = server.config();\n  const cookieName = config.get('xpack.security.cookieName');\n  const login = uiExports.apps.byId.login;\n\n  server.route({\n    method: 'GET',\n    path: '/login',\n    handler(request, reply) {\n\n      const xpackInfo = xpackMainPlugin && xpackMainPlugin.info;\n      const licenseCheckResults = xpackInfo && xpackInfo.isAvailable() && xpackInfo.feature('security').getLicenseCheckResults();\n      const showLogin = get(licenseCheckResults, 'showLogin');\n\n      const isUserAlreadyLoggedIn = !!request.state[cookieName];\n      if (isUserAlreadyLoggedIn || !showLogin) {\n        const next = get(request, 'query.next', '/');\n        return reply.redirect(`${config.get('server.basePath')}${next}`);\n      }\n      return reply.renderAppWithDefaultConfig(login);\n    },\n    config: {\n      auth: false\n    }\n  });\n};\n"
      ]
    },
    "mtime": 1491771513552
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/security/server/routes/views/logout.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [],
        "exports": {
          "exported": [],
          "specifiers": []
        }
      },
      "usedHelpers": []
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nexports['default'] = function (server, uiExports) {\n  var logout = uiExports.apps.byId.logout;\n\n  server.route({\n    method: 'GET',\n    path: '/logout',\n    handler: function handler(request, reply) {\n      return reply.renderAppWithDefaultConfig(logout);\n    },\n    config: {\n      auth: false\n    }\n  });\n};\n\nmodule.exports = exports['default'];\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvc2VjdXJpdHkvc2VydmVyL3JvdXRlcy92aWV3cy9sb2dvdXQuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7O3FCQUFlLFVBQUMsTUFBTSxFQUFFLFNBQVMsRUFBSztBQUNwQyxNQUFNLE1BQU0sR0FBRyxTQUFTLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUM7O0FBRTFDLFFBQU0sQ0FBQyxLQUFLLENBQUM7QUFDWCxVQUFNLEVBQUUsS0FBSztBQUNiLFFBQUksRUFBRSxTQUFTO0FBQ2YsV0FBTyxFQUFBLGlCQUFDLE9BQU8sRUFBRSxLQUFLLEVBQUU7QUFDdEIsYUFBTyxLQUFLLENBQUMsMEJBQTBCLENBQUMsTUFBTSxDQUFDLENBQUM7S0FDakQ7QUFDRCxVQUFNLEVBQUU7QUFDTixVQUFJLEVBQUUsS0FBSztLQUNaO0dBQ0YsQ0FBQyxDQUFDO0NBQ0oiLCJmaWxlIjoiL3Vzci9zaGFyZS9raWJhbmEvcGx1Z2lucy94LXBhY2svcGx1Z2lucy9zZWN1cml0eS9zZXJ2ZXIvcm91dGVzL3ZpZXdzL2xvZ291dC5qcyIsInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IChzZXJ2ZXIsIHVpRXhwb3J0cykgPT4ge1xuICBjb25zdCBsb2dvdXQgPSB1aUV4cG9ydHMuYXBwcy5ieUlkLmxvZ291dDtcblxuICBzZXJ2ZXIucm91dGUoe1xuICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgcGF0aDogJy9sb2dvdXQnLFxuICAgIGhhbmRsZXIocmVxdWVzdCwgcmVwbHkpIHtcbiAgICAgIHJldHVybiByZXBseS5yZW5kZXJBcHBXaXRoRGVmYXVsdENvbmZpZyhsb2dvdXQpO1xuICAgIH0sXG4gICAgY29uZmlnOiB7XG4gICAgICBhdXRoOiBmYWxzZVxuICAgIH1cbiAgfSk7XG59O1xuIl19",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/security/server/routes/views/logout.js"
      ],
      "names": [],
      "mappings": ";;;;;;qBAAe,UAAC,MAAM,EAAE,SAAS,EAAK;AACpC,MAAM,MAAM,GAAG,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC;;AAE1C,QAAM,CAAC,KAAK,CAAC;AACX,UAAM,EAAE,KAAK;AACb,QAAI,EAAE,SAAS;AACf,WAAO,EAAA,iBAAC,OAAO,EAAE,KAAK,EAAE;AACtB,aAAO,KAAK,CAAC,0BAA0B,CAAC,MAAM,CAAC,CAAC;KACjD;AACD,UAAM,EAAE;AACN,UAAI,EAAE,KAAK;KACZ;GACF,CAAC,CAAC;CACJ",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/security/server/routes/views/logout.js",
      "sourcesContent": [
        "export default (server, uiExports) => {\n  const logout = uiExports.apps.byId.logout;\n\n  server.route({\n    method: 'GET',\n    path: '/logout',\n    handler(request, reply) {\n      return reply.renderAppWithDefaultConfig(logout);\n    },\n    config: {\n      auth: false\n    }\n  });\n};\n"
      ]
    },
    "mtime": 1491771513552
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/validate_config.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [],
        "exports": {
          "exported": [],
          "specifiers": []
        }
      },
      "usedHelpers": []
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nvar crypto = require('crypto');\n\nexports['default'] = function (config, log) {\n  if (config.get('xpack.security.encryptionKey') == null) {\n    log('Generating a random key for xpack.security.encryptionKey. To prevent sessions from being invalidated on ' + 'restart, please set xpack.security.encryptionKey in kibana.yml');\n\n    config.set('xpack.security.encryptionKey', crypto.randomBytes(16).toString('hex'));\n  } else if (config.get('xpack.security.encryptionKey').length < 32) {\n    throw new Error('xpack.security.encryptionKey must be at least 32 characters. Please update the key in kibana.yml.');\n  }\n\n  var isSslConfigured = config.get('server.ssl.key') != null && config.get('server.ssl.certificate') != null;\n  if (!isSslConfigured) {\n    if (config.get('xpack.security.secureCookies')) {\n      log('Using secure cookies, but SSL is not enabled inside Kibana. SSL must be configured outside of Kibana to ' + 'function properly.');\n    } else {\n      log('Session cookies will be transmitted over insecure connections. This is not recommended.');\n    }\n  } else {\n    config.set('xpack.security.secureCookies', true);\n  }\n};\n\nmodule.exports = exports['default'];\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvc2VjdXJpdHkvc2VydmVyL2xpYi92YWxpZGF0ZV9jb25maWcuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxJQUFNLE1BQU0sR0FBRyxPQUFPLENBQUMsUUFBUSxDQUFDLENBQUM7O3FCQUVsQixVQUFDLE1BQU0sRUFBRSxHQUFHLEVBQUs7QUFDOUIsTUFBSSxNQUFNLENBQUMsR0FBRyxDQUFDLDhCQUE4QixDQUFDLElBQUksSUFBSSxFQUFFO0FBQ3RELE9BQUcsQ0FBQywwR0FBMEcsR0FDNUcsZ0VBQWdFLENBQUMsQ0FBQzs7QUFFcEUsVUFBTSxDQUFDLEdBQUcsQ0FBQyw4QkFBOEIsRUFBRSxNQUFNLENBQUMsV0FBVyxDQUFDLEVBQUUsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO0dBQ3BGLE1BQU0sSUFBSSxNQUFNLENBQUMsR0FBRyxDQUFDLDhCQUE4QixDQUFDLENBQUMsTUFBTSxHQUFHLEVBQUUsRUFBRTtBQUNqRSxVQUFNLElBQUksS0FBSyxDQUFDLG1HQUFtRyxDQUFDLENBQUM7R0FDdEg7O0FBRUQsTUFBTSxlQUFlLEdBQUcsTUFBTSxDQUFDLEdBQUcsQ0FBQyxnQkFBZ0IsQ0FBQyxJQUFJLElBQUksSUFBSSxNQUFNLENBQUMsR0FBRyxDQUFDLHdCQUF3QixDQUFDLElBQUksSUFBSSxDQUFDO0FBQzdHLE1BQUksQ0FBQyxlQUFlLEVBQUU7QUFDcEIsUUFBSSxNQUFNLENBQUMsR0FBRyxDQUFDLDhCQUE4QixDQUFDLEVBQUU7QUFDOUMsU0FBRyxDQUFDLDBHQUEwRyxHQUM1RyxvQkFBb0IsQ0FBQyxDQUFDO0tBQ3pCLE1BQU07QUFDTCxTQUFHLENBQUMseUZBQXlGLENBQUMsQ0FBQztLQUNoRztHQUNGLE1BQU07QUFDTCxVQUFNLENBQUMsR0FBRyxDQUFDLDhCQUE4QixFQUFFLElBQUksQ0FBQyxDQUFDO0dBQ2xEO0NBQ0YiLCJmaWxlIjoiL3Vzci9zaGFyZS9raWJhbmEvcGx1Z2lucy94LXBhY2svcGx1Z2lucy9zZWN1cml0eS9zZXJ2ZXIvbGliL3ZhbGlkYXRlX2NvbmZpZy5qcyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGNyeXB0byA9IHJlcXVpcmUoJ2NyeXB0bycpO1xuXG5leHBvcnQgZGVmYXVsdCAoY29uZmlnLCBsb2cpID0+IHtcbiAgaWYgKGNvbmZpZy5nZXQoJ3hwYWNrLnNlY3VyaXR5LmVuY3J5cHRpb25LZXknKSA9PSBudWxsKSB7XG4gICAgbG9nKCdHZW5lcmF0aW5nIGEgcmFuZG9tIGtleSBmb3IgeHBhY2suc2VjdXJpdHkuZW5jcnlwdGlvbktleS4gVG8gcHJldmVudCBzZXNzaW9ucyBmcm9tIGJlaW5nIGludmFsaWRhdGVkIG9uICcgK1xuICAgICAgJ3Jlc3RhcnQsIHBsZWFzZSBzZXQgeHBhY2suc2VjdXJpdHkuZW5jcnlwdGlvbktleSBpbiBraWJhbmEueW1sJyk7XG5cbiAgICBjb25maWcuc2V0KCd4cGFjay5zZWN1cml0eS5lbmNyeXB0aW9uS2V5JywgY3J5cHRvLnJhbmRvbUJ5dGVzKDE2KS50b1N0cmluZygnaGV4JykpO1xuICB9IGVsc2UgaWYgKGNvbmZpZy5nZXQoJ3hwYWNrLnNlY3VyaXR5LmVuY3J5cHRpb25LZXknKS5sZW5ndGggPCAzMikge1xuICAgIHRocm93IG5ldyBFcnJvcigneHBhY2suc2VjdXJpdHkuZW5jcnlwdGlvbktleSBtdXN0IGJlIGF0IGxlYXN0IDMyIGNoYXJhY3RlcnMuIFBsZWFzZSB1cGRhdGUgdGhlIGtleSBpbiBraWJhbmEueW1sLicpO1xuICB9XG5cbiAgY29uc3QgaXNTc2xDb25maWd1cmVkID0gY29uZmlnLmdldCgnc2VydmVyLnNzbC5rZXknKSAhPSBudWxsICYmIGNvbmZpZy5nZXQoJ3NlcnZlci5zc2wuY2VydGlmaWNhdGUnKSAhPSBudWxsO1xuICBpZiAoIWlzU3NsQ29uZmlndXJlZCkge1xuICAgIGlmIChjb25maWcuZ2V0KCd4cGFjay5zZWN1cml0eS5zZWN1cmVDb29raWVzJykpIHtcbiAgICAgIGxvZygnVXNpbmcgc2VjdXJlIGNvb2tpZXMsIGJ1dCBTU0wgaXMgbm90IGVuYWJsZWQgaW5zaWRlIEtpYmFuYS4gU1NMIG11c3QgYmUgY29uZmlndXJlZCBvdXRzaWRlIG9mIEtpYmFuYSB0byAnICtcbiAgICAgICAgJ2Z1bmN0aW9uIHByb3Blcmx5LicpO1xuICAgIH0gZWxzZSB7XG4gICAgICBsb2coJ1Nlc3Npb24gY29va2llcyB3aWxsIGJlIHRyYW5zbWl0dGVkIG92ZXIgaW5zZWN1cmUgY29ubmVjdGlvbnMuIFRoaXMgaXMgbm90IHJlY29tbWVuZGVkLicpO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBjb25maWcuc2V0KCd4cGFjay5zZWN1cml0eS5zZWN1cmVDb29raWVzJywgdHJ1ZSk7XG4gIH1cbn07XG4iXX0=",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/validate_config.js"
      ],
      "names": [],
      "mappings": ";;;;;AAAA,IAAM,MAAM,GAAG,OAAO,CAAC,QAAQ,CAAC,CAAC;;qBAElB,UAAC,MAAM,EAAE,GAAG,EAAK;AAC9B,MAAI,MAAM,CAAC,GAAG,CAAC,8BAA8B,CAAC,IAAI,IAAI,EAAE;AACtD,OAAG,CAAC,0GAA0G,GAC5G,gEAAgE,CAAC,CAAC;;AAEpE,UAAM,CAAC,GAAG,CAAC,8BAA8B,EAAE,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,CAAC;GACpF,MAAM,IAAI,MAAM,CAAC,GAAG,CAAC,8BAA8B,CAAC,CAAC,MAAM,GAAG,EAAE,EAAE;AACjE,UAAM,IAAI,KAAK,CAAC,mGAAmG,CAAC,CAAC;GACtH;;AAED,MAAM,eAAe,GAAG,MAAM,CAAC,GAAG,CAAC,gBAAgB,CAAC,IAAI,IAAI,IAAI,MAAM,CAAC,GAAG,CAAC,wBAAwB,CAAC,IAAI,IAAI,CAAC;AAC7G,MAAI,CAAC,eAAe,EAAE;AACpB,QAAI,MAAM,CAAC,GAAG,CAAC,8BAA8B,CAAC,EAAE;AAC9C,SAAG,CAAC,0GAA0G,GAC5G,oBAAoB,CAAC,CAAC;KACzB,MAAM;AACL,SAAG,CAAC,yFAAyF,CAAC,CAAC;KAChG;GACF,MAAM;AACL,UAAM,CAAC,GAAG,CAAC,8BAA8B,EAAE,IAAI,CAAC,CAAC;GAClD;CACF",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/validate_config.js",
      "sourcesContent": [
        "const crypto = require('crypto');\n\nexport default (config, log) => {\n  if (config.get('xpack.security.encryptionKey') == null) {\n    log('Generating a random key for xpack.security.encryptionKey. To prevent sessions from being invalidated on ' +\n      'restart, please set xpack.security.encryptionKey in kibana.yml');\n\n    config.set('xpack.security.encryptionKey', crypto.randomBytes(16).toString('hex'));\n  } else if (config.get('xpack.security.encryptionKey').length < 32) {\n    throw new Error('xpack.security.encryptionKey must be at least 32 characters. Please update the key in kibana.yml.');\n  }\n\n  const isSslConfigured = config.get('server.ssl.key') != null && config.get('server.ssl.certificate') != null;\n  if (!isSslConfigured) {\n    if (config.get('xpack.security.secureCookies')) {\n      log('Using secure cookies, but SSL is not enabled inside Kibana. SSL must be configured outside of Kibana to ' +\n        'function properly.');\n    } else {\n      log('Session cookies will be transmitted over insecure connections. This is not recommended.');\n    }\n  } else {\n    config.set('xpack.security.secureCookies', true);\n  }\n};\n"
      ]
    },
    "mtime": 1491771510468
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/set_elasticsearch_auth.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "./default_auth",
            "imported": [
              "USERNAME",
              "PASSWORD"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "USERNAME",
                "local": "USERNAME"
              },
              {
                "kind": "named",
                "imported": "PASSWORD",
                "local": "PASSWORD"
              }
            ]
          }
        ],
        "exports": {
          "exported": [],
          "specifiers": []
        }
      },
      "usedHelpers": []
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nvar _default_auth = require('./default_auth');\n\nexports['default'] = function (config) {\n  var _config$get = config.get('elasticsearch');\n\n  var username = _config$get.username;\n  var password = _config$get.password;\n\n  if (!username) config.set('elasticsearch.username', _default_auth.USERNAME);\n  if (!password) config.set('elasticsearch.password', _default_auth.PASSWORD);\n};\n\nmodule.exports = exports['default'];\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvc2VjdXJpdHkvc2VydmVyL2xpYi9zZXRfZWxhc3RpY3NlYXJjaF9hdXRoLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs0QkFBaUMsZ0JBQWdCOztxQkFFbEMsVUFBQyxNQUFNLEVBQUs7b0JBQ0ksTUFBTSxDQUFDLEdBQUcsQ0FBQyxlQUFlLENBQUM7O01BQWpELFFBQVEsZUFBUixRQUFRO01BQUUsUUFBUSxlQUFSLFFBQVE7O0FBQ3pCLE1BQUksQ0FBQyxRQUFRLEVBQUUsTUFBTSxDQUFDLEdBQUcsQ0FBQyx3QkFBd0IseUJBQVcsQ0FBQztBQUM5RCxNQUFJLENBQUMsUUFBUSxFQUFFLE1BQU0sQ0FBQyxHQUFHLENBQUMsd0JBQXdCLHlCQUFXLENBQUM7Q0FDL0QiLCJmaWxlIjoiL3Vzci9zaGFyZS9raWJhbmEvcGx1Z2lucy94LXBhY2svcGx1Z2lucy9zZWN1cml0eS9zZXJ2ZXIvbGliL3NldF9lbGFzdGljc2VhcmNoX2F1dGguanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1VTRVJOQU1FLCBQQVNTV09SRH0gZnJvbSAnLi9kZWZhdWx0X2F1dGgnO1xuXG5leHBvcnQgZGVmYXVsdCAoY29uZmlnKSA9PiB7XG4gIGNvbnN0IHt1c2VybmFtZSwgcGFzc3dvcmR9ID0gY29uZmlnLmdldCgnZWxhc3RpY3NlYXJjaCcpO1xuICBpZiAoIXVzZXJuYW1lKSBjb25maWcuc2V0KCdlbGFzdGljc2VhcmNoLnVzZXJuYW1lJywgVVNFUk5BTUUpO1xuICBpZiAoIXBhc3N3b3JkKSBjb25maWcuc2V0KCdlbGFzdGljc2VhcmNoLnBhc3N3b3JkJywgUEFTU1dPUkQpO1xufTtcbiJdfQ==",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/set_elasticsearch_auth.js"
      ],
      "names": [],
      "mappings": ";;;;;;4BAAiC,gBAAgB;;qBAElC,UAAC,MAAM,EAAK;oBACI,MAAM,CAAC,GAAG,CAAC,eAAe,CAAC;;MAAjD,QAAQ,eAAR,QAAQ;MAAE,QAAQ,eAAR,QAAQ;;AACzB,MAAI,CAAC,QAAQ,EAAE,MAAM,CAAC,GAAG,CAAC,wBAAwB,yBAAW,CAAC;AAC9D,MAAI,CAAC,QAAQ,EAAE,MAAM,CAAC,GAAG,CAAC,wBAAwB,yBAAW,CAAC;CAC/D",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/set_elasticsearch_auth.js",
      "sourcesContent": [
        "import {USERNAME, PASSWORD} from './default_auth';\n\nexport default (config) => {\n  const {username, password} = config.get('elasticsearch');\n  if (!username) config.set('elasticsearch.username', USERNAME);\n  if (!password) config.set('elasticsearch.password', PASSWORD);\n};\n"
      ]
    },
    "mtime": 1491771510468
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/default_auth.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [],
        "exports": {
          "exported": [],
          "specifiers": []
        }
      },
      "usedHelpers": []
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nexports['default'] = Object.freeze({\n  USERNAME: 'kibana',\n  PASSWORD: 'changeme'\n});\nmodule.exports = exports['default'];\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvc2VjdXJpdHkvc2VydmVyL2xpYi9kZWZhdWx0X2F1dGguanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7cUJBQWUsTUFBTSxDQUFDLE1BQU0sQ0FBQztBQUMzQixVQUFRLEVBQUUsUUFBUTtBQUNsQixVQUFRLEVBQUUsVUFBVTtDQUNyQixDQUFDIiwiZmlsZSI6Ii91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvc2VjdXJpdHkvc2VydmVyL2xpYi9kZWZhdWx0X2F1dGguanMiLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBPYmplY3QuZnJlZXplKHtcbiAgVVNFUk5BTUU6ICdraWJhbmEnLFxuICBQQVNTV09SRDogJ2NoYW5nZW1lJ1xufSk7XG4iXX0=",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/default_auth.js"
      ],
      "names": [],
      "mappings": ";;;;;qBAAe,MAAM,CAAC,MAAM,CAAC;AAC3B,UAAQ,EAAE,QAAQ;AAClB,UAAQ,EAAE,UAAU;CACrB,CAAC",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/default_auth.js",
      "sourcesContent": [
        "export default Object.freeze({\n  USERNAME: 'kibana',\n  PASSWORD: 'changeme'\n});\n"
      ]
    },
    "mtime": 1491771510468
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/login_scheme.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "./auth_redirect",
            "imported": [
              "*"
            ],
            "specifiers": [
              {
                "kind": "namespace",
                "local": "authRedirect"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "createScheme",
            "redirectUrl",
            "strategies"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "createScheme",
              "exported": "default"
            },
            {
              "kind": "local",
              "local": "redirectUrl",
              "exported": "default"
            },
            {
              "kind": "local",
              "local": "strategies",
              "exported": "default"
            }
          ]
        }
      },
      "usedHelpers": [
        "interop-require-wildcard"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nexports['default'] = createScheme;\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj['default'] = obj; return newObj; } }\n\nvar _auth_redirect = require('./auth_redirect');\n\nvar authRedirect = _interopRequireWildcard(_auth_redirect);\n\n/**\n * Creates a hapi auth scheme with conditional session\n * expiration handling based on each request\n *\n * @param {object}\n *    redirectUrl: Transform function that request path is passed to before\n *                 redirecting\n *    strategy:    The name of the auth strategy to use for test\n * @return {Function}\n */\n\nfunction createScheme(_ref) {\n  var redirectUrl = _ref.redirectUrl;\n  var strategies = _ref.strategies;\n\n  return function (server) {\n    var authenticate = authRedirect['default']({\n      redirectUrl: redirectUrl,\n      strategies: strategies,\n      testRequest: server.auth.test,\n      xpackMainPlugin: server.plugins.xpack_main\n    });\n    return { authenticate: authenticate };\n  };\n}\n\nmodule.exports = exports['default'];\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvc2VjdXJpdHkvc2VydmVyL2xpYi9sb2dpbl9zY2hlbWUuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7cUJBWXdCLFlBQVk7Ozs7NkJBWk4saUJBQWlCOztJQUFuQyxZQUFZOzs7Ozs7Ozs7Ozs7O0FBWVQsU0FBUyxZQUFZLENBQUMsSUFBMkIsRUFBRTtNQUEzQixXQUFXLEdBQWIsSUFBMkIsQ0FBekIsV0FBVztNQUFFLFVBQVUsR0FBekIsSUFBMkIsQ0FBWixVQUFVOztBQUM1RCxTQUFPLFVBQUMsTUFBTSxFQUFLO0FBQ2pCLFFBQU0sWUFBWSxHQUFHLFlBQVksV0FBUSxDQUFDO0FBQ3hDLGlCQUFXLEVBQVgsV0FBVztBQUNYLGdCQUFVLEVBQVYsVUFBVTtBQUNWLGlCQUFXLEVBQUUsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJO0FBQzdCLHFCQUFlLEVBQUUsTUFBTSxDQUFDLE9BQU8sQ0FBQyxVQUFVO0tBQzNDLENBQUMsQ0FBQztBQUNILFdBQU8sRUFBRSxZQUFZLEVBQVosWUFBWSxFQUFFLENBQUM7R0FDekIsQ0FBQztDQUNIIiwiZmlsZSI6Ii91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvc2VjdXJpdHkvc2VydmVyL2xpYi9sb2dpbl9zY2hlbWUuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBhdXRoUmVkaXJlY3QgZnJvbSAnLi9hdXRoX3JlZGlyZWN0JztcblxuLyoqXG4gKiBDcmVhdGVzIGEgaGFwaSBhdXRoIHNjaGVtZSB3aXRoIGNvbmRpdGlvbmFsIHNlc3Npb25cbiAqIGV4cGlyYXRpb24gaGFuZGxpbmcgYmFzZWQgb24gZWFjaCByZXF1ZXN0XG4gKlxuICogQHBhcmFtIHtvYmplY3R9XG4gKiAgICByZWRpcmVjdFVybDogVHJhbnNmb3JtIGZ1bmN0aW9uIHRoYXQgcmVxdWVzdCBwYXRoIGlzIHBhc3NlZCB0byBiZWZvcmVcbiAqICAgICAgICAgICAgICAgICByZWRpcmVjdGluZ1xuICogICAgc3RyYXRlZ3k6ICAgIFRoZSBuYW1lIG9mIHRoZSBhdXRoIHN0cmF0ZWd5IHRvIHVzZSBmb3IgdGVzdFxuICogQHJldHVybiB7RnVuY3Rpb259XG4gKi9cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGNyZWF0ZVNjaGVtZSh7IHJlZGlyZWN0VXJsLCBzdHJhdGVnaWVzIH0pIHtcbiAgcmV0dXJuIChzZXJ2ZXIpID0+IHtcbiAgICBjb25zdCBhdXRoZW50aWNhdGUgPSBhdXRoUmVkaXJlY3QuZGVmYXVsdCh7XG4gICAgICByZWRpcmVjdFVybCxcbiAgICAgIHN0cmF0ZWdpZXMsXG4gICAgICB0ZXN0UmVxdWVzdDogc2VydmVyLmF1dGgudGVzdCxcbiAgICAgIHhwYWNrTWFpblBsdWdpbjogc2VydmVyLnBsdWdpbnMueHBhY2tfbWFpblxuICAgIH0pO1xuICAgIHJldHVybiB7IGF1dGhlbnRpY2F0ZSB9O1xuICB9O1xufVxuIl19",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/login_scheme.js"
      ],
      "names": [],
      "mappings": ";;;;;qBAYwB,YAAY;;;;6BAZN,iBAAiB;;IAAnC,YAAY;;;;;;;;;;;;;AAYT,SAAS,YAAY,CAAC,IAA2B,EAAE;MAA3B,WAAW,GAAb,IAA2B,CAAzB,WAAW;MAAE,UAAU,GAAzB,IAA2B,CAAZ,UAAU;;AAC5D,SAAO,UAAC,MAAM,EAAK;AACjB,QAAM,YAAY,GAAG,YAAY,WAAQ,CAAC;AACxC,iBAAW,EAAX,WAAW;AACX,gBAAU,EAAV,UAAU;AACV,iBAAW,EAAE,MAAM,CAAC,IAAI,CAAC,IAAI;AAC7B,qBAAe,EAAE,MAAM,CAAC,OAAO,CAAC,UAAU;KAC3C,CAAC,CAAC;AACH,WAAO,EAAE,YAAY,EAAZ,YAAY,EAAE,CAAC;GACzB,CAAC;CACH",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/login_scheme.js",
      "sourcesContent": [
        "import * as authRedirect from './auth_redirect';\n\n/**\n * Creates a hapi auth scheme with conditional session\n * expiration handling based on each request\n *\n * @param {object}\n *    redirectUrl: Transform function that request path is passed to before\n *                 redirecting\n *    strategy:    The name of the auth strategy to use for test\n * @return {Function}\n */\nexport default function createScheme({ redirectUrl, strategies }) {\n  return (server) => {\n    const authenticate = authRedirect.default({\n      redirectUrl,\n      strategies,\n      testRequest: server.auth.test,\n      xpackMainPlugin: server.plugins.xpack_main\n    });\n    return { authenticate };\n  };\n}\n"
      ]
    },
    "mtime": 1491771510468
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/auth_redirect.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "boom",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "Boom"
              }
            ]
          },
          {
            "source": "bluebird",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "Promise"
              }
            ]
          },
          {
            "source": "lodash",
            "imported": [
              "contains",
              "get",
              "has"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "contains",
                "local": "contains"
              },
              {
                "kind": "named",
                "imported": "get",
                "local": "get"
              },
              {
                "kind": "named",
                "imported": "has",
                "local": "has"
              }
            ]
          }
        ],
        "exports": {
          "exported": [
            "factory",
            "redirectUrl",
            "strategies",
            "testRequest",
            "xpackMainPlugin",
            "shouldRedirect",
            "request"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "factory",
              "exported": "default"
            },
            {
              "kind": "local",
              "local": "redirectUrl",
              "exported": "default"
            },
            {
              "kind": "local",
              "local": "strategies",
              "exported": "default"
            },
            {
              "kind": "local",
              "local": "testRequest",
              "exported": "default"
            },
            {
              "kind": "local",
              "local": "xpackMainPlugin",
              "exported": "default"
            },
            {
              "kind": "local",
              "local": "shouldRedirect",
              "exported": "shouldRedirect"
            },
            {
              "kind": "local",
              "local": "request",
              "exported": "request"
            }
          ]
        }
      },
      "usedHelpers": [
        "interop-require-default"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nexports['default'] = factory;\nexports.shouldRedirect = shouldRedirect;\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _boom = require('boom');\n\nvar _boom2 = _interopRequireDefault(_boom);\n\nvar _bluebird = require('bluebird');\n\nvar _bluebird2 = _interopRequireDefault(_bluebird);\n\nvar _lodash = require('lodash');\n\nvar ROUTE_TAG_API = 'api';\nvar KIBANA_XSRF_HEADER = 'kbn-xsrf';\nvar KIBANA_VERSION_HEADER = 'kbn-version';\n\n/**\n * Creates a hapi authenticate function that conditionally\n * redirects on auth failure\n *\n * Kibana requires a `kbn-xsrf` header or a `kbn-version` for xhr requests, so\n * it is probably the safest measure we have for determining whether a request\n * should return a 401 or a 302 when authentication fails.\n *\n * @param {object}\n *    onError:     Transform function that error is passed to before deferring\n *                 to standard error handler\n *    redirectUrl: Transform function that request path is passed to before\n *                 redirecting\n *    strategy:    The name of the auth strategy to use for test, or an array of auth strategy names\n *    testRequest: Function to test authentication for a request\n * @return {Function}\n */\n\nfunction factory(_ref) {\n  var redirectUrl = _ref.redirectUrl;\n  var strategies = _ref.strategies;\n  var testRequest = _ref.testRequest;\n  var xpackMainPlugin = _ref.xpackMainPlugin;\n\n  var testRequestAsync = _bluebird2['default'].promisify(testRequest);\n  return function authenticate(request, reply) {\n    // If security is disabled or license is basic, continue with no user credentials and delete the client cookie as well\n    var xpackInfo = xpackMainPlugin && xpackMainPlugin.info;\n    if (xpackInfo && xpackInfo.isAvailable() && (!xpackInfo.feature('security').isEnabled() || xpackInfo.license.isOneOf('basic'))) {\n      reply['continue']({ credentials: {} });\n      return;\n    }\n\n    // Test the request against all of the authentication strategies and if any succeed, continue\n    return _bluebird2['default'].any(strategies.map(function (strategy) {\n      return testRequestAsync(strategy, request);\n    })).then(function (credentials) {\n      return reply['continue']({ credentials: credentials });\n    })['catch'](function () {\n      if (shouldRedirect(request)) {\n        reply.redirect(redirectUrl(request.url.path));\n      } else {\n        reply(_boom2['default'].unauthorized());\n      }\n    });\n  };\n}\n\n;\n\nfunction shouldRedirect(request) {\n  var hasVersionHeader = (0, _lodash.has)(request.raw.req.headers, KIBANA_VERSION_HEADER);\n  var hasXsrfHeader = (0, _lodash.has)(request.raw.req.headers, KIBANA_XSRF_HEADER);\n\n  var isApiRoute = (0, _lodash.contains)((0, _lodash.get)(request, 'route.settings.tags'), ROUTE_TAG_API);\n  var isAjaxRequest = hasVersionHeader || hasXsrfHeader;\n\n  return !isApiRoute && !isAjaxRequest;\n}\n\n;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvc2VjdXJpdHkvc2VydmVyL2xpYi9hdXRoX3JlZGlyZWN0LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O3FCQXlCd0IsT0FBTzs7Ozs7b0JBekJkLE1BQU07Ozs7d0JBQ0gsVUFBVTs7OztzQkFDSyxRQUFROztBQUUzQyxJQUFNLGFBQWEsR0FBRyxLQUFLLENBQUM7QUFDNUIsSUFBTSxrQkFBa0IsR0FBRyxVQUFVLENBQUM7QUFDdEMsSUFBTSxxQkFBcUIsR0FBRyxhQUFhLENBQUM7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBbUI3QixTQUFTLE9BQU8sQ0FBQyxJQUF5RCxFQUFFO01BQXpELFdBQVcsR0FBYixJQUF5RCxDQUF2RCxXQUFXO01BQUUsVUFBVSxHQUF6QixJQUF5RCxDQUExQyxVQUFVO01BQUUsV0FBVyxHQUF0QyxJQUF5RCxDQUE5QixXQUFXO01BQUUsZUFBZSxHQUF2RCxJQUF5RCxDQUFqQixlQUFlOztBQUNyRixNQUFNLGdCQUFnQixHQUFHLHNCQUFRLFNBQVMsQ0FBQyxXQUFXLENBQUMsQ0FBQztBQUN4RCxTQUFPLFNBQVMsWUFBWSxDQUFDLE9BQU8sRUFBRSxLQUFLLEVBQUU7O0FBRTNDLFFBQU0sU0FBUyxHQUFHLGVBQWUsSUFBSSxlQUFlLENBQUMsSUFBSSxDQUFDO0FBQzFELFFBQUksU0FBUyxJQUNOLFNBQVMsQ0FBQyxXQUFXLEVBQUUsS0FDdEIsQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQyxDQUFDLFNBQVMsRUFBRSxJQUFJLFNBQVMsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFBLEFBQUMsRUFBRTtBQUN6RixXQUFLLFlBQVMsQ0FBQyxFQUFFLFdBQVcsRUFBRSxFQUFFLEVBQUUsQ0FBQyxDQUFDO0FBQ3BDLGFBQU87S0FDUjs7O0FBR0QsV0FBTyxzQkFBUSxHQUFHLENBQUMsVUFBVSxDQUFDLEdBQUcsQ0FBQyxVQUFDLFFBQVE7YUFBSyxnQkFBZ0IsQ0FBQyxRQUFRLEVBQUUsT0FBTyxDQUFDO0tBQUEsQ0FBQyxDQUFDLENBQ3BGLElBQUksQ0FBQyxVQUFDLFdBQVc7YUFBSyxLQUFLLFlBQVMsQ0FBQyxFQUFFLFdBQVcsRUFBWCxXQUFXLEVBQUUsQ0FBQztLQUFBLENBQUMsU0FDakQsQ0FBQyxZQUFNO0FBQ1gsVUFBSSxjQUFjLENBQUMsT0FBTyxDQUFDLEVBQUU7QUFDM0IsYUFBSyxDQUFDLFFBQVEsQ0FBQyxXQUFXLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO09BQy9DLE1BQU07QUFDTCxhQUFLLENBQUMsa0JBQUssWUFBWSxFQUFFLENBQUMsQ0FBQztPQUM1QjtLQUNGLENBQUMsQ0FBQztHQUNKLENBQUM7Q0FDSDs7QUFBQSxDQUFDOztBQUVLLFNBQVMsY0FBYyxDQUFDLE9BQU8sRUFBRTtBQUN0QyxNQUFNLGdCQUFnQixHQUFHLGlCQUFJLE9BQU8sQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLE9BQU8sRUFBRSxxQkFBcUIsQ0FBQyxDQUFDO0FBQzdFLE1BQU0sYUFBYSxHQUFHLGlCQUFJLE9BQU8sQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLE9BQU8sRUFBRSxrQkFBa0IsQ0FBQyxDQUFDOztBQUV2RSxNQUFNLFVBQVUsR0FBRyxzQkFBUyxpQkFBSSxPQUFPLEVBQUUscUJBQXFCLENBQUMsRUFBRSxhQUFhLENBQUMsQ0FBQztBQUNoRixNQUFNLGFBQWEsR0FBRyxnQkFBZ0IsSUFBSSxhQUFhLENBQUM7O0FBRXhELFNBQU8sQ0FBQyxVQUFVLElBQUksQ0FBQyxhQUFhLENBQUM7Q0FDdEM7O0FBQUEsQ0FBQyIsImZpbGUiOiIvdXNyL3NoYXJlL2tpYmFuYS9wbHVnaW5zL3gtcGFjay9wbHVnaW5zL3NlY3VyaXR5L3NlcnZlci9saWIvYXV0aF9yZWRpcmVjdC5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBCb29tIGZyb20gJ2Jvb20nO1xuaW1wb3J0IFByb21pc2UgZnJvbSAnYmx1ZWJpcmQnO1xuaW1wb3J0IHsgY29udGFpbnMsIGdldCwgaGFzIH0gZnJvbSAnbG9kYXNoJztcblxuY29uc3QgUk9VVEVfVEFHX0FQSSA9ICdhcGknO1xuY29uc3QgS0lCQU5BX1hTUkZfSEVBREVSID0gJ2tibi14c3JmJztcbmNvbnN0IEtJQkFOQV9WRVJTSU9OX0hFQURFUiA9ICdrYm4tdmVyc2lvbic7XG5cbi8qKlxuICogQ3JlYXRlcyBhIGhhcGkgYXV0aGVudGljYXRlIGZ1bmN0aW9uIHRoYXQgY29uZGl0aW9uYWxseVxuICogcmVkaXJlY3RzIG9uIGF1dGggZmFpbHVyZVxuICpcbiAqIEtpYmFuYSByZXF1aXJlcyBhIGBrYm4teHNyZmAgaGVhZGVyIG9yIGEgYGtibi12ZXJzaW9uYCBmb3IgeGhyIHJlcXVlc3RzLCBzb1xuICogaXQgaXMgcHJvYmFibHkgdGhlIHNhZmVzdCBtZWFzdXJlIHdlIGhhdmUgZm9yIGRldGVybWluaW5nIHdoZXRoZXIgYSByZXF1ZXN0XG4gKiBzaG91bGQgcmV0dXJuIGEgNDAxIG9yIGEgMzAyIHdoZW4gYXV0aGVudGljYXRpb24gZmFpbHMuXG4gKlxuICogQHBhcmFtIHtvYmplY3R9XG4gKiAgICBvbkVycm9yOiAgICAgVHJhbnNmb3JtIGZ1bmN0aW9uIHRoYXQgZXJyb3IgaXMgcGFzc2VkIHRvIGJlZm9yZSBkZWZlcnJpbmdcbiAqICAgICAgICAgICAgICAgICB0byBzdGFuZGFyZCBlcnJvciBoYW5kbGVyXG4gKiAgICByZWRpcmVjdFVybDogVHJhbnNmb3JtIGZ1bmN0aW9uIHRoYXQgcmVxdWVzdCBwYXRoIGlzIHBhc3NlZCB0byBiZWZvcmVcbiAqICAgICAgICAgICAgICAgICByZWRpcmVjdGluZ1xuICogICAgc3RyYXRlZ3k6ICAgIFRoZSBuYW1lIG9mIHRoZSBhdXRoIHN0cmF0ZWd5IHRvIHVzZSBmb3IgdGVzdCwgb3IgYW4gYXJyYXkgb2YgYXV0aCBzdHJhdGVneSBuYW1lc1xuICogICAgdGVzdFJlcXVlc3Q6IEZ1bmN0aW9uIHRvIHRlc3QgYXV0aGVudGljYXRpb24gZm9yIGEgcmVxdWVzdFxuICogQHJldHVybiB7RnVuY3Rpb259XG4gKi9cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGZhY3RvcnkoeyByZWRpcmVjdFVybCwgc3RyYXRlZ2llcywgdGVzdFJlcXVlc3QsIHhwYWNrTWFpblBsdWdpbiB9KSB7XG4gIGNvbnN0IHRlc3RSZXF1ZXN0QXN5bmMgPSBQcm9taXNlLnByb21pc2lmeSh0ZXN0UmVxdWVzdCk7XG4gIHJldHVybiBmdW5jdGlvbiBhdXRoZW50aWNhdGUocmVxdWVzdCwgcmVwbHkpIHtcbiAgICAvLyBJZiBzZWN1cml0eSBpcyBkaXNhYmxlZCBvciBsaWNlbnNlIGlzIGJhc2ljLCBjb250aW51ZSB3aXRoIG5vIHVzZXIgY3JlZGVudGlhbHMgYW5kIGRlbGV0ZSB0aGUgY2xpZW50IGNvb2tpZSBhcyB3ZWxsXG4gICAgY29uc3QgeHBhY2tJbmZvID0geHBhY2tNYWluUGx1Z2luICYmIHhwYWNrTWFpblBsdWdpbi5pbmZvO1xuICAgIGlmICh4cGFja0luZm9cbiAgICAgICAgJiYgeHBhY2tJbmZvLmlzQXZhaWxhYmxlKClcbiAgICAgICAgJiYgKCF4cGFja0luZm8uZmVhdHVyZSgnc2VjdXJpdHknKS5pc0VuYWJsZWQoKSB8fCB4cGFja0luZm8ubGljZW5zZS5pc09uZU9mKCdiYXNpYycpKSkge1xuICAgICAgcmVwbHkuY29udGludWUoeyBjcmVkZW50aWFsczoge30gfSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gVGVzdCB0aGUgcmVxdWVzdCBhZ2FpbnN0IGFsbCBvZiB0aGUgYXV0aGVudGljYXRpb24gc3RyYXRlZ2llcyBhbmQgaWYgYW55IHN1Y2NlZWQsIGNvbnRpbnVlXG4gICAgcmV0dXJuIFByb21pc2UuYW55KHN0cmF0ZWdpZXMubWFwKChzdHJhdGVneSkgPT4gdGVzdFJlcXVlc3RBc3luYyhzdHJhdGVneSwgcmVxdWVzdCkpKVxuICAgIC50aGVuKChjcmVkZW50aWFscykgPT4gcmVwbHkuY29udGludWUoeyBjcmVkZW50aWFscyB9KSlcbiAgICAuY2F0Y2goKCkgPT4ge1xuICAgICAgaWYgKHNob3VsZFJlZGlyZWN0KHJlcXVlc3QpKSB7XG4gICAgICAgIHJlcGx5LnJlZGlyZWN0KHJlZGlyZWN0VXJsKHJlcXVlc3QudXJsLnBhdGgpKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlcGx5KEJvb20udW5hdXRob3JpemVkKCkpO1xuICAgICAgfVxuICAgIH0pO1xuICB9O1xufTtcblxuZXhwb3J0IGZ1bmN0aW9uIHNob3VsZFJlZGlyZWN0KHJlcXVlc3QpIHtcbiAgY29uc3QgaGFzVmVyc2lvbkhlYWRlciA9IGhhcyhyZXF1ZXN0LnJhdy5yZXEuaGVhZGVycywgS0lCQU5BX1ZFUlNJT05fSEVBREVSKTtcbiAgY29uc3QgaGFzWHNyZkhlYWRlciA9IGhhcyhyZXF1ZXN0LnJhdy5yZXEuaGVhZGVycywgS0lCQU5BX1hTUkZfSEVBREVSKTtcblxuICBjb25zdCBpc0FwaVJvdXRlID0gY29udGFpbnMoZ2V0KHJlcXVlc3QsICdyb3V0ZS5zZXR0aW5ncy50YWdzJyksIFJPVVRFX1RBR19BUEkpO1xuICBjb25zdCBpc0FqYXhSZXF1ZXN0ID0gaGFzVmVyc2lvbkhlYWRlciB8fCBoYXNYc3JmSGVhZGVyO1xuXG4gIHJldHVybiAhaXNBcGlSb3V0ZSAmJiAhaXNBamF4UmVxdWVzdDtcbn07XG4iXX0=",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/auth_redirect.js"
      ],
      "names": [],
      "mappings": ";;;;;qBAyBwB,OAAO;;;;;oBAzBd,MAAM;;;;wBACH,UAAU;;;;sBACK,QAAQ;;AAE3C,IAAM,aAAa,GAAG,KAAK,CAAC;AAC5B,IAAM,kBAAkB,GAAG,UAAU,CAAC;AACtC,IAAM,qBAAqB,GAAG,aAAa,CAAC;;;;;;;;;;;;;;;;;;;;AAmB7B,SAAS,OAAO,CAAC,IAAyD,EAAE;MAAzD,WAAW,GAAb,IAAyD,CAAvD,WAAW;MAAE,UAAU,GAAzB,IAAyD,CAA1C,UAAU;MAAE,WAAW,GAAtC,IAAyD,CAA9B,WAAW;MAAE,eAAe,GAAvD,IAAyD,CAAjB,eAAe;;AACrF,MAAM,gBAAgB,GAAG,sBAAQ,SAAS,CAAC,WAAW,CAAC,CAAC;AACxD,SAAO,SAAS,YAAY,CAAC,OAAO,EAAE,KAAK,EAAE;;AAE3C,QAAM,SAAS,GAAG,eAAe,IAAI,eAAe,CAAC,IAAI,CAAC;AAC1D,QAAI,SAAS,IACN,SAAS,CAAC,WAAW,EAAE,KACtB,CAAC,SAAS,CAAC,OAAO,CAAC,UAAU,CAAC,CAAC,SAAS,EAAE,IAAI,SAAS,CAAC,OAAO,CAAC,OAAO,CAAC,OAAO,CAAC,CAAA,AAAC,EAAE;AACzF,WAAK,YAAS,CAAC,EAAE,WAAW,EAAE,EAAE,EAAE,CAAC,CAAC;AACpC,aAAO;KACR;;;AAGD,WAAO,sBAAQ,GAAG,CAAC,UAAU,CAAC,GAAG,CAAC,UAAC,QAAQ;aAAK,gBAAgB,CAAC,QAAQ,EAAE,OAAO,CAAC;KAAA,CAAC,CAAC,CACpF,IAAI,CAAC,UAAC,WAAW;aAAK,KAAK,YAAS,CAAC,EAAE,WAAW,EAAX,WAAW,EAAE,CAAC;KAAA,CAAC,SACjD,CAAC,YAAM;AACX,UAAI,cAAc,CAAC,OAAO,CAAC,EAAE;AAC3B,aAAK,CAAC,QAAQ,CAAC,WAAW,CAAC,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC;OAC/C,MAAM;AACL,aAAK,CAAC,kBAAK,YAAY,EAAE,CAAC,CAAC;OAC5B;KACF,CAAC,CAAC;GACJ,CAAC;CACH;;AAAA,CAAC;;AAEK,SAAS,cAAc,CAAC,OAAO,EAAE;AACtC,MAAM,gBAAgB,GAAG,iBAAI,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,OAAO,EAAE,qBAAqB,CAAC,CAAC;AAC7E,MAAM,aAAa,GAAG,iBAAI,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,OAAO,EAAE,kBAAkB,CAAC,CAAC;;AAEvE,MAAM,UAAU,GAAG,sBAAS,iBAAI,OAAO,EAAE,qBAAqB,CAAC,EAAE,aAAa,CAAC,CAAC;AAChF,MAAM,aAAa,GAAG,gBAAgB,IAAI,aAAa,CAAC;;AAExD,SAAO,CAAC,UAAU,IAAI,CAAC,aAAa,CAAC;CACtC;;AAAA,CAAC",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/auth_redirect.js",
      "sourcesContent": [
        "import Boom from 'boom';\nimport Promise from 'bluebird';\nimport { contains, get, has } from 'lodash';\n\nconst ROUTE_TAG_API = 'api';\nconst KIBANA_XSRF_HEADER = 'kbn-xsrf';\nconst KIBANA_VERSION_HEADER = 'kbn-version';\n\n/**\n * Creates a hapi authenticate function that conditionally\n * redirects on auth failure\n *\n * Kibana requires a `kbn-xsrf` header or a `kbn-version` for xhr requests, so\n * it is probably the safest measure we have for determining whether a request\n * should return a 401 or a 302 when authentication fails.\n *\n * @param {object}\n *    onError:     Transform function that error is passed to before deferring\n *                 to standard error handler\n *    redirectUrl: Transform function that request path is passed to before\n *                 redirecting\n *    strategy:    The name of the auth strategy to use for test, or an array of auth strategy names\n *    testRequest: Function to test authentication for a request\n * @return {Function}\n */\nexport default function factory({ redirectUrl, strategies, testRequest, xpackMainPlugin }) {\n  const testRequestAsync = Promise.promisify(testRequest);\n  return function authenticate(request, reply) {\n    // If security is disabled or license is basic, continue with no user credentials and delete the client cookie as well\n    const xpackInfo = xpackMainPlugin && xpackMainPlugin.info;\n    if (xpackInfo\n        && xpackInfo.isAvailable()\n        && (!xpackInfo.feature('security').isEnabled() || xpackInfo.license.isOneOf('basic'))) {\n      reply.continue({ credentials: {} });\n      return;\n    }\n\n    // Test the request against all of the authentication strategies and if any succeed, continue\n    return Promise.any(strategies.map((strategy) => testRequestAsync(strategy, request)))\n    .then((credentials) => reply.continue({ credentials }))\n    .catch(() => {\n      if (shouldRedirect(request)) {\n        reply.redirect(redirectUrl(request.url.path));\n      } else {\n        reply(Boom.unauthorized());\n      }\n    });\n  };\n};\n\nexport function shouldRedirect(request) {\n  const hasVersionHeader = has(request.raw.req.headers, KIBANA_VERSION_HEADER);\n  const hasXsrfHeader = has(request.raw.req.headers, KIBANA_XSRF_HEADER);\n\n  const isApiRoute = contains(get(request, 'route.settings.tags'), ROUTE_TAG_API);\n  const isAjaxRequest = hasVersionHeader || hasXsrfHeader;\n\n  return !isApiRoute && !isAjaxRequest;\n};\n"
      ]
    },
    "mtime": 1491771510468
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/check_license.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [],
        "exports": {
          "exported": [
            "checkLicense",
            "xpackLicenseInfo"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "checkLicense",
              "exported": "default"
            },
            {
              "kind": "local",
              "local": "xpackLicenseInfo",
              "exported": "default"
            }
          ]
        }
      },
      "usedHelpers": []
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nexports['default'] = checkLicense;\n\nfunction checkLicense(xpackLicenseInfo) {\n\n  var showLogin = undefined; // show login page or skip it?\n  var allowLogin = undefined; // allow login or disable it on the login page?\n  var showLinks = undefined; // show security links throughout the kibana app?\n  var allowRoleDocumentLevelSecurity = undefined; // allow users to define document level security in roles?\n  var allowRoleFieldLevelSecurity = undefined; // allow users to define field level security in roles?\n\n  var loginMessage = undefined; // message to show on login page\n  var linksMessage = undefined; // message to show when security links are clicked throughout the kibana app\n\n  // If, for some reason, we cannot get license information\n  // from Elasticsearch, assume worst-case and lock user\n  // at login screen.\n  if (!xpackLicenseInfo || !xpackLicenseInfo.isAvailable()) {\n    loginMessage = 'Login is currently disabled because the license could not be determined. ' + 'Please check that Elasticsearch is running, then refresh this page.';\n    return {\n      showLogin: true,\n      allowLogin: false,\n      showLinks: false,\n      allowRoleDocumentLevelSecurity: false,\n      allowRoleFieldLevelSecurity: false,\n      loginMessage: loginMessage,\n      linksMessage: linksMessage\n    };\n  }\n\n  var isLicenseActive = xpackLicenseInfo.license.isActive();\n  var isLicenseBasic = xpackLicenseInfo.license.isOneOf(['basic']);\n  var isLicenseGold = xpackLicenseInfo.license.isOneOf(['gold']);\n  var isEnabledInES = xpackLicenseInfo.feature('security').isEnabled();\n\n  if (!isEnabledInES) {\n    linksMessage = 'Access is denied because Security is disabled in Elasticsearch.';\n    showLogin = false;\n    allowLogin = null;\n    showLinks = false;\n    allowRoleDocumentLevelSecurity = false;\n    allowRoleFieldLevelSecurity = false;\n  } else if (isLicenseBasic) {\n    linksMessage = 'Your Basic license does not support Security. Please upgrade your license.';\n    showLogin = false;\n    allowLogin = null;\n    showLinks = false;\n    allowRoleDocumentLevelSecurity = false;\n    allowRoleFieldLevelSecurity = false;\n  } else if (isLicenseGold) {\n    linksMessage = null;\n    showLogin = true;\n    allowLogin = true;\n    showLinks = true;\n    allowRoleDocumentLevelSecurity = false;\n    allowRoleFieldLevelSecurity = false;\n  } else if (!isLicenseActive) {\n    loginMessage = 'Login is disabled because your license has expired. Please extend your license or disable Security in Elasticsearch.';\n    linksMessage = 'Access is denied because your license has expired. Please extend your license.';\n    showLogin = true;\n    allowLogin = false;\n    showLinks = false;\n    allowRoleDocumentLevelSecurity = false;\n    allowRoleFieldLevelSecurity = false;\n  } else {\n    showLogin = true;\n    allowLogin = true;\n    showLinks = true;\n    allowRoleDocumentLevelSecurity = true;\n    allowRoleFieldLevelSecurity = true;\n  };\n\n  return {\n    showLogin: showLogin,\n    allowLogin: allowLogin,\n    showLinks: showLinks,\n    loginMessage: loginMessage,\n    linksMessage: linksMessage,\n    allowRoleDocumentLevelSecurity: allowRoleDocumentLevelSecurity,\n    allowRoleFieldLevelSecurity: allowRoleFieldLevelSecurity\n  };\n}\n\n;\nmodule.exports = exports['default'];\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvc2VjdXJpdHkvc2VydmVyL2xpYi9jaGVja19saWNlbnNlLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O3FCQUF3QixZQUFZOztBQUFyQixTQUFTLFlBQVksQ0FBQyxnQkFBZ0IsRUFBRTs7QUFFckQsTUFBSSxTQUFTLFlBQUEsQ0FBQztBQUNkLE1BQUksVUFBVSxZQUFBLENBQUM7QUFDZixNQUFJLFNBQVMsWUFBQSxDQUFDO0FBQ2QsTUFBSSw4QkFBOEIsWUFBQSxDQUFDO0FBQ25DLE1BQUksMkJBQTJCLFlBQUEsQ0FBQzs7QUFFaEMsTUFBSSxZQUFZLFlBQUEsQ0FBQztBQUNqQixNQUFJLFlBQVksWUFBQSxDQUFDOzs7OztBQUtqQixNQUFJLENBQUMsZ0JBQWdCLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxXQUFXLEVBQUUsRUFBRTtBQUN4RCxnQkFBWSxHQUFHLDJFQUEyRSxHQUN4RixxRUFBcUUsQ0FBQztBQUN4RSxXQUFPO0FBQ0wsZUFBUyxFQUFFLElBQUk7QUFDZixnQkFBVSxFQUFFLEtBQUs7QUFDakIsZUFBUyxFQUFFLEtBQUs7QUFDaEIsb0NBQThCLEVBQUUsS0FBSztBQUNyQyxpQ0FBMkIsRUFBRSxLQUFLO0FBQ2xDLGtCQUFZLEVBQVosWUFBWTtBQUNaLGtCQUFZLEVBQVosWUFBWTtLQUNiLENBQUM7R0FDSDs7QUFFRCxNQUFNLGVBQWUsR0FBRyxnQkFBZ0IsQ0FBQyxPQUFPLENBQUMsUUFBUSxFQUFFLENBQUM7QUFDNUQsTUFBTSxjQUFjLEdBQUcsZ0JBQWdCLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUM7QUFDbkUsTUFBTSxhQUFhLEdBQUcsZ0JBQWdCLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUM7QUFDakUsTUFBTSxhQUFhLEdBQUcsZ0JBQWdCLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQyxDQUFDLFNBQVMsRUFBRSxDQUFDOztBQUV2RSxNQUFJLENBQUMsYUFBYSxFQUFFO0FBQ2xCLGdCQUFZLEdBQUcsaUVBQWlFLENBQUM7QUFDakYsYUFBUyxHQUFHLEtBQUssQ0FBQztBQUNsQixjQUFVLEdBQUcsSUFBSSxDQUFDO0FBQ2xCLGFBQVMsR0FBRyxLQUFLLENBQUM7QUFDbEIsa0NBQThCLEdBQUcsS0FBSyxDQUFDO0FBQ3ZDLCtCQUEyQixHQUFHLEtBQUssQ0FBQztHQUNyQyxNQUFNLElBQUksY0FBYyxFQUFFO0FBQ3pCLGdCQUFZLEdBQUcsNEVBQTRFLENBQUM7QUFDNUYsYUFBUyxHQUFHLEtBQUssQ0FBQztBQUNsQixjQUFVLEdBQUcsSUFBSSxDQUFDO0FBQ2xCLGFBQVMsR0FBRyxLQUFLLENBQUM7QUFDbEIsa0NBQThCLEdBQUcsS0FBSyxDQUFDO0FBQ3ZDLCtCQUEyQixHQUFHLEtBQUssQ0FBQztHQUNyQyxNQUFNLElBQUksYUFBYSxFQUFFO0FBQ3hCLGdCQUFZLEdBQUcsSUFBSSxDQUFDO0FBQ3BCLGFBQVMsR0FBRyxJQUFJLENBQUM7QUFDakIsY0FBVSxHQUFHLElBQUksQ0FBQztBQUNsQixhQUFTLEdBQUcsSUFBSSxDQUFDO0FBQ2pCLGtDQUE4QixHQUFHLEtBQUssQ0FBQztBQUN2QywrQkFBMkIsR0FBRyxLQUFLLENBQUM7R0FDckMsTUFBTSxJQUFJLENBQUMsZUFBZSxFQUFFO0FBQzNCLGdCQUFZLEdBQUcsc0hBQXNILENBQUM7QUFDdEksZ0JBQVksR0FBRyxnRkFBZ0YsQ0FBQztBQUNoRyxhQUFTLEdBQUcsSUFBSSxDQUFDO0FBQ2pCLGNBQVUsR0FBRyxLQUFLLENBQUM7QUFDbkIsYUFBUyxHQUFHLEtBQUssQ0FBQztBQUNsQixrQ0FBOEIsR0FBRyxLQUFLLENBQUM7QUFDdkMsK0JBQTJCLEdBQUcsS0FBSyxDQUFDO0dBQ3JDLE1BQU07QUFDTCxhQUFTLEdBQUcsSUFBSSxDQUFDO0FBQ2pCLGNBQVUsR0FBRyxJQUFJLENBQUM7QUFDbEIsYUFBUyxHQUFHLElBQUksQ0FBQztBQUNqQixrQ0FBOEIsR0FBRyxJQUFJLENBQUM7QUFDdEMsK0JBQTJCLEdBQUcsSUFBSSxDQUFDO0dBQ3BDLENBQUM7O0FBRUYsU0FBTztBQUNMLGFBQVMsRUFBVCxTQUFTO0FBQ1QsY0FBVSxFQUFWLFVBQVU7QUFDVixhQUFTLEVBQVQsU0FBUztBQUNULGdCQUFZLEVBQVosWUFBWTtBQUNaLGdCQUFZLEVBQVosWUFBWTtBQUNaLGtDQUE4QixFQUE5Qiw4QkFBOEI7QUFDOUIsK0JBQTJCLEVBQTNCLDJCQUEyQjtHQUM1QixDQUFDO0NBRUg7O0FBQUEsQ0FBQyIsImZpbGUiOiIvdXNyL3NoYXJlL2tpYmFuYS9wbHVnaW5zL3gtcGFjay9wbHVnaW5zL3NlY3VyaXR5L3NlcnZlci9saWIvY2hlY2tfbGljZW5zZS5qcyIsInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGNoZWNrTGljZW5zZSh4cGFja0xpY2Vuc2VJbmZvKSB7XG5cbiAgbGV0IHNob3dMb2dpbjsgLy8gc2hvdyBsb2dpbiBwYWdlIG9yIHNraXAgaXQ/XG4gIGxldCBhbGxvd0xvZ2luOyAvLyBhbGxvdyBsb2dpbiBvciBkaXNhYmxlIGl0IG9uIHRoZSBsb2dpbiBwYWdlP1xuICBsZXQgc2hvd0xpbmtzOyAvLyBzaG93IHNlY3VyaXR5IGxpbmtzIHRocm91Z2hvdXQgdGhlIGtpYmFuYSBhcHA/XG4gIGxldCBhbGxvd1JvbGVEb2N1bWVudExldmVsU2VjdXJpdHk7IC8vIGFsbG93IHVzZXJzIHRvIGRlZmluZSBkb2N1bWVudCBsZXZlbCBzZWN1cml0eSBpbiByb2xlcz9cbiAgbGV0IGFsbG93Um9sZUZpZWxkTGV2ZWxTZWN1cml0eTsgLy8gYWxsb3cgdXNlcnMgdG8gZGVmaW5lIGZpZWxkIGxldmVsIHNlY3VyaXR5IGluIHJvbGVzP1xuXG4gIGxldCBsb2dpbk1lc3NhZ2U7IC8vIG1lc3NhZ2UgdG8gc2hvdyBvbiBsb2dpbiBwYWdlXG4gIGxldCBsaW5rc01lc3NhZ2U7IC8vIG1lc3NhZ2UgdG8gc2hvdyB3aGVuIHNlY3VyaXR5IGxpbmtzIGFyZSBjbGlja2VkIHRocm91Z2hvdXQgdGhlIGtpYmFuYSBhcHBcblxuICAvLyBJZiwgZm9yIHNvbWUgcmVhc29uLCB3ZSBjYW5ub3QgZ2V0IGxpY2Vuc2UgaW5mb3JtYXRpb25cbiAgLy8gZnJvbSBFbGFzdGljc2VhcmNoLCBhc3N1bWUgd29yc3QtY2FzZSBhbmQgbG9jayB1c2VyXG4gIC8vIGF0IGxvZ2luIHNjcmVlbi5cbiAgaWYgKCF4cGFja0xpY2Vuc2VJbmZvIHx8ICF4cGFja0xpY2Vuc2VJbmZvLmlzQXZhaWxhYmxlKCkpIHtcbiAgICBsb2dpbk1lc3NhZ2UgPSAnTG9naW4gaXMgY3VycmVudGx5IGRpc2FibGVkIGJlY2F1c2UgdGhlIGxpY2Vuc2UgY291bGQgbm90IGJlIGRldGVybWluZWQuICdcbiAgICArICdQbGVhc2UgY2hlY2sgdGhhdCBFbGFzdGljc2VhcmNoIGlzIHJ1bm5pbmcsIHRoZW4gcmVmcmVzaCB0aGlzIHBhZ2UuJztcbiAgICByZXR1cm4ge1xuICAgICAgc2hvd0xvZ2luOiB0cnVlLFxuICAgICAgYWxsb3dMb2dpbjogZmFsc2UsXG4gICAgICBzaG93TGlua3M6IGZhbHNlLFxuICAgICAgYWxsb3dSb2xlRG9jdW1lbnRMZXZlbFNlY3VyaXR5OiBmYWxzZSxcbiAgICAgIGFsbG93Um9sZUZpZWxkTGV2ZWxTZWN1cml0eTogZmFsc2UsXG4gICAgICBsb2dpbk1lc3NhZ2UsXG4gICAgICBsaW5rc01lc3NhZ2VcbiAgICB9O1xuICB9XG5cbiAgY29uc3QgaXNMaWNlbnNlQWN0aXZlID0geHBhY2tMaWNlbnNlSW5mby5saWNlbnNlLmlzQWN0aXZlKCk7XG4gIGNvbnN0IGlzTGljZW5zZUJhc2ljID0geHBhY2tMaWNlbnNlSW5mby5saWNlbnNlLmlzT25lT2YoWydiYXNpYyddKTtcbiAgY29uc3QgaXNMaWNlbnNlR29sZCA9IHhwYWNrTGljZW5zZUluZm8ubGljZW5zZS5pc09uZU9mKFsnZ29sZCddKTtcbiAgY29uc3QgaXNFbmFibGVkSW5FUyA9IHhwYWNrTGljZW5zZUluZm8uZmVhdHVyZSgnc2VjdXJpdHknKS5pc0VuYWJsZWQoKTtcblxuICBpZiAoIWlzRW5hYmxlZEluRVMpIHtcbiAgICBsaW5rc01lc3NhZ2UgPSAnQWNjZXNzIGlzIGRlbmllZCBiZWNhdXNlIFNlY3VyaXR5IGlzIGRpc2FibGVkIGluIEVsYXN0aWNzZWFyY2guJztcbiAgICBzaG93TG9naW4gPSBmYWxzZTtcbiAgICBhbGxvd0xvZ2luID0gbnVsbDtcbiAgICBzaG93TGlua3MgPSBmYWxzZTtcbiAgICBhbGxvd1JvbGVEb2N1bWVudExldmVsU2VjdXJpdHkgPSBmYWxzZTtcbiAgICBhbGxvd1JvbGVGaWVsZExldmVsU2VjdXJpdHkgPSBmYWxzZTtcbiAgfSBlbHNlIGlmIChpc0xpY2Vuc2VCYXNpYykge1xuICAgIGxpbmtzTWVzc2FnZSA9ICdZb3VyIEJhc2ljIGxpY2Vuc2UgZG9lcyBub3Qgc3VwcG9ydCBTZWN1cml0eS4gUGxlYXNlIHVwZ3JhZGUgeW91ciBsaWNlbnNlLic7XG4gICAgc2hvd0xvZ2luID0gZmFsc2U7XG4gICAgYWxsb3dMb2dpbiA9IG51bGw7XG4gICAgc2hvd0xpbmtzID0gZmFsc2U7XG4gICAgYWxsb3dSb2xlRG9jdW1lbnRMZXZlbFNlY3VyaXR5ID0gZmFsc2U7XG4gICAgYWxsb3dSb2xlRmllbGRMZXZlbFNlY3VyaXR5ID0gZmFsc2U7XG4gIH0gZWxzZSBpZiAoaXNMaWNlbnNlR29sZCkge1xuICAgIGxpbmtzTWVzc2FnZSA9IG51bGw7XG4gICAgc2hvd0xvZ2luID0gdHJ1ZTtcbiAgICBhbGxvd0xvZ2luID0gdHJ1ZTtcbiAgICBzaG93TGlua3MgPSB0cnVlO1xuICAgIGFsbG93Um9sZURvY3VtZW50TGV2ZWxTZWN1cml0eSA9IGZhbHNlO1xuICAgIGFsbG93Um9sZUZpZWxkTGV2ZWxTZWN1cml0eSA9IGZhbHNlO1xuICB9IGVsc2UgaWYgKCFpc0xpY2Vuc2VBY3RpdmUpIHtcbiAgICBsb2dpbk1lc3NhZ2UgPSAnTG9naW4gaXMgZGlzYWJsZWQgYmVjYXVzZSB5b3VyIGxpY2Vuc2UgaGFzIGV4cGlyZWQuIFBsZWFzZSBleHRlbmQgeW91ciBsaWNlbnNlIG9yIGRpc2FibGUgU2VjdXJpdHkgaW4gRWxhc3RpY3NlYXJjaC4nO1xuICAgIGxpbmtzTWVzc2FnZSA9ICdBY2Nlc3MgaXMgZGVuaWVkIGJlY2F1c2UgeW91ciBsaWNlbnNlIGhhcyBleHBpcmVkLiBQbGVhc2UgZXh0ZW5kIHlvdXIgbGljZW5zZS4nO1xuICAgIHNob3dMb2dpbiA9IHRydWU7XG4gICAgYWxsb3dMb2dpbiA9IGZhbHNlO1xuICAgIHNob3dMaW5rcyA9IGZhbHNlO1xuICAgIGFsbG93Um9sZURvY3VtZW50TGV2ZWxTZWN1cml0eSA9IGZhbHNlO1xuICAgIGFsbG93Um9sZUZpZWxkTGV2ZWxTZWN1cml0eSA9IGZhbHNlO1xuICB9IGVsc2Uge1xuICAgIHNob3dMb2dpbiA9IHRydWU7XG4gICAgYWxsb3dMb2dpbiA9IHRydWU7XG4gICAgc2hvd0xpbmtzID0gdHJ1ZTtcbiAgICBhbGxvd1JvbGVEb2N1bWVudExldmVsU2VjdXJpdHkgPSB0cnVlO1xuICAgIGFsbG93Um9sZUZpZWxkTGV2ZWxTZWN1cml0eSA9IHRydWU7XG4gIH07XG5cbiAgcmV0dXJuIHtcbiAgICBzaG93TG9naW4sXG4gICAgYWxsb3dMb2dpbixcbiAgICBzaG93TGlua3MsXG4gICAgbG9naW5NZXNzYWdlLFxuICAgIGxpbmtzTWVzc2FnZSxcbiAgICBhbGxvd1JvbGVEb2N1bWVudExldmVsU2VjdXJpdHksXG4gICAgYWxsb3dSb2xlRmllbGRMZXZlbFNlY3VyaXR5XG4gIH07XG5cbn07XG4iXX0=",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/check_license.js"
      ],
      "names": [],
      "mappings": ";;;;;qBAAwB,YAAY;;AAArB,SAAS,YAAY,CAAC,gBAAgB,EAAE;;AAErD,MAAI,SAAS,YAAA,CAAC;AACd,MAAI,UAAU,YAAA,CAAC;AACf,MAAI,SAAS,YAAA,CAAC;AACd,MAAI,8BAA8B,YAAA,CAAC;AACnC,MAAI,2BAA2B,YAAA,CAAC;;AAEhC,MAAI,YAAY,YAAA,CAAC;AACjB,MAAI,YAAY,YAAA,CAAC;;;;;AAKjB,MAAI,CAAC,gBAAgB,IAAI,CAAC,gBAAgB,CAAC,WAAW,EAAE,EAAE;AACxD,gBAAY,GAAG,2EAA2E,GACxF,qEAAqE,CAAC;AACxE,WAAO;AACL,eAAS,EAAE,IAAI;AACf,gBAAU,EAAE,KAAK;AACjB,eAAS,EAAE,KAAK;AAChB,oCAA8B,EAAE,KAAK;AACrC,iCAA2B,EAAE,KAAK;AAClC,kBAAY,EAAZ,YAAY;AACZ,kBAAY,EAAZ,YAAY;KACb,CAAC;GACH;;AAED,MAAM,eAAe,GAAG,gBAAgB,CAAC,OAAO,CAAC,QAAQ,EAAE,CAAC;AAC5D,MAAM,cAAc,GAAG,gBAAgB,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC;AACnE,MAAM,aAAa,GAAG,gBAAgB,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC;AACjE,MAAM,aAAa,GAAG,gBAAgB,CAAC,OAAO,CAAC,UAAU,CAAC,CAAC,SAAS,EAAE,CAAC;;AAEvE,MAAI,CAAC,aAAa,EAAE;AAClB,gBAAY,GAAG,iEAAiE,CAAC;AACjF,aAAS,GAAG,KAAK,CAAC;AAClB,cAAU,GAAG,IAAI,CAAC;AAClB,aAAS,GAAG,KAAK,CAAC;AAClB,kCAA8B,GAAG,KAAK,CAAC;AACvC,+BAA2B,GAAG,KAAK,CAAC;GACrC,MAAM,IAAI,cAAc,EAAE;AACzB,gBAAY,GAAG,4EAA4E,CAAC;AAC5F,aAAS,GAAG,KAAK,CAAC;AAClB,cAAU,GAAG,IAAI,CAAC;AAClB,aAAS,GAAG,KAAK,CAAC;AAClB,kCAA8B,GAAG,KAAK,CAAC;AACvC,+BAA2B,GAAG,KAAK,CAAC;GACrC,MAAM,IAAI,aAAa,EAAE;AACxB,gBAAY,GAAG,IAAI,CAAC;AACpB,aAAS,GAAG,IAAI,CAAC;AACjB,cAAU,GAAG,IAAI,CAAC;AAClB,aAAS,GAAG,IAAI,CAAC;AACjB,kCAA8B,GAAG,KAAK,CAAC;AACvC,+BAA2B,GAAG,KAAK,CAAC;GACrC,MAAM,IAAI,CAAC,eAAe,EAAE;AAC3B,gBAAY,GAAG,sHAAsH,CAAC;AACtI,gBAAY,GAAG,gFAAgF,CAAC;AAChG,aAAS,GAAG,IAAI,CAAC;AACjB,cAAU,GAAG,KAAK,CAAC;AACnB,aAAS,GAAG,KAAK,CAAC;AAClB,kCAA8B,GAAG,KAAK,CAAC;AACvC,+BAA2B,GAAG,KAAK,CAAC;GACrC,MAAM;AACL,aAAS,GAAG,IAAI,CAAC;AACjB,cAAU,GAAG,IAAI,CAAC;AAClB,aAAS,GAAG,IAAI,CAAC;AACjB,kCAA8B,GAAG,IAAI,CAAC;AACtC,+BAA2B,GAAG,IAAI,CAAC;GACpC,CAAC;;AAEF,SAAO;AACL,aAAS,EAAT,SAAS;AACT,cAAU,EAAV,UAAU;AACV,aAAS,EAAT,SAAS;AACT,gBAAY,EAAZ,YAAY;AACZ,gBAAY,EAAZ,YAAY;AACZ,kCAA8B,EAA9B,8BAA8B;AAC9B,+BAA2B,EAA3B,2BAA2B;GAC5B,CAAC;CAEH;;AAAA,CAAC",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/security/server/lib/check_license.js",
      "sourcesContent": [
        "export default function checkLicense(xpackLicenseInfo) {\n\n  let showLogin; // show login page or skip it?\n  let allowLogin; // allow login or disable it on the login page?\n  let showLinks; // show security links throughout the kibana app?\n  let allowRoleDocumentLevelSecurity; // allow users to define document level security in roles?\n  let allowRoleFieldLevelSecurity; // allow users to define field level security in roles?\n\n  let loginMessage; // message to show on login page\n  let linksMessage; // message to show when security links are clicked throughout the kibana app\n\n  // If, for some reason, we cannot get license information\n  // from Elasticsearch, assume worst-case and lock user\n  // at login screen.\n  if (!xpackLicenseInfo || !xpackLicenseInfo.isAvailable()) {\n    loginMessage = 'Login is currently disabled because the license could not be determined. '\n    + 'Please check that Elasticsearch is running, then refresh this page.';\n    return {\n      showLogin: true,\n      allowLogin: false,\n      showLinks: false,\n      allowRoleDocumentLevelSecurity: false,\n      allowRoleFieldLevelSecurity: false,\n      loginMessage,\n      linksMessage\n    };\n  }\n\n  const isLicenseActive = xpackLicenseInfo.license.isActive();\n  const isLicenseBasic = xpackLicenseInfo.license.isOneOf(['basic']);\n  const isLicenseGold = xpackLicenseInfo.license.isOneOf(['gold']);\n  const isEnabledInES = xpackLicenseInfo.feature('security').isEnabled();\n\n  if (!isEnabledInES) {\n    linksMessage = 'Access is denied because Security is disabled in Elasticsearch.';\n    showLogin = false;\n    allowLogin = null;\n    showLinks = false;\n    allowRoleDocumentLevelSecurity = false;\n    allowRoleFieldLevelSecurity = false;\n  } else if (isLicenseBasic) {\n    linksMessage = 'Your Basic license does not support Security. Please upgrade your license.';\n    showLogin = false;\n    allowLogin = null;\n    showLinks = false;\n    allowRoleDocumentLevelSecurity = false;\n    allowRoleFieldLevelSecurity = false;\n  } else if (isLicenseGold) {\n    linksMessage = null;\n    showLogin = true;\n    allowLogin = true;\n    showLinks = true;\n    allowRoleDocumentLevelSecurity = false;\n    allowRoleFieldLevelSecurity = false;\n  } else if (!isLicenseActive) {\n    loginMessage = 'Login is disabled because your license has expired. Please extend your license or disable Security in Elasticsearch.';\n    linksMessage = 'Access is denied because your license has expired. Please extend your license.';\n    showLogin = true;\n    allowLogin = false;\n    showLinks = false;\n    allowRoleDocumentLevelSecurity = false;\n    allowRoleFieldLevelSecurity = false;\n  } else {\n    showLogin = true;\n    allowLogin = true;\n    showLinks = true;\n    allowRoleDocumentLevelSecurity = true;\n    allowRoleFieldLevelSecurity = true;\n  };\n\n  return {\n    showLogin,\n    allowLogin,\n    showLinks,\n    loginMessage,\n    linksMessage,\n    allowRoleDocumentLevelSecurity,\n    allowRoleFieldLevelSecurity\n  };\n\n};\n"
      ]
    },
    "mtime": 1491771510468
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/searchprofiler/index.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "path",
            "imported": [
              "resolve"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "resolve",
                "local": "resolve"
              }
            ]
          },
          {
            "source": "./server/routes/profile",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "profileRoute"
              }
            ]
          },
          {
            "source": "boom",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "Boom"
              }
            ]
          },
          {
            "source": "./server/lib/check_license",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "checkLicense"
              }
            ]
          },
          {
            "source": "../../server/lib/mirror_plugin_status",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "mirrorPluginStatus"
              }
            ]
          }
        ],
        "exports": {
          "exported": [],
          "specifiers": []
        }
      },
      "usedHelpers": [
        "interop-require-default"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _path = require('path');\n\nvar _serverRoutesProfile = require('./server/routes/profile');\n\nvar _serverRoutesProfile2 = _interopRequireDefault(_serverRoutesProfile);\n\n// License\n\nvar _boom = require('boom');\n\nvar _boom2 = _interopRequireDefault(_boom);\n\nvar _serverLibCheck_license = require('./server/lib/check_license');\n\nvar _serverLibCheck_license2 = _interopRequireDefault(_serverLibCheck_license);\n\nvar _serverLibMirror_plugin_status = require('../../server/lib/mirror_plugin_status');\n\nvar _serverLibMirror_plugin_status2 = _interopRequireDefault(_serverLibMirror_plugin_status);\n\nexports['default'] = function (kibana) {\n  return new kibana.Plugin({\n    require: ['elasticsearch', 'xpack_main'],\n    id: 'searchprofiler',\n    configPrefix: 'xpack.searchprofiler',\n    publicDir: (0, _path.resolve)(__dirname, 'public'),\n\n    uiExports: {\n      devTools: ['plugins/searchprofiler/app'],\n      hacks: ['plugins/searchprofiler/register']\n    },\n    init: function init(server) {\n      var thisPlugin = this;\n      var xpackMainPlugin = server.plugins.xpack_main;\n      (0, _serverLibMirror_plugin_status2['default'])(xpackMainPlugin, thisPlugin);\n      xpackMainPlugin.status.once('green', function () {\n        // Register a function that is called whenever the xpack info changes,\n        // to re-compute the license check results for this plugin\n        xpackMainPlugin.info.feature(thisPlugin.id).registerLicenseCheckResultsGenerator(_serverLibCheck_license2['default']);\n      });\n\n      // Add server routes and initalize the plugin here\n      var commonRouteConfig = {\n        pre: [function forbidApiAccess(request, reply) {\n          var licenseCheckResults = xpackMainPlugin.info.feature(thisPlugin.id).getLicenseCheckResults();\n          if (licenseCheckResults.showAppLink && licenseCheckResults.enableAppLink) {\n            reply();\n          } else {\n            reply(_boom2['default'].forbidden(licenseCheckResults.message));\n          }\n        }]\n      };\n      (0, _serverRoutesProfile2['default'])(server, commonRouteConfig);\n    }\n\n  });\n};\n\nmodule.exports = exports['default'];\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvc2VhcmNocHJvZmlsZXIvaW5kZXguanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7b0JBQXdCLE1BQU07O21DQUNMLHlCQUF5Qjs7Ozs7O29CQUdqQyxNQUFNOzs7O3NDQUNFLDRCQUE0Qjs7Ozs2Q0FDdEIsdUNBQXVDOzs7O3FCQUd2RCxVQUFBLE1BQU0sRUFBSTtBQUN2QixTQUFPLElBQUksTUFBTSxDQUFDLE1BQU0sQ0FBQztBQUN2QixXQUFPLEVBQUUsQ0FBQyxlQUFlLEVBQUUsWUFBWSxDQUFDO0FBQ3hDLE1BQUUsRUFBRSxnQkFBZ0I7QUFDcEIsZ0JBQVksRUFBRSxzQkFBc0I7QUFDcEMsYUFBUyxFQUFFLG1CQUFRLFNBQVMsRUFBRSxRQUFRLENBQUM7O0FBRXZDLGFBQVMsRUFBRTtBQUNULGNBQVEsRUFBRSxDQUFDLDRCQUE0QixDQUFDO0FBQ3hDLFdBQUssRUFBRSxDQUFDLGlDQUFpQyxDQUFDO0tBQzNDO0FBQ0QsUUFBSSxFQUFFLGNBQVUsTUFBTSxFQUFFO0FBQ3RCLFVBQU0sVUFBVSxHQUFHLElBQUksQ0FBQztBQUN4QixVQUFNLGVBQWUsR0FBRyxNQUFNLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQztBQUNsRCxzREFBbUIsZUFBZSxFQUFFLFVBQVUsQ0FBQyxDQUFDO0FBQ2hELHFCQUFlLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsWUFBTTs7O0FBR3pDLHVCQUFlLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxVQUFVLENBQUMsRUFBRSxDQUFDLENBQUMsb0NBQW9DLHFDQUFjLENBQUM7T0FDaEcsQ0FBQyxDQUFDOzs7QUFHSCxVQUFNLGlCQUFpQixHQUFHO0FBQ3hCLFdBQUcsRUFBRSxDQUNILFNBQVMsZUFBZSxDQUFDLE9BQU8sRUFBRSxLQUFLLEVBQUU7QUFDdkMsY0FBTSxtQkFBbUIsR0FBRyxlQUFlLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxVQUFVLENBQUMsRUFBRSxDQUFDLENBQUMsc0JBQXNCLEVBQUUsQ0FBQztBQUNqRyxjQUFJLG1CQUFtQixDQUFDLFdBQVcsSUFBSSxtQkFBbUIsQ0FBQyxhQUFhLEVBQUU7QUFDeEUsaUJBQUssRUFBRSxDQUFDO1dBQ1QsTUFBTTtBQUNMLGlCQUFLLENBQUMsa0JBQUssU0FBUyxDQUFDLG1CQUFtQixDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUM7V0FDcEQ7U0FDRixDQUNGO09BQ0YsQ0FBQztBQUNGLDRDQUFhLE1BQU0sRUFBRSxpQkFBaUIsQ0FBQyxDQUFDO0tBQ3pDOztHQUVGLENBQUMsQ0FBQztDQUNKIiwiZmlsZSI6Ii91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvc2VhcmNocHJvZmlsZXIvaW5kZXguanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyByZXNvbHZlIH0gZnJvbSAncGF0aCc7XG5pbXBvcnQgcHJvZmlsZVJvdXRlIGZyb20gJy4vc2VydmVyL3JvdXRlcy9wcm9maWxlJztcblxuLy8gTGljZW5zZVxuaW1wb3J0IEJvb20gZnJvbSAnYm9vbSc7XG5pbXBvcnQgY2hlY2tMaWNlbnNlIGZyb20gJy4vc2VydmVyL2xpYi9jaGVja19saWNlbnNlJztcbmltcG9ydCBtaXJyb3JQbHVnaW5TdGF0dXMgZnJvbSAnLi4vLi4vc2VydmVyL2xpYi9taXJyb3JfcGx1Z2luX3N0YXR1cyc7XG5cblxuZXhwb3J0IGRlZmF1bHQga2liYW5hID0+IHtcbiAgcmV0dXJuIG5ldyBraWJhbmEuUGx1Z2luKHtcbiAgICByZXF1aXJlOiBbJ2VsYXN0aWNzZWFyY2gnLCAneHBhY2tfbWFpbiddLFxuICAgIGlkOiAnc2VhcmNocHJvZmlsZXInLFxuICAgIGNvbmZpZ1ByZWZpeDogJ3hwYWNrLnNlYXJjaHByb2ZpbGVyJyxcbiAgICBwdWJsaWNEaXI6IHJlc29sdmUoX19kaXJuYW1lLCAncHVibGljJyksXG5cbiAgICB1aUV4cG9ydHM6IHtcbiAgICAgIGRldlRvb2xzOiBbJ3BsdWdpbnMvc2VhcmNocHJvZmlsZXIvYXBwJ10sXG4gICAgICBoYWNrczogWydwbHVnaW5zL3NlYXJjaHByb2ZpbGVyL3JlZ2lzdGVyJ11cbiAgICB9LFxuICAgIGluaXQ6IGZ1bmN0aW9uIChzZXJ2ZXIpIHtcbiAgICAgIGNvbnN0IHRoaXNQbHVnaW4gPSB0aGlzO1xuICAgICAgY29uc3QgeHBhY2tNYWluUGx1Z2luID0gc2VydmVyLnBsdWdpbnMueHBhY2tfbWFpbjtcbiAgICAgIG1pcnJvclBsdWdpblN0YXR1cyh4cGFja01haW5QbHVnaW4sIHRoaXNQbHVnaW4pO1xuICAgICAgeHBhY2tNYWluUGx1Z2luLnN0YXR1cy5vbmNlKCdncmVlbicsICgpID0+IHtcbiAgICAgICAgLy8gUmVnaXN0ZXIgYSBmdW5jdGlvbiB0aGF0IGlzIGNhbGxlZCB3aGVuZXZlciB0aGUgeHBhY2sgaW5mbyBjaGFuZ2VzLFxuICAgICAgICAvLyB0byByZS1jb21wdXRlIHRoZSBsaWNlbnNlIGNoZWNrIHJlc3VsdHMgZm9yIHRoaXMgcGx1Z2luXG4gICAgICAgIHhwYWNrTWFpblBsdWdpbi5pbmZvLmZlYXR1cmUodGhpc1BsdWdpbi5pZCkucmVnaXN0ZXJMaWNlbnNlQ2hlY2tSZXN1bHRzR2VuZXJhdG9yKGNoZWNrTGljZW5zZSk7XG4gICAgICB9KTtcblxuICAgICAgLy8gQWRkIHNlcnZlciByb3V0ZXMgYW5kIGluaXRhbGl6ZSB0aGUgcGx1Z2luIGhlcmVcbiAgICAgIGNvbnN0IGNvbW1vblJvdXRlQ29uZmlnID0ge1xuICAgICAgICBwcmU6IFtcbiAgICAgICAgICBmdW5jdGlvbiBmb3JiaWRBcGlBY2Nlc3MocmVxdWVzdCwgcmVwbHkpIHtcbiAgICAgICAgICAgIGNvbnN0IGxpY2Vuc2VDaGVja1Jlc3VsdHMgPSB4cGFja01haW5QbHVnaW4uaW5mby5mZWF0dXJlKHRoaXNQbHVnaW4uaWQpLmdldExpY2Vuc2VDaGVja1Jlc3VsdHMoKTtcbiAgICAgICAgICAgIGlmIChsaWNlbnNlQ2hlY2tSZXN1bHRzLnNob3dBcHBMaW5rICYmIGxpY2Vuc2VDaGVja1Jlc3VsdHMuZW5hYmxlQXBwTGluaykge1xuICAgICAgICAgICAgICByZXBseSgpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgcmVwbHkoQm9vbS5mb3JiaWRkZW4obGljZW5zZUNoZWNrUmVzdWx0cy5tZXNzYWdlKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICBdXG4gICAgICB9O1xuICAgICAgcHJvZmlsZVJvdXRlKHNlcnZlciwgY29tbW9uUm91dGVDb25maWcpO1xuICAgIH1cblxuICB9KTtcbn07XG4iXX0=",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/searchprofiler/index.js"
      ],
      "names": [],
      "mappings": ";;;;;;;;oBAAwB,MAAM;;mCACL,yBAAyB;;;;;;oBAGjC,MAAM;;;;sCACE,4BAA4B;;;;6CACtB,uCAAuC;;;;qBAGvD,UAAA,MAAM,EAAI;AACvB,SAAO,IAAI,MAAM,CAAC,MAAM,CAAC;AACvB,WAAO,EAAE,CAAC,eAAe,EAAE,YAAY,CAAC;AACxC,MAAE,EAAE,gBAAgB;AACpB,gBAAY,EAAE,sBAAsB;AACpC,aAAS,EAAE,mBAAQ,SAAS,EAAE,QAAQ,CAAC;;AAEvC,aAAS,EAAE;AACT,cAAQ,EAAE,CAAC,4BAA4B,CAAC;AACxC,WAAK,EAAE,CAAC,iCAAiC,CAAC;KAC3C;AACD,QAAI,EAAE,cAAU,MAAM,EAAE;AACtB,UAAM,UAAU,GAAG,IAAI,CAAC;AACxB,UAAM,eAAe,GAAG,MAAM,CAAC,OAAO,CAAC,UAAU,CAAC;AAClD,sDAAmB,eAAe,EAAE,UAAU,CAAC,CAAC;AAChD,qBAAe,CAAC,MAAM,CAAC,IAAI,CAAC,OAAO,EAAE,YAAM;;;AAGzC,uBAAe,CAAC,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,EAAE,CAAC,CAAC,oCAAoC,qCAAc,CAAC;OAChG,CAAC,CAAC;;;AAGH,UAAM,iBAAiB,GAAG;AACxB,WAAG,EAAE,CACH,SAAS,eAAe,CAAC,OAAO,EAAE,KAAK,EAAE;AACvC,cAAM,mBAAmB,GAAG,eAAe,CAAC,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,EAAE,CAAC,CAAC,sBAAsB,EAAE,CAAC;AACjG,cAAI,mBAAmB,CAAC,WAAW,IAAI,mBAAmB,CAAC,aAAa,EAAE;AACxE,iBAAK,EAAE,CAAC;WACT,MAAM;AACL,iBAAK,CAAC,kBAAK,SAAS,CAAC,mBAAmB,CAAC,OAAO,CAAC,CAAC,CAAC;WACpD;SACF,CACF;OACF,CAAC;AACF,4CAAa,MAAM,EAAE,iBAAiB,CAAC,CAAC;KACzC;;GAEF,CAAC,CAAC;CACJ",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/searchprofiler/index.js",
      "sourcesContent": [
        "import { resolve } from 'path';\nimport profileRoute from './server/routes/profile';\n\n// License\nimport Boom from 'boom';\nimport checkLicense from './server/lib/check_license';\nimport mirrorPluginStatus from '../../server/lib/mirror_plugin_status';\n\n\nexport default kibana => {\n  return new kibana.Plugin({\n    require: ['elasticsearch', 'xpack_main'],\n    id: 'searchprofiler',\n    configPrefix: 'xpack.searchprofiler',\n    publicDir: resolve(__dirname, 'public'),\n\n    uiExports: {\n      devTools: ['plugins/searchprofiler/app'],\n      hacks: ['plugins/searchprofiler/register']\n    },\n    init: function (server) {\n      const thisPlugin = this;\n      const xpackMainPlugin = server.plugins.xpack_main;\n      mirrorPluginStatus(xpackMainPlugin, thisPlugin);\n      xpackMainPlugin.status.once('green', () => {\n        // Register a function that is called whenever the xpack info changes,\n        // to re-compute the license check results for this plugin\n        xpackMainPlugin.info.feature(thisPlugin.id).registerLicenseCheckResultsGenerator(checkLicense);\n      });\n\n      // Add server routes and initalize the plugin here\n      const commonRouteConfig = {\n        pre: [\n          function forbidApiAccess(request, reply) {\n            const licenseCheckResults = xpackMainPlugin.info.feature(thisPlugin.id).getLicenseCheckResults();\n            if (licenseCheckResults.showAppLink && licenseCheckResults.enableAppLink) {\n              reply();\n            } else {\n              reply(Boom.forbidden(licenseCheckResults.message));\n            }\n          }\n        ]\n      };\n      profileRoute(server, commonRouteConfig);\n    }\n\n  });\n};\n"
      ]
    },
    "mtime": 1491771506100
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/searchprofiler/server/routes/profile.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "joi",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "Joi"
              }
            ]
          }
        ],
        "exports": {
          "exported": [],
          "specifiers": []
        }
      },
      "usedHelpers": [
        "extends",
        "interop-require-default"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _joi = require('joi');\n\nvar _joi2 = _interopRequireDefault(_joi);\n\nexports['default'] = function (server, commonRouteConfig) {\n\n  server.route({\n    path: '/api/searchprofiler/profile',\n    method: 'POST',\n    config: _extends({}, commonRouteConfig, {\n      validate: {\n        payload: _joi2['default'].object().keys({\n          query: _joi2['default'].object().required(),\n          index: _joi2['default'].string().required(),\n          type: _joi2['default'].string().optional()\n        }).required() //Joi validation\n      }\n    }),\n    handler: function handler(request, reply) {\n      var _server$plugins$elasticsearch$getCluster = server.plugins.elasticsearch.getCluster('data');\n\n      var callWithRequest = _server$plugins$elasticsearch$getCluster.callWithRequest;\n\n      var parsed = request.payload.query;\n      parsed.profile = true;\n      parsed = JSON.stringify(parsed, null, 2);\n\n      var body = {\n        index: request.payload.index,\n        type: request.payload.type,\n        body: parsed\n      };\n\n      callWithRequest(request, 'search', body).then(function (resp) {\n        reply({\n          ok: true,\n          resp: resp\n        });\n      })['catch'](function (err) {\n        reply({\n          ok: false,\n          err: err\n        });\n      });\n    }\n  });\n};\n\nmodule.exports = exports['default'];\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvc2VhcmNocHJvZmlsZXIvc2VydmVyL3JvdXRlcy9wcm9maWxlLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7bUJBQWdCLEtBQUs7Ozs7cUJBRU4sVUFBQyxNQUFNLEVBQUUsaUJBQWlCLEVBQUs7O0FBRTVDLFFBQU0sQ0FBQyxLQUFLLENBQUM7QUFDWCxRQUFJLEVBQUUsNkJBQTZCO0FBQ25DLFVBQU0sRUFBRSxNQUFNO0FBQ2QsVUFBTSxlQUNELGlCQUFpQjtBQUNwQixjQUFRLEVBQUU7QUFDUixlQUFPLEVBQUUsaUJBQUksTUFBTSxFQUFFLENBQUMsSUFBSSxDQUFDO0FBQ3pCLGVBQUssRUFBRSxpQkFBSSxNQUFNLEVBQUUsQ0FBQyxRQUFRLEVBQUU7QUFDOUIsZUFBSyxFQUFFLGlCQUFJLE1BQU0sRUFBRSxDQUFDLFFBQVEsRUFBRTtBQUM5QixjQUFJLEVBQUUsaUJBQUksTUFBTSxFQUFFLENBQUMsUUFBUSxFQUFFO1NBQzlCLENBQUMsQ0FBQyxRQUFRLEVBQUU7T0FDZDtNQUNGO0FBQ0QsV0FBTyxFQUFFLGlCQUFDLE9BQU8sRUFBRSxLQUFLLEVBQUs7cURBRUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxhQUFhLENBQUMsVUFBVSxDQUFDLE1BQU0sQ0FBQzs7VUFBbkUsZUFBZSw0Q0FBZixlQUFlOztBQUN2QixVQUFJLE1BQU0sR0FBRyxPQUFPLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQztBQUNuQyxZQUFNLENBQUMsT0FBTyxHQUFHLElBQUksQ0FBQztBQUN0QixZQUFNLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQyxNQUFNLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDOztBQUV6QyxVQUFNLElBQUksR0FBRztBQUNYLGFBQUssRUFBRSxPQUFPLENBQUMsT0FBTyxDQUFDLEtBQUs7QUFDNUIsWUFBSSxFQUFFLE9BQU8sQ0FBQyxPQUFPLENBQUMsSUFBSTtBQUMxQixZQUFJLEVBQUUsTUFBTTtPQUNiLENBQUM7O0FBRUYscUJBQWUsQ0FBQyxPQUFPLEVBQUUsUUFBUSxFQUFFLElBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFDLElBQUksRUFBSztBQUN0RCxhQUFLLENBQUM7QUFDSixZQUFFLEVBQUUsSUFBSTtBQUNSLGNBQUksRUFBRSxJQUFJO1NBQ1gsQ0FBQyxDQUFDO09BQ0osQ0FBQyxTQUFNLENBQUMsVUFBQyxHQUFHLEVBQUs7QUFDaEIsYUFBSyxDQUFDO0FBQ0osWUFBRSxFQUFFLEtBQUs7QUFDVCxhQUFHLEVBQUUsR0FBRztTQUNULENBQUMsQ0FBQztPQUNKLENBQUMsQ0FBQztLQUNKO0dBQ0YsQ0FBQyxDQUFDO0NBRUoiLCJmaWxlIjoiL3Vzci9zaGFyZS9raWJhbmEvcGx1Z2lucy94LXBhY2svcGx1Z2lucy9zZWFyY2hwcm9maWxlci9zZXJ2ZXIvcm91dGVzL3Byb2ZpbGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgSm9pIGZyb20gJ2pvaSc7XG5cbmV4cG9ydCBkZWZhdWx0IChzZXJ2ZXIsIGNvbW1vblJvdXRlQ29uZmlnKSA9PiB7XG5cbiAgc2VydmVyLnJvdXRlKHtcbiAgICBwYXRoOiAnL2FwaS9zZWFyY2hwcm9maWxlci9wcm9maWxlJyxcbiAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICBjb25maWc6IHtcbiAgICAgIC4uLmNvbW1vblJvdXRlQ29uZmlnLFxuICAgICAgdmFsaWRhdGU6IHtcbiAgICAgICAgcGF5bG9hZDogSm9pLm9iamVjdCgpLmtleXMoe1xuICAgICAgICAgIHF1ZXJ5OiBKb2kub2JqZWN0KCkucmVxdWlyZWQoKSxcbiAgICAgICAgICBpbmRleDogSm9pLnN0cmluZygpLnJlcXVpcmVkKCksXG4gICAgICAgICAgdHlwZTogSm9pLnN0cmluZygpLm9wdGlvbmFsKClcbiAgICAgICAgfSkucmVxdWlyZWQoKSAgICAvL0pvaSB2YWxpZGF0aW9uXG4gICAgICB9XG4gICAgfSxcbiAgICBoYW5kbGVyOiAocmVxdWVzdCwgcmVwbHkpID0+IHtcblxuICAgICAgY29uc3QgeyBjYWxsV2l0aFJlcXVlc3QgfSA9IHNlcnZlci5wbHVnaW5zLmVsYXN0aWNzZWFyY2guZ2V0Q2x1c3RlcignZGF0YScpO1xuICAgICAgbGV0IHBhcnNlZCA9IHJlcXVlc3QucGF5bG9hZC5xdWVyeTtcbiAgICAgIHBhcnNlZC5wcm9maWxlID0gdHJ1ZTtcbiAgICAgIHBhcnNlZCA9IEpTT04uc3RyaW5naWZ5KHBhcnNlZCwgbnVsbCwgMik7XG5cbiAgICAgIGNvbnN0IGJvZHkgPSB7XG4gICAgICAgIGluZGV4OiByZXF1ZXN0LnBheWxvYWQuaW5kZXgsXG4gICAgICAgIHR5cGU6IHJlcXVlc3QucGF5bG9hZC50eXBlLFxuICAgICAgICBib2R5OiBwYXJzZWRcbiAgICAgIH07XG5cbiAgICAgIGNhbGxXaXRoUmVxdWVzdChyZXF1ZXN0LCAnc2VhcmNoJywgYm9keSkudGhlbigocmVzcCkgPT4ge1xuICAgICAgICByZXBseSh7XG4gICAgICAgICAgb2s6IHRydWUsXG4gICAgICAgICAgcmVzcDogcmVzcFxuICAgICAgICB9KTtcbiAgICAgIH0pLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgcmVwbHkoe1xuICAgICAgICAgIG9rOiBmYWxzZSxcbiAgICAgICAgICBlcnI6IGVyclxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfSk7XG5cbn07XG4iXX0=",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/searchprofiler/server/routes/profile.js"
      ],
      "names": [],
      "mappings": ";;;;;;;;;;mBAAgB,KAAK;;;;qBAEN,UAAC,MAAM,EAAE,iBAAiB,EAAK;;AAE5C,QAAM,CAAC,KAAK,CAAC;AACX,QAAI,EAAE,6BAA6B;AACnC,UAAM,EAAE,MAAM;AACd,UAAM,eACD,iBAAiB;AACpB,cAAQ,EAAE;AACR,eAAO,EAAE,iBAAI,MAAM,EAAE,CAAC,IAAI,CAAC;AACzB,eAAK,EAAE,iBAAI,MAAM,EAAE,CAAC,QAAQ,EAAE;AAC9B,eAAK,EAAE,iBAAI,MAAM,EAAE,CAAC,QAAQ,EAAE;AAC9B,cAAI,EAAE,iBAAI,MAAM,EAAE,CAAC,QAAQ,EAAE;SAC9B,CAAC,CAAC,QAAQ,EAAE;OACd;MACF;AACD,WAAO,EAAE,iBAAC,OAAO,EAAE,KAAK,EAAK;qDAEC,MAAM,CAAC,OAAO,CAAC,aAAa,CAAC,UAAU,CAAC,MAAM,CAAC;;UAAnE,eAAe,4CAAf,eAAe;;AACvB,UAAI,MAAM,GAAG,OAAO,CAAC,OAAO,CAAC,KAAK,CAAC;AACnC,YAAM,CAAC,OAAO,GAAG,IAAI,CAAC;AACtB,YAAM,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,EAAE,IAAI,EAAE,CAAC,CAAC,CAAC;;AAEzC,UAAM,IAAI,GAAG;AACX,aAAK,EAAE,OAAO,CAAC,OAAO,CAAC,KAAK;AAC5B,YAAI,EAAE,OAAO,CAAC,OAAO,CAAC,IAAI;AAC1B,YAAI,EAAE,MAAM;OACb,CAAC;;AAEF,qBAAe,CAAC,OAAO,EAAE,QAAQ,EAAE,IAAI,CAAC,CAAC,IAAI,CAAC,UAAC,IAAI,EAAK;AACtD,aAAK,CAAC;AACJ,YAAE,EAAE,IAAI;AACR,cAAI,EAAE,IAAI;SACX,CAAC,CAAC;OACJ,CAAC,SAAM,CAAC,UAAC,GAAG,EAAK;AAChB,aAAK,CAAC;AACJ,YAAE,EAAE,KAAK;AACT,aAAG,EAAE,GAAG;SACT,CAAC,CAAC;OACJ,CAAC,CAAC;KACJ;GACF,CAAC,CAAC;CAEJ",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/searchprofiler/server/routes/profile.js",
      "sourcesContent": [
        "import Joi from 'joi';\n\nexport default (server, commonRouteConfig) => {\n\n  server.route({\n    path: '/api/searchprofiler/profile',\n    method: 'POST',\n    config: {\n      ...commonRouteConfig,\n      validate: {\n        payload: Joi.object().keys({\n          query: Joi.object().required(),\n          index: Joi.string().required(),\n          type: Joi.string().optional()\n        }).required()    //Joi validation\n      }\n    },\n    handler: (request, reply) => {\n\n      const { callWithRequest } = server.plugins.elasticsearch.getCluster('data');\n      let parsed = request.payload.query;\n      parsed.profile = true;\n      parsed = JSON.stringify(parsed, null, 2);\n\n      const body = {\n        index: request.payload.index,\n        type: request.payload.type,\n        body: parsed\n      };\n\n      callWithRequest(request, 'search', body).then((resp) => {\n        reply({\n          ok: true,\n          resp: resp\n        });\n      }).catch((err) => {\n        reply({\n          ok: false,\n          err: err\n        });\n      });\n    }\n  });\n\n};\n"
      ]
    },
    "mtime": 1491771510564
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/searchprofiler/server/lib/check_license.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [],
        "exports": {
          "exported": [
            "checkLicense",
            "xpackLicenseInfo"
          ],
          "specifiers": [
            {
              "kind": "local",
              "local": "checkLicense",
              "exported": "default"
            },
            {
              "kind": "local",
              "local": "xpackLicenseInfo",
              "exported": "default"
            }
          ]
        }
      },
      "usedHelpers": []
    },
    "ignored": false,
    "code": "'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nexports['default'] = checkLicense;\n\nfunction checkLicense(xpackLicenseInfo) {\n\n  if (!xpackLicenseInfo || !xpackLicenseInfo.isAvailable()) {\n    return {\n      showAppLink: true,\n      enableAppLink: false,\n      message: 'Search Profiler is unavailable - license information is not available at this time.'\n    };\n  }\n\n  var isLicenseActive = xpackLicenseInfo.license.isActive();\n  var message = undefined;\n  if (!isLicenseActive) {\n    message = 'Search Profiler is unavailable - license has expired.';\n  }\n\n  if (xpackLicenseInfo.license.isOneOf(['trial', 'basic', 'standard', 'gold', 'platinum'])) {\n    return {\n      showAppLink: true,\n      enableAppLink: isLicenseActive,\n      message: message\n    };\n  }\n\n  message = 'Search Profiler is unavailable for the current ' + xpackLicenseInfo.license.getType() + ' license. Please upgrade your license.';\n  return {\n    showAppLink: false,\n    enableAppLink: false,\n    message: message\n  };\n}\n\nmodule.exports = exports['default'];\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvc2VhcmNocHJvZmlsZXIvc2VydmVyL2xpYi9jaGVja19saWNlbnNlLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O3FCQUF3QixZQUFZOztBQUFyQixTQUFTLFlBQVksQ0FBQyxnQkFBZ0IsRUFBRTs7QUFFckQsTUFBSSxDQUFDLGdCQUFnQixJQUFJLENBQUMsZ0JBQWdCLENBQUMsV0FBVyxFQUFFLEVBQUU7QUFDeEQsV0FBTztBQUNMLGlCQUFXLEVBQUUsSUFBSTtBQUNqQixtQkFBYSxFQUFFLEtBQUs7QUFDcEIsYUFBTyxFQUFFLHFGQUFxRjtLQUMvRixDQUFDO0dBQ0g7O0FBRUQsTUFBTSxlQUFlLEdBQUcsZ0JBQWdCLENBQUMsT0FBTyxDQUFDLFFBQVEsRUFBRSxDQUFDO0FBQzVELE1BQUksT0FBTyxZQUFBLENBQUM7QUFDWixNQUFJLENBQUMsZUFBZSxFQUFFO0FBQ3BCLFdBQU8sMERBQTBELENBQUM7R0FDbkU7O0FBRUQsTUFBSSxnQkFBZ0IsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUUsT0FBTyxFQUFFLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxFQUFFLFVBQVUsQ0FBRSxDQUFDLEVBQUU7QUFDMUYsV0FBTztBQUNMLGlCQUFXLEVBQUUsSUFBSTtBQUNqQixtQkFBYSxFQUFFLGVBQWU7QUFDOUIsYUFBTyxFQUFQLE9BQU87S0FDUixDQUFDO0dBQ0g7O0FBRUQsU0FBTyx1REFBcUQsZ0JBQWdCLENBQUMsT0FBTyxDQUFDLE9BQU8sRUFBRSwyQ0FBd0MsQ0FBQztBQUN2SSxTQUFPO0FBQ0wsZUFBVyxFQUFFLEtBQUs7QUFDbEIsaUJBQWEsRUFBRSxLQUFLO0FBQ3BCLFdBQU8sRUFBUCxPQUFPO0dBQ1IsQ0FBQztDQUNIIiwiZmlsZSI6Ii91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvc2VhcmNocHJvZmlsZXIvc2VydmVyL2xpYi9jaGVja19saWNlbnNlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gY2hlY2tMaWNlbnNlKHhwYWNrTGljZW5zZUluZm8pIHtcblxuICBpZiAoIXhwYWNrTGljZW5zZUluZm8gfHwgIXhwYWNrTGljZW5zZUluZm8uaXNBdmFpbGFibGUoKSkge1xuICAgIHJldHVybiB7XG4gICAgICBzaG93QXBwTGluazogdHJ1ZSxcbiAgICAgIGVuYWJsZUFwcExpbms6IGZhbHNlLFxuICAgICAgbWVzc2FnZTogJ1NlYXJjaCBQcm9maWxlciBpcyB1bmF2YWlsYWJsZSAtIGxpY2Vuc2UgaW5mb3JtYXRpb24gaXMgbm90IGF2YWlsYWJsZSBhdCB0aGlzIHRpbWUuJ1xuICAgIH07XG4gIH1cblxuICBjb25zdCBpc0xpY2Vuc2VBY3RpdmUgPSB4cGFja0xpY2Vuc2VJbmZvLmxpY2Vuc2UuaXNBY3RpdmUoKTtcbiAgbGV0IG1lc3NhZ2U7XG4gIGlmICghaXNMaWNlbnNlQWN0aXZlKSB7XG4gICAgbWVzc2FnZSA9IGBTZWFyY2ggUHJvZmlsZXIgaXMgdW5hdmFpbGFibGUgLSBsaWNlbnNlIGhhcyBleHBpcmVkLmA7XG4gIH1cblxuICBpZiAoeHBhY2tMaWNlbnNlSW5mby5saWNlbnNlLmlzT25lT2YoWyAndHJpYWwnLCAnYmFzaWMnLCAnc3RhbmRhcmQnLCAnZ29sZCcsICdwbGF0aW51bScgXSkpIHtcbiAgICByZXR1cm4ge1xuICAgICAgc2hvd0FwcExpbms6IHRydWUsXG4gICAgICBlbmFibGVBcHBMaW5rOiBpc0xpY2Vuc2VBY3RpdmUsXG4gICAgICBtZXNzYWdlXG4gICAgfTtcbiAgfVxuXG4gIG1lc3NhZ2UgPSBgU2VhcmNoIFByb2ZpbGVyIGlzIHVuYXZhaWxhYmxlIGZvciB0aGUgY3VycmVudCAke3hwYWNrTGljZW5zZUluZm8ubGljZW5zZS5nZXRUeXBlKCl9IGxpY2Vuc2UuIFBsZWFzZSB1cGdyYWRlIHlvdXIgbGljZW5zZS5gO1xuICByZXR1cm4ge1xuICAgIHNob3dBcHBMaW5rOiBmYWxzZSxcbiAgICBlbmFibGVBcHBMaW5rOiBmYWxzZSxcbiAgICBtZXNzYWdlXG4gIH07XG59XG4iXX0=",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/searchprofiler/server/lib/check_license.js"
      ],
      "names": [],
      "mappings": ";;;;;qBAAwB,YAAY;;AAArB,SAAS,YAAY,CAAC,gBAAgB,EAAE;;AAErD,MAAI,CAAC,gBAAgB,IAAI,CAAC,gBAAgB,CAAC,WAAW,EAAE,EAAE;AACxD,WAAO;AACL,iBAAW,EAAE,IAAI;AACjB,mBAAa,EAAE,KAAK;AACpB,aAAO,EAAE,qFAAqF;KAC/F,CAAC;GACH;;AAED,MAAM,eAAe,GAAG,gBAAgB,CAAC,OAAO,CAAC,QAAQ,EAAE,CAAC;AAC5D,MAAI,OAAO,YAAA,CAAC;AACZ,MAAI,CAAC,eAAe,EAAE;AACpB,WAAO,0DAA0D,CAAC;GACnE;;AAED,MAAI,gBAAgB,CAAC,OAAO,CAAC,OAAO,CAAC,CAAE,OAAO,EAAE,OAAO,EAAE,UAAU,EAAE,MAAM,EAAE,UAAU,CAAE,CAAC,EAAE;AAC1F,WAAO;AACL,iBAAW,EAAE,IAAI;AACjB,mBAAa,EAAE,eAAe;AAC9B,aAAO,EAAP,OAAO;KACR,CAAC;GACH;;AAED,SAAO,uDAAqD,gBAAgB,CAAC,OAAO,CAAC,OAAO,EAAE,2CAAwC,CAAC;AACvI,SAAO;AACL,eAAW,EAAE,KAAK;AAClB,iBAAa,EAAE,KAAK;AACpB,WAAO,EAAP,OAAO;GACR,CAAC;CACH",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/searchprofiler/server/lib/check_license.js",
      "sourcesContent": [
        "export default function checkLicense(xpackLicenseInfo) {\n\n  if (!xpackLicenseInfo || !xpackLicenseInfo.isAvailable()) {\n    return {\n      showAppLink: true,\n      enableAppLink: false,\n      message: 'Search Profiler is unavailable - license information is not available at this time.'\n    };\n  }\n\n  const isLicenseActive = xpackLicenseInfo.license.isActive();\n  let message;\n  if (!isLicenseActive) {\n    message = `Search Profiler is unavailable - license has expired.`;\n  }\n\n  if (xpackLicenseInfo.license.isOneOf([ 'trial', 'basic', 'standard', 'gold', 'platinum' ])) {\n    return {\n      showAppLink: true,\n      enableAppLink: isLicenseActive,\n      message\n    };\n  }\n\n  message = `Search Profiler is unavailable for the current ${xpackLicenseInfo.license.getType()} license. Please upgrade your license.`;\n  return {\n    showAppLink: false,\n    enableAppLink: false,\n    message\n  };\n}\n"
      ]
    },
    "mtime": 1491771510564
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/tilemap/index.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [
          {
            "source": "../../server/lib/mirror_plugin_status",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "mirrorPluginStatus"
              }
            ]
          },
          {
            "source": "./server/lib/inspect_settings",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "inspectSettings"
              }
            ]
          },
          {
            "source": "path",
            "imported": [
              "resolve"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "resolve",
                "local": "resolve"
              }
            ]
          }
        ],
        "exports": {
          "exported": [],
          "specifiers": []
        }
      },
      "usedHelpers": [
        "interop-require-default"
      ]
    },
    "ignored": false,
    "code": "'use strict';\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _serverLibMirror_plugin_status = require('../../server/lib/mirror_plugin_status');\n\nvar _serverLibMirror_plugin_status2 = _interopRequireDefault(_serverLibMirror_plugin_status);\n\nvar _serverLibInspect_settings = require('./server/lib/inspect_settings');\n\nvar _serverLibInspect_settings2 = _interopRequireDefault(_serverLibInspect_settings);\n\nvar _path = require('path');\n\nmodule.exports = function (kibana) {\n\n  return new kibana.Plugin({\n    id: 'tilemap',\n    configPrefix: 'xpack.tilemap',\n    require: ['xpack_main', 'kbn_vislib_vis_types'],\n    publicDir: (0, _path.resolve)(__dirname, 'public'),\n    uiExports: {\n      visTypeEnhancers: ['plugins/tilemap/vis_type_enhancers/update_tilemap_settings']\n    },\n    init: function init(server) {\n      var thisPlugin = this;\n      var xpackMainPlugin = server.plugins.xpack_main;\n      (0, _serverLibMirror_plugin_status2['default'])(xpackMainPlugin, thisPlugin);\n      xpackMainPlugin.status.once('green', function () {\n        xpackMainPlugin.info.feature(thisPlugin.id).registerLicenseCheckResultsGenerator(_serverLibInspect_settings2['default']);\n      });\n    }\n  });\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvdGlsZW1hcC9pbmRleC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OzZDQUErQix1Q0FBdUM7Ozs7eUNBQzFDLCtCQUErQjs7OztvQkFDckMsTUFBTTs7QUFFNUIsTUFBTSxDQUFDLE9BQU8sR0FBRyxVQUFVLE1BQU0sRUFBRTs7QUFFakMsU0FBTyxJQUFJLE1BQU0sQ0FBQyxNQUFNLENBQUM7QUFDdkIsTUFBRSxFQUFFLFNBQVM7QUFDYixnQkFBWSxFQUFFLGVBQWU7QUFDN0IsV0FBTyxFQUFFLENBQUMsWUFBWSxFQUFFLHNCQUFzQixDQUFDO0FBQy9DLGFBQVMsRUFBRSxtQkFBUSxTQUFTLEVBQUUsUUFBUSxDQUFDO0FBQ3ZDLGFBQVMsRUFBQztBQUNSLHNCQUFnQixFQUFFLENBQUUsNERBQTRELENBQUM7S0FDbEY7QUFDRCxRQUFJLEVBQUUsY0FBVSxNQUFNLEVBQUU7QUFDdEIsVUFBTSxVQUFVLEdBQUcsSUFBSSxDQUFDO0FBQ3hCLFVBQU0sZUFBZSxHQUFHLE1BQU0sQ0FBQyxPQUFPLENBQUMsVUFBVSxDQUFDO0FBQ2xELHNEQUFtQixlQUFlLEVBQUUsVUFBVSxDQUFDLENBQUM7QUFDaEQscUJBQWUsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxZQUFNO0FBQ3pDLHVCQUFlLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxVQUFVLENBQUMsRUFBRSxDQUFDLENBQUMsb0NBQW9DLHdDQUFpQixDQUFDO09BQ25HLENBQUMsQ0FBQztLQUNKO0dBQ0YsQ0FBQyxDQUFDO0NBQ0osQ0FBQyIsImZpbGUiOiIvdXNyL3NoYXJlL2tpYmFuYS9wbHVnaW5zL3gtcGFjay9wbHVnaW5zL3RpbGVtYXAvaW5kZXguanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgbWlycm9yUGx1Z2luU3RhdHVzIGZyb20gJy4uLy4uL3NlcnZlci9saWIvbWlycm9yX3BsdWdpbl9zdGF0dXMnO1xuaW1wb3J0IGluc3BlY3RTZXR0aW5ncyBmcm9tICcuL3NlcnZlci9saWIvaW5zcGVjdF9zZXR0aW5ncyc7XG5pbXBvcnQge3Jlc29sdmV9IGZyb20gJ3BhdGgnO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChraWJhbmEpIHtcblxuICByZXR1cm4gbmV3IGtpYmFuYS5QbHVnaW4oe1xuICAgIGlkOiAndGlsZW1hcCcsXG4gICAgY29uZmlnUHJlZml4OiAneHBhY2sudGlsZW1hcCcsXG4gICAgcmVxdWlyZTogWyd4cGFja19tYWluJywgJ2tibl92aXNsaWJfdmlzX3R5cGVzJ10sXG4gICAgcHVibGljRGlyOiByZXNvbHZlKF9fZGlybmFtZSwgJ3B1YmxpYycpLFxuICAgIHVpRXhwb3J0czp7XG4gICAgICB2aXNUeXBlRW5oYW5jZXJzOiBbICdwbHVnaW5zL3RpbGVtYXAvdmlzX3R5cGVfZW5oYW5jZXJzL3VwZGF0ZV90aWxlbWFwX3NldHRpbmdzJ10sXG4gICAgfSxcbiAgICBpbml0OiBmdW5jdGlvbiAoc2VydmVyKSB7XG4gICAgICBjb25zdCB0aGlzUGx1Z2luID0gdGhpcztcbiAgICAgIGNvbnN0IHhwYWNrTWFpblBsdWdpbiA9IHNlcnZlci5wbHVnaW5zLnhwYWNrX21haW47XG4gICAgICBtaXJyb3JQbHVnaW5TdGF0dXMoeHBhY2tNYWluUGx1Z2luLCB0aGlzUGx1Z2luKTtcbiAgICAgIHhwYWNrTWFpblBsdWdpbi5zdGF0dXMub25jZSgnZ3JlZW4nLCAoKSA9PiB7XG4gICAgICAgIHhwYWNrTWFpblBsdWdpbi5pbmZvLmZlYXR1cmUodGhpc1BsdWdpbi5pZCkucmVnaXN0ZXJMaWNlbnNlQ2hlY2tSZXN1bHRzR2VuZXJhdG9yKGluc3BlY3RTZXR0aW5ncyk7XG4gICAgICB9KTtcbiAgICB9XG4gIH0pO1xufTtcbiJdfQ==",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/tilemap/index.js"
      ],
      "names": [],
      "mappings": ";;;;6CAA+B,uCAAuC;;;;yCAC1C,+BAA+B;;;;oBACrC,MAAM;;AAE5B,MAAM,CAAC,OAAO,GAAG,UAAU,MAAM,EAAE;;AAEjC,SAAO,IAAI,MAAM,CAAC,MAAM,CAAC;AACvB,MAAE,EAAE,SAAS;AACb,gBAAY,EAAE,eAAe;AAC7B,WAAO,EAAE,CAAC,YAAY,EAAE,sBAAsB,CAAC;AAC/C,aAAS,EAAE,mBAAQ,SAAS,EAAE,QAAQ,CAAC;AACvC,aAAS,EAAC;AACR,sBAAgB,EAAE,CAAE,4DAA4D,CAAC;KAClF;AACD,QAAI,EAAE,cAAU,MAAM,EAAE;AACtB,UAAM,UAAU,GAAG,IAAI,CAAC;AACxB,UAAM,eAAe,GAAG,MAAM,CAAC,OAAO,CAAC,UAAU,CAAC;AAClD,sDAAmB,eAAe,EAAE,UAAU,CAAC,CAAC;AAChD,qBAAe,CAAC,MAAM,CAAC,IAAI,CAAC,OAAO,EAAE,YAAM;AACzC,uBAAe,CAAC,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,EAAE,CAAC,CAAC,oCAAoC,wCAAiB,CAAC;OACnG,CAAC,CAAC;KACJ;GACF,CAAC,CAAC;CACJ,CAAC",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/tilemap/index.js",
      "sourcesContent": [
        "import mirrorPluginStatus from '../../server/lib/mirror_plugin_status';\nimport inspectSettings from './server/lib/inspect_settings';\nimport {resolve} from 'path';\n\nmodule.exports = function (kibana) {\n\n  return new kibana.Plugin({\n    id: 'tilemap',\n    configPrefix: 'xpack.tilemap',\n    require: ['xpack_main', 'kbn_vislib_vis_types'],\n    publicDir: resolve(__dirname, 'public'),\n    uiExports:{\n      visTypeEnhancers: [ 'plugins/tilemap/vis_type_enhancers/update_tilemap_settings'],\n    },\n    init: function (server) {\n      const thisPlugin = this;\n      const xpackMainPlugin = server.plugins.xpack_main;\n      mirrorPluginStatus(xpackMainPlugin, thisPlugin);\n      xpackMainPlugin.status.once('green', () => {\n        xpackMainPlugin.info.feature(thisPlugin.id).registerLicenseCheckResultsGenerator(inspectSettings);\n      });\n    }\n  });\n};\n"
      ]
    },
    "mtime": 1491771506060
  },
  "{\"filename\":\"/usr/share/kibana/plugins/x-pack/plugins/tilemap/server/lib/inspect_settings.js\",\"extra\":{},\"env\":{},\"retainLines\":false,\"nonStandard\":true,\"experimental\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"stage\":2,\"blacklist\":[],\"optional\":[],\"modules\":\"common\",\"moduleIds\":false,\"jsxPragma\":\"React.createElement\",\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"keepModuleIdExtensions\":false,\"auxiliaryCommentAfter\":\"\",\"externalHelpers\":false,\"metadataUsedHelpers\":false,\"breakConfig\":false,\"sourceType\":\"module\"}:5.8.38": {
    "metadata": {
      "modules": {
        "imports": [],
        "exports": {
          "exported": [],
          "specifiers": []
        }
      },
      "usedHelpers": []
    },
    "ignored": false,
    "code": "'use strict';\n\nmodule.exports = function (xpackInfo) {\n\n  if (!xpackInfo || !xpackInfo.isAvailable()) {\n    return {\n      message: 'You cannot use the Tilemap Plugin because license information is not available at this time.'\n    };\n  }\n\n  /**\n   *Propagate these settings to the client\n   */\n  return {\n    license: {\n      uid: xpackInfo.license.getUid(),\n      active: xpackInfo.license.isActive(),\n      valid: xpackInfo.license.isOneOf(['trial', 'standard', 'gold', 'platinum'])\n    }\n  };\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvdGlsZW1hcC9zZXJ2ZXIvbGliL2luc3BlY3Rfc2V0dGluZ3MuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxNQUFNLENBQUMsT0FBTyxHQUFHLFVBQVUsU0FBUyxFQUFFOztBQUVwQyxNQUFJLENBQUMsU0FBUyxJQUFJLENBQUMsU0FBUyxDQUFDLFdBQVcsRUFBRSxFQUFFO0FBQzFDLFdBQU87QUFDTCxhQUFPLEVBQUUsOEZBQThGO0tBQ3hHLENBQUM7R0FDSDs7Ozs7QUFLRCxTQUFPO0FBQ0wsV0FBTyxFQUFFO0FBQ1AsU0FBRyxFQUFFLFNBQVMsQ0FBQyxPQUFPLENBQUMsTUFBTSxFQUFFO0FBQy9CLFlBQU0sRUFBRSxTQUFTLENBQUMsT0FBTyxDQUFDLFFBQVEsRUFBRTtBQUNwQyxXQUFLLEVBQUUsU0FBUyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsQ0FBQyxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sRUFBRSxVQUFVLENBQUMsQ0FBQztLQUM1RTtHQUNGLENBQUM7Q0FFSCxDQUFDIiwiZmlsZSI6Ii91c3Ivc2hhcmUva2liYW5hL3BsdWdpbnMveC1wYWNrL3BsdWdpbnMvdGlsZW1hcC9zZXJ2ZXIvbGliL2luc3BlY3Rfc2V0dGluZ3MuanMiLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uICh4cGFja0luZm8pIHtcblxuICBpZiAoIXhwYWNrSW5mbyB8fCAheHBhY2tJbmZvLmlzQXZhaWxhYmxlKCkpIHtcbiAgICByZXR1cm4ge1xuICAgICAgbWVzc2FnZTogJ1lvdSBjYW5ub3QgdXNlIHRoZSBUaWxlbWFwIFBsdWdpbiBiZWNhdXNlIGxpY2Vuc2UgaW5mb3JtYXRpb24gaXMgbm90IGF2YWlsYWJsZSBhdCB0aGlzIHRpbWUuJ1xuICAgIH07XG4gIH1cblxuICAvKipcbiAgICpQcm9wYWdhdGUgdGhlc2Ugc2V0dGluZ3MgdG8gdGhlIGNsaWVudFxuICAgKi9cbiAgcmV0dXJuIHtcbiAgICBsaWNlbnNlOiB7XG4gICAgICB1aWQ6IHhwYWNrSW5mby5saWNlbnNlLmdldFVpZCgpLFxuICAgICAgYWN0aXZlOiB4cGFja0luZm8ubGljZW5zZS5pc0FjdGl2ZSgpLFxuICAgICAgdmFsaWQ6IHhwYWNrSW5mby5saWNlbnNlLmlzT25lT2YoWyd0cmlhbCcsICdzdGFuZGFyZCcsICdnb2xkJywgJ3BsYXRpbnVtJ10pXG4gICAgfVxuICB9O1xuXG59O1xuIl19",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "/usr/share/kibana/plugins/x-pack/plugins/tilemap/server/lib/inspect_settings.js"
      ],
      "names": [],
      "mappings": ";;AAAA,MAAM,CAAC,OAAO,GAAG,UAAU,SAAS,EAAE;;AAEpC,MAAI,CAAC,SAAS,IAAI,CAAC,SAAS,CAAC,WAAW,EAAE,EAAE;AAC1C,WAAO;AACL,aAAO,EAAE,8FAA8F;KACxG,CAAC;GACH;;;;;AAKD,SAAO;AACL,WAAO,EAAE;AACP,SAAG,EAAE,SAAS,CAAC,OAAO,CAAC,MAAM,EAAE;AAC/B,YAAM,EAAE,SAAS,CAAC,OAAO,CAAC,QAAQ,EAAE;AACpC,WAAK,EAAE,SAAS,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,OAAO,EAAE,UAAU,EAAE,MAAM,EAAE,UAAU,CAAC,CAAC;KAC5E;GACF,CAAC;CAEH,CAAC",
      "file": "/usr/share/kibana/plugins/x-pack/plugins/tilemap/server/lib/inspect_settings.js",
      "sourcesContent": [
        "module.exports = function (xpackInfo) {\n\n  if (!xpackInfo || !xpackInfo.isAvailable()) {\n    return {\n      message: 'You cannot use the Tilemap Plugin because license information is not available at this time.'\n    };\n  }\n\n  /**\n   *Propagate these settings to the client\n   */\n  return {\n    license: {\n      uid: xpackInfo.license.getUid(),\n      active: xpackInfo.license.isActive(),\n      valid: xpackInfo.license.isOneOf(['trial', 'standard', 'gold', 'platinum'])\n    }\n  };\n\n};\n"
      ]
    },
    "mtime": 1491771510468
  }
}